{"id":"wf-08k","title":"bug: waif --version varies by current working directory (git commands use wrong cwd)","description":"Observed: running 'waif --version' from different CWDs outputs different dev version stamps. Root cause: version.js spawns git commands without setting cwd, so git runs in the caller's CWD instead of the waif package root.\\n\\nRepro steps:\\n1. Install waif with local source in /home/rgardler/projects/waif and symlinked bin.\\n2. From /home/rgardler/projects/waif: waif --version -\u003e outputs v0.0.0-dev+\u003cstamp\u003e.\u003chashA\u003e\\n3. From another repo (e.g., ~/projects/GEngine): waif --version -\u003e outputs v0.0.0-dev+\u003cstamp\u003e.\u003chashB\u003e (different)\\n\\nExpected: waif --version should return the version for the waif package (package.json or git hash from the waif repo), independent of the current working directory.\\n\\nSuggested fix: run git child processes with cwd set to the waif package root (derived from import.meta.url) so git rev-parse and git describe operate against the correct repository. Also add unit tests to assert deterministic output when invoked from other directories.,--acceptance:1) getCliVersion returns the same value when invoked from any CWD on the same machine when waif is sourced from /home/rgardler/projects/waif.\\n2) Implementation runs git commands with cwd set to the package root (no reliance on process.cwd()).\\n3) Add unit tests covering dev and release modes and ensuring deterministic behavior when invoked from another repo's CWD.\\n4) Update changelog or release notes if behavior changes.,--json","notes":"Assign to @patch: implement git-cwd fix per analysis. Implementation checklist for @patch:\\n\\n1) Branch: create branch from origin/main named wf-08k/git-cwd-fix (or reuse if exists).\\n2) Code changes (src/lib/version.ts):\\n   - Derive package root: const pkgRoot = fileURLToPath(new URL('../../', import.meta.url));\\n   - Update hasGitDir() to check pkgRoot/.git instead of current CWD.\\n   - Call spawnSync('git', [...], { cwd: pkgRoot, encoding: 'utf8', timeout: 2000 }) for tryGetGitShortHash and isExactGitTag.\\n   - Preserve existing timeout/encoding and error handling.\\n3) Add unit tests: src/lib/version.test.ts (or existing test file): assert that getCliVersion() returns the same value when invoked from a different CWD; cover release/dev modes and WAIF_VERSION_MODE. Mock spawnSync where appropriate to make tests deterministic.\\n4) Build and test: run the project's test/build commands and verify manual checks: from two different directories run waif --version and confirm identical output.\\n5) Open a PR from wf-08k/git-cwd-fix -\u003e origin/main, include link to wf-08k, describe changes, list acceptance criteria.\\n\\nFiles inspected during triage:\\n- src/lib/version.ts\\n- dist/lib/version.js\\n- dist/index.js\\n- /home/rgardler/.npm-global/bin/waif (symlink)\\n\\nAcceptance criteria (summary):\\n- getCliVersion returns the same value regardless of caller CWD when package repo has .git.\\n- spawnSync git calls run with cwd set to package root.\\n- hasGitDir checks pkg root .git.\\n- Tests added and CI passing.\\n\\nWhen you open the PR, please update wf-08k with the PR URL and set status to in_review. If you need me to draft the patch or run the tests locally after you push the branch, say so.","status":"open","priority":1,"issue_type":"bug","assignee":"patch","created_at":"2026-01-08T02:34:22.669212094-08:00","created_by":"WAIF","updated_at":"2026-01-08T02:40:04.287252906-08:00"}
{"id":"wf-0fy","title":"Bug: context command idempotency failure (tests/context.command.test.ts)","notes":"Merged into wf-e6r.2.1/config-loader (commit 117a62dae55e98cf65a385ad82221045c082467f): context command now skips writing self-generated CONTEXT_PACK.md entry and uses relative links; idempotent writes verified by context.command.test.","status":"closed","priority":0,"issue_type":"bug","assignee":"patch","created_at":"2026-01-08T03:01:23.545457083-08:00","created_by":"WAIF","updated_at":"2026-01-11T20:21:00.812124018-08:00","closed_at":"2026-01-11T20:21:00.812124018-08:00","close_reason":"Merged into wf-e6r.2.1 (commit 117a62d). Files: src/commands/context.ts. Tests updated: tests/context.command.test.ts. Closing as implemented.","labels":["Status: Implemented (merged to impl branch)"],"comments":[{"id":98,"issue_id":"wf-0fy","author":"rgardler","text":"Merged into config-loader implementation (commit 117a62dae55e98cf65a385ad82221045c082467f). Files: src/commands/context.ts (idempotency fix). Full test suite passing. Closing bead.","created_at":"2026-01-12T04:11:32Z"}]}
{"id":"wf-0p2","title":"Q3: Define YAML snapshot retention policy for workflow outputs","description":"Recommend timestamped snapshot files in history/ (audit friendly) for v1, with rotation/cleanup as a later maintenance task. Example: history/ooda_snapshot_20251228T170000Z.jsonl.","notes":"Retention policy: v1 writes timestamped snapshot JSONL files under history/ (e.g., history/ooda_snapshot_\u003cts\u003e.jsonl). Rotation/cleanup deferred to maintenance task.","status":"closed","priority":2,"issue_type":"task","assignee":"patch","created_at":"2025-12-28T17:07:30.627597995-08:00","updated_at":"2025-12-28T21:27:56.203771158-08:00","closed_at":"2025-12-28T21:27:56.203785893-08:00","dependencies":[{"issue_id":"wf-0p2","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T17:07:30.628485786-08:00","created_by":"daemon"}]}
{"id":"wf-0rf","title":"CI artifacts missing for PR #112 — wf-d0y (Probe review)","description":"Summary\n\nProbe ran an isolated review of PR #112 for bd#wf-d0y and found that the CI workflow completed but did not upload the expected artifacts (snapshot JSONL and vitest results). Because artifacts are missing, the snapshot fields required by wf-e6r.1.2 could not be verified from CI.\n\nFindings (from Probe):\n- Local tests (isolation worktree) passed 3/3 for the new integration test and retention test.\n- CI run: https://github.com/SorraTheOrc/waif/actions/runs/20981940852\n  - Job succeeded, but artifact step warned: \"No files were found with the provided path: node_modules/.vite/**/results.json tests/**/ooda_snapshot_*.jsonl. No artifacts will be uploaded.\" No artifacts available.\n- Result: cannot verify snapshot JSONL fields (time, job_id, status, exit_code, durationMs, metadata_version) from CI artifacts.\n\nRequest (what to do)\n\nShip, please fix the CI workflow to upload the correct artifacts and re-run the PR job. Specifically:\n1) Update .github/workflows/ooda-e2e.yml to ensure artifact upload paths match the files created by the test. Expected paths to include: tests/**/ooda_snapshot_*.jsonl and any vitest result output (e.g., results.json or junit.xml) produced by the run.\n2) Re-run the PR CI (PR #112) and ensure artifacts are present in the Actions run.\n3) Attach the snapshot JSONL artifact and vitest results to the CI run so QA can verify fields.\n4) In the PR or this new bead, post the CI run URL and confirm artifacts are present. Then the QA reviewer (Probe) will download and verify fields and retention behaviour.\n\nAcceptance criteria\n\n- CI run for PR #112 includes uploaded artifacts: snapshot JSONL (tests/**/ooda_snapshot_*.jsonl) and vitest results (results.json or junit.xml).\n- Probe can download the snapshot JSONL artifact and verify each asserted snapshot line contains fields: time, job_id, status, exit_code, durationMs, metadata_version.\n- Retention trimming behaviour is verifiable from the artifact or from a repeatable test run in CI logs/artifacts.\n- Ship posts a comment on PR #112 and on bd#wf-d0y with the Actions run URL (with artifacts) and notes about what was changed.\n\nCommands / steps Ship can run locally to reproduce/fix\n\n- Inspect workflow artifact upload step in .github/workflows/ooda-e2e.yml\n- Reproduce locally (optional): gh pr checkout 112; npm ci; npm test -- tests/integration/ooda-scheduler-e2e.test.ts; find generated snapshots: find . -name \"ooda_snapshot_*.jsonl\"\n- Update artifact path(s) and commit on wf-d0y/ci-sandbox and open PR (or push to the same PR branch).\n\nReferences\n\n- bd: wf-d0y\n- PR: https://github.com/SorraTheOrc/waif/pull/112\n- Probe review notes: local tests passed 3/3; retention test passed; CI run lacked artifacts: https://github.com/SorraTheOrc/waif/actions/runs/20981940852\n\nPlease respond in this bead with the planned fix and ETA, and post the PR/CI links when available.\n","notes":"PR #122 merged to fix artifact uploads; successful run with artifacts: https://github.com/SorraTheOrc/waif/actions/runs/21019385657. Probe please verify artifacts and close this bead if satisfied.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-13T20:17:24.839499371-08:00","created_by":"WAIF","updated_at":"2026-01-14T20:34:01.670357012-08:00","closed_at":"2026-01-14T20:34:01.670357012-08:00","close_reason":"Closed","labels":["Status: CI Fixed","Status: Fix PR Opened"],"dependencies":[{"issue_id":"wf-0rf","depends_on_id":"wf-d0y","type":"blocks","created_at":"2026-01-13T20:17:24.875690861-08:00","created_by":"WAIF"}]}
{"id":"wf-10f","title":"Show dependencies in waif in-progress: Intake brief","description":"Linked PRD: docs/dev/PRD-command-in-progress.md\nRelated PRD: docs/dev/CLI_PRD.md (console table output requirements)\n\nProblem\n- `waif in-progress` currently prints a table of in-progress Beads issues, but it does not show which specific issues are blocking each in-progress item.\n- Users have to run `bd show` or manually inspect dependencies to learn what is blocking active work.\n\nUsers\n- Primary: Producer/PM using the WAIF CLI to monitor active work and quickly identify what needs to be closed to unblock work.\n- Secondary: workflow agents/maintainers who want inline visibility into blockers without additional commands.\n\nSuccess criteria\n- Running `waif in-progress` (human output) prints the existing in-progress table, and then for **each** in-progress issue prints an indented follow-up section:\n  - If the issue has one or more `blocks` dependencies whose target issue status is **not terminal** (`closed`, `done`, `tombstone`), print an indented sub-table listing those blocking issues.\n  - If there are zero such blockers, print an indented line: `No blockers`.\n- The blocker sub-table must:\n  - Use the same table rendering function/format as the main table.\n  - Be indented by **2 spaces** on every line.\n  - Be sorted by blocking issue ID.\n- Fallback: if dependency details/status cannot be resolved, still list the dependency (treat as blocking).\n- `waif in-progress --json` output remains unchanged.\n\nConstraints\n- Default behavior: blocker sub-tables / `No blockers` are shown by default (no flag required).\n- Risk tolerance: low; prefer reusing proven dependency-enrichment logic (e.g., from `waif next`).\n\nExisting state (current behavior)\n- `src/commands/inProgress.ts` loads in-progress issues via `bd list --status in_progress --json` when `bd` is available (with `.beads/issues.jsonl` fallback).\n- It prints a single table via `renderIssuesTable(issues)`.\n\nDesired change (new behavior)\n- Enhance `waif in-progress` human output by rendering per-issue blocker sections as specified above.\n\nRelated code/docs\n- PRD: docs/dev/PRD-command-in-progress.md\n- src/commands/inProgress.ts\n- src/commands/next.ts (example dependency enrichment)\n- src/lib/table.ts (`renderIssuesTable`)\n- tests/inProgress.test.ts\n\nProposed next step\n- Implement behavior per PRD in `src/commands/inProgress.ts` plus tests; keep `--json` unchanged.","notes":"PR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md\n\n---\n\nPR merged via #46\n\n---\n\nPR merged via #46\n\n---\n\nCleanup completed:\n- Updated wf-10f issue description to point Linked PRD to docs/dev/PRD-command-in-progress.md.\n- Removed/resolved clarifying questions from intake brief; moved locked decisions into Success criteria section.\n\nCommands executed:\n- bd update wf-10f --description ...\n- bd close wf-hn4 --reason ...\n\nDocs referenced:\n- docs/dev/PRD-command-in-progress.md\n- docs/dev/CLI_PRD.md","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-22T10:59:35.054233135-08:00","updated_at":"2025-12-22T16:31:06.87121382-08:00","closed_at":"2025-12-22T15:59:16.360246215-08:00","comments":[{"id":1,"issue_id":"wf-10f","author":"rogardle","text":"Stopped PRD drafting per producer request; intake brief captured and issue remains open for later.","created_at":"2025-12-24T00:43:53Z"},{"id":2,"issue_id":"wf-10f","author":"rogardle","text":"Implementation session stopped per producer request before branching/claiming. Working tree was dirty (.beads/issues.jsonl, package-lock.json); no code changes made for wf-10f.","created_at":"2025-12-24T00:43:53Z"},{"id":3,"issue_id":"wf-10f","author":"rogardle","text":"PRD session stopped per producer request (no PRD file edits made).","created_at":"2025-12-24T00:43:53Z"},{"id":4,"issue_id":"wf-10f","author":"rogardle","text":"Linked PRD: docs/dev/PRD-command-in-progress.md","created_at":"2025-12-24T00:43:53Z"},{"id":5,"issue_id":"wf-10f","author":"rogardle","text":"PR opened: https://github.com/SorraTheOrc/waif/pull/42","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-1at","title":"in th beads summary table the blocks calcualtion is incorrect, see wf-cvz for example","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T17:21:12.358497986-08:00","updated_at":"2025-12-23T17:21:12.358497986-08:00"}
{"id":"wf-1mv","title":"Add lint script + minimal linter config","description":"Problem\\n- The repository has no npm run lint script, but workflow docs expect it as a standard quality gate.\\n\\nGoal\\n- Implement a minimal lint configuration and add an npm run lint script that can be run locally and in CI.\\n\\nScope\\n- Keep changes minimal and low-risk; prefer TypeScript-aware linting if feasible.\\n- Avoid large rule debates; start with a small ruleset and iterate.\\n\\nDeliverables\\n- package.json: add lint script\\n- Add minimal config files (e.g., eslint config)\\n- Update docs to reference the actual lint command and what it enforces\\n- Optionally add CI job/context for branch protection\\n\\nNotes\\n- This should only proceed after wf-z3v decides to implement lint rather than removing/gating lint references.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T23:26:31.296193972-08:00","updated_at":"2025-12-22T23:27:10.965145178-08:00","dependencies":[{"issue_id":"wf-1mv","depends_on_id":"wf-z3v","type":"discovered-from","created_at":"2025-12-22T23:27:27.446599928-08:00","created_by":"daemon"}]}
{"id":"wf-1ne","title":"Spike: collect tmux probe data for ooda","status":"closed","priority":1,"issue_type":"task","assignee":"ship","created_at":"2025-12-23T17:13:16.966870001-08:00","updated_at":"2025-12-23T17:19:52.24844601-08:00","closed_at":"2025-12-23T17:19:52.24844601-08:00","close_reason":"Replaced by hierarchical child wf-cvz.1","dependencies":[{"issue_id":"wf-1ne","depends_on_id":"wf-cvz","type":"discovered-from","created_at":"2025-12-23T17:13:16.971044534-08:00","created_by":"daemon"},{"issue_id":"wf-1ne","depends_on_id":"wf-cvz","type":"blocks","created_at":"2025-12-23T17:16:32.554763826-08:00","created_by":"daemon"}]}
{"id":"wf-1ou","title":"Move config directory to .waif and update references","description":"Move the project configuration directory from config/ to a hidden .waif/ directory at the repo root. Update all code, tests, docs, and tooling to use the new path, with a temporary compatibility shim for legacy installs. Provide migration guidance and ensure CI/tests cover the new discovery order.\n\nScope:\n- Introduce .waif/ as the default config directory (project root).\n- Implement config discovery order: WAIF_CONFIG_DIR (highest), .waif/, then legacy config/ (fallback during deprecation).\n- Update all code references (loaders, defaults, scripts) and tests/fixtures to the new path.\n- Add migration support (script/command) to move config/ -\u003e .waif and document the process.\n- Update documentation/examples and release notes to describe the new default and deprecation of config/.\n- Ensure CI/build tooling and packaging do not rely on config/ hardcodes.\n\nNotes:\n- Keep legacy config/ fallback only for the deprecation window; prefer a clear warning/migration note.\n- Changes must be idempotent and avoid duplicate configs.\n","acceptance_criteria":"- Application config is read from .waif/ by default; WAIF_CONFIG_DIR overrides; legacy config/ is used only as fallback while .waif is absent.\n- All code/tests/scripts/docs reference the new .waif/ path (no reliance on config/ hardcodes); no duplication between config/ and .waif/.\n- Migration support exists (script/command or documented steps) to move existing config/ into .waif/; new installs use .waif/.\n- Tests cover config discovery (env override, .waif default, legacy fallback) and fail if only config/ is available without .waif.\n- Documentation/release notes explain the new default, fallback behavior, and migration steps.\n","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-03T09:58:24.60872237-08:00","created_by":"WAIF","updated_at":"2026-01-03T09:58:24.60872237-08:00"}
{"id":"wf-1un","title":"Revert copilot-pr/setup branch to origin/main (force)","description":"User requested: revert all changes in the current branch (copilot-pr/setup) which has not been merged to main. This task is destructive to the branch: we will reset the branch to origin/main and force-push the result. A backup branch will be created locally and pushed before the destructive operation. Do NOT delete other branches.\\n\\nAcceptance criteria:\\n1) A backup branch named backup/copilot-pr-setup-\u003cshortsha\u003e exists and points to the branch head before the revert.\\n2) The branch copilot-pr/setup on origin matches origin/main (no extra commits).\\n3) .github/workflows/copilot-pr-review.yml is absent from origin/copilot-pr/setup after the revert.\\n4) Provide exact commands run, raw outputs, and verification commands showing the file absence (gh api calls).\\n\\nConstraints: User explicitly approved destructive force-push for this branch only. Do NOT delete the branch; only overwrite it. Timebox: 1h. Priority: P0.","notes":"Reverted copilot-pr/setup to origin/main. Backup branch: backup/copilot-pr-setup-8481674. Commands executed:\n- git fetch origin\n- git fetch origin refs/heads/copilot-pr/setup:refs/heads/bg-temp \u0026\u0026 git rev-parse --short bg-temp \u0026\u0026 git branch -f backup/copilot-pr-setup-8481674 bg-temp \u0026\u0026 git push -u origin backup/copilot-pr-setup-8481674\n- git checkout copilot-pr/setup \u0026\u0026 git reset --hard origin/main \u0026\u0026 git push --force-with-lease origin copilot-pr/setup\n- gh api repos/SorraTheOrc/waif/contents/.github/workflows/copilot-pr-review.yml?ref=copilot-pr/setup --jq . || echo file-missing\\n\\nOutputs:\\n- Backup branch created and pushed: backup/copilot-pr-setup-8481674 (https://github.com/SorraTheOrc/waif/branches)\n- Force-pushed copilot-pr/setup to origin/main (force update).\\n- Verification: gh api returned 404 for the workflow file on copilot-pr/setup (file removed).\\n\\nRun ids / resources changed:\\n- Branch changed: origin/copilot-pr/setup now matches origin/main (HEAD: 9561008).\\n\\nFollow-ups:\\n- If you want the backup branch removed, prepare an explicit approval to delete remote branch backup/copilot-pr-setup-8481674.\\n","status":"closed","priority":0,"issue_type":"task","assignee":"patch","created_at":"2026-01-13T22:43:54.546133084-08:00","created_by":"WAIF","updated_at":"2026-01-13T22:44:23.674587036-08:00","closed_at":"2026-01-13T22:44:23.674593431-08:00"}
{"id":"wf-1xt","title":"Add waif in-progress command","description":"Add a waif in-progress command that prints a table (or emits --json) of all beads issues with status=in_progress. Use bd list --status in_progress --json when bd is available; otherwise parse .beads/issues.jsonl. Include tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T16:08:35.088717087-08:00","updated_at":"2025-12-19T16:11:47.584412718-08:00","closed_at":"2025-12-19T16:11:47.584412718-08:00"}
{"id":"wf-1ze","title":"Enable Actions workflow write permissions for repo (admin)","notes":"Ship: validated Copilot-on-open workflow run; details in build report","status":"closed","priority":0,"issue_type":"task","assignee":"ship","created_at":"2026-01-13T22:05:24.275547743-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:22:42.592056046-08:00","closed_at":"2026-01-14T01:22:42.592056046-08:00","close_reason":"Closed"}
{"id":"wf-20x","title":"Testing Critical Bugs","status":"tombstone","priority":0,"issue_type":"bug","created_at":"2025-12-16T11:09:08.456046263-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"wf-2ch","title":"Feature: Beads DB compaction","description":"Beads DB compaction\n\nSummary\n\nImplement a Beads (bd) feature that supports safe, configurable database compaction workflows based on the recommendations and example scripts from the upstream beads examples (https://github.com/steveyegge/beads/tree/main/examples/compaction). The feature should provide both interactive and fully-automated workflows, support tiered compaction levels, thresholds to avoid low-value runs, and clear observability (logs, stats, cost estimates).\n\nMotivation\n\nCompact sqlite-backed beads DBs periodically to reclaim space, reduce query costs/latency, and keep the JSONL/DB authoritative state tidy for long-running repositories. The upstream examples include workflow.sh (interactive), cron-compact.sh (cron automation) and auto-compact.sh (thresholded automation). Re-implement and integrate these recommendations into this project so teams can run safe compaction as part of maintenance, CI, or scheduled jobs.\n\nScope / Proposed features\n\n- Command surface: provide a 'bd compact' command (or extend existing compact support) with subcommands/modes:\n  - preview / dry-run: list candidate objects and show estimated reclaimable size and issue counts without changing DB\n  - run / execute: perform compaction, with tier option (tier 1 = safe/light, tier 2 = aggressive/deep)\n  - stats: print post-compact statistics and costs (issues compacted, bytes reclaimed, estimated $ cost)\n\n- Automation scripts: add example scripts (interactive workflow.sh, cron-compact.sh, auto-compact.sh) to examples/ or docs/ demonstrating safe usage patterns. These scripts should follow upstream recommendations:\n  - cron-compact: pulls latest changes, runs compact, logs output (BD_LOG_FILE), auto-commits and pushes when compact modifies repo (opt-in)\n  - auto-compact: thresholded runs (only compact when \u003e= N eligible items), supports --tier and --dry-run\n  - workflow.sh: interactive confirmations and preview before committing\n\n- Configuration \u0026 env vars:\n  - ANTHROPIC_API_KEY: only required if using any AI preview helpers from upstream examples (optional)\n  - BD_REPO_PATH: repo path for cron/script usage\n  - BD_LOG_FILE: where to write compaction logs\n  - CLI flags: --tier, --threshold, --dry-run, --yes/--confirm to bypass prompts, --log-file\n\n- Safety \u0026 defaults:\n  - Default to dry-run unless explicit --yes/--commit flag is provided\n  - Provide preview output and require explicit confirmation for any auto-commit/push\n  - Provide idempotent behavior and clear revert guidance in runbook\n\n- Tiering \u0026 thresholds:\n  - Tier 1: Quick compacting of easy candidates; low-risk, suitable for CI/auto mode\n  - Tier 2: Ultra-compression / deep compaction; higher risk/time, suitable for scheduled maintenance\n  - Thresholds to avoid noisy runs (e.g., only run if \u003e= 50 eligible items by default)\n\n- Observability / cost monitoring:\n  - bd compact --stats to show counts, bytes reclaimed, and cost estimate\n  - Log file output and exit codes for CI/crontab\n\n- Testing \u0026 docs:\n  - Provide manual test instructions (how to run dry-run, how to run cron-compact.sh locally)\n  - Add runbook to history/ (or docs/ if intended to be permanent) with recommended schedules by project size (small/medium/large/high-velocity)\n\nOut of scope\n\n- Changes to underlying beads DB schema or the beads core sqlite engine other than invoking existing compact/rewrite mechanisms.\n\nReferences\n\n- Upstream examples: https://github.com/steveyegge/beads/tree/main/examples/compaction\n\nRecommended owners\n\n- Owner (implementation): patch or a maintainer familiar with bd internals\n- Map (PM) to coordinate documentation, acceptance testing and rollout\n\n","acceptance_criteria":"1) Ability to run non-destructive dry-run compaction and produce a preview report. 2) Provide automated compacting scripts for cron/CI (tiered: tier1 quick, tier2 deep) with threshold configuration. 3) Safe default behavior: dry-run and require explicit opt-in for auto-commit/push. 4) Export compact stats via 'bd compact --stats' and log output to configurable file. 5) Docs and runbook added to docs/ or history/ with testing steps. ","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T15:32:38.599454703-08:00","updated_at":"2025-12-24T15:32:38.599454703-08:00","comments":[{"id":27,"issue_id":"wf-2ch","author":"map","text":"Created feature from producer request; expanded description and acceptance criteria based on upstream beads compaction examples (examples/compaction). See history planning for draft runbook and scripts. Files created: none yet. Planning artifacts should live in history/ once implemented.","created_at":"2025-12-24T23:32:41Z"},{"id":28,"issue_id":"wf-2ch","author":"map","text":"Session record: commands executed and next steps\\n\\nCommands run:\\n- bd ready --json (inspect queue)\\n- bd create 'Feature: Beads DB compaction' -t feature -p 2 --body-file - --acceptance ... (created issue wf-2ch)\\n- bd comments add wf-2ch \"Created feature from producer request...\" (context note)\\n\\nFiles / resources referenced:\\n- Upstream examples: https://github.com/steveyegge/beads/tree/main/examples/compaction (README and scripts: workflow.sh, cron-compact.sh, auto-compact.sh)\\n- Recommended future artifacts (not yet created): examples/compaction/{workflow.sh,cron-compact.sh,auto-compact.sh}, docs/COMPACTION.md or history/COMPACTION_RUNBOOK.md\\n\\nWhat I changed:\\n- Created bd feature wf-2ch with expanded description and acceptance criteria. No repository files were modified.\\n\\nRemaining risks / follow-ups:\\n1) Owner assignment: recommend patch for implementation; map (PM) to coordinate docs/testing. Please confirm assignee.\\n2) Automation that auto-commits/pushes requires repo credentials and policy review (opt-in only).\\n3) Need tests and CI integration for thresholded runs and exit codes for cron.\\n4) Decide where permanent docs live: docs/COMPACTION.md (public) vs history/ (ephemeral runbook).\\n\\nNext recommended steps:\\n- Confirm owner (patch?)\\n- Implement bd compact subcommand and add example scripts to examples/compaction/ as draft files under history/ first, then promote to repo when ready.\\n- Add acceptance test plan and add to wf-2ch as child tasks if approved.\\n\\n,json","created_at":"2025-12-24T23:32:58Z"}]}
{"id":"wf-2gj","title":"Add bd to allowed commands for all agents","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T02:22:12.468533317-08:00","updated_at":"2025-12-22T02:22:12.468533317-08:00","dependencies":[{"issue_id":"wf-2gj","depends_on_id":"wf-5ay","type":"parent-child","created_at":"2025-12-22T16:04:44.699326323-08:00","created_by":"daemon"}]}
{"id":"wf-2ia","title":"PM Delegation Workflow","description":"PM Delegation Workflow\n\nRecord of delegation and cleanup\n\nDelegation to Patch\n- Command executed: npm run start -- ask patch to /implement wf-cvz.1\n- Result: Prompt was sent to Patch in a live tmux pane (waif-workflow:specialist.1) instructing Patch to begin implementing the probe child wf-cvz.1. Spike artifacts and a PR were later observed and are referenced from wf-cvz and wf-cvz.1.\n\nNote on duplication\n- This issue previously contained the same delegation addendum twice. The duplicate text has been removed and the single, canonical addendum is presented above.\n\nNext actions\n- Confirm whether Patch should be considered the active owner of wf-cvz.1 (currently in_progress, assignee=rgardler). If so, I will update wf-cvz.1 to assignee=patch and add a comment linking Patch's PR artifacts.\n- Verify PR at: https://github.com/SorraTheOrc/waif/pull/58 and link any additional artifacts to wf-cvz.1.\n\nAudit\n- This update deduplicates the addendum and records the canonical delegation note. For a full audit trail, see bd comments on wf-cvz and wf-cvz.1 and the beads DB (.beads/issues.jsonl).\n\n","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-23T17:30:30.980921561-08:00","updated_at":"2025-12-24T22:08:15.178978293-08:00","closed_at":"2025-12-24T18:54:20.178938385-08:00"}
{"id":"wf-2ih","title":"ooda: include raw and latest OpenCode events in JSON output","description":"Emit both the raw parsed OpenCode events array and the latest-per-agent reduced event set in ooda JSON output so consumers can access full stream and reduced view.","acceptance_criteria":"1) When --json is used, emitted JSON contains opencodeEventsRaw (array) and opencodeEventsLatest (array) in addition to rows. 2) Human table output unchanged. 3) Unit tests still pass.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-27T20:09:27.8727527-08:00","updated_at":"2025-12-28T14:24:41.63859815-08:00","closed_at":"2025-12-28T14:24:41.63859815-08:00","close_reason":"Closed"}
{"id":"wf-2x5","title":"tsc fails: octal escape sequences in startWork.ts","description":"## Summary\n\n[Brief description of the bug]\n\n## Steps to Reproduce\n\n1. Step 1\n2. Step 2\n3. Step 3\n\n## Expected Behavior\n\n[What should happen]\n\n## Actual Behavior\n\n[What actually happens]\n\n## Environment\n\n- OS: [e.g., macOS 15.7.1]\n- Version: [e.g., bd 0.20.1]\n- Additional context: [any relevant details]\n\n## Additional Context\n\n[Screenshots, logs, or other relevant information]\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-19T17:08:41.518775621-08:00","updated_at":"2025-12-22T09:26:17.210114242-08:00","closed_at":"2025-12-19T22:49:16.286035686-08:00","labels":["bug"]}
{"id":"wf-32r","title":"Beads search command: Intake brief","description":"Problem\nAs the number of beads grows it becomes harder to find the right one we are looking for. A search facility will help. Currently we need to use the bd CLI to search; this feature should be exposed in a convenient way as a waif command.\n\nUsers\nPrimary: human producer operating the waif CLI. No secondary stakeholders; agents continue to use bd directly.\n\nSuccess criteria\nProvide a waif command that searches Beads issues by default across title and description, with optional switches to expand search to notes/comments and linked documents. Done when search results are accurate, fast enough for interactive use, and accessible via CLI flags.\n\nConstraints\nNo deadlines or special constraints noted. Must not disrupt existing bd workflows; should work in current environments.\n\nExisting state\nCurrently search requires using bd CLI directly; no waif-native search command exists.\n\nDesired change\nExpose a waif CLI command that wraps search logic with progressive scope flags (default title+description, optional notes/comments, optional linked docs).\n\nLikely duplicates / related docs\n- docs/dev/CLI_PRD.md\n\nRelated issues\n- None\n\nClarifying questions\n1. Should results include metadata like status, priority, and blockers to help triage?\n2. Are fuzzy/partial matches required or should search stay exact substring/regex?\n3. How should linked document search work—do we index docs on demand or rely on existing references?\n4. Should the command support JSON output for scripting?\n5. Are there privacy/visibility limits (e.g., ignore certain labels or private notes)?\n\nProposed next step\nNEW PRD at: docs/dev/beads_search_command_PRD.md\nRecommended next command: /prd docs/dev/beads_search_command_PRD.md \u003cissue-id\u003e","notes":"Intake brief captured via interview; related docs searched (docs/dev/CLI_PRD.md). No existing issues overlap. Next: confirm NEW PRD path docs/dev/beads_search_command_PRD.md.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-22T02:27:01.107209743-08:00","updated_at":"2025-12-22T02:38:39.644507455-08:00","comments":[{"id":6,"issue_id":"wf-32r","author":"map","text":"Linked PRD: docs/dev/beads_search_command_PRD.md","created_at":"2025-12-24T00:43:53Z"},{"id":7,"issue_id":"wf-32r","author":"map","text":"Linked PRD: docs/dev/beads_search_command_PRD.md","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-35m","title":"Code maintainability improvements","description":"## Overview\n\n[Describe the high-level goal and scope of this epic]\n\n## Success Criteria\n\n- [ ] Criteria 1\n- [ ] Criteria 2\n- [ ] Criteria 3\n\n## Background\n\n[Provide context and motivation]\n\n## Scope\n\n**In Scope:**\n- Item 1\n- Item 2\n\n**Out of Scope:**\n- Item 1\n- Item 2\n","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-19T21:47:33.8734976-08:00","updated_at":"2025-12-19T21:47:33.8734976-08:00","labels":["epic"]}
{"id":"wf-35m.1","title":"Refactor bd/bv CLI invocation into shared utility","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:10.438202021-08:00","updated_at":"2025-12-19T21:48:10.438202021-08:00","dependencies":[{"issue_id":"wf-35m.1","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:10.439483168-08:00","created_by":"daemon"}]}
{"id":"wf-35m.2","title":"Centralize issue loading logic and dedupe env/jsonl/CLI paths","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:12.4006343-08:00","updated_at":"2025-12-19T21:48:12.4006343-08:00","dependencies":[{"issue_id":"wf-35m.2","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:12.426971805-08:00","created_by":"daemon"}]}
{"id":"wf-35m.3","title":"Extract shared table rendering and align blockers logic","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:14.437851288-08:00","updated_at":"2025-12-19T21:48:14.437851288-08:00","dependencies":[{"issue_id":"wf-35m.3","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:14.469238414-08:00","created_by":"daemon"}]}
{"id":"wf-35m.4","title":"Reduce code duplication across next/recent/in-progress commands","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:16.637485778-08:00","updated_at":"2025-12-19T21:48:16.637485778-08:00","dependencies":[{"issue_id":"wf-35m.4","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:16.648239136-08:00","created_by":"daemon"}]}
{"id":"wf-35m.5","title":"Add color handling/util tests and centralize ANSI config","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-19T21:48:19.119696813-08:00","updated_at":"2025-12-19T21:48:19.119696813-08:00","dependencies":[{"issue_id":"wf-35m.5","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:19.135534676-08:00","created_by":"daemon"}]}
{"id":"wf-35m.6","title":"Unify clipboard copy behavior and error handling","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-19T21:48:21.203474492-08:00","updated_at":"2025-12-19T21:48:21.203474492-08:00","dependencies":[{"issue_id":"wf-35m.6","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:21.217637092-08:00","created_by":"daemon"}]}
{"id":"wf-35m.7","title":"Add missing error handling coverage for bd/bv spawn failures","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:23.292519541-08:00","updated_at":"2025-12-19T21:48:23.292519541-08:00","dependencies":[{"issue_id":"wf-35m.7","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:23.303631915-08:00","created_by":"daemon"}]}
{"id":"wf-35m.8","title":"Refactor issue parsing to shared type helpers and guards","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:48:25.091957986-08:00","updated_at":"2025-12-19T21:48:25.091957986-08:00","dependencies":[{"issue_id":"wf-35m.8","depends_on_id":"wf-35m","type":"parent-child","created_at":"2025-12-19T21:48:25.113528511-08:00","created_by":"daemon"}]}
{"id":"wf-367","title":"Heuristics: define and unit-test Busy/Free rules","status":"closed","priority":1,"issue_type":"task","assignee":"forge","created_at":"2025-12-23T17:13:23.010060265-08:00","updated_at":"2025-12-23T17:19:57.95384528-08:00","closed_at":"2025-12-23T17:19:57.95384528-08:00","close_reason":"Replaced by hierarchical child wf-cvz.3","dependencies":[{"issue_id":"wf-367","depends_on_id":"wf-cvz","type":"discovered-from","created_at":"2025-12-23T17:13:23.013223947-08:00","created_by":"daemon"},{"issue_id":"wf-367","depends_on_id":"wf-cvz","type":"blocks","created_at":"2025-12-23T17:16:36.627233036-08:00","created_by":"daemon"}]}
{"id":"wf-3di","title":"ship: open PR for wf-r1d.5.1-opencode-plugin (blocked: gh auth)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T01:40:05.522233449-08:00","updated_at":"2025-12-28T14:24:18.692877148-08:00","closed_at":"2025-12-28T14:24:18.692877148-08:00","close_reason":"Closed"}
{"id":"wf-3il","title":"Remove docs/dev content from waif ctx and relocate doc under docs","description":"Goal: waif ctx should no longer pull content from docs/dev. Move the relevant ctx doc(s) to docs/, update all agents/commands to reference the new path, and ensure tests/docs match the new location.\n\nScope:\n- Identify the doc(s) currently consumed from docs/dev by waif ctx.\n- Relocate them under docs/ (hidden under docs/ if preferred) and ensure waif ctx uses the new path.\n- Update agent definitions and command wiring (including config/context loading) to the new location.\n- Clean up/deprecate docs/dev usage for ctx.\n- Update docs/examples to reflect the new path.\n\nNotes:\n- Ensure no regressions to other commands that might share these docs.\n- Keep changes minimal and idempotent; prefer a single source of truth under docs/.\n","acceptance_criteria":"- waif ctx reads from the new docs/ location (not docs/dev).\n- Agent definitions/command configs referencing the old path are updated to the new path.\n- The moved doc lives under docs/ and is not duplicated in docs/dev.\n- Tests cover the new path and fail if docs/dev is required.\n- Documentation/examples reflect the new location for ctx content.\n","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-03T09:56:18.115696319-08:00","created_by":"WAIF","updated_at":"2026-01-03T09:56:18.115696319-08:00"}
{"id":"wf-3k9","title":"Q2: Clarify testing approach — mock vs real OpenCode endpoints","description":"Recommend tests use a mock OpenCode emitter in CI for reliability and reproducibility. Provide a small dev emitter script under tests/fixtures or scripts/ to append sample events to .opencode/logs/events.jsonl.","notes":"Created scripts/dev_opencode_emitter.js for dev/CI use to append sample events to .opencode/logs/events.jsonl. See scripts/dev_opencode_emitter.js.","status":"closed","priority":1,"issue_type":"task","assignee":"probe","created_at":"2025-12-28T17:07:30.558878042-08:00","updated_at":"2025-12-28T21:27:49.951779831-08:00","closed_at":"2025-12-28T21:27:49.951788607-08:00","dependencies":[{"issue_id":"wf-3k9","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T17:07:30.559777888-08:00","created_by":"daemon"}],"comments":[{"id":72,"issue_id":"wf-3k9","author":"rgardler","text":"Added dev emitter script at scripts/dev_opencode_emitter.js to append sample OpenCode JSONL events to .opencode/logs/events.jsonl for CI/local testing. Included history note and tests as part of PRD review. Files created: scripts/dev_opencode_emitter.js, history/implementation-wf-r1d.2.md.","created_at":"2025-12-29T05:15:23Z"}]}
{"id":"wf-3l4","title":"test chores","status":"tombstone","priority":3,"issue_type":"chore","created_at":"2025-12-16T11:14:06.710048237-08:00","updated_at":"2025-12-16T11:15:28.937882222-08:00","deleted_at":"2025-12-16T11:15:28.937882222-08:00","deleted_by":"rogardle","delete_reason":"manual delete","original_type":"chore"}
{"id":"wf-3qw8","title":"Make Ooda loop ouput fit the available screen width","description":"Problem: OODA scheduler table output wraps when terminal is narrow (e.g., split screen). Existing width-fit logic appears not to cap columns, causing long Title column to overflow.\\n\\nSuccess criteria:\\n- In non-JSON OODA output, header and rows fit within available terminal columns (process.stdout.columns or ), including narrow/split terminals.\\n- Title column truncates with an ellipsis when content exceeds available width; rows do not wrap.\\n- Behavior works in POSIX shells/WSL; JSON output unchanged.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-16T22:22:08.474648623-08:00","created_by":"WAIF","updated_at":"2026-01-18T17:44:05.74497689-08:00","closed_at":"2026-01-18T17:44:05.74497689-08:00","close_reason":"Completed","external_ref":"gh-pr:https://github.com/SorraTheOrc/waif/pull/156","labels":["Status: PR Created"]}
{"id":"wf-3qw8.1","title":"Add runtime OODA debug output (WAIF_DEBUG_OODA)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-18T01:05:28.467454725-08:00","created_by":"WAIF","updated_at":"2026-01-18T17:38:14.994726102-08:00","closed_at":"2026-01-18T17:38:14.994726102-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-3qw8.1","depends_on_id":"wf-3qw8","type":"parent-child","created_at":"2026-01-18T01:05:28.471843639-08:00","created_by":"WAIF"}]}
{"id":"wf-3qw8.2","title":"Refactor WF OODA output to use shared in-progress renderer","description":"Problem: The in-progress view and the WF OODA output use different rendering engines; as a result the OODA output does not observe the same column capping/truncation behavior and overflows in narrow terminals.\\n\\nGoal: Make the WF OODA (non-JSON) output use the same table rendering engine used by the in-progress display so formatting is consistent across views and terminal widths.\\n\\nAcceptance criteria:\\n- The OODA non-JSON output uses the same renderer/code paths as the in-progress display (shared module or exported renderer).\\n- With process.stdout.columns set to narrow widths, the OODA output header and rows fit within the terminal (no wrapping) and the Title column truncates with an ellipsis exactly as in the in-progress view.\\n- Existing tests for in-progress/table formatting cover OODA output behavior; add/modify tests (e.g., tests/ooda.test.ts, tests/table.test.ts) to assert identical behavior under varying terminal widths.\\n- No behavioral change to JSON OODA output.\\n- Create a short note in docs (history/ or docs/) explaining the renderer consolidation and where shared rendering lives.\\n\\nFiles likely affected: src/commands/ooda.ts, src/lib/table.ts, src/lib/displayWidth.ts (new/untracked), tests/ooda.test.ts, tests/table.test.ts.\\n\\nNotes / risks:\\n- Changing renderer may expose edge cases in OODA-specific formatting—add regression tests.\\n- Ensure PR includes test updates and CI passes before merge.\\n\\nEstimate: 2-4 hours (dev + tests).,--json","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-18T17:11:40.889606906-08:00","created_by":"WAIF","updated_at":"2026-01-18T17:44:03.17420539-08:00","closed_at":"2026-01-18T17:44:03.17420539-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-3qw8.2","depends_on_id":"wf-3qw8","type":"parent-child","created_at":"2026-01-18T17:11:40.890697265-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur","title":"WAIF version 0.2","status":"in_progress","priority":2,"issue_type":"epic","created_at":"2025-12-19T01:44:27.024739687-08:00","updated_at":"2026-01-19T03:54:14.935740779-08:00","labels":["stage:in_progress","state:in_progress"]}
{"id":"wf-3ur.1","title":"Add --number/-n option to 'waif next' to return multiple suggestions","description":"Add a --number/-n parameter to the 'waif next' command that defines how many suggestions to return (default 1). When -n \u003e 1, the human output should be a truncated table with columns: ID, Title, Priority, #blocked. JSON output should return an array of selected issues, each augmented with per-item waif metadata. Acceptance criteria:\\n- Default behavior without -n remains unchanged (single suggestion).\\n- 'waif next -n 3' prints a table with 3 rows containing ID, Title, Priority, and number of blocked issues for each suggestion.\\n- 'waif next --json -n 2' returns a JSON array of length 2 with full issue objects and per-item waif metadata.","notes":"PR opened: https://github.com/SorraTheOrc/waif/pull/81. Changes: src/commands/next.ts (add -n/--number, selectTopN), tests/next.test.ts (add -n tests).","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2025-12-19T01:48:02.473539752-08:00","updated_at":"2025-12-30T11:53:58.9668267-08:00","closed_at":"2025-12-30T11:53:58.9668267-08:00","close_reason":"Completed (PR #81 merged)","external_ref":"gh-PR: https://github.com/SorraTheOrc/waif/pull/81","dependencies":[{"issue_id":"wf-3ur.1","depends_on_id":"wf-3ur","type":"parent-child","created_at":"2025-12-19T01:48:02.47514716-08:00","created_by":"daemon"}]}
{"id":"wf-3ur.2","title":"Add workflow stage tracking to beads","description":"Linked PRD: docs/dev/workflow_stage_tracking_PRD.md\n\n\u003c!-- BEGIN WAIF PLAN (generated) --\u003e\n## Plan\n### Features\n1) Stage Derivation Helper (wf-3ur.2.1)\n- Summary: Compute canonical stage token from stage:* labels using PRD maturity order.\n\n2) Augment waif show output (Human + JSON) (wf-3ur.2.2)\n- Summary: Display stage in the show table, include computed stage in show --json; warn on multiple stage:*.\n- Depends on: wf-3ur.2.1\n\n3) Stage Column Across Issues Tables (wf-3ur.2.3)\n- Summary: Add non-droppable Stage column to issues tables (next/recent/in-progress/show) that may shrink to 3-letter PRD code.\n- Depends on: wf-3ur.2.1\n\n4) Docs: Stage Labels + CLI Behavior (wf-3ur.2.4)\n- Summary: User-facing docs for stage:* labels and WAIF CLI stage display behavior.\n\n### Open Questions\n- (none)\n\n## Plan: changelog\n- 2026-01-19: Created feature beads wf-3ur.2.1..4 and standard child tasks (docs/tests/implement). Added deps: wf-3ur.2.2 -\u003e wf-3ur.2.1 and wf-3ur.2.3 -\u003e wf-3ur.2.1.\n\u003c!-- END WAIF PLAN (generated) --\u003e\n","notes":"The PRD has been created/updated at: docs/dev/workflow_stage_tracking_PRD.md (history drafts available under history/).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T02:11:37.42387859-08:00","updated_at":"2026-01-18T23:00:50.743975433-08:00","closed_at":"2026-01-18T23:00:50.743975433-08:00","close_reason":"Merged","external_ref":"https://github.com/SorraTheOrc/waif/pull/158","labels":["Status: PR Created","Status: Plan Created","Status: Work in PR","stage:in_progress","stage:prd_complete","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2","depends_on_id":"wf-3ur","type":"parent-child","created_at":"2025-12-19T02:11:37.42576962-08:00","created_by":"daemon"}]}
{"id":"wf-3ur.2.1","title":"Stage Derivation Helper","description":"## Summary\nCompute canonical stage token from stage:* labels using PRD maturity order.\n\n## Acceptance Criteria\n- Given no stage:* labels, computed stage is 'unknown'.\n- Given one stage:* label, computed stage returns the token without the 'stage:' prefix.\n- Given multiple stage:* labels, computed stage returns the most mature token per PRD order.\n- Parsing is case-insensitive; stored labels remain unchanged.\n\n## Minimal Implementation\n- Implement a single helper (e.g., src/lib/stage.ts) that extracts stage from labels[].\n- Embed PRD maturity order and selection rule.\n- Add unit tests covering: none/one/multiple stage labels.\n\n## Deliverables\n- Unit tests for stage selection behavior.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T20:44:43.123346859-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:21:53.859962799-08:00","closed_at":"2026-01-18T21:21:53.859962799-08:00","close_reason":"PR opened: https://github.com/SorraTheOrc/waif/pull/158","labels":["feature","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2.1","depends_on_id":"wf-3ur.2","type":"parent-child","created_at":"2026-01-18T20:44:43.125479182-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.1.1","title":"Docs: Stage Derivation Helper","description":"## Summary\nDocument the canonical stage selection rule and how to use the helper from WAIF CLI code.\n\n## Acceptance Criteria\n- Docs explain stage:* label namespace and PRD maturity order.\n- Docs state missing stage behavior returns 'unknown'.\n- Docs include an example list of stage:* labels and the selected stage.\n\n## Minimal Implementation\n- Update an appropriate doc under docs/ describing stage tokens and selection.\n- Link to PRD docs/dev/workflow_stage_tracking_PRD.md.\n\n## Deliverables\n- Updated documentation page(s) under docs/.\n","status":"closed","priority":2,"issue_type":"task","assignee":"Scribbler","created_at":"2026-01-18T20:44:47.773295414-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:25:43.291667699-08:00","closed_at":"2026-01-18T21:25:43.291667699-08:00","close_reason":"Covered by workflow stage docs PR https://github.com/SorraTheOrc/waif/pull/158","labels":["docs"],"dependencies":[{"issue_id":"wf-3ur.2.1.1","depends_on_id":"wf-3ur.2.1","type":"parent-child","created_at":"2026-01-18T20:44:47.775562612-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.1.2","title":"Tests: Stage Derivation Helper","description":"## Summary\nAdd unit tests for canonical stage derivation from stage:* labels.\n\n## Acceptance Criteria\n- Tests cover: no stage labels -\u003e 'unknown'.\n- Tests cover: one stage label -\u003e exact token.\n- Tests cover: multiple stage labels -\u003e most mature token per PRD order.\n- Tests cover: case-insensitive parsing of labels.\n\n## Minimal Implementation\n- Add/extend tests under tests/ for stage helper.\n- Keep tests deterministic and independent of external bd CLI.\n\n## Deliverables\n- Passing unit tests in CI (npm test).\n","status":"closed","priority":1,"issue_type":"task","assignee":"Probe","created_at":"2026-01-18T20:44:49.320732498-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:25:00.698596339-08:00","closed_at":"2026-01-18T21:25:00.698596339-08:00","close_reason":"Implemented in PR https://github.com/SorraTheOrc/waif/pull/158","labels":["status:in_progress","test"],"dependencies":[{"issue_id":"wf-3ur.2.1.2","depends_on_id":"wf-3ur.2.1","type":"parent-child","created_at":"2026-01-18T20:44:49.322966763-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.1.3","title":"Implement: Stage Derivation Helper","description":"## Summary\nImplement the stage derivation helper used by WAIF to compute canonical workflow stage from labels.\n\n## Acceptance Criteria\n- Helper returns 'unknown' when no stage:* labels present.\n- Helper returns most mature token when multiple stage:* labels present.\n- Helper logic follows PRD order in docs/dev/workflow_stage_tracking_PRD.md.\n- No unrelated labels are modified (read-only computation).\n\n## Minimal Implementation\n- Add a helper module in src/lib/ (e.g., src/lib/stage.ts).\n- Add exported function(s) used by table renderers and show command.\n- Add minimal wiring as needed once consumers exist.\n\n## Deliverables\n- New helper module + exports.\n","status":"closed","priority":1,"issue_type":"task","assignee":"Patch","created_at":"2026-01-18T20:44:54.025069013-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:25:00.701709838-08:00","closed_at":"2026-01-18T21:25:00.701709838-08:00","close_reason":"Implemented in PR https://github.com/SorraTheOrc/waif/pull/158","labels":["status:in_progress","task"],"dependencies":[{"issue_id":"wf-3ur.2.1.3","depends_on_id":"wf-3ur.2.1","type":"parent-child","created_at":"2026-01-18T20:44:54.028236028-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.2","title":"Augment waif show output (Human + JSON)","description":"## Summary\nDisplay computed workflow stage in waif show output and include computed stage in waif show --json output.\n\n## Acceptance Criteria\n- waif show \u003cid\u003e table includes a Stage column showing computed stage token.\n- waif show \u003cid\u003e prints a one-line warning when multiple stage:* labels are present (still selects most mature stage).\n- waif show \u003cid\u003e --json includes a computed 'stage' field (e.g., stage: 'in_progress'), while preserving existing bd issue fields.\n- Missing stage:* labels display as 'unknown'.\n\n## Minimal Implementation\n- Compute stage from issue.labels using shared helper.\n- Extend show table rendering to include Stage column.\n- Augment JSON output to add 'stage' (and optionally 'stage_warning' if desired).\n- Add unit tests for show output and JSON augmentation.\n\n## Deliverables\n- Passing tests for show table and JSON output.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T20:45:00.765075428-08:00","created_by":"WAIF","updated_at":"2026-01-18T23:02:14.132236797-08:00","closed_at":"2026-01-18T23:02:14.132236797-08:00","close_reason":"Closed","labels":["Status: Work in PR","feature","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2.2","depends_on_id":"wf-3ur.2","type":"parent-child","created_at":"2026-01-18T20:45:00.767129968-08:00","created_by":"WAIF"},{"issue_id":"wf-3ur.2.2","depends_on_id":"wf-3ur.2.1","type":"blocks","created_at":"2026-01-18T20:45:51.00418331-08:00","created_by":"WAIF"}],"comments":[{"id":170,"issue_id":"wf-3ur.2.2","author":"rgardler","text":"Work in PR: https://github.com/SorraTheOrc/waif/pull/158","created_at":"2026-01-19T05:29:58Z"},{"id":173,"issue_id":"wf-3ur.2.2","author":"rgardler","text":"Added test for show warning; all wf-3ur.2 work is in PR: https://github.com/SorraTheOrc/waif/pull/158","created_at":"2026-01-19T05:49:08Z"}]}
{"id":"wf-3ur.2.2.1","title":"Docs: Augment waif show output (Human + JSON)","description":"## Summary\nDocument how waif show displays workflow stage and what waif show --json includes.\n\n## Acceptance Criteria\n- Docs mention Stage column in waif show table output.\n- Docs specify missing stage renders as 'unknown'.\n- Docs specify warning behavior when multiple stage:* labels exist.\n- Docs specify waif show --json includes computed 'stage'.\n\n## Minimal Implementation\n- Update command docs page(s) for waif show under docs/.\n\n## Deliverables\n- Updated docs under docs/.\n","status":"closed","priority":2,"issue_type":"task","assignee":"Scribbler","created_at":"2026-01-18T20:45:04.829918481-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.444335561-08:00","closed_at":"2026-01-19T01:08:55.444335561-08:00","close_reason":"Docs covered in PR #158 (docs/stage-labels.md)","labels":["docs","stage:in_progress","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2.2.1","depends_on_id":"wf-3ur.2.2","type":"parent-child","created_at":"2026-01-18T20:45:04.830782331-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.2.2","title":"Tests: Augment waif show output (Human + JSON)","description":"## Summary\nAdd tests ensuring waif show and waif show --json include computed stage correctly.\n\n## Acceptance Criteria\n- Test verifies show table includes Stage and value is correct.\n- Test verifies show --json includes 'stage'.\n- Test verifies multiple stage:* labels triggers a warning line in show output and selects most mature stage.\n\n## Minimal Implementation\n- Add/extend tests under tests/show.test.ts (or appropriate file).\n- Use fixtures with labels arrays to avoid bd dependency.\n\n## Deliverables\n- Passing tests (npm test).\n","status":"closed","priority":1,"issue_type":"task","assignee":"OpenCode","created_at":"2026-01-18T20:45:08.467061134-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:05:10.987710276-08:00","closed_at":"2026-01-19T01:05:10.987710276-08:00","close_reason":"Completed (tests already present on main)","labels":["Status: Completed","status:in_progress","test"],"dependencies":[{"issue_id":"wf-3ur.2.2.2","depends_on_id":"wf-3ur.2.2","type":"parent-child","created_at":"2026-01-18T20:45:08.468757849-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.2.3","title":"Implement: Augment waif show output (Human + JSON)","description":"## Summary\nImplement stage rendering and JSON augmentation in waif show.\n\n## Acceptance Criteria\n- Show table includes non-droppable Stage column.\n- show --json includes computed stage.\n- Multiple stage:* labels produce a one-line warning in show human output.\n- Missing stage:* labels yield stage='unknown'.\n\n## Minimal Implementation\n- Use shared stage helper from Stage Derivation Helper feature.\n- Update src/commands/show.ts to compute stage and augment JSON output.\n- Update table rendering to include stage column and width behavior.\n\n## Deliverables\n- Code implementation + passing tests.\n","status":"closed","priority":1,"issue_type":"task","assignee":"Patch","created_at":"2026-01-18T20:45:14.747593324-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.465898654-08:00","closed_at":"2026-01-19T01:08:55.465898654-08:00","close_reason":"Implementation present in src/commands/show.ts and src/lib/table.ts; merged in PR #158","labels":["task"],"dependencies":[{"issue_id":"wf-3ur.2.2.3","depends_on_id":"wf-3ur.2.2","type":"parent-child","created_at":"2026-01-18T20:45:14.749119415-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.3","title":"Stage Column Across Issues Tables","description":"## Summary\nAdd a non-droppable Stage column across WAIF issues tables (next/recent/in-progress/show). Stage may shrink to 3-letter PRD code under narrow terminal widths.\n\n## Acceptance Criteria\n- Stage column appears in issues tables for next, recent, in-progress, and show.\n- Stage column is not droppable.\n- When space constrained, stage displays as 1-3 char PRD code (e.g., inp, prd, pln) rather than being dropped.\n- Missing stage:* labels display as 'unknown'.\n\n## Minimal Implementation\n- Extend src/lib/table.ts issues table to include Stage column.\n- Add stage token-\u003ecode mapping per PRD.\n- Add width-aware display mode: full token if column wide enough else code.\n\n## Deliverables\n- Updated issues tables + tests for narrow and wide outputs.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T20:45:19.060948875-08:00","created_by":"WAIF","updated_at":"2026-01-18T23:02:00.852314651-08:00","closed_at":"2026-01-18T23:02:00.852314651-08:00","close_reason":"Closed","labels":["Status: Work in PR","feature","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2.3","depends_on_id":"wf-3ur.2","type":"parent-child","created_at":"2026-01-18T20:45:19.06176885-08:00","created_by":"WAIF"},{"issue_id":"wf-3ur.2.3","depends_on_id":"wf-3ur.2.1","type":"blocks","created_at":"2026-01-18T20:45:51.101299754-08:00","created_by":"WAIF"}],"comments":[{"id":171,"issue_id":"wf-3ur.2.3","author":"rgardler","text":"Work in PR: https://github.com/SorraTheOrc/waif/pull/158","created_at":"2026-01-19T05:40:42Z"}]}
{"id":"wf-3ur.2.3.1","title":"Docs: Stage Column Across Issues Tables","description":"## Summary\nDocument Stage column behavior across WAIF commands that render issues tables.\n\n## Acceptance Criteria\n- Docs list which commands include Stage column (next/recent/in-progress/show).\n- Docs specify when Stage shrinks to a 3-letter PRD code.\n- Docs specify missing stage behavior is 'unknown'.\n\n## Minimal Implementation\n- Update docs describing table columns for relevant commands.\n\n## Deliverables\n- Updated docs under docs/.\n","status":"closed","priority":2,"issue_type":"task","assignee":"Scribbler","created_at":"2026-01-18T20:45:24.453932582-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.454492705-08:00","closed_at":"2026-01-19T01:08:55.454492705-08:00","close_reason":"Docs covered in PR #158 (docs/stage-labels.md)","labels":["docs"],"dependencies":[{"issue_id":"wf-3ur.2.3.1","depends_on_id":"wf-3ur.2.3","type":"parent-child","created_at":"2026-01-18T20:45:24.455442098-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.3.2","title":"Tests: Stage Column Across Issues Tables","description":"## Summary\nAdd tests ensuring Stage column is present and behaves correctly under width pressure across issues tables.\n\n## Acceptance Criteria\n- Tests validate Stage column exists in rendered table output.\n- Tests validate Stage is not dropped when term width is narrow.\n- Tests validate Stage value switches to PRD code mapping when width constrained.\n\n## Minimal Implementation\n- Add/extend unit tests for src/lib/table.ts rendering.\n- Use controlled termWidth to force shrink behavior.\n\n## Deliverables\n- Passing tests (npm test).\n","status":"closed","priority":1,"issue_type":"task","assignee":"Probe","created_at":"2026-01-18T20:45:28.113665971-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.454902907-08:00","closed_at":"2026-01-19T01:08:55.454902907-08:00","close_reason":"Tests exist and passing (tests/table.test.ts); covered in PR #158","labels":["test"],"dependencies":[{"issue_id":"wf-3ur.2.3.2","depends_on_id":"wf-3ur.2.3","type":"parent-child","created_at":"2026-01-18T20:45:28.11742286-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.3.3","title":"Implement: Stage Column Across Issues Tables","description":"## Summary\nImplement Stage column across WAIF issues tables and add width-aware stage display mode.\n\n## Acceptance Criteria\n- Stage is computed via shared helper from issue labels.\n- Stage column is included in issues tables and is not droppable.\n- Stage column shrinks to PRD code mapping when narrow.\n- Missing stage yields 'unknown'.\n\n## Minimal Implementation\n- Update src/lib/table.ts columns and row mapping to include stage.\n- Implement stage token-\u003ecode mapping per PRD.\n- Ensure show/next/recent/in-progress callers pass enough data; otherwise represent stage as 'unknown'.\n\n## Deliverables\n- Code changes + passing tests.\n","status":"closed","priority":1,"issue_type":"task","assignee":"Patch","created_at":"2026-01-18T20:45:32.571184954-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.458398322-08:00","closed_at":"2026-01-19T01:08:55.458398322-08:00","close_reason":"Implementation in src/lib/table.ts; merged in PR #158","labels":["task"],"dependencies":[{"issue_id":"wf-3ur.2.3.3","depends_on_id":"wf-3ur.2.3","type":"parent-child","created_at":"2026-01-18T20:45:32.572737154-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.4","title":"Docs: Stage Labels + CLI Behavior","description":"## Summary\nDocument stage:* labels and how WAIF CLI displays and interprets them (unknown fallback, PRD mapping, warning behavior).\n\n## Acceptance Criteria\n- Docs describe stage:* namespace, token list, and maturity order.\n- Docs describe selection rule and warning behavior for multiple stage labels (show emits warning).\n- Docs describe table Stage column and 3-letter code mapping.\n- Docs include example bd label update commands.\n\n## Minimal Implementation\n- Update a user-facing doc under docs/ (not docs/dev) that covers labels and CLI outputs.\n\n## Deliverables\n- Updated docs under docs/.\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-18T20:45:37.938929284-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:44:28.573110794-08:00","closed_at":"2026-01-18T21:44:28.573110794-08:00","close_reason":"Docs added in PR https://github.com/SorraTheOrc/waif/pull/158","labels":["Status: Work in PR","feature","status:in_progress"],"dependencies":[{"issue_id":"wf-3ur.2.4","depends_on_id":"wf-3ur.2","type":"parent-child","created_at":"2026-01-18T20:45:37.939898325-08:00","created_by":"WAIF"}],"comments":[{"id":172,"issue_id":"wf-3ur.2.4","author":"rgardler","text":"Docs added in PR: https://github.com/SorraTheOrc/waif/pull/158 (docs/stage-labels.md)","created_at":"2026-01-19T05:44:22Z"}]}
{"id":"wf-3ur.2.4.1","title":"Docs: Docs: Stage Labels + CLI Behavior","description":"## Summary\nWrite/update user-facing documentation for stage:* labels and WAIF CLI stage display behavior.\n\n## Acceptance Criteria\n- Documentation exists under docs/ and is discoverable from existing docs structure.\n- Includes PRD token list, maturity order, and mapping to 3-letter codes.\n- Includes examples for bd update --add-label/--remove-label.\n\n## Minimal Implementation\n- Create or update one docs page under docs/ (avoid docs/dev).\n- Add links from command docs if appropriate.\n\n## Deliverables\n- Updated docs under docs/.\n","status":"closed","priority":2,"issue_type":"task","assignee":"Scribbler","created_at":"2026-01-18T20:45:42.132021163-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.48334863-08:00","closed_at":"2026-01-19T01:08:55.48334863-08:00","close_reason":"Docs added in PR #158 (docs/stage-labels.md)","labels":["docs"],"dependencies":[{"issue_id":"wf-3ur.2.4.1","depends_on_id":"wf-3ur.2.4","type":"parent-child","created_at":"2026-01-18T20:45:42.132804954-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.4.2","title":"Tests: Docs: Stage Labels + CLI Behavior","description":"## Summary\nAdd lightweight tests ensuring docs-related stage behavior remains consistent (where practical).\n\n## Acceptance Criteria\n- If docs are referenced in CLI help output, tests validate help text mentions stage where appropriate.\n- Otherwise, a small smoke test ensures commands that render tables include Stage column once implemented.\n\n## Minimal Implementation\n- Add/extend CLI snapshot tests for relevant command help/output.\n\n## Deliverables\n- Passing tests (npm test).\n","status":"closed","priority":1,"issue_type":"task","assignee":"Probe","created_at":"2026-01-18T20:45:46.367129343-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.486884545-08:00","closed_at":"2026-01-19T01:08:55.486884545-08:00","close_reason":"Docs/tests covered in PR #158; help output/tests passing","labels":["test"],"dependencies":[{"issue_id":"wf-3ur.2.4.2","depends_on_id":"wf-3ur.2.4","type":"parent-child","created_at":"2026-01-18T20:45:46.367909342-08:00","created_by":"WAIF"}]}
{"id":"wf-3ur.2.4.3","title":"Implement: Docs: Stage Labels + CLI Behavior","description":"## Summary\nUpdate WAIF CLI docs output and/or command docs wiring to reference stage behavior documentation appropriately.\n\n## Acceptance Criteria\n- Commands documentation is updated to reference stage column and stage label conventions.\n- Any relevant help text or docs links remain accurate.\n\n## Minimal Implementation\n- Update relevant docs files under docs/.\n\n## Deliverables\n- Documentation changes merged.\n","status":"closed","priority":1,"issue_type":"task","assignee":"Patch","created_at":"2026-01-18T20:45:47.659614588-08:00","created_by":"WAIF","updated_at":"2026-01-19T01:08:55.48336223-08:00","closed_at":"2026-01-19T01:08:55.48336223-08:00","close_reason":"Docs wiring updated in PR #158","labels":["task"],"dependencies":[{"issue_id":"wf-3ur.2.4.3","depends_on_id":"wf-3ur.2.4","type":"parent-child","created_at":"2026-01-18T20:45:47.660984029-08:00","created_by":"WAIF"}]}
{"id":"wf-3wc","title":"Task: Snapshot metadata versioning \u0026 truncation","description":"Add durationMs, sanitized, truncated, metadata_version to snapshots; unit tests","notes":"PR #121 merged: https://github.com/SorraTheOrc/waif/pull/121. Snapshot metadata fields added and runner truncated wiring. Marking for closure.","status":"closed","priority":1,"issue_type":"task","assignee":"rgardler","created_at":"2026-01-12T02:10:07.502028103-08:00","created_by":"WAIF","updated_at":"2026-01-14T20:02:01.389824725-08:00","closed_at":"2026-01-14T20:02:01.389824725-08:00","close_reason":"Merged PR #121 implements metadata_version, durationMs, sanitized, truncated; retention unchanged; tests passing.","labels":["Status: PR Created"],"dependencies":[{"issue_id":"wf-3wc","depends_on_id":"wf-e6r","type":"discovered-from","created_at":"2026-01-12T02:10:07.50407093-08:00","created_by":"WAIF"}]}
{"id":"wf-3xw","title":"Post-merge: wf-rkq followups — smoke tests \u0026 release checklist","notes":"PR merged: https://github.com/SorraTheOrc/waif/pull/63. Integration tests added in tests/show.cli.test.ts. CI green locally; monitor CI on origin/main for 24h.","status":"closed","priority":2,"issue_type":"task","assignee":"ship","created_at":"2025-12-24T16:38:59.236883486-08:00","updated_at":"2025-12-24T18:05:01.87431953-08:00","closed_at":"2025-12-24T18:05:01.87435128-08:00","external_ref":"gh:feature/wf-3xw-release-notes","dependencies":[{"issue_id":"wf-3xw","depends_on_id":"wf-rkq","type":"discovered-from","created_at":"2025-12-24T16:38:59.249451712-08:00","created_by":"daemon"}]}
{"id":"wf-4bx","title":"CLI integration hangs for ooda --once","description":"Automated execa call to 'node dist/index.js ooda --once' hangs \u003e15s in tests; needs investigation of ooda command --once behavior or additional flags to force exit.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-08T02:29:59.680329912-08:00","created_by":"patch","updated_at":"2026-01-08T02:29:59.680329912-08:00","dependencies":[{"issue_id":"wf-4bx","depends_on_id":"wf-e6r.2.14","type":"discovered-from","created_at":"2026-01-08T02:29:59.68567631-08:00","created_by":"patch"}]}
{"id":"wf-4cv","title":"Docs: ooda scheduler command documentation","description":"Create user-facing documentation for the ooda scheduler and run-job behavior. Write docs on branch wf-e6r.2.1.1/job-command and commit files under docs/commands/ooda.md. Acceptance criteria:\\n1) Overview + motivation for ooda scheduler\\n2) CLI usage examples (including removal of --once/--events and job.command usage)\\n3) Local manual testing steps (run run-job, run deterministic E2E test)\\n4) Security considerations and redact notes\\n5) File committed on wf-e6r.2.1.1/job-command with bd id in the commit message and branch pushed","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-11T21:12:24.370021679-08:00","created_by":"WAIF","updated_at":"2026-01-19T04:08:32.16636347-08:00","closed_at":"2026-01-19T04:08:32.166367964-08:00","dependencies":[{"issue_id":"wf-4cv","depends_on_id":"wf-e6r.2.1.1","type":"discovered-from","created_at":"2026-01-11T21:12:24.371649368-08:00","created_by":"WAIF"}],"comments":[{"id":101,"issue_id":"wf-4cv","author":"rgardler","text":"Created docs/commands/ooda.md (user-facing ooda scheduler + run-job docs).\n\nGit commands executed:\n- git status\n- git branch --show-current\n- git add docs/commands/ooda.md\n- git commit -m \"wf-4cv: add ooda command docs\"\n- git push -u origin wf-e6r.2.1.1/job-command","created_at":"2026-01-12T05:13:01Z"},{"id":102,"issue_id":"wf-4cv","author":"rgardler","text":"Created docs/commands/ooda.md on branch wf-e6r.2.1.1/job-command. Commit e7f10aa (wf-4cv: add ooda command docs). Commands: git add docs/commands/ooda.md, git commit -m 'wf-4cv: add ooda command docs', git push origin wf-e6r.2.1.1/job-command. File: docs/commands/ooda.md","created_at":"2026-01-12T05:13:10Z"},{"id":103,"issue_id":"wf-4cv","author":"rgardler","text":"Expanded docs/commands/ooda.md with 'Defining jobs' section and examples. Commit 9d456f1 (wf-4cv: expand ooda docs to include job definition examples). File: docs/commands/ooda.md","created_at":"2026-01-12T05:16:46Z"},{"id":104,"issue_id":"wf-4cv","author":"rgardler","text":"Added hello-5s scheduler fixture and linked OODA docs. Files: tests/fixtures/ooda.hello-5s.yaml, docs/commands/ooda.md, README.md, docs/dev/prd/prd-ooda-loop.md. Git commands: git add, git commit -m 'wf-4cv: add hello-5s fixture and link ooda docs', git push origin wf-e6r.2.1.1/job-command.","created_at":"2026-01-12T05:21:06Z"},{"id":105,"issue_id":"wf-4cv","author":"rgardler","text":"Updated docs/commands/ooda.md with detailed hello-5s example usage for scheduler and run-job modes. Commit 3ce53a8 (wf-4cv: document hello-5s example for scheduler and run-job modes). File: docs/commands/ooda.md","created_at":"2026-01-12T05:23:00Z"}]}
{"id":"wf-4sw","title":"wf-mtc.3.3: Deterministic E2E for run-job CLI","description":"Add a deterministic E2E test that programmatically invokes waif ooda run-job against test helpers and asserts a JSONL snapshot is appended and retention applied. Use a temporary log file and mock where needed for determinism. Acceptance criteria: E2E passes locally and in CI.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-11T23:25:29.740505512-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:11:09.75085209-08:00","closed_at":"2026-01-12T00:11:09.75085209-08:00","close_reason":"QA passed: deterministic E2E verified on PR #106","comments":[{"id":124,"issue_id":"wf-4sw","author":"rgardler","text":"Starting wf-mtc.3.3: deterministic E2E implementation on branch wf-mtc.3.3/deterministic-e2e","created_at":"2026-01-12T08:09:13Z"},{"id":125,"issue_id":"wf-4sw","author":"rgardler","text":"Opened PR https://github.com/SorraTheOrc/waif/pull/106 for deterministic E2E (wf-mtc.3.3). Changed files: tests/run-job.e2e.test.ts. Requesting Probe to run focused and full test suites against PR #106.","created_at":"2026-01-12T08:09:44Z"},{"id":126,"issue_id":"wf-4sw","author":"rgardler","text":"QA results (Probe): Build + focused vitest (run-job e2e/ooda-run-job/timeout/exit/largeOutput) and full npm test all passed on PR #106 (wf-mtc.3.3 deterministic E2E). No failures observed.","created_at":"2026-01-12T08:11:07Z"}]}
{"id":"wf-4y2","title":"waif next copies recommended issue ID to clipboard","description":"Enhance waif next so the recommended issue ID is copied to the OS clipboard on success (best-effort). It must not fail the command if clipboard tooling is unavailable; instead, optionally log a debug message when --verbose.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T16:22:29.56100019-08:00","updated_at":"2025-12-19T16:24:30.694077988-08:00","closed_at":"2025-12-19T16:24:30.694077988-08:00"}
{"id":"wf-54a","title":"Add dark mode","description":"Priority: 2","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-16T12:44:06.726185979-08:00","updated_at":"2025-12-16T12:44:18.171003121-08:00","deleted_at":"2025-12-16T12:44:18.171003121-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-558p","title":"Cleanup: remove scripts/start-workflow-tmux.sh (medium-risk)","description":"Inventory candidate: start-workflow-tmux script. This is medium-risk because many docs and workflows reference it; propose deprecation + replacement plan before removal.","notes":"start-workflow-tmux.sh removed in feature/wf-e6r.cleanup-legacy","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:26:31.622558686-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:42:19.138508448-08:00","closed_at":"2026-01-16T00:42:19.138512463-08:00"}
{"id":"wf-58w","title":"Build countdown timer application with Agent Mail integration","description":"## Feature Request\n\nBuild a real-world countdown timer application that demonstrates Agent Mail integration for cross-agent communication and coordination.\n\n## Motivation\n\nAgent Mail (https://github.com/Dicklesworthstone/mcp_agent_mail) is an MCP server that enables AI agents to communicate asynchronously via a message queue system. Building a countdown timer application serves multiple purposes:\n\n1. **Learn Agent Mail**: Practical experience with MCP-based agent communication\n2. **Real Application**: Create a useful tool (multiple timers with alarms)\n3. **Demonstrate Coordination**: Show how agents can coordinate on building a complete application\n4. **Test Workflow**: Exercise beads issue tracking in a realistic development scenario\n\n## Use Cases\n\n1. **Multiple Timers**: User can create multiple countdown timers running simultaneously\n2. **Timer Management**: Start, pause, resume, cancel, and reset individual timers\n3. **Visual Display**: Show remaining time for all active timers\n4. **Audio Alarms**: Sound notification when timer completes\n5. **Persistent State**: Save timer state so they survive application restart\n6. **Agent Coordination**: Use Agent Mail for agents to coordinate implementation tasks\n\n## Proposed Solution\n\nBuild a terminal-based countdown timer application with:\n\n**Technology Stack**:\n- Python or Node.js for the application\n- Agent Mail MCP server for agent-to-agent communication\n- Sound library for alarms (e.g., playsound, beep, or system notification)\n- Simple TUI or CLI interface\n- JSON file for persistence\n\n**Agent Mail Usage**:\n- Coordinate development tasks between multiple AI agents\n- Use message queues to assign subtasks (UI, timer logic, alarm system, etc.)\n- Demonstrate asynchronous agent communication patterns\n\n**Features**:\n- `timer add \u003cname\u003e \u003cduration\u003e` - Create new timer (e.g., \"5m\", \"2h30m\")\n- `timer list` - Show all active timers\n- `timer pause \u003cname\u003e` - Pause a timer\n- `timer resume \u003cname\u003e` - Resume a paused timer\n- `timer cancel \u003cname\u003e` - Cancel a timer\n- `timer reset \u003cname\u003e` - Reset timer to original duration\n\n## Alternatives Considered\n\n- **Alternative 1**: Build a web-based timer with real-time updates\n  - Why not chosen: More complex, focus should be on Agent Mail integration not web development\n  \n- **Alternative 2**: Simple single-timer application\n  - Why not chosen: Too basic, doesn't showcase agent coordination or complex state management\n  \n- **Alternative 3**: Pomodoro timer specific\n  - Why not chosen: Less flexible than general countdown timers","status":"tombstone","priority":2,"issue_type":"feature","created_at":"2025-12-16T12:51:31.969126204-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","labels":["application","feature"],"deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"wf-5ad","title":"Task: ensure waif-ooda plugin filters noisy events","description":"Acceptance criteria:\\n- .opencode/plugin/waif-ooda.ts implements an ignore list (session.diff, file-watcher noise)\\n- Unit/test harness demonstrating filtered events are not written to .opencode/logs/events.jsonl\\n- Small code change + tests committed in a branch named with the bd id","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T16:00:33.771339974-08:00","updated_at":"2025-12-30T02:26:05.090191738-08:00","closed_at":"2025-12-30T02:26:05.090191738-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-5ad","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T16:00:33.775368833-08:00","created_by":"daemon"}]}
{"id":"wf-5ay","title":"Can agents be allowed to run all commands except destructive ones?","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-22T02:25:24.190128429-08:00","updated_at":"2025-12-22T16:35:50.098089928-08:00"}
{"id":"wf-5bh","title":"Docs: Add QUICKSTART.md referenced by AGENTS.md","description":"Add a concise QUICKSTART.md or update AGENTS.md to remove the reference; include setup, install, and 'bd ready' quick steps.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:42.252037617-08:00","updated_at":"2025-12-19T22:11:35.63102098-08:00","dependencies":[{"issue_id":"wf-5bh","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.489495014-08:00","created_by":"daemon"}]}
{"id":"wf-5bm","title":"Pilot Option 3 workflow: team worktree + topic branches","description":"Problem\\n- Current docs assume 1 bd issue -\u003e 1 team branch. Teams are persistent and need a repeatable flow for many bd issues, without per-issue team branches or conflicting worktree constraints.\\n\\nGoal\\n- Run a small pilot adopting Option 3: one long-lived team worktree + short-lived topic branches per bd issue, with optional agent sub-branches for true parallelism.\\n\\nScope\\n- Process-only: validate naming conventions, handoff template usage, and branch hygiene.\\n- Do NOT change release policy, secrets, or infrastructure.\\n\\nChecklist\\n1) Choose pilot team name and create team worktree\\n   - Convention proposal: ../worktree_team_\u003cteam\u003e (e.g., ../worktree_team_core)\\n   - Commands: git fetch origin; git worktree add ../worktree_team_\u003cteam\u003e origin/main\\n\\n2) Choose 1-2 real bd issues to implement using the new flow\\n   - For each issue, create topic branch: topic/bd-\u003cid\u003e/\u003cshort-desc\u003e from origin/main\\n   - Keep PRs small; merge frequently\\n\\n3) Parallel work test (optional)\\n   - If 2+ agents need to work simultaneously, create sub-branches: topic/bd-\u003cid\u003e/\u003cpatch|docs|ci\u003e\\n   - Merge sub-branches into the topic branch (designate merge owner in bd)\\n\\n4) PR conventions\\n   - PR title includes bd-\u003cid\u003e\\n   - Use .github/PULL_REQUEST_TEMPLATE.md\\n   - Record commands run + files touched in bd handoff notes\\n\\n5) Metrics / success criteria\\n   - Cycle time: compare time-to-PR vs old model\\n   - Merge friction: number of conflicts and time to resolve\\n   - CI churn: number of failed reruns due to merge conflicts\\n   - Clarity: could a new agent understand branch/worktree state from bd + PR alone?\\n\\n6) Rollback plan\\n   - If the flow causes confusion or blocking, revert to per-issue branch model for that team and document lessons learned in bd.\\n\\nDeliverables\\n- At least one PR created using topic branches from the team worktree\\n- At least one hard handoff note posted using docs/.github/handoff_note_template.md\\n- Summary comment on this issue capturing outcomes, gotchas, and recommended doc tweaks\\n\\nRelated docs\\n- docs/dev/git_workflow.md (Option 3 guidance)\\n- docs/.github/handoff_note_template.md\\n- docs/.github/branch_protection.md\\n\\nRelated issues\\n- wf-79y.14 PR validation workflow (future enforcement)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-22T23:22:36.103011438-08:00","updated_at":"2025-12-22T23:23:37.435250548-08:00","dependencies":[{"issue_id":"wf-5bm","depends_on_id":"wf-79y","type":"related","created_at":"2025-12-22T23:27:58.596990017-08:00","created_by":"daemon"}]}
{"id":"wf-5e2","title":"PM: decompose PRD into bead plan (OpenCode command 'plan')","description":"Problem\n\nPMs need a reliable, repeatable way to decompose a PRD into a Beads plan that is immediately actionable for engineering. Currently decomposition is ad-hoc: deliverables lack consistent acceptance tests, dependencies/blockers are often undocumented, and bead creation is manual—this slows handoffs and increases planning friction.\n\nUsers\n\n- Primary: PMs who author PRDs and produce implementation plans.\n- Secondary: Engineers and Tech Leads who pick work from beads and need clear acceptance criteria; automation that consumes bead graphs.\n\nSuccess criteria\n\nInvoking the plan command with a seed Beads issue produces a child epic (under the supplied issue) and a hierarchy of child beads that together represent the implementation plan. Done test: running `/plan bd-123` where `bd-123` is the seed issue creates a child epic under `bd-123` and at least three child beads; every created bead includes `title`, `short description`, `acceptance criteria`, and `linked PRD path`. Re-running the same command does not create duplicates (idempotence).\n\nConstraints\n\n- Must preserve existing Beads workflows and not overwrite unrelated beads. The command must be idempotent and conservative about changes. It must run as the invoking user (respect BD_ACTOR) and not auto-change assignees without explicit flags.\n- Must integrate with existing OpenCode command conventions in `.opencode/command/` and not break `/prd` or `/intake` behavior.\n\nExisting state\n\n- OpenCode command templates: `.opencode/command/prd.md`, `.opencode/command/intake.md` exist and provide interview templates.\n- Related PRDs and docs: `docs/dev/context_pack_PRD.md`, `docs/dev/opencode_integration_PRD.md`, `docs/Workflow.md`.\n- Related Beads: `wf-70j.4` (PM skill: generate bead hierarchy), `wf-70j.3` (PRD authoring/linking), `wf-70j.2` (scripted intake).\n\nDesired change (what to deliver)\n\n- Implement an OpenCode command `.opencode/command/plan.md` (user-facing spec) that:\n  - Is invoked by Beads issue id: `/plan bd-123` (the command reads the seed issue `bd-123` for context and PRD links).\n  - Defaults to auto-create: the command creates beads under the provided seed issue without requiring an explicit `--auto-create` flag.\n  - Supports an optional `--propose-only` mode to emit `plan.md` and `plan.json` without modifying the Beads DB.\n  - Produces two artifacts on propose-only: `plan.md` (human summary) and `plan.json` (machine bundle compatible with `bd create --file`).\n  - When creating beads, populates each bead with the required fields and annotates created beads with `auto-created-by: wf-5e2` and `Linked PRD: \u003cpath\u003e` (the PRD link should be taken from the seed issue body or metadata).\n  - Ensures idempotence by matching existing beads using canonical title + linked PRD path before creating new beads.\n  - Emits a creation log `./.opencode/plan_\u003ctimestamp\u003e.json` listing created bead IDs and titles.\n\nRequired fields for every bead\n\n- `title` (short)\n- `short description` (one-line goal)\n- `acceptance criteria` (clear, testable done-test)\n- `linked PRD path` (path to PRD source — taken from the seed issue)\n- `parent` (the provided seed issue becomes the parent; created epic is a child of the seed)\n- `children` (if any)\n- `blockers` (explicit dependency ids, if applicable)\n\nBehavioral rules and edge cases\n\n- Idempotence algorithm: canonicalize candidate titles (lowercase, trim, collapse spaces, strip punctuation) and match against open beads where `linked PRD path` equals the PRD; update existing bead if matched, otherwise create.\n- Auto-create threshold: if decomposition yields more than 25 beads, pause and require explicit PM confirmation before mass-creation (fail-safe threshold configurable).\n- Conflicts: if a matched bead has a different parent or semantics, surface a conflict and pause for PM decision (re-parent vs create new bead).\n- Permissions: respect BD_ACTOR and repo ACLs; never change assignees without `--assign` or explicit approval.\n\nLikely duplicates / related docs\n\n- `.opencode/command/prd.md`\n- `.opencode/command/intake.md`\n- `docs/dev/context_pack_PRD.md`\n- `docs/dev/opencode_integration_PRD.md`\n- `docs/Workflow.md`\n\nRelated Beads\n\n- `wf-70j.4` — PM skill: generate bead hierarchy (plan) with PRD traceability (parent)\n- `wf-70j.3` — PRD authoring + idempotent PRD linking\n- `wf-70j.2` — scripted interview + intake normalization\n\nClarifying questions (to finalize the PRD)\n\n1. Auto-create threshold set to 25 beads. Confirm if you want a different threshold.\n2. Estimates: plan should not include estimates. Confirm.\n\nBeads metadata\n\n- Beads issue id: `wf-5e2` (feature, priority 2)\n- Parent: `wf-70j.4`","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-31T12:35:19.357784754-08:00","updated_at":"2025-12-31T13:24:48.909482818-08:00","dependencies":[{"issue_id":"wf-5e2","depends_on_id":"wf-70j.4","type":"related","created_at":"2025-12-31T12:39:17.522735837-08:00","created_by":"daemon"}]}
{"id":"wf-5th","title":"Prepare Copilot PR workflow file (pull_request_target, write permissions)","description":"Create/update .github/workflows/copilot-pr-review.yml to run on pull_request_target, request pull-requests: write, and avoid checking out PR code. Include comments explaining security tradeoffs and a dry-run mode that only logs the API payload. Acceptance criteria:\\n1) Workflow YAML exists at .github/workflows/copilot-pr-review.yml and uses pull_request_target trigger.\\n2) permissions: pull-requests: write is present (or uses REVIEW_TOKEN secret fallback if admin denies).\\n3) Job does NOT checkout or run PR code (no uses: actions/checkout@v* for PR).\\n4) Includes a commented 'dry-run' input to avoid posting during validation.\\n5) PR created with the workflow changes (branch name includes bd id).\\n","notes":"/delegate @patch\n\nRationale: Implement and test the pull_request_target Actions workflow to allow Copilot-like first-pass reviews. As Build I define the plan; @patch should implement the workflow file, open the PR, and run dry-run validation.\n\nAcceptance criteria:\n1) Branch created: wf-5th/prepare-copilot-workflow from origin/main and up to date.\n2) .github/workflows/copilot-pr-review.yml updated to use pull_request_target (types: [opened]) and include a top-level permissions: pull-requests: write (or, if denied by admin, implement REVIEW_TOKEN fallback using least-privilege PAT stored in a repo secret).\n3) The job MUST NOT checkout or execute PR code. No uses: actions/checkout@ for the PR context.\n4) Add DRY_RUN input/default env (true) so initial validation only logs the would-be API payload. When DRY_RUN=false the job will call github.rest.pulls.createReview.\n5) Inline comments documenting security tradeoffs and the reason for pull_request_target.\n6) Commit only the workflow and history/github-copilot-pr.md files. Open a PR from the branch to main and include this bd id (wf-5th) in the PR body.\n7) Provide run ids and logs showing either the logged payload (dry-run) or the successful createReview response (HTTP 201) after admin approves write permissions.\n\nConstraints: Timebox 8h. Priority P1. Do NOT use force pushes or destructive git actions. If repo-level permission changes are required, stop and report exact settings required and wait for admin confirmation.\n\nDeliverables:\n- PR URL (wf-5th/prepare-copilot-workflow)\n- Action run ids and logs (dry-run payload or createReview response)\n- Files changed: list of paths\n- BD comment summarizing commands executed and outputs\n\nCommands to run (copy-paste):\n- git fetch origin \u0026\u0026 git checkout -b wf-5th/prepare-copilot-workflow origin/main\n- git status --porcelain \u0026\u0026 git rev-parse --abbrev-ref HEAD\n- (edit .github/workflows/copilot-pr-review.yml and history/github-copilot-pr.md)\n- git add .github/workflows/copilot-pr-review.yml history/github-copilot-pr.md \u0026\u0026 git commit -m \"wf-5th: add pull_request_target Copilot review workflow (dry-run)\"\n- git push -u origin wf-5th/prepare-copilot-workflow\n- gh pr create --title \"ci: copilot-pr review workflow (wf-5th)\" --body \"Implements pull_request_target workflow (dry-run). BD: wf-5th\" --base main --head wf-5th/prepare-copilot-workflow\n\nRelated bd: wf-1ze (admin permission task). ","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-13T22:05:33.377256398-08:00","created_by":"WAIF","updated_at":"2026-01-14T00:57:18.418620544-08:00","closed_at":"2026-01-14T00:57:18.418620544-08:00","close_reason":"Closed"}
{"id":"wf-5w2","title":"Logging: implement history/ persisted logs and redaction policy","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T17:13:25.187590601-08:00","updated_at":"2025-12-23T17:20:02.475730359-08:00","closed_at":"2025-12-23T17:20:02.475730359-08:00","close_reason":"Replaced by hierarchical child wf-cvz.4","dependencies":[{"issue_id":"wf-5w2","depends_on_id":"wf-cvz","type":"discovered-from","created_at":"2025-12-23T17:13:25.192747685-08:00","created_by":"daemon"},{"issue_id":"wf-5w2","depends_on_id":"wf-cvz","type":"blocks","created_at":"2025-12-23T17:16:39.622242784-08:00","created_by":"daemon"}]}
{"id":"wf-5x4","title":"Open PR for commit c223808 (agent/PRD/test updates)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T16:58:22.265101628-08:00","updated_at":"2025-12-27T17:12:07.867985951-08:00","closed_at":"2025-12-27T17:12:07.867991476-08:00","comments":[{"id":59,"issue_id":"wf-5x4","author":"rgardler","text":"PR #71 merged (branch wf-5x4/pr-for-c223808). Scope: c223808 agent/PRD/test updates; no new code beyond that commit. No further action.","created_at":"2025-12-28T01:12:06Z"}]}
{"id":"wf-608","title":"Q4: Clarify redaction and security constraints for captured data","description":"Define redaction rules: never persist full message bodies; redact tokens/credentials and trim long fields to e.g., 200 chars. Implement a redaction helper utility and tests (see wf-7el).","notes":"Added src/lib/redact.ts (redactSecrets) and test coverage in tests/ooda.test.ts for redaction of sk- keys and long bodies. See src/lib/redact.ts and tests/ooda.test.ts.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-28T17:07:30.684786451-08:00","updated_at":"2025-12-28T21:27:52.946611195-08:00","closed_at":"2025-12-28T21:27:52.946620404-08:00","dependencies":[{"issue_id":"wf-608","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T17:07:30.685709866-08:00","created_by":"daemon"}]}
{"id":"wf-633","title":"Docs: update ooda docs for run-job CLI and deprecate --once/--events","description":"Update docs to describe run-job subcommand, config schema with job.command, and deprecate --once/--events flags. Add migration notes and example usage.","acceptance_criteria":"Docs updated in docs/dev and README examples; PR created referencing wf-bkt.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-08T20:38:06.807645003-08:00","created_by":"WAIF","updated_at":"2026-01-19T04:09:14.429864762-08:00","closed_at":"2026-01-19T04:09:14.429871013-08:00","dependencies":[{"issue_id":"wf-633","depends_on_id":"wf-bkt","type":"discovered-from","created_at":"2026-01-08T20:38:06.808731143-08:00","created_by":"WAIF"}],"comments":[{"id":89,"issue_id":"wf-633","author":"rgardler","text":"Docs chore placeholder created; implementation branch updated with run-job CLI — please update docs in a follow-up PR referencing wf-bkt. Commit d865192.","created_at":"2026-01-09T04:58:17Z"}]}
{"id":"wf-63w","title":"Render issue title string with configurable symbols","description":"- Problem\n  - When listing issues in the CLI, we want a compact, readable \"title string\" that quickly conveys issue type and status without needing a full table.\n  - Today there is no single canonical renderer for an issue's title line.\n\n- Users\n  - Primary: PM using `waif` CLI outputs (e.g., next/ready/recent lists).\n  - Secondary: TUI consumers and tests that need stable formatting.\n\n- Success criteria\n  - Provide a pure function that renders an issue's title line as:\n    - `\u003ctypeSymbol\u003e\u003cspace\u003e\u003cstatusSymbol\u003e\u003cspace\u003e\u003ctitleOrTruncatedTitle\u003e`\n  - Optional truncation: when `n \u003c= 0` (default), no truncation.\n  - When truncating, use ellipsis (`...`) to indicate truncation and ensure the final returned string length is **never greater than `n`**.\n  - Type/status glyphs are configurable via a config file with sensible defaults.\n\n- Constraints\n  - Must not hardcode glyphs in business logic; must load defaults from config.\n  - Output should be deterministic for tests (no locale/emoji variability unless configured).\n\n- Existing state\n  - We have issue listing/table helpers but no shared per-issue title renderer.\n\n- Desired change\n  - Add a new helper function (name TBD, e.g. `renderIssueTitle`) that takes:\n    - `issue` (at least: `issue_type`, `status`, `title`)\n    - optional `maxLen` (default `\u003c=0` meaning \"no truncation\")\n    - optional config override (or config is loaded by caller)\n  - Add a config file (e.g. `config/symbols.json` or `config/symbols.yaml`) defining:\n    - mapping of issue type -\u003e symbol (bug/feature/task/epic/chore)\n    - mapping of status -\u003e symbol (open/in_progress/done/closed/tombstone)\n    - sensible defaults (ASCII-safe by default; unicode optional).\n  - Add/adjust tests to cover:\n    - formatting for each type/status\n    - truncation boundary behavior (n small, exact boundary, n\u003c=0)\n    - ellipsis behavior and exact length guarantee.\n\n- Clarifying questions\n  1. Do we want defaults to be ASCII-only (e.g., `B`, `F`, `T`, ...) or unicode (e.g., `🐛`, `✨`, ...)? Proposed default: ASCII-safe.\n  2. Which statuses are expected in this repo's `Issue` model? (At minimum: open/in_progress/closed; others appear in Beads output.) Proposed: support `open`, `in_progress`, `done`, `closed`, `tombstone`.\n\n- Acceptance criteria\n  - [ ] A new function exists that returns `\u003ctypeSym\u003e \u003cstatusSym\u003e \u003ctitle\u003e` with optional truncation.\n  - [ ] If `maxLen \u003c= 0` then no truncation occurs.\n  - [ ] If truncation occurs, returned string contains `...` and `len(result) \u003c= maxLen` always.\n  - [ ] Glyphs/symbols come from a config file with sensible defaults.\n  - [ ] Unit tests cover types/statuses and truncation edge cases.\n\n- Proposed next step\n  - Implement in `src/lib/` and wire into list outputs later.\n","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/7","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T11:27:34.05515748-08:00","updated_at":"2025-12-19T15:13:42.422575288-08:00","closed_at":"2025-12-19T15:13:42.422575288-08:00"}
{"id":"wf-64m","title":"CLI: when 'waif in-progress' finds no in_progress items, inform user and run 'waif next'","description":"Modify the 'waif in-progress' command to detect when there are no issues with status 'in_progress'. In that case, print a clear informational message to the user and invoke the 'waif next' command so the user sees the next actionable items. This improves UX for empty in-progress queues and reduces user confusion.","acceptance_criteria":"1) When 'waif in-progress' is run and there are one or more issues with status 'in_progress', behavior is unchanged.\n2) When 'waif in-progress' is run and there are zero issues with status 'in_progress', the CLI prints: 'No items are currently in progress. Showing next ready work:' (or similar), then runs the same logic as 'waif next' and displays its output.\n3) The command avoids infinite recursion (e.g., if 'waif next' triggers 'waif in-progress' again) and returns exit code 0 on normal operation.\n4) Unit tests are added/updated to cover both branches (has in_progress, no in_progress) and CI passes.","notes":"Merged PR: https://github.com/SorraTheOrc/waif/pull/80","status":"closed","priority":2,"issue_type":"feature","assignee":"map","created_at":"2025-12-30T02:01:35.84018273-08:00","updated_at":"2025-12-30T02:16:23.918044556-08:00","closed_at":"2025-12-30T02:15:59.276400073-08:00","close_reason":"Merged in PR #80","comments":[{"id":74,"issue_id":"wf-64m","author":"map","text":"Created feature to improve UX when 'waif in-progress' has no items: print message and run 'waif next'. Acceptance criteria added; tests required. Files likely to touch: src/commands/inProgress.ts, src/commands/next.ts, tests/*.{test,ts}.","created_at":"2025-12-30T10:01:46Z"}]}
{"id":"wf-6bth","title":"Rename OpenCode plugin and in-repo plugin filename from 'waif-ooda' to 'wf-ooda'","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-16T17:39:32.334930705-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:59:01.92803535-08:00","dependencies":[{"issue_id":"wf-6bth","depends_on_id":"wf-k5um.7","type":"discovered-from","created_at":"2026-01-16T17:39:32.336406905-08:00","created_by":"WAIF"}],"deleted_at":"2026-01-19T03:59:01.92803535-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-6j5","title":"(deleted)","status":"tombstone","priority":0,"issue_type":"task","created_at":"2025-12-18T13:09:26.86264662-08:00","updated_at":"2025-12-18T13:38:16.928947451-08:00","deleted_at":"2025-12-16T20:44:18.166999953Z","deleted_by":"rogardle","delete_reason":"batch delete"}
{"id":"wf-6kgn","title":"Add git status to In Progress view","description":"At the end of the list of in-progress beads we should also show the output of 'git status -s --porcelain'","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-18T18:04:31.267615736-08:00","created_by":"WAIF","updated_at":"2026-01-18T18:04:31.267615736-08:00"}
{"id":"wf-6pe","title":"Idle Scheduler: per-terminal idle-time scheduler (drop-in Bash module)","description":"# **Drop‑In Bash Module: Idle Scheduler with Randomized Interval**\n\n## **1. Overview**\nThis module provides a **per‑terminal idle‑time scheduler** for Bash.  \nIt executes a user‑defined task **only when the terminal is idle** (i.e., Bash is displaying the prompt and no interactive foreground process is running).  \n\nExecution occurs at **randomized intervals between 20 and 40 seconds** (30 ± 10 seconds jitter).  \nEach terminal session maintains its own independent schedule and state.\n\n---\n\n## **2. What Is a “Drop‑In Bash Module”?**\nA **drop‑in Bash module** is a standalone `.sh` file designed to be:\n\n- **Self‑contained** (no external dependencies)\n- **Safe to source** from `.bashrc`, `.bash_profile`, or a modular directory such as `~/.bashrc.d/`\n- **Non‑intrusive** (does not override user settings unless explicitly intended)\n- **Composable** with other modules\n\nA drop‑in module:\n\n- Should not assume global variables unless it defines them  \n- Should not overwrite existing `PROMPT_COMMAND` logic  \n- Must chain cleanly with other prompt hooks  \n- Should be removable simply by deleting the file\n\nThis module follows those rules.\n\n---\n\n## **3. Goals**\n- Provide a lightweight, dependency‑free idle scheduler.\n- Ensure tasks run **only when the terminal is idle**.\n- Introduce **random jitter** to avoid synchronized behaviour across terminals.\n- Maintain **per‑terminal isolation**.\n- Be installable simply by dropping a file into a Bash module directory.\n\n---\n\n## **4. Non‑Goals**\n- Not a system‑wide scheduler.\n- Not a precise timing mechanism.\n- Not persistent across sessions.\n- Not intended for long‑running background jobs.\n\n---\n\n## **5. Functional Requirements**\n\n### **5.1 Idle Detection**\n- Scheduler runs only when Bash is about to display the prompt.\n- Implemented via `PROMPT_COMMAND`.\n- Must not run while a foreground process is active.\n\n### **5.2 Randomized Interval**\n- After each execution, the next interval is randomly selected.\n- Range: **20–40 seconds**.\n- Uses Bash’s `$RANDOM`.\n\n### **5.3 Per‑Terminal State**\nEach terminal session maintains:\n\n- `LAST_IDLE_RUN` — timestamp of last execution  \n- `NEXT_IDLE_INTERVAL` — randomized delay until next run  \n\nState is stored in shell variables scoped to the session.\n\n### **5.4 User‑Defined Task**\n- The module exposes a function `idle_task()` for user override.\n- Default implementation prints a timestamp.\n\n---\n\n## **6. Implementation (Drop‑In Module)**\n\nSave as:  \n`~/.bashrc.d/idle-scheduler.sh`  \n(or any sourced location)\n\n```bash\n# --- Idle Scheduler Module (Drop-In) ---\n\n# User-overridable idle task\nidle_task() {\n    echo \"[idle task] Running at $(date)\"\n}\n\n# Random interval bounds (seconds)\nIDLE_MIN=20\nIDLE_MAX=40\n\n# Initialize state if not already set\nLAST_IDLE_RUN=${LAST_IDLE_RUN:-0}\nNEXT_IDLE_INTERVAL=${NEXT_IDLE_INTERVAL:-$(( RANDOM % (IDLE_MAX - IDLE_MIN + 1) + IDLE_MIN ))}\n\n# Preserve existing PROMPT_COMMAND\n__idle_prev_prompt_command=\"$PROMPT_COMMAND\"\n\n# Compose new PROMPT_COMMAND\nPROMPT_COMMAND='\\\n  now=$(date +%s)\\\n\\\n  if (( now - LAST_IDLE_RUN \u003e= NEXT_IDLE_INTERVAL )); then\\\n      idle_task\\\n      LAST_IDLE_RUN=$now\\\n      NEXT_IDLE_INTERVAL=$(( RANDOM % (IDLE_MAX - IDLE_MIN + 1) + IDLE_MIN ))\\\n  fi\\\n\\\n  # Chain previous PROMPT_COMMAND if it exists\\\n  if [[ -n \"$__idle_prev_prompt_command\" ]]; then\\\n      eval \"$__idle_prev_prompt_command\"\\\n  fi\\\n'\n```\n\n---\n\n## **7. Behaviour Examples**\n\n### **7.1 Idle Terminal**\n- User presses Enter repeatedly  \n- Scheduler fires at random intervals  \n- Output appears between prompts\n\n### **7.2 Busy Terminal**\n- User runs `vim`, `top`, `ssh`, etc.  \n- Scheduler does **not** run  \n- Execution resumes when prompt returns\n\n### **7.3 Multiple Terminals**\n- Each terminal has its own independent timer  \n- Random jitter prevents synchronized execution\n\n---\n\n## **8. Extensibility**\n\n### **8.1 Optional Enhancements**\n- Only run when last command succeeded  \n- tmux‑mode awareness  \n- Subshell suppression  \n- Logging hooks  \n- Integration with agent‑based workflows (beads, waif, etc.)\n\n### **8.2 Future Extensions**\n- Pluggable idle‑task registry  \n- Per‑project idle hooks  \n- Adaptive intervals based on load or context  \n\n---\n\n## **9. Risks \u0026 Mitigations**\n\n| Risk | Mitigation |\n|------|------------|\n| Excessive output | Override `idle_task` to silence or redirect |\n| PROMPT_COMMAND conflicts | Module chains safely with existing logic |\n| Too frequent execution | Increase `IDLE_MIN` and `IDLE_MAX` |\n| Non‑interactive shells | Guard with `[[ $- == *i* ]]` if needed |\n\n---\n\n## **10. Summary**\nThis drop‑in Bash module provides a clean, modular, and dependency‑free way to run tasks during terminal idle time with randomized intervals. It integrates safely with existing shell configurations and supports per‑terminal isolation, making it ideal for lightweight automation, agent loops, and background checks.\n\n---\n\nIf you want, I can also generate:\n\n- a **module loader** for `.bashrc.d/`  \n- a **waif‑style PRD version**  \n- a **beads node spec**  \n- or a **tmux‑aware variant**\n\nJust tell me the direction you want to take it.\n","notes":"Documented that the tmux workflow auto-loads the idle scheduler for the PM pane with idle_task(){ clear; waif in-progress; }.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-19T23:57:36.011092114-08:00","updated_at":"2025-12-20T20:33:27.127557723-08:00","closed_at":"2025-12-20T20:33:27.127563346-08:00","labels":["feature"]}
{"id":"wf-70j","title":"Define the PM process for selecting and assigning work: Intake brief","description":"Linked PRD: docs/dev/pm_assignment_PRD.md\n","notes":"PR #59 merged; beads-only change recorded. Files changed: .beads/issues.jsonl. Follow-ups: implement child beads wf-70j.* as needed.\n\n---\n\nScribbler: delegated PR creation to Ship via waif ask for branch wf-70j/child-beads (beads-only change: .beads/issues.jsonl). Ask: waif ask ship to raise PR with commit+push+gh pr create. Ask log: /home/rgardler/.waif/logs/ask.log.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-23T21:53:01.358272443-08:00","updated_at":"2025-12-24T13:36:58.60531-08:00","closed_at":"2025-12-23T22:55:24.341353595-08:00","comments":[{"id":23,"issue_id":"wf-70j","author":"map","text":"Linked PRD: docs/dev/pm_assignment_PRD.md","created_at":"2025-12-24T05:59:24Z"},{"id":24,"issue_id":"wf-70j","author":"map","text":"Scribbler review: edited PRD at docs/dev/pm_assignment_PRD.md (clarity, acceptance criteria, rollout plan). Changelog in PRD header.","created_at":"2025-12-24T06:08:57Z"},{"id":25,"issue_id":"wf-70j","author":"scribbler","text":"Created child beads for PRD implementation (skills-based workflow that reuses /intake and /prd). New children: wf-70j.1 composition decision; wf-70j.2 interview/intake skill; wf-70j.3 PRD skill + idempotent linking; wf-70j.4 bead plan generation; wf-70j.5 assignment proposal (propose-only); wf-70j.6 command wiring; wf-70j.7 audit logging; wf-70j.8 pilot evaluation.","created_at":"2025-12-24T06:23:21Z"}]}
{"id":"wf-70j.1","title":"PM skill: define workflow composition with /intake and /prd","description":"Define the intended composition between /intake and /prd and the new PM skill(s). Decide wrap vs internal-call vs shared-library approach, and identify the single source of truth for templates/questions. Deliverable: a short decision recorded in bd notes plus pointers to the docs/paths to update.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T22:22:13.175201743-08:00","updated_at":"2025-12-23T22:22:44.155545047-08:00","dependencies":[{"issue_id":"wf-70j.1","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:13.183564611-08:00","created_by":"daemon"}]}
{"id":"wf-70j.2","title":"PM skill: scripted interview + intake normalization (reuse /intake)","description":"Implement the structured PM interview/intake capture as an agent skill, leveraging the existing /intake command behavior/templates. Must accept bd issue id seed context and produce normalized problem/users/success/constraints. Record output in bd notes for audit. Acceptance: can run end-to-end on a sample issue without manual reformatting.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T22:22:47.446996428-08:00","updated_at":"2025-12-23T22:22:47.446996428-08:00","dependencies":[{"issue_id":"wf-70j.2","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:47.462338638-08:00","created_by":"daemon"}]}
{"id":"wf-70j.2.1","title":"waif intake command — convenience wrapper for /intake","description":"Problem\n- Running the OpenCode slash command `/intake` inside an OpenCode session captures a short intake interview; however, invoking that flow currently requires users to open/run OpenCode directly. The `waif` CLI could provide a thin convenience wrapper that launches an appropriately-configured OpenCode session and immediately issues `/intake`, saving a manual step and reducing friction for producers and maintainers.\n\nUsers\n- Primary: PMs / producers who author intake briefs and want a fast, consistent way to start the interview.\n- Secondary: Developers and agents who run local workflows and prefer a single `waif` command to start intake sessions.\n\nSuccess criteria\n- Running `waif intake` launches an OpenCode session pre-configured for this repo and issues the `/intake` command into the session so the user immediately sees the interactive intake interview.\n- The command returns success if OpenCode starts and the `/intake` command was issued; it must not attempt to complete the interview non-interactively. (Manual interview continues inside the OpenCode session.)\n- The command must not create or modify beads automatically.\n\nConstraints\n- Must be a thin wrapper only: do not change `/intake` behavior, do not auto-create beads or PRDs, do not alter repo files.\n- Must respect existing `.opencode` configuration and environment variables (e.g., `OPENCODE_*`) so it does not break other OpenCode commands or workflows.\n- Must work on dev machines where `opencode` is available; if not present, print a clear error message with instructions.\n\nExisting state\n- `.opencode/command/intake.md` contains the OpenCode command template and interview questions.\n- `README.md` and `src/lib/opencode.ts` show existing OpenCode integration and CLI usage patterns.\n- There are multiple Beads issues concerning intake/PRD wiring (see Related issues below).\n\nDesired change\n- Add a `waif intake` CLI subcommand that:\n  - Ensures the local OpenCode environment is configured for this repo (uses `.opencode/` config),\n  - Starts an OpenCode session (interactive) and immediately sends `/intake` into it,\n  - Exits after launching the session (the interview runs interactively inside the session),\n  - Emits a helpful message/next-steps if `opencode` is not installed or fails to start.\n\nLikely duplicates / related docs (file paths)\n- `.opencode/command/intake.md`\n- `.opencode/command/prd.md`\n- `README.md`\n- `docs/Workflow.md`\n\nRelated issues (Beads ids)\n- wf-70j.2 — PM skill: scripted interview + intake normalization (reuse /intake)\n- wf-70j.1 — PM skill: define workflow composition with /intake and /prd\n- wf-v0m — Delegate command to pass work to another agent: Intake brief\n- wf-70j.6 — PM skill: command surface wiring (/intake, /prd, /assign-propose)\n- wf-32r — Beads search command: Intake brief\n- wf-3ur.2 — Add workflow stage tracking to WAIF CLI: Intake brief\n\nClarifying questions\n1. Parent bead selected: `wf-70j.2` (confirmed by requestor).\n2. No extra OpenCode args to auto-pass — default behavior only.\n3. Command will be interactive only and must not auto-create beads.\n\nProposed next step\n- Implementation: Add `waif intake` subcommand that starts an OpenCode session and issues `/intake`.\n- No standalone PRD required; attach this feature as a child of `wf-70j.2`.\n- Recommended follow-up: small CLI test that asserts `waif intake` exits with success when `opencode` present, and emits a user-facing error when not.","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-02T11:18:13.373367182-08:00","updated_at":"2026-01-02T11:18:13.373367182-08:00","dependencies":[{"issue_id":"wf-70j.2.1","depends_on_id":"wf-70j.2","type":"parent-child","created_at":"2026-01-02T11:18:13.375677969-08:00","created_by":"daemon"}]}
{"id":"wf-70j.3","title":"PM skill: PRD authoring (reuse /prd) + idempotent PRD linking","description":"Implement PRD authoring/updating as an agent skill built on the existing /prd command. Create PRD at docs/dev/\u003cfeature\u003e_PRD.md when missing; otherwise link existing PRD. Ensure idempotent traceability updates on source issue: add/maintain 'Linked PRD: \u003cpath\u003e' and external-ref 'PRD: \u003cpath\u003e' without duplicates. Acceptance: rerun produces no duplicate links.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T22:22:50.873966617-08:00","updated_at":"2025-12-23T22:22:50.873966617-08:00","dependencies":[{"issue_id":"wf-70j.3","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:50.887905924-08:00","created_by":"daemon"}]}
{"id":"wf-70j.4","title":"PM skill: generate bead hierarchy (plan) with PRD traceability","description":"Implement bead hierarchy generation as part of the PM skill. Given a PRD path and source issue, propose and/or create a parent/child bead plan (bd create), with clear titles/deliverables and links back to the PRD. Must support parallelizable decomposition. Acceptance: created beads include PRD reference and are logically grouped under a parent bead or the source issue.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T22:22:53.00586385-08:00","updated_at":"2025-12-23T22:22:53.00586385-08:00","dependencies":[{"issue_id":"wf-70j.4","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:53.032067071-08:00","created_by":"daemon"}]}
{"id":"wf-70j.5","title":"PM skill: assignment proposal heuristics + propose-only confirmation","description":"Implement assignment proposal generation for each bead: suggest assignee(s) with rationale (role/skill match, dependencies, risks). Must default to propose-only and never change assignees without explicit Producer confirmation. Record proposals in bd notes/comments for audit. Acceptance: proposals produced for each bead in a plan, and no bd assignee updates occur in propose mode.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T22:22:56.139938581-08:00","updated_at":"2025-12-23T22:22:56.139938581-08:00","dependencies":[{"issue_id":"wf-70j.5","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:56.155152609-08:00","created_by":"daemon"}]}
{"id":"wf-70j.6","title":"PM skill: command surface wiring (/intake, /prd, /assign-propose)","description":"Expose/standardize the command surface for the PM workflow: /intake, /prd, and /assign-propose (names may align to existing conventions). Ensure input validation and deterministic outputs. Acceptance: commands run end-to-end with clear errors; PM skill composes with /intake and /prd behavior.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T22:22:59.310732856-08:00","updated_at":"2025-12-23T22:22:59.310732856-08:00","dependencies":[{"issue_id":"wf-70j.6","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:22:59.320787601-08:00","created_by":"daemon"}]}
{"id":"wf-70j.7","title":"PM workflow: observability + audit notes (bd comments/notes)","description":"Add consistent audit logging to bd notes/comments for actions taken: PRD created/linked, beads created (IDs), and assignment proposals with rationale. Must be concise and idempotent (avoid duplicate noise). Acceptance: each PM run leaves a single clear audit record on the source issue.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T22:23:03.190873907-08:00","updated_at":"2025-12-23T22:23:03.190873907-08:00","dependencies":[{"issue_id":"wf-70j.7","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:23:03.2112867-08:00","created_by":"daemon"}]}
{"id":"wf-70j.8","title":"Pilot evaluation: run 10 requests and measure proposal acceptance","description":"Execute the pilot on 10 Producer requests using the PM skill workflow. Record outcomes: PRD created/linked, bead plan produced, assignments proposed, and whether Producer accepted without correction. Acceptance: \u003e=90% acceptance rate recorded in bd notes with the sample set referenced.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T22:23:06.682131095-08:00","updated_at":"2025-12-23T22:23:06.682131095-08:00","dependencies":[{"issue_id":"wf-70j.8","depends_on_id":"wf-70j","type":"parent-child","created_at":"2025-12-23T22:23:06.694518481-08:00","created_by":"daemon"}]}
{"id":"wf-73k","title":"Update /prd: accept bd issue ID as interview seed","description":"Enhance the OpenCode /prd command so it can take a beads issue ID (e.g., bd-123) as the starting input to the interview process.\\n\\nBehavior:\\n- If a bd issue ID is provided as an argument, /prd should fetch the issue details (at minimum description + acceptance) and use that content as initial context for the PRD interview.\\n- /prd should still support the existing create-vs-edit behavior when passed a PRD path/directory.\\n- If both a PRD path and an issue ID are provided, path selects the target file and issue provides seed context.\\n\\nUpdate docs/Workflow.md Step 2 to document the bd-id invocation pattern.","notes":"Updated docs/Workflow.md to direct agents to /implement for branch/PR/beads hygiene; hardened /implement command (assignee=rogardle, missing origin guidance, bd sync --flush-only fallback). Commit: 5cabf1c","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:00:49.431468333-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","labels":["opencode","workflow"],"deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-74","title":"Find next item to work on: Intake brief","description":"Linked PRD: /tmp/test-prd-md.md","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/1","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T20:35:09.113334635-08:00","updated_at":"2025-12-19T02:00:18.050994668-08:00","closed_at":"2025-12-19T02:00:18.050994668-08:00"}
{"id":"wf-79y","title":"Epic: Git workflow enforcement \u0026 automation","description":"Implement branch protections, PR templates, CI gates, commit conventions, pre-commit hooks, bd\u003c\u003ePR automation, LFS policy, and rollout plan to align with best-practice Git workflows for multi-agent teams.\\n\\nGoal: Make main reliably releasable, reduce conflicts, and codify agent push/merge policies.\\n\\nSee docs/dev/git_workflow.md for the current guidance; this epic will track implementing the high-priority recommendations and follow-ups.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-22T22:30:13.220015464-08:00","updated_at":"2026-01-19T03:39:27.47027042-08:00","closed_at":"2026-01-19T03:39:27.470281833-08:00","labels":["done"],"comments":[{"id":9,"issue_id":"wf-79y","author":"ship","text":"Updated workflow docs to Option 3 (team worktree + topic branches) and updated supporting templates/docs.\\n\\nChanges\\n- docs/dev/git_workflow.md: adopt Option 3; add worktree constraint note; update naming conventions (team worktrees, topic branches, optional agent sub-branches).\\n- docs/.github/handoff_note_template.md: update to reference topic branches and optional sub-branches; rename 'Risks / TODOs' -\u003e 'Risks / follow-ups'.\\n- docs/.github/permissions_matrix.md: expand from draft to table; align with .opencode permissions concept (ask for push/merge/tag).\\n- docs/.github/branch_protection.md: mention suggested status check name  (wf-79y.14).\\n- .github/PULL_REQUEST_TEMPLATE.md: add recommended branch naming.\\n\\nValidation\\n- npm test: PASS (note: \n\u003e waif@0.1.0 build\n\u003e eval \"$(direnv export bash)\" \u0026\u0026 tsc --project tsconfig.json prints direnv blocked message, but tests still passed).\\n- npm run lint: N/A (no lint script in package.json; consider adding or updating docs to match reality).\\n- npm run build: emits direnv blocked message in this environment; suggests build step may be sensitive to direnv being allowed.\\n\\nFollow-ups / risks\\n- Consider updating docs to avoid implying a lint script exists, or add lint script + CI check.\\n- Consider adding/landing PR validation workflow per wf-79y.14 to enforce title pattern and publish status check .","created_at":"2025-12-24T00:43:53Z"},{"id":10,"issue_id":"wf-79y","author":"ship","text":"Correction: suggested status check name is 'pr/validate-title' (wf-79y.14). The previous comment lost it due to shell backtick parsing.","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-79y.1","title":"Add branch protection and PR gating","description":"Add and document branch protection rules for main and any protected branches.\\n\\nRequirements (suggested):\\n- Block force pushes to main\\n- Require pull request reviews before merging (1-2 approvers)\\n- Require passing CI status checks before merge (ci/test, ci/lint, ci/build)\\n- Restrict who can push to main (optional: only CI and designated humans)\\n- Enforce linear history or preferred merge method (document policy)\\n\\nDeliverables:\\n1) Configure branch protection in the Git provider (admins only).\\n2) Add docs/.github/branch_protection.md describing exact settings and rationale.\\n3) Add a bd note referencing the change and any required admin actions.\\n\\nReferences:\\n- GitHub docs: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-protected-branches\\- Use repo admin to set these.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T22:30:16.414509034-08:00","updated_at":"2026-01-19T03:40:11.718475587-08:00","closed_at":"2026-01-19T03:40:11.718481277-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-79y.1","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:16.442481034-08:00","created_by":"daemon"}]}
{"id":"wf-79y.10","title":"Document security notes: secrets, CI credentials, signed commits","description":"Add security guidance: never commit secrets, where CI secrets live, rotation policy, and optional signed commits guidance.\\n\\nDeliverables:\\n1) docs/dev/security_git_notes.md documenting secrets handling and CI credentials.\\n2) Add guidance on optional GPG signing for commits and verification for releases.\\n\\nReferences:\\n- GitHub Actions Secrets: https://docs.github.com/en/actions/security-guides/encrypted-secrets","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T22:30:38.632536879-08:00","updated_at":"2025-12-22T22:30:38.632536879-08:00","dependencies":[{"issue_id":"wf-79y.10","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:38.679469118-08:00","created_by":"daemon"}]}
{"id":"wf-79y.11","title":"Add BD handoff note template to repo and process","description":"Add the handoff note template to history/handoff_note_template.md (done) and integrate the template into team process. Tasks:\\n1) Move history/handoff_note_template.md into docs/.github/handoff_note_template.md (or keep in history/ and link) and ensure it's discoverable by agents and humans.\\n2) Update docs/dev/git_workflow.md to reference the template and include a short copy/paste snippet.\\n3) Add a small bd onboarding note/example showing how to use the template for a Patch-\u003eProbe handoff.\\n\\nDeliverables:\\n- docs/.github/handoff_note_template.md or link from README to history/\\n- docs/dev/git_workflow.md updated to point to the template (and include usage guidance).\\n- Example bd comment in history/example_handoffs.md\\n\\nNotes: history/handoff_note_template.md is already created. This task will fully integrate it into the process.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:43:30.794853033-08:00","updated_at":"2025-12-23T16:21:28.154774482-08:00","dependencies":[{"issue_id":"wf-79y.11","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:43:30.796027263-08:00","created_by":"daemon"}]}
{"id":"wf-79y.12","title":"Add branch protection recommendations and implement settings","description":"Add the branch protection recommendation doc (docs/.github/branch_protection.md already created) and implement the protected branch settings.\\n\\nDeliverables:\\n1) docs/.github/branch_protection.md in repo (done).\\n2) Create a short checklist for repo admins to apply the settings.\\n3) If permitted, propose the JSON payload to apply via GitHub API or terraform.\\n\\nNotes: Actual application of protection rules requires admin rights; coordinate with org admins.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T22:50:37.94613759-08:00","updated_at":"2026-01-19T03:40:11.727864506-08:00","closed_at":"2026-01-19T03:40:11.72786857-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-79y.12","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:50:37.956615576-08:00","created_by":"daemon"}]}
{"id":"wf-79y.13","title":"Add PR template enforcement (oykk request template)","description":"Add the PR template (created at .github/PULL_REQUEST_TEMPLATE.md) and enforce PR title formatting via a CI check or GitHub Action.\\n\\nDeliverables:\\n1) .github/PULL_REQUEST_TEMPLATE.md added (done).\\n2) Create a GitHub Action or CI job to validate PR titles include bd-\u003cid\u003e and comment if missing.\\n3) Update docs/dev/git_workflow.md to reference the enforcement and PR template.\\n\\nNotes: Implementing the action requires adding a workflow file in .github/workflows/.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T22:50:41.177178665-08:00","updated_at":"2026-01-19T03:40:11.731673697-08:00","closed_at":"2026-01-19T03:40:11.731677252-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-79y.13","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:50:41.187414235-08:00","created_by":"daemon"}]}
{"id":"wf-79y.14","title":"Create PR validation workflow (check PR title \u0026 template)","description":"Problem\\n- PRs must reference beads issues (bd-\u003cid\u003e) in their title for traceability and automation. We need an automated CI/GitHub Action workflow to validate PR titles (and optionally ensure required PR body fields) and to provide clear feedback when PRs don't comply.\\n\\nGoal\\n- Add a GitHub Action (or CI job) that validates PR titles match the required pattern (contains 'bd-\u003cid\u003e') and optionally checks the PR body includes required sections from the PR template. The workflow should comment on PRs that fail validation and expose a status check so branch protection can block merges until corrected.\\n\\nDeliverables\\n1) Add workflow file: .github/workflows/pr-validation.yml implementing title and optional body checks.\\n2) Provide a configurable regex for bd id patterns (default: 'bd-[A-Za-z0-9_.-]+').\\n3) When a PR fails validation, the action should post a helpful comment showing the required format and a link to .github/PULL_REQUEST_TEMPLATE.md and docs/dev/git_workflow.md.\\n4) Publish the status check name (e.g., 'pr/validate-title') so it can be required in branch protection.\\n5) Document the workflow in docs/.github/branch_protection.md and docs/dev/git_workflow.md.\\n6) Add tests or example PRs demonstrating the action behavior (optional).\\n\\nNotes/Implementation options\\n- Use a community action (for example, 'amannn/validate-pr-title' or similar) or implement a small JavaScript action that runs the checks.\\n- References: https://docs.github.com/en/actions, https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#pull_request_event\\n\\nAcceptance criteria\\n- A workflow file exists in .github/workflows/ that validates PR titles and posts clear comments on failure.\\n- The workflow exposes a status check name suitable for branch protection rules.\\n\\nOwner suggestions\\n- Map (PM) to coordinate; Forge or a human with repo CI permissions to implement the action.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T22:57:19.478933244-08:00","updated_at":"2026-01-19T03:40:11.735321246-08:00","closed_at":"2026-01-19T03:40:11.735326833-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-79y.14","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:57:19.490448474-08:00","created_by":"daemon"}]}
{"id":"wf-79y.15","title":"Permissions \u0026 enforcement matrix for git operations","description":"Problem\\n- Agents and humans need an unambiguous reference that maps roles to allowed Git operations (push, merge, tag, force-push) so day-to-day coordination doesn't require digging into .opencode files repeatedly.\n\nGoal\\n- Produce a small, authoritative Permissions \u0026 Enforcement matrix documenting which roles may perform which operations, the approval flow for exceptions, and how agents should request permissions (bd note pattern). Store the matrix in docs/.github/permissions_matrix.md and add a short 'how an agent asks' snippet to docs/dev/git_workflow.md.\n\nDeliverables\\n1) docs/.github/permissions_matrix.md listing roles (Ship, Patch, Probe, Map, Forge, Scribbler, Muse, Pixel, human Producer) and allowed operations: push, merge, tag, force-push, create branches, create worktrees. Include example bd delegation notes (delegated-to:@ship) and escalation steps.\n2) Update docs/dev/git_workflow.md to reference the permissions matrix and include a one-paragraph agent request pattern.\n3) Add a short checklist for repo admins to enforce permissions via branch protection and CODEOWNERS where possible.\n\nReferences\\n- .opencode/agent/*.md for current allowed commands and boundaries\\n- GitHub branch protection docs: https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-protected-branches\\n\nAcceptance criteria\\n- Permissions matrix file exists in docs/.github/ and doc links updated.\\n,json:true}","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T23:01:11.513708498-08:00","updated_at":"2025-12-22T23:01:11.513708498-08:00","dependencies":[{"issue_id":"wf-79y.15","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T23:01:11.522893088-08:00","created_by":"daemon"}]}
{"id":"wf-79y.16","title":"Add TL;DR Quick Start and decision table for rebase vs merge","description":"Add a short TL;DR Quick Start at the top of docs/dev/git_workflow.md and a compact decision table that clarifies when to rebase vs merge.\\n\\nDeliverables:\\n1) A 4–6 line TL;DR Quick Start block for the top of the doc with minimal commands.\\n2) A two-row decision table or rule box explaining rebasing vs merging for local-only, shared/published, and long-running work.\\n3) Update docs/dev/git_workflow.md (done as part of doc edits) and record the change in bd.\\n\\nReferences:\\n- Best-practice summaries: trunk-based vs feature-branch models (various articles).\\n,json:true}","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T23:01:16.205043818-08:00","updated_at":"2025-12-22T23:01:16.205043818-08:00","dependencies":[{"issue_id":"wf-79y.16","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T23:01:16.216152338-08:00","created_by":"daemon"}]}
{"id":"wf-79y.17","title":"Add PR description checklist and PR template enforcement docs","description":"Document a short PR description checklist in docs/dev/git_workflow.md and add docs on how PR template enforcement works and where to find the PR template.\\n\\nDeliverables:\\n1) Short PR description checklist (2–3 bullets) added to git_workflow.md.\\n2) docs/.github/pr_enforcement.md describing the PR validation workflow, status check name, and how to configure branch protection to require it.\\n3) Link to .github/PULL_REQUEST_TEMPLATE.md and mention wf-79y.14 (PR validation workflow task).\\n,json:true}","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T23:01:22.688771861-08:00","updated_at":"2025-12-22T23:01:22.688771861-08:00","dependencies":[{"issue_id":"wf-79y.17","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T23:01:22.705940441-08:00","created_by":"daemon"}]}
{"id":"wf-79y.18","title":"Add decision guidance for lockfile/dependency conflicts and flaky CI","description":"Add guidance for dependency/lockfile conflicts and flaky CI to docs/dev/git_workflow.md.\\n\\nDeliverables:\\n1) Add a short section describing best practices for lockfile handling: dedicated dependency PRs, renovate/dependabot, npm ci, regenerate lockfile after conflicts, run full tests.\\n2) Add instructions for recording flaky CI failures in bd and escalation path to Ship if persistent.\\n\\nReferences:\\n- Renovate, Dependabot docs.\\n,json:true}","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T23:01:25.225798616-08:00","updated_at":"2025-12-22T23:01:25.225798616-08:00","dependencies":[{"issue_id":"wf-79y.18","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T23:01:25.236688256-08:00","created_by":"daemon"}]}
{"id":"wf-79y.2","title":"Create PR template and review checklist","description":"Add a standard PR template to .github/PULL_REQUEST_TEMPLATE.md with the following sections:\\n- Title should start with 'bd-\u003cid\u003e: short description'\\n- Summary of change and scope\\n- bd link(s)\\n- Commands run locally (npm test, lint, build)\\n- Tests executed and status\\n- Risk, rollback plan, and migration notes\\n- Files changed\\n\\nDeliverables:\\n1) .github/PULL_REQUEST_TEMPLATE.md added to repo.\\n2) Update docs/dev/git_workflow.md to reference the template.\\n\\nReferences: https://docs.github.com/en/github/building-a-strong-community/creating-a-pull-request-template-for-your-repository","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T22:30:20.025696394-08:00","updated_at":"2026-01-19T03:40:11.723779072-08:00","closed_at":"2026-01-19T03:40:11.723784863-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-79y.2","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:20.046894274-08:00","created_by":"daemon"}]}
{"id":"wf-79y.3","title":"Adopt commit message conventions and commitlint","description":"Define commit message convention (recommend Conventional Commits plus bd-\u003cid\u003e prefix). Add commitlint and CI check to enforce messages.\\n\\nDeliverables:\\n1) docs/dev/git_workflow.md: add a section on commit conventions and examples.\\n2) Add commitlint config and note in docs how to run locally.\\n3) CI job to validate commit messages for PR merges.\\n\\nReferences:\\n- https://www.conventionalcommits.org/en/v1.0.0/\\n- https://github.com/conventional-changelog/commitlint","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:22.076657524-08:00","updated_at":"2025-12-22T22:30:22.076657524-08:00","dependencies":[{"issue_id":"wf-79y.3","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:22.101468994-08:00","created_by":"daemon"}]}
{"id":"wf-79y.4","title":"Add pre-commit hooks (husky + lint-staged)","description":"Introduce optional local dev tooling to catch lint/test issues before pushing.\\n\\nDeliverables:\\n1) Add recommended dev-dependencies and sample config in package.json (husky, lint-staged).\\n2) docs/dev/git_workflow.md: document how to opt-in and run locally.\\n3) Provide a sample pre-commit script for linting and fast tests.\\n\\nReferences:\\n- Husky: https://typicode.github.io/husky/\\n- lint-staged: https://github.com/okonet/lint-staged","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:24.107691124-08:00","updated_at":"2025-12-22T22:30:24.107691124-08:00","dependencies":[{"issue_id":"wf-79y.4","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:24.117310864-08:00","created_by":"daemon"}]}
{"id":"wf-79y.5","title":"Automate bd \u003c\u003e PR linking","description":"Add automation to ensure PRs reference bd issues and optionally update bd when PRs land.\\n\\nDeliverables:\\n1) CI/Action that validates PR title or body contains 'bd-\u003cid\u003e'.\\n2) Optional: GitHub Action that comments on PR with bd link and updates bead note via API when status changes.\\n3) docs/dev/git_workflow.md: document the automation and expected PR naming conventions.\\n\\nReferences:\\n- GitHub Actions: https://docs.github.com/en/actions\\- Example action that parses PR title and calls an API\\n","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:25.988894434-08:00","updated_at":"2025-12-22T22:30:25.988894434-08:00","dependencies":[{"issue_id":"wf-79y.5","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:26.000513704-08:00","created_by":"daemon"}]}
{"id":"wf-79y.6","title":"Define Git LFS and large asset policy","description":"Document policy for large binaries and how to add them (Git LFS, allowed locations, ownership and approval workflow).\\n\\nDeliverables:\\n1) docs/dev/git_lfs_policy.md explaining where to store large assets, LFS usage, and approval steps.\\n2) Add .gitattributes if adopting LFS for certain paths.\\n3) Update docs/dev/git_workflow.md to reference the policy.\\n\\nReferences:\\n- Git LFS: https://git-lfs.github.com/","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:28.649096704-08:00","updated_at":"2025-12-22T22:30:28.649096704-08:00","dependencies":[{"issue_id":"wf-79y.6","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:28.671137974-08:00","created_by":"daemon"}]}
{"id":"wf-79y.7","title":"Document release/tagging policy and Ship responsibilities","description":"Document who tags releases, semantic versioning expectations, changelog process, and Ship's role in validating release readiness.\\n\\nDeliverables:\\n1) docs/dev/release_policy.md with tagging and release steps.\\n2) Update docs/dev/git_workflow.md to reference release policy.\\n\\nReferences:\\n- Semantic Versioning: https://semver.org/\\- semantic-release: https://github.com/semantic-release/semantic-release","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:30.769298254-08:00","updated_at":"2025-12-22T22:30:30.769298254-08:00","dependencies":[{"issue_id":"wf-79y.7","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:30.780363394-08:00","created_by":"daemon"}]}
{"id":"wf-79y.8","title":"Adopt merge queue or merge-when-green policy","description":"Investigate and adopt a merge queue or 'merge when green' strategy to serialize merges and reduce CI churn.\\n\\nDeliverables:\\n1) Evaluation of options (Mergify, GitHub Merge Queue, custom action).\\n2) If suitable, configure merge queue for the repo and document behavior.\\n3) Update docs/dev/git_workflow.md with the selected approach.\\n\\nReferences:\\n- Mergify: https://mergify.io/\\n","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T22:30:34.638871834-08:00","updated_at":"2025-12-22T22:30:34.638871834-08:00","dependencies":[{"issue_id":"wf-79y.8","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:34.648196914-08:00","created_by":"daemon"}]}
{"id":"wf-79y.9","title":"Add guidance for dependency/lockfile merges","description":"Document strategies to reduce lockfile conflicts and dependency churn.\\n\\nDeliverables:\\n1) docs/dev/dependency_guidance.md describing best practices (dedicated dependency PRs, renovate/dependabot, how to resolve lockfile conflicts).\\n2) CI guidance to run npm ci and how to handle lockfile regeneration after conflicts.\\n\\nReferences:\\n- Renovate: https://www.whitesourcesoftware.com/free-developer-tools/renovate/\\n- Dependabot: https://github.com/dependabot","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T22:30:36.546483484-08:00","updated_at":"2025-12-22T22:30:36.546483484-08:00","dependencies":[{"issue_id":"wf-79y.9","depends_on_id":"wf-79y","type":"parent-child","created_at":"2025-12-22T22:30:36.570362165-08:00","created_by":"daemon"}]}
{"id":"wf-7cn","title":"Docs: Implement Context Pack command and template","description":"Document the CLI 'context' command and add a stable template at docs/dev/CONTEXT_PACK.md; ensure redact rules for ignored files are specified.","notes":"Linked implementation PRD: docs/dev/context_pack_PRD.md (source intake: wf-ba2.5.4). CLI_PRD now points to this PRD for the context/ctx command.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-19T21:44:26.713260809-08:00","updated_at":"2025-12-22T16:31:06.896524268-08:00","closed_at":"2025-12-22T15:15:51.105437603-08:00","dependencies":[{"issue_id":"wf-7cn","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.174175879-08:00","created_by":"daemon"}]}
{"id":"wf-7el","title":"Task: implement redaction helper for ooda snapshots","description":"Acceptance criteria:\\n- Utility to remove/trim large message bodies and redact secrets\\n- Unit tests covering common cases (long bodies, secrets)\\n- Documentation note about redaction policy referencing wf-ba2.8","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-28T16:00:38.696359601-08:00","updated_at":"2025-12-28T16:00:38.696359601-08:00","dependencies":[{"issue_id":"wf-7el","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T16:00:38.700363483-08:00","created_by":"daemon"}]}
{"id":"wf-7m7","title":"Add waif command to validate implementation plan integrity","description":"Feature intake: Plan Validator (wf doctor)\n\nProblem\n\nPMs maintain many Beads issues; there is no single interactive tool to validate plan integrity locally. PMs need a quick command that scans the Beads DB and reports structural problems so they can fix intake/plan issues before reviews.\n\nUsers\n\n- Product managers who run checks locally before PRs or planning meetings\n- Program leads who audit plan hygiene for a release\n- Integrators who want a local, interactive validator (not CI-first)\n\nSuccess criteria\n\n- `wf doctor` runs locally and scans the project's beads (via `bd` or `.beads/issues.jsonl` fallback)\n- It reports human-friendly findings (what is wrong and where) but does not apply fixes or print bd commands\n- The validator respects the project decision: interactive-only, no suggested bd commands\n- Output is clear and actionable for a PM to manually fix issues\n\nConstraints\n\n- Interactive-only tool: no automatic fixes, no CLI fix suggestions\n- Default scan scope: all beads in the workspace\n- Exit-code behavior: interactive (always exit code 0 by default) — scripts may parse output, but validator is intended for humans\n\nScope / Rules to validate (initial)\n\n- Intake completeness: require presence of intake headings (Problem, Users, Success criteria, Constraints) in issue body (heuristic string match)\n- Dependency consistency: flag cycles, missing referenced issue IDs, or broken discovered-from links\n- Orphans: flag leaf tasks (non-epic) that are isolated with no parent or deps (informational)\n- Milestone: do not enforce a milestone policy (per decision)\n\nOutput format\n\n- Human-readable Markdown report printed to stdout\n- No suggestion lines or copy/paste bd commands (per decision)\n- Optional `--json` flag is reserved for future automation (not required now)\n\nImplementation notes\n\n- Use existing `src/lib/bd.ts` to call `bd` programmatically when available; fall back to reading `.beads/issues.jsonl` if `bd` is not present\n- Add a new command `src/commands/plan-check.ts` and wire into `src/index.ts` following existing command patterns\n- Reuse existing test patterns in `tests/` (show.test.ts, stage.test.ts) for report formatting unit tests\n\nDeliverables\n\n- Draft intake file (this document)\n- CLI command `wf doctor` implementing the checks above (interactive only)\n- Unit tests for validator heuristics and output formatting\n- Documentation snippet in `docs/Workflow.md` explaining usage\n\nRelated beads / docs\n\n- Update existing bead `wf-7m7` (parent) with this intake and mark Status: Intake Completed when ready\n- docs/Workflow.md, .opencode/command/intake.md, docs/dev/workflow_stage_tracking_PRD.md\n\nNext steps\n\n1) Review this draft and request edits if needed\n2) After approval I will update bead `wf-7m7` with the intake (add label `Status: Intake Completed`, assign to Build) and run `bd sync`\n3) Implement `wf doctor` and add tests","status":"closed","priority":2,"issue_type":"feature","assignee":"Build","created_at":"2025-12-19T15:30:42.855434612-08:00","updated_at":"2026-01-19T02:42:44.208735431-08:00","closed_at":"2026-01-19T02:42:44.208772144-08:00","external_ref":"https://github.com/SorraTheOrc/waif/pull/160","labels":["Status: Intake Completed","Status: PR Created","feature","stage:done"]}
{"id":"wf-7xv","title":"Create specialist agent files for each role","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-20T15:12:42.33485019-08:00","updated_at":"2025-12-20T20:32:57.462454025-08:00","closed_at":"2025-12-20T20:32:57.462478711-08:00"}
{"id":"wf-7xv.1","title":"Create specialist agent file: PM (human)","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.54340158-08:00","updated_at":"2025-12-20T16:10:01.426414083-08:00","dependencies":[{"issue_id":"wf-7xv.1","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.54511198-08:00","created_by":"daemon"}],"deleted_at":"2025-12-20T16:10:01.426414083-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-7xv.10","title":"Create specialist agent file: Pixel (Art AI)","description":"Subagent: Pixel (Art AI). Config lives at .opencode/agent/pixel.md. Provides asset/variant guidance, naming/location conventions, and review support (no bash).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T16:09:47.022486262-08:00","updated_at":"2025-12-20T16:46:38.84198776-08:00","closed_at":"2025-12-20T16:46:38.84198776-08:00","dependencies":[{"issue_id":"wf-7xv.10","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T16:09:47.045034233-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.11","title":"Create specialist agent file: Ship (DevOps AI)","description":"Subagent: Ship (DevOps AI). Config lives at .opencode/agent/ship.md. Owns CI/build/release readiness; keeps main releasable and adds minimal CI changes.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T16:09:49.421590729-08:00","updated_at":"2025-12-20T18:32:04.140520094-08:00","closed_at":"2025-12-20T18:32:04.140520094-08:00","dependencies":[{"issue_id":"wf-7xv.11","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T16:09:49.439816711-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.12","title":"Create specialist agent file: Forge (Agent-file Authoring AI)","description":"Subagent: Forge (Agent-file Authoring AI). Config will live at .opencode/agent/forge.md. Specializes in drafting and refining other agent definition files (frontmatter, permissions, boundaries, workflow, RACI alignment) to match repo conventions.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T18:45:22.891859553-08:00","updated_at":"2025-12-21T17:47:21.565482324-08:00","closed_at":"2025-12-21T17:47:21.56558052-08:00","dependencies":[{"issue_id":"wf-7xv.12","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T18:45:22.894582688-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.2","title":"Create specialist agent file: Design (human)","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.593213799-08:00","updated_at":"2025-12-20T16:09:53.794632613-08:00","dependencies":[{"issue_id":"wf-7xv.2","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.593830899-08:00","created_by":"daemon"}],"deleted_at":"2025-12-20T16:09:53.794632613-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-7xv.3","title":"Create specialist agent file: Engineering (human)","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.642302219-08:00","updated_at":"2025-12-20T16:09:53.801805658-08:00","dependencies":[{"issue_id":"wf-7xv.3","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.643882119-08:00","created_by":"daemon"}],"deleted_at":"2025-12-20T16:09:53.801805658-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-7xv.4","title":"Create specialist agent file: QA (human)","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.688024637-08:00","updated_at":"2025-12-20T16:09:53.803363586-08:00","dependencies":[{"issue_id":"wf-7xv.4","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.688690437-08:00","created_by":"daemon"}],"deleted_at":"2025-12-20T16:09:53.803363586-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-7xv.5","title":"Create specialist agent file: Map (PM AI, primary)","description":"Primary OpenCode agent (PM AI / Map). Config lives at .opencode/agent/map.md. This is the main interaction point with the Producer; coordinates other call-sign subagents and tracks work in bd.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.736170555-08:00","updated_at":"2025-12-20T16:42:18.855881035-08:00","closed_at":"2025-12-20T16:42:18.855881035-08:00","dependencies":[{"issue_id":"wf-7xv.5","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.736775656-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.6","title":"Create specialist agent file: Muse (Designer AI)","description":"Subagent: Muse (Designer AI). Config lives at .opencode/agent/muse.md. Produces design variants, user flows, state transitions, and clarifies acceptance criteria.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.784878275-08:00","updated_at":"2025-12-20T18:33:02.820101525-08:00","closed_at":"2025-12-20T18:33:02.820101525-08:00","dependencies":[{"issue_id":"wf-7xv.6","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.788174876-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.7","title":"Create specialist agent file: Patch (Implementation AI)","description":"Subagent: Patch (Implementation AI). Config lives at .opencode/agent/patch.md. Implements small, correct code changes with minimal churn; follows bd-driven workflow.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.835424094-08:00","updated_at":"2025-12-20T17:00:25.175994505-08:00","closed_at":"2025-12-20T17:00:25.175994505-08:00","dependencies":[{"issue_id":"wf-7xv.7","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.836032795-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.8","title":"Create specialist agent file: Scribbler (Docs AI)","description":"Subagent: Scribbler (Docs AI). Config lives at .opencode/agent/scribbler.md. Maintains PRDs and repo docs; prefers updating existing docs; no bash.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.883846514-08:00","updated_at":"2025-12-20T18:38:01.168511255-08:00","closed_at":"2025-12-20T18:38:01.168511255-08:00","dependencies":[{"issue_id":"wf-7xv.8","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.884979114-08:00","created_by":"daemon"}]}
{"id":"wf-7xv.9","title":"Create specialist agent file: Probe (QA AI + review)","description":"Subagent: Probe (QA AI + review). Config lives at .opencode/agent/probe.md. Runs/assesses quality gates and provides PR risk/review feedback (read-only).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T15:13:03.932272433-08:00","updated_at":"2025-12-20T18:41:47.125175615-08:00","closed_at":"2025-12-20T18:41:47.125175615-08:00","dependencies":[{"issue_id":"wf-7xv.9","depends_on_id":"wf-7xv","type":"parent-child","created_at":"2025-12-20T15:13:03.932846233-08:00","created_by":"daemon"}]}
{"id":"wf-84p","title":"Rename project to WAIF","description":"Rename the project branding to 'WAIF' across the repo and documentation.\n\nExplanation: The project name remains the same in spirit, but we standardize on the spelling 'WAIF' for branding consistency.\n\nNautical acronym (tongue-in-cheek): WAIF — Wind Assisted Freaking Idiot. Note: humans inevitably typo this as 'WAFI' sometimes; we embrace the typo and make a joke: 'When sailors spell it wrong, they blame the wind — humans blame their fingers.'\n\nMVP scope (minimal, low-risk):\n- Update  feature and name mentions to 'WAIF' where applicable.\n- Update   and any CLI references if present.\n- Update  and docs/ references to use 'WAIF'.\n- Create follow-up issues for any code/CI/display name changes that require broader coordination.\n\nAcceptance criteria:\n- Repo README and docs use 'WAIF' consistently.\n- A P0 chore exists tracking the rename with clear next steps.\n\nRecommended next commands:\n- Review created issue and confirm whether files should be updated automatically.\n,","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2 (CLI renamed to 'waif')\n\n---\n\nPR: https://github.com/SorraTheOrc/wafi/pull/2","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-19T02:14:56.497483898-08:00","updated_at":"2025-12-19T03:09:27.383433104-08:00","closed_at":"2025-12-19T03:09:27.383433104-08:00"}
{"id":"wf-8e9","title":"Make CLI E2E deterministic: programmatic run-job + mocked snapshot writer","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T20:02:53.197279798-08:00","created_by":"WAIF","updated_at":"2026-01-08T20:22:09.921115714-08:00","closed_at":"2026-01-08T20:22:09.921115714-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-8e9","depends_on_id":"wf-e6r.2.1.1","type":"discovered-from","created_at":"2026-01-08T20:02:53.206281868-08:00","created_by":"WAIF"}],"comments":[{"id":83,"issue_id":"wf-8e9","author":"rgardler","text":"Changed tests/wf-e6r.2.14.cli-e2e.test.ts to run programmatically and mock writeSnapshots; added deterministic E2E that uses --sample + --once and spies on writeSnapshots to avoid disk IO.","created_at":"2026-01-09T04:22:07Z"}]}
{"id":"wf-8js","title":"Adaptice console output format: Intake brief","description":"Linked PRD: docs/dev/CLI_PRD.md\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T23:24:38.135582108-08:00","updated_at":"2025-12-21T02:46:05.002650691-08:00","closed_at":"2025-12-21T02:46:05.002650691-08:00"}
{"id":"wf-8k6","title":"Ship: merge bd-wf-ba2.3.4/implement-integrate-context into main and delete branch","status":"tombstone","priority":1,"issue_type":"task","created_at":"2025-12-30T17:30:42.302810634-08:00","updated_at":"2025-12-30T17:31:02.133123712-08:00","dependencies":[{"issue_id":"wf-8k6","depends_on_id":"wf-ba2.3.4","type":"discovered-from","created_at":"2025-12-30T17:30:42.315608213-08:00","created_by":"daemon"}],"comments":[{"id":77,"issue_id":"wf-8k6","author":"map","text":"Handing off to Ship: merge branch bd-wf-ba2.3.4/implement-integrate-context into main, then delete local and remote branches. Map confirmed force-delete allowed if branch not merged. Verify working tree is clean before running; commit .opencode/agent/ship.md or stash. Known merge commit: 47fac44f8a88163070f9f6349e54d9add219adf5. PR: https://github.com/SorraTheOrc/waif/pull/90","created_at":"2025-12-31T01:30:43Z"}],"deleted_at":"2025-12-30T17:31:02.133123712-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-8k7","title":"PRD: Beads search command","description":"Write the full PRD at docs/dev/beads_search_command_PRD.md for feature wf-32r. Must define CLI signature, search semantics (title/desc default, flags to include notes/comments and linked docs), performance expectations, JSON output, ignore boundary considerations, and test plan. Ensure two-way traceability: PRD includes 'Source issue: wf-32r' and wf-8k7 external-ref is set to 'PRD: docs/dev/beads_search_command_PRD.md'.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T16:04:56.291500625-08:00","updated_at":"2025-12-22T16:35:50.110121177-08:00","dependencies":[{"issue_id":"wf-8k7","depends_on_id":"wf-32r","type":"discovered-from","created_at":"2025-12-22T16:04:56.298958872-08:00","created_by":"daemon"},{"issue_id":"wf-8k7","depends_on_id":"wf-32r","type":"parent-child","created_at":"2025-12-22T16:05:04.039431698-08:00","created_by":"daemon"}]}
{"id":"wf-8n9","title":"wf-mtc.3.5: Security review - runJobCommand sandboxing \u0026 redaction","description":"Review runJobCommand for sandboxing risks, command injection, redaction coverage, and CI implications. Deliverables: 1) short threat-model doc saved to history/ooda_runjob_threat_model.md, 2) recommended mitigations (priority list), 3) list of required follow-up code tasks (allowlist/array-command enforcement, capture opt-in default, redaction tests, runtime containment pilot), 4) recommended CI changes and smoke tests. Acceptance criteria: threat-model doc attached to issue (history/ooda_runjob_threat_model.md), mitigation list provided, and at least one follow-up code task created or assigned.\n\nSuggested owner: security reviewer (map/ops). Estimated effort: 1-2 days.,--json","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-11T23:25:36.241450787-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:42:43.100875827-08:00"}
{"id":"wf-8re","title":"Enable Copilot PR review only on PR open","description":"/delegate @ship\n\nRationale\n\nWe want GitHub Copilot to produce an automated review when a PR is first opened, but not to re-run when the PR receives subsequent pushes/updates. This reduces noise while preserving a first-pass automated review. Ship (CI/Repo admin) should configure the repo appropriately (either via the official Copilot-for-PRs GitHub App settings or via a minimal GitHub Actions workflow) and validate behaviour.\n\nScope \u0026 constraints\n\n- Do NOT change or rely on local uncommitted files in the main repo workspace. Create branches from origin/main for any workflow file changes.\n- Prefer repo-level GitHub App configuration (preferred, least-privilege) over writing a workflow that uses an elevated PAT. If App installation is not possible (organization policy), implement a scoped GitHub Actions workflow that calls Copilot action/API and is triggered only on pull_request types: [opened].\n- Document exact permission grants and secrets / tokens needed. Avoid using tokens with broad org-level permissions.\n\nAcceptance criteria (concrete)\n\n1) When a PR is opened in this repository, Copilot (or the configured automation) posts an automated review/comment summarizing high-level issues (lint/test failures, quick suggestions or review notes) within 10 minutes of PR creation.\n2) When subsequent commits are pushed to the same PR (pull_request:synchronize), the Copilot automation does NOT post new automated reviews/comments. (It may update an existing comment only if you choose that behaviour, but it must not create a new review on synchronize.)\n3) Demonstration: create a short test PR (branch: ci/copilot-pr-check) that triggers the behaviour and capture: PR URL, link to the Copilot review/comment, and timeline showing it ran on PR opened and did not run on a follow-up push.\n4) Documentation: add history/github-copilot-pr.md describing the chosen implementation, configuration steps (App install or workflow file), permissions granted, and how to revert. If a workflow file was added, place it at .github/workflows/copilot-pr-review.yml and include the job trigger definition showing it only runs on pull_request: types: [opened].\n5) Security/audit: list any tokens or secrets used and recommend rotation/least-privilege scope. If an org-admin is required to complete the work, escalate and document the required admin action.\n\nDeliverables (expected)\n\n- Either: GitHub App configured for “Copilot for PRs” with settings changed to only run on PR opened (preferred). OR: Workflow file .github/workflows/copilot-pr-review.yml that triggers only on PR opened and calls the Copilot review action/API.\n- A short test PR (ci/copilot-pr-check) demonstrating the behaviour (opened → Copilot review posted; push new commit → no new review created).\n- Documentation at history/github-copilot-pr.md documenting steps, permissions, and test evidence.\n- A bd comment on this task with commands run, PR URL(s), and verification evidence.\n\nSuggested steps \u0026 example commands\n\n(1) Check app availability and install/configure (preferred):\n- Inspect repo Installations: gh api repos/:owner/:repo/installation --jq '.id' (or use org UI)\n- If Copilot for PRs is available as a GitHub App, configure its event subscriptions or settings to only act on pull_request.opened events (consult org admin if needed)\n\n(2) If App install is not possible, create a minimal Actions workflow (example trigger):\n- Create branch: git fetch origin \u0026\u0026 git checkout -b copilot-pr/setup origin/main\n- Add .github/workflows/copilot-pr-review.yml with:\n  on:\n    pull_request:\n      types: [opened]\n  jobs:\n    copilot_review:\n      runs-on: ubuntu-latest\n      steps:\n        - uses: actions/checkout@v4\n        - name: Run Copilot review (choose action or script that calls Copilot)\n          run: |\n            # call copilot review API or action here\n\n(3) Test \u0026 validate:\n- gh pr create --title \"test: copilot pr review\" --head copilot-pr/setup --base main\n- Capture PR URL and verify Copilot posted a review shortly after open\n- Push a dummy commit to the PR and confirm no additional automated review is created\n\nPriority \u0026 timebox\n\nPriority: 2 (medium). Timebox: initial implementation + test within 2 working days. If App-level permissions or org-admin involvement is required, escalate immediately and post a blocker on the bd issue.\n\nNotes on least-privilege\n\n- Prefer using the GitHub App (Copilot for PRs) which scopes itself via the App installation instead of storing tokens in repo secrets.\n- If using Actions, create a dedicated machine user / token with minimal repo scope and document it.\n\nPlease acknowledge pickup on this bd task and post the first commands you will run. If you need org-admin permissions, escalate immediately and document the required action.\n\n","notes":"/delegate @ship\n\nDo this now (authoritative handoff)\n\nRationale\n- We need GitHub Copilot to post an automated review only when a PR is first opened, and NOT to create new automated reviews on subsequent PR updates. This reduces noise while preserving a first-pass automated review.\n\nScope (pick ONE approach and implement):\nA) Preferred — GitHub App configuration\n   - If the Copilot-for-PRs GitHub App is installable/configurable for this repo, update its settings so it runs on pull_request:opened only (or equivalent \"Run on PR open\" toggle) and does not run on pull_request:synchronize. Document the exact setting changed and provide evidence (screenshot link or setting dump) in the bd comment.\nB) Fallback — GitHub Actions workflow\n   - Add a minimal workflow at .github/workflows/copilot-pr-review.yml that triggers only on pull_request: types: [opened] and invokes the Copilot review action/API with least-privilege credentials. Document secrets used and their minimal scopes.\n\nAcceptance criteria (must meet to close wf-8re)\n1) On PR open, Copilot posts an automated review/comment within 10 minutes summarizing quick findings.\n2) On subsequent pushes to the same PR (pull_request:synchronize), no new automated Copilot review/comment is created. (Updating an existing comment is acceptable if documented, but do NOT create a new review on synchronize.)\n3) Demonstration: Create test PRs to show behaviour: ci/copilot-pr-check (open → Copilot review posted) and ci/copilot-pr-check-updated (push new commit → no new review). Provide PR URLs and timestamps.\n4) Documentation: add history/github-copilot-pr.md describing chosen approach, commands run, permissions/secrets used, how to revert, and test evidence.\n5) Post a bd comment on wf-8re with exact git/gh commands run, PR URLs, and verification evidence. If org-admin action was required, include the escalation details.\n\nConstraints \u0026 notes\n- Do NOT base branches on local uncommitted changes. Always create branches from origin/main.\n- Prefer the App route for least privilege. If App change requires org-admin, escalate immediately and document the requested admin action.\n- If using Actions, use a machine user token with minimal repo scope and document rotation/expiry recommendation.\n\nImmediate steps (exact commands to run now)\n1) Check App availability:\n   - git fetch origin\n   - gh api repos/:owner/:repo/installation --jq '.id' || echo \"No App installation info available\"\n   - If App present, inspect its settings in the GitHub UI and change to run on PR opened only (document the UI path and exact toggles changed).\n2) If App route unavailable, implement workflow:\n   - git fetch origin \u0026\u0026 git checkout -b copilot-pr/setup origin/main\n   - Create .github/workflows/copilot-pr-review.yml with 'on: pull_request: types: [opened]'\n   - git add .github/workflows/copilot-pr-review.yml \u0026\u0026 git commit -m \"wf-8re: add Copilot PR-on-open workflow\" \u0026\u0026 git push -u origin copilot-pr/setup\n   - gh pr create --title \"ci: copilot-pr-check\" --head copilot-pr/setup --base main --body \"Test: Copilot PR-on-open behaviour. References bd#wf-8re\"\n3) Create a short test PR branch to demonstrate behaviour:\n   - git checkout -b ci/copilot-pr-check origin/main \u0026\u0026 gh pr create --title \"test: copilot pr check\" --head ci/copilot-pr-check --base main\n\nReporting \u0026 handoff\n- Post an acknowledgement comment on bd#wf-8re with the exact commands you ran and their outputs (copy-paste). Include PR URLs and evidence (timestamps, screenshots or links) showing Copilot ran on open and not on synchronize.\n- If you need org-admin permissions to change App settings, post a blocker comment on wf-8re and escalate to the Producer with the exact admin steps required.\n\nTimebox\n- Priority: P2. Target initial implementation + demo within 2 working days. Escalate immediately if admin privileges are required.\n\nFiles expected to be created/edited if using Actions route:\n- .github/workflows/copilot-pr-review.yml\n- history/github-copilot-pr.md\n- Branches: copilot-pr/setup and ci/copilot-pr-check\n\nPlease acknowledge pickup on bd#wf-8re and post the first commands you run. Then proceed to implement the chosen approach and post PR/verification links.\n\nNOTE: Do not run these steps on the main working tree if there are local uncommitted changes; create a fresh branch from origin/main or use a worktree/clone instead.","status":"closed","priority":2,"issue_type":"task","assignee":"ship","created_at":"2026-01-13T20:46:12.033219275-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:22:42.599095042-08:00","closed_at":"2026-01-14T01:22:42.599095042-08:00","close_reason":"Closed","comments":[{"id":163,"issue_id":"wf-8re","author":"rgardler","text":"@ship please pick up wf-8re (Enable Copilot PR review only on PR open). This is a direct ping to request immediate acknowledgement and the first commands you will run.\n\nQuick pickup steps (please run and post outputs as your first bd comment):\n1) Confirm repo state (do NOT rely on local uncommitted files):\n   - git fetch origin\n   - git checkout -b copilot-pr/setup origin/main\n   - git status --porcelain\n2) Inspect App availability and permissions:\n   - gh api repos/:owner/:repo/installation --jq '.id' || echo \"No App info available\"\n   - If Copilot-for-PRs GitHub App is available, prefer configuring it to only run on pull_request.opened.\n3) If App route is not possible, create workflow branch and file:\n   - Add .github/workflows/copilot-pr-review.yml with 'on: pull_request: types: [opened]'\n   - Commit, push, and create PR: gh pr create --title \"ci: copilot-pr-check\" --head copilot-pr/setup --base main\n\nDeliverables to post after pickup:\n- Acknowledge on bd#wf-8re and post the exact commands you ran (copy-paste) and their outputs\n- If you choose App route: document the config change and any admin actions required\n- If you choose Actions route: branch + workflow file, test PR URL, and history/github-copilot-pr.md\n\nTimebox: 2 working days. If org-admin permissions are required, escalate immediately and post a blocker comment on bd#wf-8re.\n","created_at":"2026-01-14T04:48:50Z"},{"id":164,"issue_id":"wf-8re","author":"rgardler","text":"/delegate @ship\n\nDo this now — authoritative order\n\nShip: implement wf-8re (Enable Copilot PR review only on PR open) immediately. This is an explicit handoff: pick the App route if possible; otherwise implement the Actions fallback. Follow the acceptance criteria in wf-8re and report back on bd#wf-8re with exact commands and outputs.\n\nImmediate commands to run (copy-paste these exact commands and paste outputs into your bd comment):\n1) Confirm repo state and create branch from origin/main:\n   - git fetch origin\n   - git checkout -b copilot-pr/setup origin/main\n   - git status --porcelain\n2) Check for Copilot App installation (preferred):\n   - gh api repos/:owner/:repo/installation --jq '.id' || echo \"No App installation info available\"\n   - If App present, configure it to run on pull_request:opened only (document UI path \u0026 toggles changed)\n3) If App not available, add Actions workflow:\n   - Create file .github/workflows/copilot-pr-review.yml with trigger on pull_request types: [opened]\n   - git add .github/workflows/copilot-pr-review.yml \u0026\u0026 git commit -m \"wf-8re: add Copilot PR-on-open workflow\" \u0026\u0026 git push -u origin copilot-pr/setup\n   - gh pr create --title \"ci: copilot-pr-check\" --head copilot-pr/setup --base main --body \"Test: Copilot PR-on-open behaviour. References bd#wf-8re\"\n4) Test demonstration:\n   - Create test PR: git checkout -b ci/copilot-pr-check origin/main \u0026\u0026 gh pr create --title \"test: copilot pr check\" --head ci/copilot-pr-check --base main\n   - Capture PR URL and timestamps for open and for a follow-up push\n   - Push a dummy commit to the PR and confirm no new Copilot review is created on synchronize\n\nReporting (mandatory):\n- Post a bd comment on wf#wf-8re acknowledging pickup and paste exact command outputs from steps above.\n- Post PR URLs and evidence: Copilot review on open (link or screenshot) and no new review on synchronize.\n- Add history/github-copilot-pr.md documenting implementation, permissions/secrets used, and how to revert.\n\nEscalation: If org-admin permissions are required to change App settings, post an immediate blocker on bd#wf-8re noting required admin steps (UI path \u0026 permission grant) and ETA impact.\n\nTimebox: 2 working days. Close wf-8re only after acceptance criteria met and documentation posted.\n","created_at":"2026-01-14T04:56:04Z"},{"id":165,"issue_id":"wf-8re","author":"rgardler","text":"/delegate @ship\n\nDo this now (authoritative handoff)\n\nRationale\n- We need GitHub Copilot to post an automated review only when a PR is first opened, and NOT to create new automated reviews on subsequent PR updates. This reduces noise while preserving a first-pass automated review.\n\nScope (pick ONE approach and implement):\nA) Preferred — GitHub App configuration\n   - If the Copilot-for-PRs GitHub App is installable/configurable for this repo, update its settings so it runs on pull_request:opened only (or equivalent \"Run on PR open\" toggle) and does not run on pull_request:synchronize. Document the exact setting changed and provide evidence (screenshot link or setting dump) in the bd comment.\nB) Fallback — GitHub Actions workflow\n   - Add a minimal workflow at .github/workflows/copilot-pr-review.yml that triggers only on pull_request: types: [opened] and invokes the Copilot review action/API with least-privilege credentials. Document secrets used and their minimal scopes.\n\nAcceptance criteria (must meet to close wf-8re)\n1) On PR open, Copilot posts an automated review/comment within 10 minutes summarizing quick findings.\n2) On subsequent pushes to the same PR (pull_request:synchronize), no new automated Copilot review/comment is created. (Updating an existing comment is acceptable if documented, but do NOT create a new review on synchronize.)\n3) Demonstration: Create test PRs to show behaviour: ci/copilot-pr-check (open → Copilot review posted) and ci/copilot-pr-check-updated (push new commit → no new review). Provide PR URLs and timestamps.\n4) Documentation: add history/github-copilot-pr.md describing chosen approach, commands run, permissions/secrets used, how to revert, and test evidence.\n5) Post a bd comment on wf-8re with exact git/gh commands run, PR URLs, and verification evidence. If org-admin action was required, include the escalation details.\n\nConstraints \u0026 notes\n- Do NOT base branches on local uncommitted changes. Always create branches from origin/main.\n- Prefer the App route for least privilege. If App change requires org-admin, escalate immediately and document the requested admin action.\n- If using Actions, use a machine user token with minimal repo scope and document rotation/expiry recommendation.\n\nImmediate steps (exact commands to run now)\n1) Check App availability:\n   - git fetch origin\n   - gh api repos/:owner/:repo/installation --jq '.id' || echo \"No App installation info available\"\n   - If App present, inspect its settings in the GitHub UI and change to run on PR opened only (document the UI path and exact toggles changed).\n2) If App route unavailable, implement workflow:\n   - git fetch origin \u0026\u0026 git checkout -b copilot-pr/setup origin/main\n   - Create .github/workflows/copilot-pr-review.yml with 'on: pull_request: types: [opened]'\n   - git add .github/workflows/copilot-pr-review.yml \u0026\u0026 git commit -m \"wf-8re: add Copilot PR-on-open workflow\" \u0026\u0026 git push -u origin copilot-pr/setup\n   - gh pr create --title \"ci: copilot-pr-check\" --head copilot-pr/setup --base main --body \"Test: Copilot PR-on-open behaviour. References bd#wf-8re\"\n3) Create a short test PR branch to demonstrate behaviour:\n   - git checkout -b ci/copilot-pr-check origin/main \u0026\u0026 gh pr create --title \"test: copilot pr check\" --head ci/copilot-pr-check --base main\n\nReporting \u0026 handoff\n- Post an acknowledgement comment on bd#wf-8re with the exact commands you ran and their outputs (copy-paste). Include PR URLs and evidence (timestamps, screenshots or links) showing Copilot ran on open and not on synchronize.\n- If you need org-admin permissions to change App settings, post a blocker comment on wf-8re and escalate to the Producer with the exact admin steps required.\n\nTimebox\n- Priority: P2. Target initial implementation + demo within 2 working days. Escalate immediately if admin privileges are required.\n\nFiles expected to be created/edited if using Actions route:\n- .github/workflows/copilot-pr-review.yml\n- history/github-copilot-pr.md\n- Branches: copilot-pr/setup and ci/copilot-pr-check\n\nPlease acknowledge pickup on bd#wf-8re and post the first commands you run. Then proceed to implement the chosen approach and post PR/verification links.\n\nNOTE: Do not run these steps on the main working tree if there are local uncommitted changes; create a fresh branch from origin/main or use a worktree/clone instead.\n","created_at":"2026-01-14T05:06:54Z"}]}
{"id":"wf-8tcx","title":"ooda: clear terminal before job header when stdout is TTY","description":"When the ooda scheduler runs a job, run the external 'clear' command before printing the job header, but only when stdout is a TTY.\\n\\nMotivation:\\n- Prevents header clutter during interactive runs while avoiding clearing CI/log outputs.\\n\\nAcceptance criteria:\\n1) Code change implemented in src/commands/ooda.ts (or shared output helper) to run the shell command 'clear' before emitting the job header, but only when process.stdout.isTTY is true.\\n2) Behavior on non-TTY remains unchanged (no external clear command invoked).\\n3) Add unit tests that:\\n   - mock process.stdout.isTTY = true and assert that 'clear' is invoked (or that the ANSI clear escape is emitted if implementation chooses that path), and header is printed afterwards.\\n   - mock process.stdout.isTTY = false and assert that 'clear' is not invoked and header is printed as before.\\n4) Add or update an integration/e2e test (tests/integration/ooda-scheduler-e2e.test.ts or equivalent) demonstrating that CI runs (non-TTY) do not have their logs cleared.\\n5) Update docs/usage/ooda.md to note the interactive behavior (clear-before-header only on TTY).\\n6) Ensure tests pass locally; open a PR from a branch named with the bead id (branch-per-bd).\\n\\nSuggested priority: 2 (medium).\\n\\nNotes/implementation guidance for implementer:\\n- Use process.stdout.isTTY check; on truthy, prefer invoking child_process.execSync('clear') or spawnSync to avoid shell-specific behaviour.\\n- Keep change minimal and isolated to the output path that prints job headers.\\n- Add a short test harness or spy for the child_process invocation to avoid actually clearing the test runner's terminal during tests.\\n\\nRelated beads/issues: wf-e6r.2.3 (OODA docs) -- update usage docs there; wf-d0y (integration tests) may need update.\\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T21:18:30.946011604-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:16:49.00314266-08:00","closed_at":"2026-01-14T22:16:49.00314266-08:00","close_reason":"Merged in PR #124","comments":[{"id":166,"issue_id":"wf-8tcx","author":"rgardler","text":"Implementation PR: https://github.com/SorraTheOrc/waif/pull/124","created_at":"2026-01-15T05:22:30Z"},{"id":167,"issue_id":"wf-8tcx","author":"rgardler","text":"Implementation PR: https://github.com/SorraTheOrc/waif/pull/124","created_at":"2026-01-15T05:27:36Z"},{"id":168,"issue_id":"wf-8tcx","author":"rgardler","text":"Implementation PR: https://github.com/SorraTheOrc/waif/pull/124","created_at":"2026-01-15T05:30:22Z"},{"id":169,"issue_id":"wf-8tcx","author":"rgardler","text":"Implementation PR: https://github.com/SorraTheOrc/waif/pull/124 — updated to inherit stdio so \u001b[H\u001b[2J\u001b[3J affects WSL/terminal; ANSI fallback retained","created_at":"2026-01-15T05:39:38Z"}]}
{"id":"wf-8wf","title":"Export printJobResult helper and update tests","description":"Move printJobResult to an exported top-level function and update tests to import it directly. Replace any cmd.__internals usage.\\n\\nAcceptance criteria:\\n- export function printJobResult(job, result, jsonOutput) added to src/commands/ooda.ts\\n- tests/ooda-echo.test.ts updated to import helper and pass existing tests\\n- No remaining cmd.__internals references\\n- Commit on branch wf-e6r.2.1.1/job-command with message including bd id\\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-11T21:36:42.6624756-08:00","created_by":"WAIF","updated_at":"2026-01-11T21:46:57.71040685-08:00","closed_at":"2026-01-11T21:46:57.71040685-08:00","close_reason":"Merged (PR #102) — exported helper landed","comments":[{"id":107,"issue_id":"wf-8wf","author":"rgardler","text":"Exported printJobResult helper and updated tests to import it. Files changed: src/commands/ooda.ts, tests/ooda-echo.test.ts. Commit: ddeb73c.","created_at":"2026-01-12T05:38:38Z"}]}
{"id":"wf-94r","title":"Add recent issues command","description":"## Feature Request\n\n[Describe the desired feature]\n\n## Motivation\n\n[Why is this feature needed? What problem does it solve?]\n\n## Use Cases\n\n1. **Use Case 1**: [description]\n2. **Use Case 2**: [description]\n\n## Proposed Solution\n\n[High-level approach to implementing this feature]\n\n## Alternatives Considered\n\n- **Alternative 1**: [description and why not chosen]\n- **Alternative 2**: [description and why not chosen]\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T11:00:08.115241903-08:00","updated_at":"2025-12-19T11:09:51.729125335-08:00","closed_at":"2025-12-19T11:09:51.729129991-08:00","labels":["feature"]}
{"id":"wf-9ujx","title":"ooda: per-job clear_terminal option (default false)","description":"Add a per-job boolean config field 'clear_terminal' (default: false) that controls whether the scheduler clears the terminal before printing the job header.\\n\\nMotivation:\\n- Let job authors opt into interactive terminal clearing per job while keeping default behaviour safe for CI/log capture.\\n\\nAcceptance criteria:\\n1) Schema: Add 'clear_terminal' (boolean, default false) to the job schema (src/lib/schemas/ooda-scheduler.schema.json or equivalent).\\n2) Loader: loadConfig() sets job.clear_terminal to false when missing and validates type.\\n3) Runtime: printJobHeader(job) only calls clearTerminalIfTTY() when job.clear_terminal === true and process.stdout.isTTY === true.\\n4) CLI: 'waif ooda run-job' and 'waif ooda scheduler' respect this option.\\n5) Tests: unit tests for loader default and header behaviour; integration test demonstrating opt-in behaviour (mocked to avoid clearing test runner).\\n6) Docs: update docs/usage/ooda.md and example YAML fixtures to document clear_terminal (default false).\\n7) Backwards compatibility: existing job defs without the field behave as before (no clearing).\\n\\nRelated: wf-8tcx (TTY-only clear implementation).\\n\\nImplementation guidance: update schema first, then loader; keep the runtime change minimal by gating clearTerminalIfTTY call on job.clear_terminal.\\n,--json:null","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-14T21:45:32.763080325-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:16:51.919814541-08:00","closed_at":"2026-01-14T22:16:51.919814541-08:00","close_reason":"Merged into wf-8tcx/implement-clear-tty (PR #124) and changes pushed"}
{"id":"wf-9ujx.1","title":"Enable Ajv useDefaults to apply schema defaults (clear_terminal)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T21:50:25.188937644-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:16:54.617293569-08:00","closed_at":"2026-01-14T22:16:54.617293569-08:00","close_reason":"Merged into wf-8tcx/implement-clear-tty (PR #124)","dependencies":[{"issue_id":"wf-9ujx.1","depends_on_id":"wf-9ujx","type":"parent-child","created_at":"2026-01-14T21:50:25.191483095-08:00","created_by":"WAIF"}]}
{"id":"wf-9ujx.2","title":"Add loadConfig unit tests for clear_terminal default","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T21:50:27.121882395-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:16:54.62199526-08:00","closed_at":"2026-01-14T22:16:54.62199526-08:00","close_reason":"Merged into wf-8tcx/implement-clear-tty (PR #124)","dependencies":[{"issue_id":"wf-9ujx.2","depends_on_id":"wf-9ujx","type":"parent-child","created_at":"2026-01-14T21:50:27.128120923-08:00","created_by":"WAIF"}]}
{"id":"wf-9ujx.3","title":"Update example fixtures and docs showing clear_terminal: true","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T21:50:29.438734263-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:16:54.627504286-08:00","closed_at":"2026-01-14T22:16:54.627504286-08:00","close_reason":"Merged into wf-8tcx/implement-clear-tty (PR #124)","dependencies":[{"issue_id":"wf-9ujx.3","depends_on_id":"wf-9ujx","type":"parent-child","created_at":"2026-01-14T21:50:29.439602218-08:00","created_by":"WAIF"}]}
{"id":"wf-9ujx.4","title":"Fix terminal clear to avoid losing job output (use ANSI clear instead of spawnSync)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T22:03:07.635412122-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:08:00.444994219-08:00","closed_at":"2026-01-14T22:08:00.444994219-08:00","close_reason":"Fixed: ANSI clear avoids output loss","dependencies":[{"issue_id":"wf-9ujx.4","depends_on_id":"wf-9ujx","type":"parent-child","created_at":"2026-01-14T22:03:07.637207565-08:00","created_by":"WAIF"}]}
{"id":"wf-ad1","title":"Add top-level `--version` (`-v`) CLI option","description":"Add a top-level CLI option `--version` (alias `-v`) that prints the CLI version and exits.\\n\\nBehavior:\\n- When the CLI corresponds to an official release, print the release semver (e.g., v1.2.3).\\n- When running from an unreleased working tree, print a development stamp such as `v0.0.0-dev+YYYYMMDDTHHMMSS` or `dev-\u003ctimestamp\u003e-\u003cshort-commit\u003e`.\\n- The command must be fast, make no network calls, and return exit code 0.\\n- Include unit tests and update `README.md` and CLI help text.\\n\\nAcceptance criteria:\\n- Running `--version` or `-v` prints the release semver when the build is a released artifact (e.g., `v1.2.3`).\\n- When running from an unreleased tree, `--version` prints a development stamp and exits with code 0.\\n- The option is available as a top-level flag (no subcommand required) and does not execute application logic.\\n- Unit tests cover both released and unreleased outputs and exit codes.\\n- README and CLI help include usage examples for `--version` / `-v`.\\n","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/3","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-19T02:54:15.475046713-08:00","updated_at":"2025-12-19T10:16:43.704822544-08:00","closed_at":"2025-12-19T10:16:43.704822544-08:00"}
{"id":"wf-am1","title":"wf-mtc.3.1: Implement run-job CLI handler","description":"Add 'waif ooda run-job' CLI handler that: loads config, finds job by id, runs it once via runJobCommand, prints captured output when not --json, writes JSONL snapshot via writeJobSnapshot, enforces retention, and exits with appropriate code. Acceptance criteria: flags (--config, --job, --log, --json) supported; job not found errors clearly; writeJobSnapshot called when --log not false; printJobResult used for console output; unit tests stubbed (see wf-mtc.3.2)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-11T23:25:23.073139645-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:33:50.570639535-08:00","closed_at":"2026-01-14T02:33:50.570639535-08:00","close_reason":"Implemented and verified; PR #105: https://github.com/SorraTheOrc/waif/pull/105","comments":[{"id":119,"issue_id":"wf-am1","author":"rgardler","text":"Implemented wf-mtc.3.1 run-job CLI handler and tests. Changed files: src/commands/ooda.ts, tests/ooda-run-job.test.ts, tests/runJobCommand.exit.test.ts, tests/wf-e6r.2.14.cli-e2e.test.ts. PR: https://github.com/SorraTheOrc/waif/pull/105","created_at":"2026-01-12T07:54:03Z"},{"id":122,"issue_id":"wf-am1","author":"rgardler","text":"Verification of run-job CLI handler (PR #105) completed: focused suite (ooda-run-job + runJobCommand variants) and full npm test all passed. Branch wf-mtc.3.1/run-job-handler up to date.","created_at":"2026-01-12T08:06:23Z"}]}
{"id":"wf-aonm","title":"Epic: Support catchup_on_start for scheduler jobs","description":"Allow scheduler jobs to optionally run (catch up) when the scheduler starts. Default behavior is false. This epic contains the work to add a boolean job field that triggers catch-up execution at scheduler startup, update scheduler logic, tests, and docs.","acceptance_criteria":"- Jobs gain a boolean field 'catchup_on_start' documented and defaulting to false.\\n- Scheduler only triggers a run on startup for jobs where catchup_on_start=true AND the last scheduled run time was missed (i.e., there is a past scheduled run that did not execute).\\n- Behavior is covered by unit and integration tests.\\n- Examples and docs updated with migration notes and config samples.","notes":"Linked fix: wf-c72j removed duplicate maybeRunStartupCatchups and pushed branch wf-aonm/5-enable-catchup-waif-in-progress; PR #130","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-14T22:46:23.357224979-08:00","created_by":"WAIF","updated_at":"2026-01-14T23:55:20.361324687-08:00"}
{"id":"wf-aonm.1","title":"Add job field 'catchup_on_start' (default false)","description":"Add a boolean field catchup_on_start to job definitions, default false. Update job schema/types and validation. Ensure CLI/definitions and any job loader accept the new field without breaking existing jobs.","acceptance_criteria":"- Job schema includes catchup_on_start:boolean with default false.\\n- Job loading/validation accepts the field and preserves backward compatibility.\\n- Unit tests verifying default false and explicit true/false parsing.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/126","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T22:46:25.403411894-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:57:04.624288722-08:00","closed_at":"2026-01-14T22:57:04.624288722-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-aonm.1","depends_on_id":"wf-aonm","type":"parent-child","created_at":"2026-01-14T22:46:25.404401903-08:00","created_by":"WAIF"}]}
{"id":"wf-aonm.2","title":"Implement scheduler catch-up logic on start","description":"On scheduler startup, detect jobs where catchup_on_start=true and trigger a run if their most-recent scheduled run time is in the past and was not executed. Do not run jobs whose next scheduled run is in the future. Ensure safe concurrency (configurable) and logging.","acceptance_criteria":"- Scheduler inspects schedules at startup and triggers runs only for jobs with catchup_on_start=true and missed runs.\\n- No duplicate runs if scheduler was stopped and restarted quickly.\\n- Logging indicates which jobs were triggered and why.\\n- Covered by unit/integration tests.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/127","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T22:46:27.721916884-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:57:04.675630912-08:00","closed_at":"2026-01-14T22:57:04.675630912-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-aonm.2","depends_on_id":"wf-aonm","type":"parent-child","created_at":"2026-01-14T22:46:27.722600086-08:00","created_by":"WAIF"}]}
{"id":"wf-aonm.3","title":"Tests: verify catchup_on_start behaviors","description":"Add unit and integration tests covering: default false; jobs with catchup_on_start=true and missed runs are executed on scheduler start; jobs with catchup_on_start=false are not executed; avoid duplicate runs on quick restarts; concurrency behavior.","acceptance_criteria":"- Tests added and passing.\\n- CI/integration harness demonstrates end-to-end behavior.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/128","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T22:46:29.392398321-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:57:04.728985227-08:00","closed_at":"2026-01-14T22:57:04.728985227-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-aonm.3","depends_on_id":"wf-aonm","type":"parent-child","created_at":"2026-01-14T22:46:29.393548777-08:00","created_by":"WAIF"}]}
{"id":"wf-aonm.4","title":"Docs: update scheduler docs for catchup_on_start","description":"Document the new catchup_on_start option, examples, migration notes, and default behavior. Add a short FAQ entry about concurrency and duplicate runs.","acceptance_criteria":"- Docs updated with examples and migration notes.\\n- HISTORY/ or docs/ contains the planning notes.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/129","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T22:46:31.323584626-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:57:04.785207005-08:00","closed_at":"2026-01-14T22:57:04.785207005-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-aonm.4","depends_on_id":"wf-aonm","type":"parent-child","created_at":"2026-01-14T22:46:31.32952848-08:00","created_by":"WAIF"}]}
{"id":"wf-aonm.5","title":"Enable catchup_on_start for default in-progress job","description":"Set catchup_on_start: true for the default in-progress waif-in-progress-30s job in .waif/ooda-scheduler.yaml so it will run once at scheduler startup if a run was missed.","acceptance_criteria":"- .waif/ooda-scheduler.yaml updated: waif-in-progress-30s job has catchup_on_start: true.\\n- Small branch created, commit made, and draft PR opened.\\n- bd task updated with PR link and then closed when done.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/130 (schema updated to accept catchup_on_start)","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-14T23:07:16.464583132-08:00","created_by":"WAIF","updated_at":"2026-01-14T23:12:07.849354097-08:00","closed_at":"2026-01-14T23:07:39.082079097-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-aonm.5","depends_on_id":"wf-aonm","type":"parent-child","created_at":"2026-01-14T23:07:16.466093121-08:00","created_by":"WAIF"}]}
{"id":"wf-aqt","title":"Task: add timeout and large-output tests for runJobCommand","description":"Add unit tests for runJobCommand covering: (1) process timeout behavior (timedOut=true, killed), (2) non-zero exit codes, (3) large stdout/stderr truncation/stream handling. Use mocks for child_process.spawn or use a small helper process to emit large output. Link discovered-from:wf-uba.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-11T22:19:25.203580452-08:00","created_by":"WAIF","updated_at":"2026-01-11T22:35:34.531952354-08:00","closed_at":"2026-01-11T22:35:34.531952354-08:00","close_reason":"Merged (PR #103) — tests added \u0026 passing","comments":[{"id":111,"issue_id":"wf-aqt","author":"rgardler","text":"Added tests/helpers/sleep.js, tests/helpers/exit.js, tests/helpers/emit-large.js, tests/runJobCommand.timeout.test.ts, tests/runJobCommand.exit.test.ts, tests/runJobCommand.largeOutput.test.ts. PR: https://github.com/SorraTheOrc/waif/pull/103","created_at":"2026-01-12T06:33:42Z"},{"id":112,"issue_id":"wf-aqt","author":"rgardler","text":"Vitest subset passed: npx vitest run tests/runJobCommand.timeout.test.ts tests/runJobCommand.exit.test.ts tests/runJobCommand.largeOutput.test.ts","created_at":"2026-01-12T06:33:43Z"},{"id":113,"issue_id":"wf-aqt","author":"rgardler","text":"Merged PR #103 (tests for runJobCommand timeout \u0026 large output). Merge commit: 308cfc919f521a855e68fac57ed5f5c7af044a6b. Local branch deleted.","created_at":"2026-01-12T06:35:18Z"}]}
{"id":"wf-ask","title":"chore: add history/*.jsonl to .gitignore and remove local snapshot","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-12T00:16:54.89713846-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:17:25.579000558-08:00","closed_at":"2026-01-12T00:17:25.579006558-08:00","dependencies":[{"issue_id":"wf-ask","depends_on_id":"wf-mtc.3","type":"discovered-from","created_at":"2026-01-12T00:16:54.90048391-08:00","created_by":"WAIF"}],"comments":[{"id":128,"issue_id":"wf-ask","author":"rgardler","text":"Added history/*.jsonl to .gitignore and moved local snapshot to .history_tmp. Files changed: .gitignore, .history_tmp/ooda_snapshot_1768205459098.jsonl","created_at":"2026-01-12T08:17:21Z"}]}
{"id":"wf-b6fz","title":"Refactor: remove TMUX traces from code and docs","description":"Remove TMUX-specific code, configuration, docs, comments, and tests. Scope: code paths that reference tmux (WAIF_TMUX_* env vars, tmux pane parsing/mapping, start-workflow-tmux scripts), docs examples, and tests. Acceptance criteria:\\n- No references to 'tmux' or 'TMUX' (case-insensitive) remain in source code, docs/, or tests, unless they are historical archived files in history/ or external references.\\n- All runtime behavior that depended on tmux is removed or replaced with neutral implementations and documented.\\n- Tests that relied on tmux behavior are deleted or refactored to not require tmux.\\n- PR(s) created covering code, docs, and test removals; CI passes.\\nNotes: This is a refactor (P2). Coordinate with the QA agent to run full test suite and with Ship for any release notes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T19:38:32.378248386-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:38:01.904030071-08:00","closed_at":"2026-01-19T03:38:01.904033531-08:00","labels":["done","refactor"]}
{"id":"wf-b6fz.1","title":"Remove TMUX runtime code (src)","description":"Remove tmux-specific runtime behavior from src/commands (ask, startWork, and any tmux spawn calls). Replace with neutral behavior: do not require tmux, log deprecation hints, and avoid throwing tmux-specific errors. Acceptance: no runtime code calls tmux; code paths that previously errored when tmux was missing now return a helpful message or fallback to headless behavior.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T19:41:59.62430063-08:00","created_by":"WAIF","updated_at":"2026-01-18T00:41:31.431276223-08:00","closed_at":"2026-01-18T00:41:31.431276223-08:00","close_reason":"Closed","labels":["refactor"],"dependencies":[{"issue_id":"wf-b6fz.1","depends_on_id":"wf-b6fz","type":"parent-child","created_at":"2026-01-16T19:41:59.62665273-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.1.1","title":"Add tmux provider API and migrate tests to use it","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T19:56:34.732958604-08:00","created_by":"WAIF","updated_at":"2026-01-16T19:58:55.730262467-08:00","closed_at":"2026-01-16T19:58:55.730262467-08:00","close_reason":"Implemented provider and migrated tests; PR: https://github.com/SorraTheOrc/waif/pull/147","dependencies":[{"issue_id":"wf-b6fz.1.1","depends_on_id":"wf-b6fz.1","type":"parent-child","created_at":"2026-01-16T19:56:34.733799004-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.1.2","title":"Remove tmux provider and remove TMUX runtime code","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T20:00:50.767348595-08:00","created_by":"WAIF","updated_at":"2026-01-16T20:04:12.874321874-08:00","closed_at":"2026-01-16T20:04:12.874328964-08:00","dependencies":[{"issue_id":"wf-b6fz.1.2","depends_on_id":"wf-b6fz.1","type":"parent-child","created_at":"2026-01-16T20:00:50.76805397-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.1.3","title":"wf-b6fz.1.3: Remove TMUX runtime behavior and surface error message","description":"Remove all runtime calls to tmux (spawnSync('tmux', ...)) from source. Replace those code paths with a clear user-facing error: when code attempts to use tmux at runtime, return/print an error message saying tmux support was removed and point to docs/migration/rename-waif-to-wf.md or docs/migration/tmux-removal.md. Update tests to reflect new behavior (mock process invocation or assert error). Create branch wf-b6fz.1/remove-tmux-runtime and open a PR. Do not change WAIF_* env shim.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/149","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T20:08:53.031484342-08:00","created_by":"WAIF","updated_at":"2026-01-16T20:10:30.248663762-08:00","closed_at":"2026-01-16T20:10:30.248671502-08:00","dependencies":[{"issue_id":"wf-b6fz.1.3","depends_on_id":"wf-b6fz.1","type":"parent-child","created_at":"2026-01-16T20:08:53.032868825-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.2","title":"Remove TMUX tests and refactor test fixtures","description":"Delete or refactor tests that depend on tmux (e.g., tests/ask.test.ts and related integration tests). Replace with unit tests that mock new headless behavior where appropriate. Acceptance: test suite passes locally after changes; no tests require tmux to run.","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/146","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T19:42:02.159424401-08:00","created_by":"WAIF","updated_at":"2026-01-16T20:31:16.764847161-08:00","closed_at":"2026-01-16T20:31:16.764847161-08:00","close_reason":"PR https://github.com/SorraTheOrc/waif/pull/146 - remove tmux-dependent tests and refactor fixtures","labels":["refactor"],"dependencies":[{"issue_id":"wf-b6fz.2","depends_on_id":"wf-b6fz","type":"parent-child","created_at":"2026-01-16T19:42:02.164024051-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.3","title":"Update docs: remove TMUX references","description":"Remove tmux examples, start-workflow-tmux references, and tmux-based TUI guidance from README and docs/. Add migration notes about removing tmux and the recommended headless workflows.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-16T19:42:04.178499677-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:36:16.757434197-08:00","closed_at":"2026-01-19T03:36:16.757437962-08:00","labels":["done","refactor"],"dependencies":[{"issue_id":"wf-b6fz.3","depends_on_id":"wf-b6fz","type":"parent-child","created_at":"2026-01-16T19:42:04.179171594-08:00","created_by":"WAIF"}]}
{"id":"wf-b6fz.4","title":"Deprecation note and release guidance for TMUX removal","description":"Add release notes and a migration guide entry documenting TMUX removal, recommended replacements (headless OODA workflow, OpenCode plugin event stream), and backward compatibility notes.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T19:42:07.311939749-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:38:01.900543311-08:00","closed_at":"2026-01-19T03:38:01.900547382-08:00","labels":["done","refactor"],"dependencies":[{"issue_id":"wf-b6fz.4","depends_on_id":"wf-b6fz","type":"parent-child","created_at":"2026-01-16T19:42:07.313321074-08:00","created_by":"WAIF"}]}
{"id":"wf-ba2","title":"PM Agent MVP","description":"Master epic for prd-agent MVP (see docs/prd-agent_PRD.md).","notes":"Commands executed: waif next --json; bd show wf-ba2.3 --json; bd show wf-ba2.4 --json; bd show wf-ba2.5 --json; bd show wf-ba2.6 --json; bd show wf-ba2.7 --json; bd show wf-ba2.8 --json; bd close wf-ba2.3 wf-ba2.4 wf-ba2.5 wf-ba2.6 wf-ba2.7 wf-ba2.8 --reason 'Closed per Producer directive'. Referenced docs/files: none. Remaining risks/follow-ups: confirm downstream dependents (e.g., wf-ba2.3.1, wf-ba2.4.1, wf-ba2.5.4, etc.) now need explicit rescoping or closure to ensure roadmap reflects Producer decision.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:15:55.170224155-08:00","updated_at":"2025-12-30T02:23:39.79022544-08:00","closed_at":"2025-12-30T02:23:39.790234598-08:00","labels":["epic","prd-agent"]}
{"id":"wf-ba2.1","title":"Rule of Five: iterate each workflow stage 5 times","description":"Implement *The Rule of Five* across the project workflow: for each major stage (intake, PRD, review, planning, design, implementation, testing/quality, release), run 5 iterations before considering the stage complete.\n\nReference: https://steve-yegge.medium.com/six-new-tips-for-better-coding-with-agents-d4e9c86e42a9\n\nDefinition:\n- Step 1: initial completion (creative/broad).\n- Steps 2-5: successive reviews that narrow scope, increase precision, and polish clarity/completeness.\n\nThis epic contains child epics per workflow stage; each stage epic contains 5 child tasks with proposed AI prompts.","notes":"Merged via PR #66 and branch wf-ba2.1 pushed/merged. Branch landed and main updated. Files committed: .opencode/command/review.md; beads state synced.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:44:48.692168383-08:00","updated_at":"2025-12-25T00:53:48.141231146-08:00","closed_at":"2025-12-25T00:50:47.984453412-08:00","labels":["process","rule-of-five","workflow"],"dependencies":[{"issue_id":"wf-ba2.1","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-18T15:44:48.693667078-08:00","created_by":"rogardle"}],"comments":[{"id":41,"issue_id":"wf-ba2.1","author":"ship","text":"Created branch wf-ba2.1, committed .opencode/command/review.md and .beads/issues.jsonl, pushed branch, and opened PR #66 (https://github.com/SorraTheOrc/waif/pull/66). PR state: OPEN (CONFLICTING) — merge blocked until conflicts are resolved. Files changed: .opencode/command/review.md (new), .beads/issues.jsonl (updated). Untracked: history/wf-3xw-map-review.txt. Next steps: 1) Resolve merge conflicts on branch wf-ba2.1 and push fix (owner: patch suggested). 2) After PR merges, I will update this bead with the merge commit and close or advance status per Producer instructions. Commands executed: git add, git commit, git checkout -b wf-ba2.1, git push -u origin wf-ba2.1, gh pr create.\n","created_at":"2025-12-25T08:36:45Z"},{"id":42,"issue_id":"wf-ba2.1","author":"ship","text":"Status update: holding until PR wf-ba2.1 (#66) is merged. Current blocker: PR is CONFLICTING and needs conflict resolution before merge. I will pause here and wait for your instruction.\n\nCommands executed in session:\n- bd ready --json\n- bd show wf-ba2.1 --json\n- git status --porcelain\n- git add .opencode/command/review.md .beads/issues.jsonl\n- git commit -m 'wf-ba2.1: add OpenCode review command doc (.opencode/command/review.md)'\n- git checkout -b wf-ba2.1\n- git push -u origin wf-ba2.1\n- gh pr create --title 'wf-ba2.1: add OpenCode review command doc' --body '...'\n\nFiles created/edited:\n- .opencode/command/review.md (new, committed to wf-ba2.1)\n- .beads/issues.jsonl (updated and committed)\n- history/wf-3xw-map-review.txt (untracked)\n\nNext steps (options):\nA) I can resolve the merge conflicts now and push a fix to wf-ba2.1 (requires permission to modify code and run merge resolution). Owner suggestion: patch.\nB) You or a reviewer can resolve conflicts \u0026 merge the PR; I will watch and then record the merge and land the plane.\n\nPlease confirm which option you prefer. If A, confirm and I will proceed to fetch origin/main, rebase or merge, resolve conflicts, run quick tests, commit, and push, then request merge.\n\nRisks / follow-ups:\n- PR is conflicting; merge blocked until resolved.\n- Untracked file in history/ not included — decide whether to include it in this PR.\n\n","created_at":"2025-12-25T08:36:45Z"},{"id":43,"issue_id":"wf-ba2.1","author":"ship","text":"Branch wf-ba2.1 merged via PR #66. Actions completed in session:\n- Created branch wf-ba2.1 and committed .opencode/command/review.md\n- Rebased and resolved conflicts against origin/main\n- Pushed rebased branch with force-with-lease\n- Merged PR #66 via GitHub merge API\n- Pulled merged changes into local main and synced beads state\n- Closed bead wf-ba2.1 with merge note\n\nFiles created/edited during this session:\n- .opencode/command/review.md (new, now merged into main)\n- .beads/issues.jsonl (updated throughout rebase/resolution)\n- history/bd-comment-wf-cvz.1.txt (created by rebase resolution)\n- history/wf-3xw-map-review.txt (untracked local planning file)\n\nRemaining follow-ups/risks:\n- history/wf-3xw-map-review.txt is untracked; decide whether to include in a follow-up PR or keep in history/\n- Large rebase included many upstream acceptances; verify any intended local changes were preserved (search for wf-ba2.1 commit contents).\n- If you need a human review of the conflict resolutions, I can open a follow-up PR with the resolution commits isolated for inspection.\n\n","created_at":"2025-12-25T08:50:56Z"}]}
{"id":"wf-ba2.1.1","title":"Rule of Five: Intake brief (Workflow step 1)","description":"Apply Rule of Five to the intake brief stage (docs/Workflow.md step 1). Produce prompts that guide initial capture, then incrementally refine into a crisp brief with success criteria, constraints, and clarified questions.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:33.272619383-08:00","updated_at":"2025-12-30T22:40:21.140721954-08:00","closed_at":"2025-12-30T22:40:21.140721954-08:00","close_reason":"Closed by Map per user request: parent closed after children","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.1","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:33.274031532-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.1.1","title":"AI prompt for step 1 of intake","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:33.423411766-08:00","updated_at":"2025-12-30T22:40:20.994883624-08:00","closed_at":"2025-12-30T22:40:20.994883624-08:00","close_reason":"Closed by Map per user request: close all children of wf-ba2.1.1","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.1.1","depends_on_id":"wf-ba2.1.1","type":"parent-child","created_at":"2025-12-18T15:45:33.425267156-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.1.2","title":"AI prompt for step 2 of intake","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:33.551786803-08:00","updated_at":"2025-12-30T22:40:21.012480984-08:00","closed_at":"2025-12-30T22:40:21.012480984-08:00","close_reason":"Closed by Map per user request: close all children of wf-ba2.1.1","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.1.2","depends_on_id":"wf-ba2.1.1","type":"parent-child","created_at":"2025-12-18T15:45:33.553245457-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.1.3","title":"AI prompt for step 3 of intake","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:33.677798473-08:00","updated_at":"2025-12-30T22:40:21.023467894-08:00","closed_at":"2025-12-30T22:40:21.023467894-08:00","close_reason":"Closed by Map per user request: close all children of wf-ba2.1.1","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.1.3","depends_on_id":"wf-ba2.1.1","type":"parent-child","created_at":"2025-12-18T15:45:33.679253805-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.1.4","title":"AI prompt for step 4 of intake","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:33.806363351-08:00","updated_at":"2025-12-30T22:40:21.028578384-08:00","closed_at":"2025-12-30T22:40:21.028578384-08:00","close_reason":"Closed by Map per user request: close all children of wf-ba2.1.1","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.1.4","depends_on_id":"wf-ba2.1.1","type":"parent-child","created_at":"2025-12-18T15:45:33.807904033-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.1.5","title":"AI prompt for step 5 of intake","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:33.937777074-08:00","updated_at":"2025-12-30T22:40:21.033061324-08:00","closed_at":"2025-12-30T22:40:21.033061324-08:00","close_reason":"Closed by Map per user request: close all children of wf-ba2.1.1","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.1.5","depends_on_id":"wf-ba2.1.1","type":"parent-child","created_at":"2025-12-18T15:45:33.939167259-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2","title":"Rule of Five: PRD authoring via interview (Workflow step 2)","description":"Apply Rule of Five to PRD creation/update via interview (docs/Workflow.md step 2). Prompts should produce an initial PRD draft, then refine structure, testability, and clarity across 5 iterations.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:34.065138622-08:00","updated_at":"2025-12-31T12:15:43.37245087-08:00","closed_at":"2025-12-31T12:15:43.37245087-08:00","close_reason":"Closed along with children per user request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.2","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:34.067988584-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2.1","title":"AI prompt for step 1 of prd-authoring","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.199443849-08:00","updated_at":"2025-12-31T12:15:43.099749445-08:00","closed_at":"2025-12-31T12:15:43.099749445-08:00","close_reason":"Closed per user request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.2.1","depends_on_id":"wf-ba2.1.2","type":"parent-child","created_at":"2025-12-18T15:45:34.201328559-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2.2","title":"AI prompt for step 2 of prd-authoring","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.333731065-08:00","updated_at":"2025-12-31T12:15:43.156094701-08:00","closed_at":"2025-12-31T12:15:43.156094701-08:00","close_reason":"Closed per user request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.2.2","depends_on_id":"wf-ba2.1.2","type":"parent-child","created_at":"2025-12-18T15:45:34.335259129-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2.3","title":"AI prompt for step 3 of prd-authoring","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.467168293-08:00","updated_at":"2025-12-31T12:15:43.21318636-08:00","closed_at":"2025-12-31T12:15:43.21318636-08:00","close_reason":"Closed per user request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.2.3","depends_on_id":"wf-ba2.1.2","type":"parent-child","created_at":"2025-12-18T15:45:34.469071797-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2.4","title":"AI prompt for step 4 of prd-authoring","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.592996711-08:00","updated_at":"2025-12-31T12:15:43.272186238-08:00","closed_at":"2025-12-31T12:15:43.272186238-08:00","close_reason":"Closed per user request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.2.4","depends_on_id":"wf-ba2.1.2","type":"parent-child","created_at":"2025-12-18T15:45:34.59424785-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.2.5","title":"AI prompt for step 5 of prd-authoring","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.714647643-08:00","updated_at":"2025-12-31T12:15:43.321650155-08:00","closed_at":"2025-12-31T12:15:43.321650155-08:00","close_reason":"Closed per user request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.2.5","depends_on_id":"wf-ba2.1.2","type":"parent-child","created_at":"2025-12-18T15:45:34.716176-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3","title":"Rule of Five: PRD review and sign-off (Workflow step 3)","description":"Apply Rule of Five to PRD review/sign-off (docs/Workflow.md step 3). Prompts should progressively tighten acceptance criteria, resolve ambiguities, and ensure the PRD is executable.","status":"closed","priority":3,"issue_type":"epic","created_at":"2025-12-18T15:45:34.853062314-08:00","updated_at":"2026-01-03T00:11:41.074214893-08:00","closed_at":"2026-01-03T00:11:41.074214893-08:00","close_reason":"Closed","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.3","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:34.854698274-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3.1","title":"AI prompt for step 1 of prd-signoff","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:34.989809266-08:00","updated_at":"2025-12-31T12:21:37.585364085-08:00","closed_at":"2025-12-31T12:21:37.585364085-08:00","close_reason":"Closed","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.3.1","depends_on_id":"wf-ba2.1.3","type":"parent-child","created_at":"2025-12-18T15:45:34.991029766-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3.2","title":"AI prompt for step 2 of prd-signoff","description":"Goal: first review pass. Tighten structure and remove ambiguity.\\n\\nPrompt:\\nReview the PRD for structure and completeness.\\n- Identify missing sections and add them.\\n- Re-order content for the most logical flow.\\n- Replace hand-wavy language with explicit statements.\\n- Produce a revised version with minimal fluff. \\n\\n\u003csystem-reminder\u003e\\nYour operational mode has changed from plan to build.\\nYou are no longer in read-only mode.\\nYou are permitted to make file changes, run shell commands, and utilize your arsenal of tools as needed.\\n\u003c/system-reminder\u003e\\n\\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.12230998-08:00","updated_at":"2025-12-31T12:22:42.498095561-08:00","closed_at":"2025-12-31T12:22:42.498095561-08:00","close_reason":"Closed","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.3.2","depends_on_id":"wf-ba2.1.3","type":"parent-child","created_at":"2025-12-18T15:45:35.124011697-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3.3","title":"AI prompt for step 3 of prd-signoff","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\\n\\nPrompt:\\nAudit the PRD for correctness and real-world usability.\\n- Add missing constraints, assumptions, and decision points.\\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\\n- Ensure steps are testable/verifiable.\\n- Remove anything not serving the artifact purpose.\\n\\nBe sure to maintain proper markdown formatting.\\n\\n\u003csystem-reminder\u003e\\nYour operational mode has changed from plan to build.\\nYou are no longer in read-only mode.\\nYou are permitted to make file changes, run shell commands, and utilize your arsenal of tools as needed.\\n\u003c/system-reminder\u003e\\n\\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.244801108-08:00","updated_at":"2025-12-31T12:23:03.548016672-08:00","closed_at":"2025-12-31T12:23:03.548016672-08:00","close_reason":"Closed","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.3.3","depends_on_id":"wf-ba2.1.3","type":"parent-child","created_at":"2025-12-18T15:45:35.24648799-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3.4","title":"AI prompt for step 4 of prd-signoff","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.374857605-08:00","updated_at":"2025-12-31T12:23:18.808089943-08:00","closed_at":"2025-12-31T12:23:18.808089943-08:00","close_reason":"Closed","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.3.4","depends_on_id":"wf-ba2.1.3","type":"parent-child","created_at":"2025-12-18T15:45:35.377237409-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.3.5","title":"AI prompt for step 5 of prd-signoff","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.523931968-08:00","updated_at":"2025-12-31T12:23:34.581191604-08:00","closed_at":"2025-12-31T12:23:34.581191604-08:00","close_reason":"Closed","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.3.5","depends_on_id":"wf-ba2.1.3","type":"parent-child","created_at":"2025-12-18T15:45:35.525660571-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.4","title":"Rule of Five: Decompose PRD into issues/milestones (Workflow step 4)","description":"Apply Rule of Five to decomposing a PRD into Beads issues, epics, milestones, and dependencies (docs/Workflow.md step 4). Prompts should start broad then converge on a cycle-free, dependency-aware plan.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:35.694322284-08:00","updated_at":"2025-12-18T15:45:35.694322284-08:00","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.4","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:35.696003194-08:00","created_by":"rogardle"},{"issue_id":"wf-ba2.1.4","depends_on_id":"wf-5e2","type":"blocks","created_at":"2025-12-31T13:52:06.049643424-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.1.4.1","title":"AI prompt for step 1 of decomposition","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.844034688-08:00","updated_at":"2025-12-18T15:45:35.844034688-08:00","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.4.1","depends_on_id":"wf-ba2.1.4","type":"parent-child","created_at":"2025-12-18T15:45:35.846891203-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.4.2","title":"AI prompt for step 2 of decomposition","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:35.972197275-08:00","updated_at":"2025-12-18T15:45:35.972197275-08:00","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.4.2","depends_on_id":"wf-ba2.1.4","type":"parent-child","created_at":"2025-12-18T15:45:35.973824468-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.4.3","title":"AI prompt for step 3 of decomposition","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.098663902-08:00","updated_at":"2025-12-18T15:45:36.098663902-08:00","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.4.3","depends_on_id":"wf-ba2.1.4","type":"parent-child","created_at":"2025-12-18T15:45:36.100053354-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.4.4","title":"AI prompt for step 4 of decomposition","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.216332291-08:00","updated_at":"2025-12-18T15:45:36.216332291-08:00","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.4.4","depends_on_id":"wf-ba2.1.4","type":"parent-child","created_at":"2025-12-18T15:45:36.217941195-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.4.5","title":"AI prompt for step 5 of decomposition","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.328488527-08:00","updated_at":"2025-12-18T15:45:36.328488527-08:00","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.4.5","depends_on_id":"wf-ba2.1.4","type":"parent-child","created_at":"2025-12-18T15:45:36.329709321-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5","title":"Rule of Five: Select next issue (Workflow step 4.1)","description":"Apply Rule of Five to selecting the next most important issue (docs/Workflow.md step 4.1). Prompts should guide from high-level candidate set → ranked decision → final claim with explicit rationale.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:36.454146435-08:00","updated_at":"2025-12-31T13:53:10.752625989-08:00","closed_at":"2025-12-31T13:53:10.752625989-08:00","close_reason":"Deleted per request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.5","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:36.455248667-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5.1","title":"AI prompt for step 1 of issue-selection","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.57569346-08:00","updated_at":"2025-12-31T13:53:07.735324235-08:00","closed_at":"2025-12-31T13:53:07.735324235-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.5.1","depends_on_id":"wf-ba2.1.5","type":"parent-child","created_at":"2025-12-18T15:45:36.576980046-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5.2","title":"AI prompt for step 2 of issue-selection","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.709175202-08:00","updated_at":"2025-12-31T13:53:07.741223626-08:00","closed_at":"2025-12-31T13:53:07.741223626-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.5.2","depends_on_id":"wf-ba2.1.5","type":"parent-child","created_at":"2025-12-18T15:45:36.711268812-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5.3","title":"AI prompt for step 3 of issue-selection","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.837431399-08:00","updated_at":"2025-12-31T13:53:07.743762701-08:00","closed_at":"2025-12-31T13:53:07.743762701-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.5.3","depends_on_id":"wf-ba2.1.5","type":"parent-child","created_at":"2025-12-18T15:45:36.838771934-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5.4","title":"AI prompt for step 4 of issue-selection","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:36.975854946-08:00","updated_at":"2025-12-31T13:53:07.745855359-08:00","closed_at":"2025-12-31T13:53:07.745855359-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.5.4","depends_on_id":"wf-ba2.1.5","type":"parent-child","created_at":"2025-12-18T15:45:36.977688829-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.5.5","title":"AI prompt for step 5 of issue-selection","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.127538076-08:00","updated_at":"2025-12-31T13:53:07.748496001-08:00","closed_at":"2025-12-31T13:53:07.748496001-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.5.5","depends_on_id":"wf-ba2.1.5","type":"parent-child","created_at":"2025-12-18T15:45:37.128952883-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6","title":"Rule of Five: Issue design interview (Workflow step 4.2)","description":"Apply Rule of Five to turning a selected issue into an actionable design (docs/Workflow.md step 4.2). Prompts should go from creative solution sketch → constraints/alternatives → final design notes ready for implementation.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:37.250278583-08:00","updated_at":"2025-12-31T13:54:00.114301203-08:00","closed_at":"2025-12-31T13:54:00.114301203-08:00","close_reason":"Deleted per request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.6","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:37.251995285-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6.1","title":"AI prompt for step 1 of issue-design","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.381786272-08:00","updated_at":"2025-12-31T13:53:56.317224803-08:00","closed_at":"2025-12-31T13:53:56.317224803-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.6.1","depends_on_id":"wf-ba2.1.6","type":"parent-child","created_at":"2025-12-18T15:45:37.384069138-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6.2","title":"AI prompt for step 2 of issue-design","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.503687742-08:00","updated_at":"2025-12-31T13:53:56.325149202-08:00","closed_at":"2025-12-31T13:53:56.325149202-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.6.2","depends_on_id":"wf-ba2.1.6","type":"parent-child","created_at":"2025-12-18T15:45:37.505212664-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6.3","title":"AI prompt for step 3 of issue-design","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.627783489-08:00","updated_at":"2025-12-31T13:53:56.329244319-08:00","closed_at":"2025-12-31T13:53:56.329244319-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.6.3","depends_on_id":"wf-ba2.1.6","type":"parent-child","created_at":"2025-12-18T15:45:37.629192741-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6.4","title":"AI prompt for step 4 of issue-design","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.751991079-08:00","updated_at":"2025-12-31T13:53:56.332243285-08:00","closed_at":"2025-12-31T13:53:56.332243285-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.6.4","depends_on_id":"wf-ba2.1.6","type":"parent-child","created_at":"2025-12-18T15:45:37.753525751-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.6.5","title":"AI prompt for step 5 of issue-design","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:37.897259349-08:00","updated_at":"2025-12-31T13:53:56.33466191-08:00","closed_at":"2025-12-31T13:53:56.33466191-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.6.5","depends_on_id":"wf-ba2.1.6","type":"parent-child","created_at":"2025-12-18T15:45:37.899902961-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7","title":"Rule of Five: Implement in small increments (Workflow step 5)","description":"Apply Rule of Five to implementation (docs/Workflow.md step 5). Prompts should guide an agent from initial implementation through increasingly strict review passes: safety, tests, docs, polish, and final readiness.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:38.047902592-08:00","updated_at":"2025-12-31T13:54:37.251805493-08:00","closed_at":"2025-12-31T13:54:37.251805493-08:00","close_reason":"Deleted per request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.7","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:38.049938152-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7.1","title":"AI prompt for step 1 of implementation","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.173804478-08:00","updated_at":"2025-12-31T13:54:34.773397467-08:00","closed_at":"2025-12-31T13:54:34.773397467-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.7.1","depends_on_id":"wf-ba2.1.7","type":"parent-child","created_at":"2025-12-18T15:45:38.175572345-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7.2","title":"AI prompt for step 2 of implementation","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.30780529-08:00","updated_at":"2025-12-31T13:54:34.77970945-08:00","closed_at":"2025-12-31T13:54:34.77970945-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.7.2","depends_on_id":"wf-ba2.1.7","type":"parent-child","created_at":"2025-12-18T15:45:38.309138673-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7.3","title":"AI prompt for step 3 of implementation","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.448133156-08:00","updated_at":"2025-12-31T13:54:34.782198933-08:00","closed_at":"2025-12-31T13:54:34.782198933-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.7.3","depends_on_id":"wf-ba2.1.7","type":"parent-child","created_at":"2025-12-18T15:45:38.450301116-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7.4","title":"AI prompt for step 4 of implementation","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.576607734-08:00","updated_at":"2025-12-31T13:54:34.784444125-08:00","closed_at":"2025-12-31T13:54:34.784444125-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.7.4","depends_on_id":"wf-ba2.1.7","type":"parent-child","created_at":"2025-12-18T15:45:38.578793289-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.7.5","title":"AI prompt for step 5 of implementation","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.704215479-08:00","updated_at":"2025-12-31T13:54:34.787102825-08:00","closed_at":"2025-12-31T13:54:34.787102825-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.7.5","depends_on_id":"wf-ba2.1.7","type":"parent-child","created_at":"2025-12-18T15:45:38.706062562-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8","title":"Rule of Five: Review/merge/close loop (Workflow step 6)","description":"Apply Rule of Five to the review→merge→close loop (docs/Workflow.md step 6). Prompts should ensure pre-review checks, clear PR summary, risk assessment, post-merge closure hygiene, and final audit log completeness.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:38.839508552-08:00","updated_at":"2025-12-31T13:55:15.934477079-08:00","closed_at":"2025-12-31T13:55:15.934477079-08:00","close_reason":"Deleted per request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.8","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:38.841449451-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8.1","title":"AI prompt for step 1 of review-merge","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:38.972915487-08:00","updated_at":"2025-12-31T13:55:13.395710406-08:00","closed_at":"2025-12-31T13:55:13.395710406-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.8.1","depends_on_id":"wf-ba2.1.8","type":"parent-child","created_at":"2025-12-18T15:45:38.974348331-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8.2","title":"AI prompt for step 2 of review-merge","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.103775964-08:00","updated_at":"2025-12-31T13:55:13.401270081-08:00","closed_at":"2025-12-31T13:55:13.401270081-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.8.2","depends_on_id":"wf-ba2.1.8","type":"parent-child","created_at":"2025-12-18T15:45:39.105559208-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8.3","title":"AI prompt for step 3 of review-merge","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.21774105-08:00","updated_at":"2025-12-31T13:55:13.403539564-08:00","closed_at":"2025-12-31T13:55:13.403539564-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.8.3","depends_on_id":"wf-ba2.1.8","type":"parent-child","created_at":"2025-12-18T15:45:39.219388364-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8.4","title":"AI prompt for step 4 of review-merge","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.349029696-08:00","updated_at":"2025-12-31T13:55:13.405981839-08:00","closed_at":"2025-12-31T13:55:13.405981839-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.8.4","depends_on_id":"wf-ba2.1.8","type":"parent-child","created_at":"2025-12-18T15:45:39.350414101-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.8.5","title":"AI prompt for step 5 of review-merge","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.468263024-08:00","updated_at":"2025-12-31T13:55:13.408266722-08:00","closed_at":"2025-12-31T13:55:13.408266722-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.8.5","depends_on_id":"wf-ba2.1.8","type":"parent-child","created_at":"2025-12-18T15:45:39.470424297-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9","title":"Rule of Five: Release + release notes (Workflow step 7)","description":"Apply Rule of Five to cutting a release and writing release notes (docs/Workflow.md step 7). Prompts should produce initial notes and then refine accuracy, completeness, and clarity, ending with a release-quality checklist.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-18T15:45:39.655643269-08:00","updated_at":"2025-12-31T18:54:03.162126049-08:00","closed_at":"2025-12-31T18:54:03.162126049-08:00","close_reason":"Deleted per request","labels":["rule-of-five","workflow-stage"],"dependencies":[{"issue_id":"wf-ba2.1.9","depends_on_id":"wf-ba2.1","type":"parent-child","created_at":"2025-12-18T15:45:39.657279003-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9.1","title":"AI prompt for step 1 of release","description":"Goal: produce the first complete draft for this stage. Encourage creativity and exploration.\n\nPrompt:\nYou are an expert product+engineering agent. Complete the **first full draft** of this workflow artifact for the current work item.\n- Be creative and propose strong defaults.\n- If uncertain, present 2-3 alternatives and choose one, explaining why.\n- Keep it actionable: concrete lists, commands, checklists, and examples.\n- Assume the reader wants momentum; do not over-polish yet.\n\nOutput: a full artifact draft suitable for immediate review.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.801596899-08:00","updated_at":"2025-12-31T18:54:00.074835354-08:00","closed_at":"2025-12-31T18:54:00.074835354-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.9.1","depends_on_id":"wf-ba2.1.9","type":"parent-child","created_at":"2025-12-18T15:45:39.803109567-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9.2","title":"AI prompt for step 2 of release","description":"Goal: first review pass. Tighten structure and remove ambiguity.\n\nPrompt:\nReview the Step 1 output for structure and completeness.\n- Identify missing sections and add them.\n- Re-order content for the most logical flow.\n- Replace hand-wavy language with explicit statements.\n- Produce a revised version with minimal fluff.\n\nOutput: revised artifact + a short list of key changes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:39.92724795-08:00","updated_at":"2025-12-31T18:54:00.097985206-08:00","closed_at":"2025-12-31T18:54:00.097985206-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.9.2","depends_on_id":"wf-ba2.1.9","type":"parent-child","created_at":"2025-12-18T15:45:39.929983987-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9.3","title":"AI prompt for step 3 of release","description":"Goal: second review pass. Focus on correctness, edge cases, and operational detail.\n\nPrompt:\nAudit the current artifact for correctness and real-world usability.\n- Add missing constraints, assumptions, and decision points.\n- Add edge cases, failure modes, and \"what could go wrong\" notes.\n- Ensure steps are testable/verifiable.\n- Remove anything not serving the artifact purpose.\n\nOutput: revised artifact + checklist of verifications.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:40.071117777-08:00","updated_at":"2025-12-31T18:54:00.102344504-08:00","closed_at":"2025-12-31T18:54:00.102344504-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.9.3","depends_on_id":"wf-ba2.1.9","type":"parent-child","created_at":"2025-12-18T15:45:40.072246861-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9.4","title":"AI prompt for step 4 of release","description":"Goal: third review pass. Improve clarity, concision, and scanability.\n\nPrompt:\nPolish the artifact for clarity and fast reading.\n- Rewrite unclear sections and tighten wording.\n- Convert paragraphs into bullets/checklists where helpful.\n- Normalize terminology and naming.\n- Ensure examples/commands are copy-pastable and consistent.\n\nOutput: revised artifact optimized for human scanning.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:40.199154684-08:00","updated_at":"2025-12-31T18:54:00.107078534-08:00","closed_at":"2025-12-31T18:54:00.107078534-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.9.4","depends_on_id":"wf-ba2.1.9","type":"parent-child","created_at":"2025-12-18T15:45:40.201888987-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.1.9.5","title":"AI prompt for step 5 of release","description":"Goal: final review pass. Treat this as a release-quality QA gate.\n\nPrompt:\nPerform a final QA review of the artifact.\n- Check for internal consistency and contradictions.\n- Ensure it aligns with repo conventions and the Workflow doc.\n- Ensure every requirement is actionable and measurable.\n- Emit a final “ready” version with a small list of remaining open questions (if any).\n\nOutput: final artifact + remaining risks/open questions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T15:45:40.334530324-08:00","updated_at":"2025-12-31T18:54:00.113416639-08:00","closed_at":"2025-12-31T18:54:00.113416639-08:00","close_reason":"Deleted per request","labels":["ai-prompt","rule-of-five"],"dependencies":[{"issue_id":"wf-ba2.1.9.5","depends_on_id":"wf-ba2.1.9","type":"parent-child","created_at":"2025-12-18T15:45:40.335903665-08:00","created_by":"rogardle"}]}
{"id":"wf-ba2.2","title":"CLI Foundation \u0026 UX","description":"Milestones M0-M2: user-runnable CLI, prompt input, dry-run preview.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:16:50.642948602-08:00","updated_at":"2025-12-19T15:19:43.609673344-08:00","closed_at":"2025-12-19T15:19:43.609678661-08:00","labels":["epic","milestone:M0","prd-agent"]}
{"id":"wf-ba2.2.1","title":"CLI skeleton + subcommands scaffold","description":"M0: Provide CLI entrypoint and minimal subcommands.","notes":"Added a mandatory dirty-working-tree decision gate to docs (.opencode/command/implement.md + docs/Workflow.md). Agents must stop and ask how to handle uncommitted changes; never assume changes are irrelevant.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:18:53.285620964-08:00","updated_at":"2025-12-18T14:29:01.274129788-08:00","closed_at":"2025-12-18T14:29:01.274129788-08:00","labels":["milestone:M0","prd-agent"]}
{"id":"wf-ba2.2.2","title":"Prompt input modes (arg/stdin/file)","description":"- Problem\n  - Downstream PRD generation needs a prompt body, but the CLI currently only writes a stub (or seeds from an issue). This issue defines how prompt text is provided to CLI commands in a repeatable way (arg/stdin/file).\n\n- Users\n  - Primary: PM/agent invoking waif prd locally and in automation.\n  - Secondary: future TUI and CI scripts that need deterministic, non-interactive behavior.\n\n- Success criteria\n  - waif prd accepts prompt input from:\n    - CLI arg via --prompt \u003ctext\u003e\n    - stdin via --prompt -\n    - file via --prompt-file \u003cpath\u003e\n  - If both --prompt and --prompt-file are provided, exit code 2 with a clear usage error.\n  - Prompt is embedded into the generated PRD as a comment block so later stages can consume it.\n  - JSON output includes prompt metadata (source, length) for debugging/automation.\n\n- Constraints\n  - Default behavior must not block waiting on stdin; stdin is only read when explicitly requested with --prompt -.\n  - Preserve existing --out and --issue behavior, exit codes, and JSON/human output conventions.\n\n- Existing state\n  - waif prd writes a stub PRD and can seed from a Beads issue via --issue.\n  - No support for ingesting a freeform prompt from arg/stdin/file.\n\n- Desired change\n  - Add --prompt and --prompt-file to waif prd.\n  - Implement deterministic prompt-source selection with explicit stdin mode only.\n\n- Likely duplicates / related docs (file paths)\n  - .opencode/command/intake.md\n  - docs/dev/CLI_PRD.md\n\n- Related issues (Beads ids)\n  - wf-ba2.2.1 (CLI skeleton)\n  - wf-ba2.3.1 (Minimal PRD generator from prompt input; blocked by this)\n\n- Clarifying questions\n  1. Should stdin be read implicitly when piped and no flags are provided, or explicit-only? (Chosen: explicit-only for safety.)\n  2. Should we support multiple prompt inputs concatenated (e.g. repeated flags)? (Chosen: no, error if ambiguous.)\n  3. Should prompt be persisted as metadata-only or embedded in the PRD file? (Chosen: embed in PRD comment block for traceability.)\n\n- Proposed next step:\n  - Implement in src/commands/prd.ts and add tests in tests/cli.test.ts\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:18:53.370913238-08:00","updated_at":"2025-12-19T13:19:45.660969168-08:00","closed_at":"2025-12-19T13:19:45.660969168-08:00","labels":["milestone:M0","prd-agent"]}
{"id":"wf-ba2.2.3","title":"--dry-run preview mode (no writes/branches/PRs)","description":"M2: Preview/diff output without filesystem or git writes.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:50.918771263-08:00","updated_at":"2025-12-30T02:22:15.502385447-08:00","closed_at":"2025-12-30T02:22:15.502394397-08:00","labels":["milestone:M2","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.2.3","depends_on_id":"wf-ba2.3.1","type":"blocks","created_at":"2025-12-17T13:19:53.752409696-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.2.3","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:53.806343188-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.2.3","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:19.535779357-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3","title":"PRD Template \u0026 Validation","description":"Milestones M0-M4: generate/update PRDs with required outline and structure-preserving edits.","notes":"Investigated user report '/intake: No such file or directory'. Ran 'waif next --json' and 'bd show wf-ba2.3 --json' to confirm epic context, then reviewed .opencode/command/intake.md, src/commands/intake.ts, and src/index.ts. Intake command instructions exist for OpenCode and a TypeScript implementation lives in src/commands/intake.ts, but index.ts never registers it, so 'waif intake' is currently unavailable and prompts referencing '/intake' fall back to shell errors. Need to wire the intake command into the CLI and clarify when to use '/intake' (OpenCode) vs 'waif intake'.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:17:01.146351818-08:00","updated_at":"2025-12-22T16:56:27.525563379-08:00","closed_at":"2025-12-22T16:56:27.525563379-08:00","labels":["epic","milestone:M0","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.148338347-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3.1","title":"Minimal PRD generator (writes Markdown file)","description":"M0: Generate a Markdown PRD file from prompt input.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.010542797-08:00","updated_at":"2025-12-30T02:22:15.50888051-08:00","closed_at":"2025-12-30T02:22:15.508886889-08:00","labels":["milestone:M0","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3.1","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-17T13:19:51.012711622-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.1","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:20.02846878-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3.2","title":"Enforce required PRD outline headings","description":"M1: Ensure output matches required PRD outline.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.090710055-08:00","updated_at":"2025-12-30T02:22:15.514511314-08:00","closed_at":"2025-12-30T02:22:15.514517487-08:00","labels":["milestone:M1","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3.2","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-17T13:19:51.092313156-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.2","depends_on_id":"wf-ba2.3.1","type":"blocks","created_at":"2025-12-17T13:19:53.441959375-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.2","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:20.252638838-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3.3","title":"Update mode preserves structure / minimal edits","description":"M3: Update existing PRD without restructuring unrelated content.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.174262271-08:00","updated_at":"2025-12-30T02:22:15.519311807-08:00","closed_at":"2025-12-30T02:22:15.519317363-08:00","labels":["milestone:M3","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3.3","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-17T13:19:51.175400782-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.3","depends_on_id":"wf-ba2.3.2","type":"blocks","created_at":"2025-12-17T13:19:53.864632066-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.3","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:53.91970648-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.3","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:20.481194882-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3.4","title":"Integrate context gathering into create/update (optional)","description":"M4: Use eligible repo context to improve generation/update.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:51.249761909-08:00","updated_at":"2025-12-30T17:26:13.518797371-08:00","closed_at":"2025-12-30T17:26:13.518797371-08:00","close_reason":"Completed: PR #90 merged","labels":["milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3.4","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-17T13:19:51.250972949-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.4","depends_on_id":"wf-ba2.3.1","type":"blocks","created_at":"2025-12-17T13:19:54.174821827-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.4","depends_on_id":"wf-ba2.3.3","type":"blocks","created_at":"2025-12-17T13:19:54.237947383-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.4","depends_on_id":"wf-ba2.5.2","type":"blocks","created_at":"2025-12-17T13:19:54.302590833-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.4","depends_on_id":"wf-ba2.5.4","type":"blocks","created_at":"2025-12-30T14:36:04.727798337-08:00","created_by":"daemon"}],"comments":[{"id":75,"issue_id":"wf-ba2.3.4","author":"map","text":"Map: landed changes and opened PR.\\n\\nBranch: bd-wf-ba2.3.4/implement-integrate-context\\nPR: https://github.com/SorraTheOrc/waif/pull/90\\nCommit: f79a772\\n\\nFiles created/edited while working this issue:\\n- .beads/issues.jsonl (edited)\\n- .opencode/command/prd.md (edited)\\n- docs/dev/CONTEXT_PACK.md (created)\\n\\nNotes:\\n- Branch pushed to origin and PR opened for review. CI may run on the PR.\\n- I set the issue to in_progress to indicate active work on the bd branch.\\n","created_at":"2025-12-31T01:25:20Z"},{"id":76,"issue_id":"wf-ba2.3.4","author":"map","text":"Map: PR merged and issue landed.\n\nPR: https://github.com/SorraTheOrc/waif/pull/90\nMerge commit: 47fac44f8a88163070f9f6349e54d9add219adf5\nFiles landed:\n- .beads/issues.jsonl\n- .opencode/command/prd.md\n- docs/dev/CONTEXT_PACK.md\n\nNotes: branch bd-wf-ba2.3.4/implement-integrate-context was NOT deleted.","created_at":"2025-12-31T01:26:12Z"},{"id":78,"issue_id":"wf-ba2.3.4","author":"map","text":"Forge: added five automated, sequential review stages to .opencode/command/prd.md (structural, clarity \u0026 language, technical consistency, security \u0026 compliance, lint/style \u0026 polish). Each stage must emit a starting and finished message and include brief notes of any improvements applied; idempotent changelog lines are required when a stage modifies a PRD. See file: .opencode/command/prd.md. Commands executed in this session: git checkout -b bd-000/prd-5-reviews origin/main; git add .opencode/command/prd.md; git commit -m 'opencode: add five automated review stages to PRD command (structural, clarity, technical consistency, security, lint/polish)'. Remaining follow-ups: (1) implement the runtime behavior in the PRD command implementation to actually run these stages (this change is specification only), (2) consider adding tests or examples that show expected output messages, (3) confirm preferred stage wording or adjustment to any stage scope.","created_at":"2025-12-31T19:34:04Z"}]}
{"id":"wf-ba2.3.5","title":"Per-repo config file (template + lint rules)","description":"M4: Support per-repo configuration for templates and linting.","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-17T13:19:51.310735147-08:00","updated_at":"2025-12-30T10:42:52.010468671-08:00","labels":["milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.3.5","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-17T13:19:51.311865677-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.3.5","depends_on_id":"wf-ba2.3.2","type":"blocks","created_at":"2025-12-17T13:19:54.364555119-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.3.6","title":"Wire waif prd command to PRD Agent workflow","description":"- Problem\n  - `waif prd` supports prompt ingestion and can seed from issues, but it is not yet explicitly wired to the OpenCode PRD Agent workflow (`/prd`) described in `.opencode/command/prd.md`.\n  - Cross-linking expectations currently differ:\n    - PRD Agent spec suggests using `bd comment \u003cid\u003e \"Linked PRD: \u003cpath\u003e\"` plus `bd update \u003cid\u003e --external-ref \"PRD: \u003cpath\u003e\"`.\n    - CLI currently updates the issue description with a `Linked PRD: \u003cpath\u003e` line.\n  - There is no single end-to-end command that takes the user from “I have a prompt/issue” to “I have a completed PRD” via an interactive agent/human interview.\n\n- Users\n  - Primary: PM/agent who wants one consistent PRD authoring workflow (CLI + agent) with reliable traceability.\n  - Secondary: automation/TUI that depends on stable link surfaces.\n\n- Success criteria\n  - Decide and document the canonical cross-link mechanism (description vs comment vs external-ref).\n  - Ensure `waif prd` and `/prd` workflow produce the same links by default.\n  - Ensure idempotence: re-running does not create duplicate links/comments.\n\n- Functional requirements (new)\n  - `waif prd` provides an interactive mode that *invokes the OpenCode PRD Agent* (`/prd`) so the user (human) and/or a coding agent can complete the PRD through interview.\n  - The interactive flow must:\n    - support starting from either a `--prompt`/`--prompt-file` OR a `--issue \u003cid\u003e` seed\n    - write/update the PRD file on disk (`docs/dev/..._PRD.md`)\n    - ensure two-way traceability between the PRD and the Beads issue\n    - allow a human to answer interview questions (non-autonomous) OR allow an agent to drive the interview (autonomous), with clear UX distinction\n\n- Constraints\n  - Must remain deterministic and audit-friendly:\n    - any automated edits must be written to disk (no hidden changes)\n    - the resulting PRD must contain `Source issue: \u003cid\u003e` when an issue id is used\n    - linking must be idempotent\n  - Must not break existing `waif prd --out ...` stub behavior.\n  - Must respect ignore boundaries (OpenCode rules) when passing context to the agent.\n\n- Related docs\n  - `.opencode/command/prd.md`\n  - `.opencode/command/intake.md`\n  - `docs/Workflow.md`\n\n- Related issues\n  - `wf-ba2.3.1` (Minimal PRD generator from prompt input)\n  - `wf-ba2.2.2` (Prompt input modes)\n\n- Open questions\n  1. What is the canonical way for a CLI process to invoke OpenCode `/prd`? Options:\n     - launch `opencode` with a pre-filled command string\n     - print a next-step instruction for the user to run in OpenCode (fallback)\n     - integrate via an OpenCode API/MCP if available\n  2. Should the CLI always run in “instruction emission” mode (prints `/prd ...`) vs attempting to spawn an interactive OpenCode session?\n  3. Which link mechanism becomes canonical: issue description line vs `bd comment` vs `--external-ref`?\n\n- Proposed next step\n  - Define the integration approach (spawn vs instruction-only vs API), then implement the interactive `waif prd` mode and align cross-linking semantics across CLI + agent + docs.\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T13:34:56.931577392-08:00","updated_at":"2026-01-18T17:45:28.769041448-08:00","closed_at":"2026-01-18T17:45:28.769041448-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-ba2.3.6","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-19T13:35:04.622477457-08:00","created_by":"import"},{"issue_id":"wf-ba2.3.6","depends_on_id":"wf-ba2.2.2","type":"discovered-from","created_at":"2025-12-19T13:35:04.62453208-08:00","created_by":"import"},{"issue_id":"wf-ba2.3.6","depends_on_id":"wf-ba2.3.1","type":"discovered-from","created_at":"2025-12-19T13:35:04.62553039-08:00","created_by":"import"},{"issue_id":"wf-ba2.3.6","depends_on_id":"wf-ba2.3.7","type":"blocks","created_at":"2025-12-19T13:48:04.57869771-08:00","created_by":"import"}]}
{"id":"wf-ba2.3.7","title":"Design: integrate waif CLI with OpenCode PRD agent","description":"Linked PRD: /home/rgardler/projects/waif/worktree_design/docs/dev/wf-ba2.3.7_PRD.md","notes":"PR: https://github.com/SorraTheOrc/waif/pull/10","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T13:47:25.027491647-08:00","updated_at":"2025-12-22T16:31:06.881672894-08:00","closed_at":"2025-12-22T14:34:58.306420459-08:00","dependencies":[{"issue_id":"wf-ba2.3.7","depends_on_id":"wf-ba2.3","type":"parent-child","created_at":"2025-12-19T13:48:04.582847605-08:00","created_by":"import"},{"issue_id":"wf-ba2.3.7","depends_on_id":"wf-ug7","type":"blocks","created_at":"2025-12-22T10:40:45.293567494-08:00","created_by":"daemon"}],"comments":[{"id":11,"issue_id":"wf-ba2.3.7","author":"design","text":"Linked PRD: docs/dev/wf-ba2.3.7_PRD.md","created_at":"2025-12-24T00:43:53Z"},{"id":12,"issue_id":"wf-ba2.3.7","author":"design","text":"PRD draft removed from branch per request; will create a new PRD when ready.","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-ba2.4","title":"Markdown Linting Pipeline (remark)","description":"Milestones M1-M2: run remark formatting and define lint error policy.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:17:01.225289887-08:00","updated_at":"2025-12-22T16:56:27.542206103-08:00","closed_at":"2025-12-22T16:56:27.542206103-08:00","labels":["epic","milestone:M1","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.4","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.227253675-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4","depends_on_id":"wf-ba2.3","type":"blocks","created_at":"2025-12-17T13:17:57.428404613-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.4.1","title":"Run remark and rewrite output in-place","description":"M1: Run remark to format generated/updated PRDs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.376152083-08:00","updated_at":"2025-12-30T02:22:15.524385539-08:00","closed_at":"2025-12-30T02:22:15.524389654-08:00","labels":["milestone:M1","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.4.1","depends_on_id":"wf-ba2.4","type":"parent-child","created_at":"2025-12-17T13:19:51.377467062-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4.1","depends_on_id":"wf-ba2.3.2","type":"blocks","created_at":"2025-12-17T13:19:53.53161492-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4.1","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:21.285955967-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.4.2","title":"Lint error policy per mode (fail vs warn)","description":"M2: Define behavior on remark errors in dry-run vs write mode.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:51.440050479-08:00","updated_at":"2025-12-30T10:43:30.635891319-08:00","closed_at":"2025-12-30T10:43:30.635891319-08:00","close_reason":"Closed","labels":["milestone:M2","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.4.2","depends_on_id":"wf-ba2.4","type":"parent-child","created_at":"2025-12-17T13:19:51.44135769-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4.2","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:53.590118288-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4.2","depends_on_id":"wf-ba2.2.3","type":"blocks","created_at":"2025-12-17T13:19:53.644702217-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.4.3","title":"Idempotence/stability checks for formatted output","description":"M8: Ensure repeated formatting produces stable output.","notes":"PR merged: https://github.com/SorraTheOrc/waif/pull/139","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T13:19:51.503578557-08:00","updated_at":"2026-01-16T02:09:19.507261065-08:00","closed_at":"2026-01-16T02:09:19.507266745-08:00","external_ref":"https://github.com/SorraTheOrc/waif/pull/139","labels":["Status: PR Created","milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.4.3","depends_on_id":"wf-ba2.4","type":"parent-child","created_at":"2025-12-17T13:19:51.505163282-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.4.3","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:53.701300851-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5","title":"Context Gathering + .gitignore Guards","description":"Milestone M4: context gathering with strict .gitignore read/write enforcement.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:17:01.297482665-08:00","updated_at":"2025-12-22T16:56:27.553234611-08:00","closed_at":"2025-12-22T16:56:27.553234611-08:00","labels":["epic","milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.5","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.298760281-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.1","title":".gitignore guards for reads + writes (hard enforcement)","description":"M4: Never read/write ignored paths when gathering context or writing outputs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.571202137-08:00","updated_at":"2025-12-30T02:24:51.171813837-08:00","closed_at":"2025-12-30T02:24:51.171813837-08:00","close_reason":"Closed","labels":["milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.5.1","depends_on_id":"wf-ba2.5","type":"parent-child","created_at":"2025-12-17T13:19:51.572857192-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.1","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:18:24.647947163-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.2","title":"Context selection strategy (eligible repo context)","description":"M4: Define what repo content is eligible as context.","notes":"Merged PR https://github.com/SorraTheOrc/waif/pull/84; landing PRD into main.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:51.637139286-08:00","updated_at":"2025-12-30T14:29:18.102480455-08:00","closed_at":"2025-12-30T14:29:18.102488212-08:00","external_ref":"gh-PR: https://github.com/SorraTheOrc/waif/pull/84","labels":["milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.5.2","depends_on_id":"wf-ba2.5","type":"parent-child","created_at":"2025-12-17T13:19:51.638875804-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.2","depends_on_id":"wf-ba2.5.1","type":"blocks","created_at":"2025-12-17T13:19:54.041264988-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.3","title":"Affected-files calculation (for audit logs)","description":"M4: Compute affected files for audit logging.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:51.703912151-08:00","updated_at":"2025-12-30T16:43:26.381818533-08:00","closed_at":"2025-12-30T16:43:26.381818533-08:00","close_reason":"won't fix","labels":["milestone:M4","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.5.3","depends_on_id":"wf-ba2.5","type":"parent-child","created_at":"2025-12-17T13:19:51.70501008-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.3","depends_on_id":"wf-ba2.5.1","type":"blocks","created_at":"2025-12-17T13:19:54.110593061-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.4","title":"Context Pack command (waif ctx): Intake brief","description":"Linked PRD: docs/dev/context_pack_PRD.md\n\nProblem\n- Agents starting work on a new issue need to understand the project’s overall purpose, structure, and operating rules.\n- Today that context is spread across many files and is not optimized for agent consumption, increasing time-to-first-contribution and raising the risk that agents miss critical workflow/guardrail information.\n- Implement this early, before the repo grows large enough that agents cannot efficiently discover what they need.\n\nUsers\n- Primary: workflow agents starting a new Beads issue (they should consult the context pack at the start of each new issue).\n- Secondary: the Map agent (periodically maintains accuracy of the context pack); the PM indirectly benefits via faster/safer agent execution.\n\nSuccess criteria\n- `waif context` (alias: `waif ctx`) generates/updates a single agent-oriented “signpost” document: `docs/dev/CONTEXT_PACK.md`.\n- The context pack provides “minimum efficient” discovery:\n  - Links to all important docs (PRDs/specs, user docs, workflow rules, issue tracking rules, agent roles, key source folders).\n  - Each entry includes a short description (1–2 bullets) describing what it contains and when to read it.\n  - Large docs may be referenced multiple times, pointing at specific sections.\n- The pack avoids rapidly-changing content; instead it points to the canonical way to query it (e.g., it does not list active Beads issues, but explains how to query for ready/active work).\n- Soft size limit: ~20,000 tokens.\n  - If generation exceeds the limit, still write the file AND create/update a P0 Beads issue assigned to the PM flagging that the context pack has exceeded the target and needs strategy/partitioning.\n\nConstraints\n- Ignore/redaction boundaries are defined by `.gitignore`.\n  - Ignored content must not be included; “omitted but redacted” summaries are acceptable.\n- Initial scope (this iteration): implement the `waif context|ctx` command to create/update the context pack.\n- Out of scope (this iteration): defining/automating rules for when agents must file “request context update” issues after significant changes.\n- This document is intended for agent consumption, not human consumption.\n\nExisting state (current behavior)\n- `docs/dev/CLI_PRD.md` recommends a `context`/`ctx` command that generates `docs/dev/CONTEXT_PACK.md`, but the command and template do not currently exist.\n- Project structure/rules are spread across multiple docs; there is no single agent-first index.\n\nDesired change\n- Implement/ship a CLI command `waif context` (alias `waif ctx`) that generates/updates `docs/dev/CONTEXT_PACK.md` from a stable template.\n- Ensure ignore boundary compliance via `.gitignore`.\n- Implement the “20,000 token” soft limit behavior: write the file and create/update a P0 issue assigned to the PM when exceeded.\n\nLikely duplicates / related docs (file paths)\n- docs/dev/CLI_PRD.md (mentions `context`/`ctx` utility command)\n- docs/dev/TUI_PRD.md (mentions context sharing with OpenCode; ignore boundaries)\n- docs/Workflow.md (workflow rules that the context pack should signpost)\n- docs/dev/context_pack_PRD.md (canonical Context Pack PRD)\n\nRelated issues (Beads ids)\n- wf-7cn: Docs: Implement Context Pack command and template\n- wf-ba2.5: Context Gathering + .gitignore Guards (epic)\n- wf-ba2.5.1: .gitignore guards for reads + writes (hard enforcement)\n- wf-ba2.5.2: Context selection strategy (eligible repo context)\n- wf-ba2.9.4: Tests: .gitignore enforcement\n- wf-ba2.5.5: Instruct agents to file context pack update requests\n\nClarifying questions\n1. Minimum required section outline for `docs/dev/CONTEXT_PACK.md` (top-level headings) so the generator stays stable?\n2. How should “~20,000 tokens” be measured (approximate by characters/words, or via a tokenizer implementation)?\n3. P0 issue strategy on overflow: one long-lived issue updated each time vs create a new P0 each time?\n4. Should `waif ctx` enumerate PRDs/specs by scanning `docs/dev/*PRD*.md`, or rely on a curated allowlist?\n5. Should ordering be deterministic (stable sort by path/title) to reduce diff noise?\n\nProposed next step\n- NEW PRD at: docs/dev/context_pack_PRD.md\n- Recommended next command: /prd docs/dev/context_pack_PRD.md wf-ba2.5.4\n","notes":"PR: https://github.com/SorraTheOrc/waif/pull/88","status":"closed","priority":2,"issue_type":"feature","assignee":"rgardler","created_at":"2025-12-22T10:07:31.618758246-08:00","updated_at":"2025-12-30T17:16:16.999609887-08:00","closed_at":"2025-12-30T17:16:16.999609887-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-ba2.5.4","depends_on_id":"wf-ba2.5","type":"parent-child","created_at":"2025-12-22T10:07:31.620445866-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.4","depends_on_id":"wf-7cn","type":"discovered-from","created_at":"2025-12-22T10:07:31.62456323-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.4.1","title":"Implement 'waif ctx' CLI command (MVP)","description":"Acceptance criteria:\\n-  (alias ) CLI entrypoint exists (src/commands/context.ts or integrated into existing CLI)\\n- Supports flags: --out (default docs/dev/CONTEXT_PACK.md), --force, --max-tokens\\n- Generates docs/dev/CONTEXT_PACK.md from a stable template and writes file to disk\\n- Respects .gitignore (no ignored file contents included)\\n- Unit tests for argument parsing and basic generation are provided\\nNotes: Implementation agent (@patch) should not hardcode PM assignment for overflow issues; create a helper to request Map coordination for strategy.","notes":"Requirement change: default behavior must now write the generated context pack to 'doc/context_pack.md' and overwrite it on every run. Implementation required to update CLI and tests accordingly. Created follow-up task wf-ba2.5.4.1.1 to track work.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:36:30.146083786-08:00","updated_at":"2025-12-30T15:34:35.276228165-08:00","closed_at":"2025-12-30T15:34:35.276228165-08:00","close_reason":"Merged PR #86: implemented waif ctx (MVP) with default write","dependencies":[{"issue_id":"wf-ba2.5.4.1","depends_on_id":"wf-ba2.5.4","type":"parent-child","created_at":"2025-12-30T14:36:30.148554943-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.4.2","title":"Consolidate Context PRDs into single canonical PRD","description":"Rationale: docs/dev/context_pack_PRD.md and docs/dev/prd-context.md overlap and should be unified to avoid divergence.\\n\\nProposed change: make docs/dev/context_pack_PRD.md the canonical PRD and merge the eligibility/selection material from docs/dev/prd-context.md into a new section 'Context selection \u0026 eligibility' (or an appendix) so a single PRD captures both implementation and selection rules. Move the old docs/dev/prd-context.md to history/ (or delete) as part of the PR.\\n\\nAcceptance criteria:\\n- docs/dev/context_pack_PRD.md is updated and contains: introduction, users, core UX/agent contract, functional \u0026 non-functional requirements, token/size thresholds, redaction \u0026 safety rules, selection heuristics, packaging \u0026 summarization guidance, and an explicit acceptance criteria section.\\n- The combined PRD includes the eligibility checklist items from prd-context.md and the CLI/tooling guidance (scanning, scoring, manifest) so implementers have a single source of truth.\\n- All references to docs/dev/prd-context.md are updated (CLI PRD, related docs) or the file is moved to history/ with a note.\\n- A short changelog entry (one paragraph) is added at the top of docs/dev/context_pack_PRD.md describing the merge and date.\\n- A PR is opened with the doc merge, with the bd task linked in the PR description.\\n\\nNotes: Implementation agent (@patch) will perform the textual merge; Map will review for coverage and cross-links. If you prefer, instead of merging into a single file we can keep a concise PRD and move exhaustive eligibility rules into docs/dev/context_selection.md and link it from the PRD—state preference in the comment when claiming the task.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:40:43.161382241-08:00","updated_at":"2025-12-30T16:42:10.93238754-08:00","closed_at":"2025-12-30T16:42:10.93238754-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-ba2.5.4.2","depends_on_id":"wf-ba2.5.4","type":"parent-child","created_at":"2025-12-30T14:40:43.172143948-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.4.3","title":"Implement context generator: scan docs and respect .gitignore","description":"Generate context pack by scanning allowed docs and assembling structured entries. Respects .gitignore and deterministically orders entries.","acceptance_criteria":"- Scans allowed doc paths and produces entries with path and 1-2 bullet description\\n- Excludes or redacts ignored files per .gitignore\\n- Deterministic ordering (stable sort by path)\\n- Unit tests for scanning and ignore enforcement\\n- Adds helper function for building entries","notes":"Merged PR https://github.com/SorraTheOrc/waif/pull/89 - generator implemented and tests added","status":"closed","priority":2,"issue_type":"task","assignee":"rgardler","created_at":"2025-12-30T16:51:07.136794908-08:00","updated_at":"2025-12-30T17:13:54.992963613-08:00","closed_at":"2025-12-30T17:13:54.992970333-08:00","dependencies":[{"issue_id":"wf-ba2.5.4.3","depends_on_id":"wf-ba2.5.4","type":"parent-child","created_at":"2025-12-30T16:51:07.13994303-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.4.3","depends_on_id":"wf-ba2.5.4","type":"discovered-from","created_at":"2025-12-30T16:51:07.146207346-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.4.4","title":"Implement overflow handling: create/update P0 when context pack exceeds max tokens","description":"When generated context pack exceeds the soft token limit, create or update a P0 Beads issue assigned to the PM flagging strategy/partitioning required.","acceptance_criteria":"- Detect overflow using token-count helper or heuristic\\n- Create a P0 issue or update an existing canonical P0 issue describing the overflow and linking the PR/pack\\n- Do not hardcode PM assignment; prefer a helper that assigns to the PM role or requests Map coordination\\n- Unit tests for detection and issue creation/update (mocked bd)","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-30T16:51:11.908773054-08:00","updated_at":"2025-12-30T17:15:21.872406474-08:00","labels":["automation","infra"],"dependencies":[{"issue_id":"wf-ba2.5.4.4","depends_on_id":"wf-ba2.5.4","type":"parent-child","created_at":"2025-12-30T16:51:11.913065277-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.4.4","depends_on_id":"wf-ba2.5.4","type":"discovered-from","created_at":"2025-12-30T16:51:11.915884941-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.5.5","title":"Instruct agents to file context pack update requests","description":"Define/update agent operating rules so that when an agent makes a significant repo change, they file a Beads request to update the context pack (docs/dev/CONTEXT_PACK.md). Initial implementation (waif ctx command) is tracked separately; this task is for adding/clarifying the instruction + trigger rule in workflow docs/agent instructions.","notes":"This policy work depends on the Context Pack PRD: docs/dev/context_pack_PRD.md and intake brief wf-ba2.5.4.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T10:07:35.103697584-08:00","updated_at":"2025-12-22T10:11:47.573911992-08:00","dependencies":[{"issue_id":"wf-ba2.5.5","depends_on_id":"wf-ba2.5","type":"parent-child","created_at":"2025-12-22T10:07:35.105282246-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.5.5","depends_on_id":"wf-ba2.5.4","type":"discovered-from","created_at":"2025-12-22T10:07:35.107802363-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.6","title":"Git Branch + PR via gh","description":"Milestones M5-M6: branch+commit and PR creation via gh.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T13:17:01.373489716-08:00","updated_at":"2025-12-22T16:56:27.564010669-08:00","closed_at":"2025-12-22T16:56:27.564010669-08:00","labels":["epic","milestone:M5","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.6","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.375033692-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6","depends_on_id":"wf-ba2.3","type":"blocks","created_at":"2025-12-17T13:17:57.61327417-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.6.1","title":"Safe branch + commit workflow (clean/dirty checks)","description":"M5: Create branch and commit PRD changes safely.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.765863304-08:00","updated_at":"2025-12-30T02:22:15.528534417-08:00","closed_at":"2025-12-30T02:22:15.528538841-08:00","labels":["milestone:M5","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.6.1","depends_on_id":"wf-ba2.6","type":"parent-child","created_at":"2025-12-17T13:19:51.767067298-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.1","depends_on_id":"wf-ba2.3.3","type":"blocks","created_at":"2025-12-17T13:19:54.422079787-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.1","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:54.473259339-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.1","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:22.239610354-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.6.2","title":"Enforce no direct commits / protected branch safety","description":"M5: Prevent direct commits to protected branches; default to branch+PR.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.836559885-08:00","updated_at":"2025-12-30T02:22:15.532627433-08:00","closed_at":"2025-12-30T02:22:15.532632269-08:00","labels":["milestone:M5","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.6.2","depends_on_id":"wf-ba2.6","type":"parent-child","created_at":"2025-12-17T13:19:51.837939982-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.2","depends_on_id":"wf-ba2.6.1","type":"blocks","created_at":"2025-12-17T13:19:54.529431249-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.2","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:22.518671857-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.6.3","title":"Dry-run prevents git actions","description":"M5: Ensure dry-run never creates branches/commits.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:51.914191747-08:00","updated_at":"2025-12-30T17:31:42.16037516-08:00","labels":["milestone:M5","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.6.3","depends_on_id":"wf-ba2.6","type":"parent-child","created_at":"2025-12-17T13:19:51.915695629-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.3","depends_on_id":"wf-ba2.2.3","type":"blocks","created_at":"2025-12-17T13:19:54.586670984-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.3","depends_on_id":"wf-ba2.6.1","type":"blocks","created_at":"2025-12-17T13:19:54.642171544-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:31:42.16037516-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.6.4","title":"Open PR via gh (auth checks, base branch, PR URL output)","description":"M6: Use gh CLI to open a pull request.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T13:19:51.990423314-08:00","updated_at":"2025-12-30T02:22:15.538535591-08:00","closed_at":"2025-12-30T02:22:15.538541557-08:00","labels":["milestone:M6","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.6.4","depends_on_id":"wf-ba2.6","type":"parent-child","created_at":"2025-12-17T13:19:51.991524057-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.4","depends_on_id":"wf-ba2.6.1","type":"blocks","created_at":"2025-12-17T13:19:54.69693234-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.6.4","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:22.741152456-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.7","title":"bd Linking","description":"Milestone M6: accept bd IDs and inject references into PRDs.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-17T13:17:01.447764175-08:00","updated_at":"2025-12-22T16:56:27.57395146-08:00","closed_at":"2025-12-22T16:56:27.57395146-08:00","labels":["epic","milestone:M6","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.7","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.448860734-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.7","depends_on_id":"wf-ba2.3","type":"blocks","created_at":"2025-12-17T13:17:57.666333086-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.7.1","title":"Accept/validate bd id(s) and inject PRD references","description":"M6: Include bd issue references in PRD output.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.068386831-08:00","updated_at":"2025-12-30T17:32:02.780563947-08:00","closed_at":"2025-12-30T17:32:02.780563947-08:00","close_reason":"Closed","labels":["milestone:M6","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.7.1","depends_on_id":"wf-ba2.7","type":"parent-child","created_at":"2025-12-17T13:19:52.06967738-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.7.1","depends_on_id":"wf-ba2.3.2","type":"blocks","created_at":"2025-12-17T13:19:54.755520567-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.7.2","title":"Pass bd id through CLI and ensure it appears in PRD","description":"M6: Wire bd id input end-to-end.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.147589895-08:00","updated_at":"2025-12-30T17:32:21.479970092-08:00","closed_at":"2025-12-30T17:32:21.479970092-08:00","close_reason":"Closed","labels":["milestone:M6","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.7.2","depends_on_id":"wf-ba2.7","type":"parent-child","created_at":"2025-12-17T13:19:52.148714825-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.7.2","depends_on_id":"wf-ba2.7.1","type":"blocks","created_at":"2025-12-17T13:19:54.873506194-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.8","title":"Audit Logging + Redaction","description":"Milestone M7: redacted audit logs (8000 chars) with prompt hash and metadata.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-17T13:17:01.514925677-08:00","updated_at":"2025-12-22T16:56:27.595489184-08:00","closed_at":"2025-12-22T16:56:27.595489184-08:00","labels":["epic","milestone:M7","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.8","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.516568561-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8","depends_on_id":"wf-ba2.5","type":"blocks","created_at":"2025-12-17T13:17:57.782362273-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.8.1","title":"Audit schema + storage location default","description":"M7: Define audit log schema and where it is stored.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.227461366-08:00","updated_at":"2025-12-30T17:32:37.335211152-08:00","labels":["milestone:M7","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.8.1","depends_on_id":"wf-ba2.8","type":"parent-child","created_at":"2025-12-17T13:19:52.228753057-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:32:37.335211152-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.8.2","title":"Prompt redaction/truncation (8000 chars) + prompt_hash","description":"M7: Redact tokens/passwords/PEM and truncate prompt excerpt.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.305537561-08:00","updated_at":"2025-12-30T17:33:05.570450922-08:00","labels":["milestone:M7","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.8.2","depends_on_id":"wf-ba2.8","type":"parent-child","created_at":"2025-12-17T13:19:52.306832606-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.2","depends_on_id":"wf-ba2.8.1","type":"blocks","created_at":"2025-12-17T13:19:55.008483486-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:33:05.570450922-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.8.3","title":"Audit metadata capture (timestamp, invoker, mode, affected files, issue links)","description":"M7: Capture required audit metadata.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.37791664-08:00","updated_at":"2025-12-30T17:33:29.327988648-08:00","labels":["milestone:M7","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.8.3","depends_on_id":"wf-ba2.8","type":"parent-child","created_at":"2025-12-17T13:19:52.378959182-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.3","depends_on_id":"wf-ba2.8.1","type":"blocks","created_at":"2025-12-17T13:19:55.085635777-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.3","depends_on_id":"wf-ba2.5.3","type":"blocks","created_at":"2025-12-17T13:19:55.160150004-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.3","depends_on_id":"wf-ba2.7.1","type":"blocks","created_at":"2025-12-17T13:19:55.233410564-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:33:29.327988648-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.8.4","title":"Hook auditing into create/update/dry-run flows","description":"M7: Ensure every run emits an audit entry.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.444434382-08:00","updated_at":"2025-12-30T17:33:42.183023424-08:00","labels":["milestone:M7","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.8","type":"parent-child","created_at":"2025-12-17T13:19:52.44604712-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.3.1","type":"blocks","created_at":"2025-12-17T13:19:55.293409259-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.3.3","type":"blocks","created_at":"2025-12-17T13:19:55.352268359-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.2.3","type":"blocks","created_at":"2025-12-17T13:19:55.415752074-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.8.2","type":"blocks","created_at":"2025-12-17T13:19:55.471271543-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.8.4","depends_on_id":"wf-ba2.8.3","type":"blocks","created_at":"2025-12-17T13:19:55.522028122-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:33:42.183023424-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.9","title":"Acceptance Criteria Test Harness","description":"Milestone M8: automated tests mapped to PRD acceptance criteria.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-17T13:17:01.579549323-08:00","updated_at":"2025-12-30T02:22:15.479782091-08:00","closed_at":"2025-12-30T02:22:15.479797008-08:00","labels":["epic","milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2","type":"parent-child","created_at":"2025-12-17T13:17:01.580990851-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.3","type":"blocks","created_at":"2025-12-17T13:17:57.884986714-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.4","type":"blocks","created_at":"2025-12-17T13:17:57.945686229-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.5","type":"blocks","created_at":"2025-12-17T13:17:58.012421806-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.6","type":"blocks","created_at":"2025-12-17T13:17:58.071780019-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.7","type":"blocks","created_at":"2025-12-17T13:17:58.137610639-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9","depends_on_id":"wf-ba2.8","type":"blocks","created_at":"2025-12-17T13:17:58.196618519-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.9.1","title":"Tests: create (outline + remark formatting)","description":"M8: Tests for create path.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.525622395-08:00","updated_at":"2025-12-30T17:34:16.164162334-08:00","closed_at":"2025-12-30T17:34:16.164162334-08:00","close_reason":"Closed","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.1","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:52.527534969-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.1","depends_on_id":"wf-ba2.3.2","type":"blocks","created_at":"2025-12-17T13:19:55.576496882-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.1","depends_on_id":"wf-ba2.4.1","type":"blocks","created_at":"2025-12-17T13:19:55.634314216-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.9.2","title":"Tests: dry-run produces no writes","description":"M8: Ensure dry-run has zero side effects.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.651224888-08:00","updated_at":"2025-12-30T17:34:29.715916483-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.2","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:52.653202034-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.2","depends_on_id":"wf-ba2.2.3","type":"blocks","created_at":"2025-12-17T13:19:55.692553479-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.2","depends_on_id":"wf-ba2.6.1","type":"blocks","created_at":"2025-12-17T13:19:55.759888803-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:34:29.715916483-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.9.3","title":"Tests: update preserves structure","description":"M8: Update behavior tests.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.747690873-08:00","updated_at":"2025-12-30T17:34:43.396122549-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.3","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:52.748894227-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.3","depends_on_id":"wf-ba2.3.3","type":"blocks","created_at":"2025-12-17T13:19:55.8357798-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:34:43.396122549-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.9.4","title":"Tests: .gitignore enforcement","description":"M8: Context and writes respect .gitignore.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.835281611-08:00","updated_at":"2025-12-30T17:34:53.953887373-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.4","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:52.836721508-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.4","depends_on_id":"wf-ba2.5.1","type":"blocks","created_at":"2025-12-17T13:19:55.919746271-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:34:53.953887373-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.9.5","title":"Tests: git branch+commit","description":"M8: Branch/commit behavior tests.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:52.921612495-08:00","updated_at":"2025-12-30T17:35:11.03444666-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.5","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:52.923714452-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.5","depends_on_id":"wf-ba2.6.1","type":"blocks","created_at":"2025-12-17T13:19:55.991281086-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.5","depends_on_id":"wf-ba2.6.2","type":"blocks","created_at":"2025-12-17T13:19:56.066559538-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:35:11.03444666-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-ba2.9.6","title":"Tests: gh PR failure modes","description":"M8: Auth missing, no remote, etc.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-17T13:19:53.015235848-08:00","updated_at":"2025-12-18T11:04:24.331239738-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.6","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:53.016881754-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.6","depends_on_id":"wf-ba2.6.4","type":"blocks","created_at":"2025-12-17T13:19:56.13541498-08:00","created_by":"daemon"}]}
{"id":"wf-ba2.9.7","title":"Tests: audit redaction/truncation + metadata","description":"M8: Audit log behavior tests.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T13:19:53.094757743-08:00","updated_at":"2025-12-30T17:35:24.132852036-08:00","labels":["milestone:M8","prd-agent"],"dependencies":[{"issue_id":"wf-ba2.9.7","depends_on_id":"wf-ba2.9","type":"parent-child","created_at":"2025-12-17T13:19:53.096176544-08:00","created_by":"daemon"},{"issue_id":"wf-ba2.9.7","depends_on_id":"wf-ba2.8.4","type":"blocks","created_at":"2025-12-17T13:19:56.205968613-08:00","created_by":"daemon"}],"deleted_at":"2025-12-30T17:35:24.132852036-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-bkt","title":"Feature: run-job subcommand + job runner","description":"Add ooda run-job subcommand and a reusable job runner module that executes job.command, enforces timeout, captures stdout/stderr, applies redact rules, and returns structured results. Export helpers for tests.","acceptance_criteria":"1) run-job CLI present: 'waif ooda run-job --config \u003cpath\u003e --job \u003cid\u003e --log \u003cpath\u003e' runs the job once and appends sanitized JSONL snapshot. 2) runJobCommand implemented and exported for tests. 3) Snapshot retention enforced per job.retention.keep_last. 4) Unit + E2E tests added and passing locally.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-08T20:38:00.899610233-08:00","created_by":"WAIF","updated_at":"2026-01-11T22:18:36.0477389-08:00","closed_at":"2026-01-11T22:18:36.0477389-08:00","close_reason":"Merged (PR #102) — run-job subcommand \u0026 runner landed; follow-ups tracked separately","dependencies":[{"issue_id":"wf-bkt","depends_on_id":"wf-e6r.2.1.1","type":"discovered-from","created_at":"2026-01-08T20:38:00.910292883-08:00","created_by":"WAIF"}],"comments":[{"id":86,"issue_id":"wf-bkt","author":"rgardler","text":"Committed job runner + snapshot writer; files: src/lib/jobRunner.js, src/lib/snapshotWriter.js, src/commands/ooda.ts. Commit d865192. Branch: wf-e6r.2.1.1/job-command-work.","created_at":"2026-01-09T04:58:09Z"},{"id":91,"issue_id":"wf-bkt","author":"rgardler","text":"Added type alias updates to JobRunResult and snapshot writer to satisfy TypeScript build. Commit 4da5164. Full test suite (npm test) passed locally. Branch: wf-e6r.2.1.1/job-command-work.","created_at":"2026-01-09T05:00:48Z"},{"id":109,"issue_id":"wf-bkt","author":"rgardler","text":"Feature implementation merged via PR #102 (merge commit e7ea93b5dddad2773511ba2099b23e4a16eb495d). Summary: run-job subcommand added, runJobCommand exported, writeJobSnapshot + enforceRetention implemented, printJobResult exported, tests added (ooda-echo, ooda-run-job, ooda-hello-5s + related fixtures), docs updated (docs/commands/ooda.md). Files merged include: .github/workflows/ci-tests.yml, README.md, docs/commands/ooda.md, docs/dev/prd/prd-ooda-loop.md, package-lock.json, package.json, src/commands/ooda.ts, src/lib/config.ts, src/lib/schemas/ooda-scheduler.schema.json, tests/fixtures/ooda.hello-5s.yaml, tests/fixtures/ooda.invalid-*.yaml, tests/fixtures/ooda.missing-*.yaml, tests/fixtures/ooda.valid.yaml, tests/ooda-echo.test.ts, tests/ooda-hello-5s.test.ts, tests/ooda-run-job.test.ts, tests/ooda.test.ts and other related tests. Local and CI tests passed. Closing wf-bkt.","created_at":"2026-01-12T06:18:33Z"}]}
{"id":"wf-bky","title":"Cleanup: delete backup branch and close session PRs","description":"Delete the backup branch created during revert (backup/copilot-pr-setup-8481674) and close any open PRs created during the session (e.g., validation PRs). This is destructive (remote delete, PR close) and was explicitly approved by the Producer. Do NOT delete other branches. Record exact commands and outputs in the BD comment.","notes":"Deleted backup branch backup/copilot-pr-setup-8481674 and closed PRs #117, #116, #115. Commands executed:\n- git push origin --delete backup/copilot-pr-setup-8481674\n- gh pr list --state open --json number,title,headRefName,baseRefName,url --jq ...\n- gh pr close 117 --delete-branch --comment \"Closing validation PRs from Copilot workflow session cleanup (approved).\"\n- gh pr close 116 --delete-branch --comment \"Closing validation PRs from Copilot workflow session cleanup (approved).\"\n- gh pr close 115 --delete-branch --comment \"Closing validation PRs from Copilot workflow session cleanup (approved).\"\n\nOutputs:\n- backup branch deleted remotely.\n- PRs closed and their branches deleted remotely.\n\nIf you need any other branches closed or deleted, list them explicitly.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-13T22:47:19.899299733-08:00","created_by":"WAIF","updated_at":"2026-01-13T22:47:38.201861355-08:00","closed_at":"2026-01-13T22:47:38.201908547-08:00"}
{"id":"wf-bpa","title":"Add tmux startup script for multi-agent workflow","description":"Create a shell script that starts tmux and opens panes for each workflow agent described in docs/Workflow.md (PM, design, build, docs, review) plus a user shell pane.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:37:26.170929409-08:00","updated_at":"2025-12-19T14:55:04.539060742-08:00","closed_at":"2025-12-19T14:55:04.539060742-08:00"}
{"id":"wf-bsz","title":"Feature: normalize OpenCode plugin events into canonical waif schema","description":"Make the in-repo OpenCode plugin output a stable, canonical event shape (agent, title, time, type, seq, sessionID, properties) so waif ooda and other consumers can parse events reliably. Include small adapter in .opencode/plugin/waif-ooda.ts that translates raw opencode events to the canonical schema before appending to .opencode/logs/events.jsonl. Provide tests and update PRD.","notes":"Implementing plugin normalization in .opencode/plugin/waif-ooda.ts; replaced old behavior with canonical event emitter writing {time,type,agent,title,seq,sessionID,properties}. No backward compatibility retained per instruction. Added tests and updated PRD/documentation.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T21:45:41.960989532-08:00","updated_at":"2025-12-30T02:26:20.094857418-08:00","closed_at":"2025-12-30T02:26:20.094857418-08:00","close_reason":"Closed"}
{"id":"wf-bxn","title":"Docs: Resolve TBDs in docs/dev/TUI_PRD.md","description":"Clarify observability, OpenCode integration details, and any TBD placeholders in docs/dev/TUI_PRD.md.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:34.185590955-08:00","updated_at":"2025-12-19T22:11:35.495196974-08:00","dependencies":[{"issue_id":"wf-bxn","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.342791333-08:00","created_by":"daemon"}]}
{"id":"wf-c2n","title":"waif next: optional search-prioritized issue selection","description":"Problem\nDeciding the next issue in a large project is currently based purely on a mathematical calculation that relies on issues being accurately prioritized and the hierarchy being fully defined. In practice this is not a perfect science. Allowing a search term to filter/prioritize possible next issues will let the Producer influence the next decision when needed.\n\nUsers\nPrimary: Producer (user running ID          Type / Status / Title                                    Priority  Blockers  Blocks  Assignee\n----------  -------------------------------------------------------  --------  --------  ------  --------\nwf-ba2.5.2  🧩 ⭕ Context selection strategy (eligible repo context)  2         0         0               \n\n# Details\n\nwf-ba2.5.2: Context selection strategy (eligible repo context)\nStatus: open\nPriority: P2\nType: task\nCreated: 2025-12-17 13:19\nUpdated: 2025-12-18 11:04\n\nDescription:\nM4: Define what repo content is eligible as context.\n\nLabels: [milestone:M4 prd-agent]\n\n\n  ← wf-ba2.3.4: Integrate context gathering into create/update (optional) [P2 - open]). No secondary stakeholders identified.\n\nSuccess criteria\nWhen a search string is provided, matches should apply a weighting to bv-computed scores so that: a title match increases an issue's score more than a description match. A high-scoring matching issue should be recommended over a roughly-equivalent (or slightly higher scoring) non-matching issue. If no sufficiently-scoring match exists, ID          Type / Status / Title                                    Priority  Blockers  Blocks  Assignee\n----------  -------------------------------------------------------  --------  --------  ------  --------\nwf-ba2.5.2  🧩 ⭕ Context selection strategy (eligible repo context)  2         0         0               \n\n# Details\n\nwf-ba2.5.2: Context selection strategy (eligible repo context)\nStatus: open\nPriority: P2\nType: task\nCreated: 2025-12-17 13:19\nUpdated: 2025-12-18 11:04\n\nDescription:\nM4: Define what repo content is eligible as context.\n\nLabels: [milestone:M4 prd-agent]\n\n\n  ← wf-ba2.3.4: Integrate context gathering into create/update (optional) [P2 - open] should fall back to the existing selection process and clearly indicate a no-match result. Measurable tests: unit tests that exercise title vs description matches, and an integration test verifying fallback behavior.\n\nConstraints\n- Timeline: no urgent deadline noted (default P2).\n- Compatibility: must be a no-op when no search string is given; must not change existing ranking heuristics except when a search term is present. Performance must remain interactive for typical repo sizes.\n- Risk tolerance: low — changes should be additive and behind argument/flag; deterministic behavior required for automation consumers of  output.\n\nExisting state\n- Current behavior: ID          Type / Status / Title                                    Priority  Blockers  Blocks  Assignee\n----------  -------------------------------------------------------  --------  --------  ------  --------\nwf-ba2.5.2  🧩 ⭕ Context selection strategy (eligible repo context)  2         0         0               \n\n# Details\n\nwf-ba2.5.2: Context selection strategy (eligible repo context)\nStatus: open\nPriority: P2\nType: task\nCreated: 2025-12-17 13:19\nUpdated: 2025-12-18 11:04\n\nDescription:\nM4: Define what repo content is eligible as context.\n\nLabels: [milestone:M4 prd-agent]\n\n\n  ← wf-ba2.3.4: Integrate context gathering into create/update (optional) [P2 - open] selects next item purely from bv/computed scores (src/commands/next.ts).\n\nDesired change\n- Update ID          Type / Status / Title                                    Priority  Blockers  Blocks  Assignee\n----------  -------------------------------------------------------  --------  --------  ------  --------\nwf-ba2.5.2  🧩 ⭕ Context selection strategy (eligible repo context)  2         0         0               \n\n# Details\n\nwf-ba2.5.2: Context selection strategy (eligible repo context)\nStatus: open\nPriority: P2\nType: task\nCreated: 2025-12-17 13:19\nUpdated: 2025-12-18 11:04\n\nDescription:\nM4: Define what repo content is eligible as context.\n\nLabels: [milestone:M4 prd-agent]\n\n\n  ← wf-ba2.3.4: Integrate context gathering into create/update (optional) [P2 - open] to accept an optional search string/flag which, when present, applies additional weighting to bv scores:\n  - Title match: strong positive multiplier/score bump\n  - Description match: smaller positive multiplier/score bump\n  - Matching must be case-insensitive and deterministic; exact matching behavior (substring vs fuzzy) to be decided in follow-ups\n- Fallback: when no match rises above a configurable threshold, revert to current selection and indicate no-match.\n- Implementation likely lives in:  + tests in  and docs update at .\n\nLikely duplicates / related docs\n- docs/dev/prd-command-next.md\n- docs/Workflow.md (selection rules)\n- docs/dev/CLI_PRD.md\n- src/commands/next.ts\n- tests/next.test.ts\n\nRelated issues (Beads)\n- wf-3ur.1 Add --number/-n option to 'waif next' to return multiple suggestions\n- wf-35m.4 Reduce code duplication across next/recent/in-progress commands\n- wf-ba2.1.5 Rule of Five: Select next issue (Workflow step 4.1)\n- wf-ba2.3.6 Wire waif prd command to PRD Agent workflow (adjacent)\n- wf-32r Beads search command (related search UX)\n\nClarifying questions\n1) Matching algorithm: prefer exact substring (case-insensitive) or fuzzy/tokenized matching? Any preference for libraries to use? \n2) Weighting: do you want fixed multipliers (e.g., title match +20% score, description +10%) or a configurable additive score? Which is preferred? \n3) CLI UX: should the search be a positional arg (e.g. ID          Type / Status / Title                                    Priority  Blockers  Blocks  Assignee\n----------  -------------------------------------------------------  --------  --------  ------  --------\nwf-ba2.5.2  🧩 ⭕ Context selection strategy (eligible repo context)  2         0         0               \n\n# Details\n\nwf-ba2.5.2: Context selection strategy (eligible repo context)\nStatus: open\nPriority: P2\nType: task\nCreated: 2025-12-17 13:19\nUpdated: 2025-12-18 11:04\n\nDescription:\nM4: Define what repo content is eligible as context.\n\nLabels: [milestone:M4 prd-agent]\n\n\n  ← wf-ba2.3.4: Integrate context gathering into create/update (optional) [P2 - open]) or an explicit flag (e.g. )?\n4) Thresholds and ties: how should ties be broken when a matching issue is slightly lower than a non-matching issue? (current default: numeric score then id lexicographic)\n5) JSON contract: should {\n  \"id\": \"wf-ba2.5.2\",\n  \"title\": \"Context selection strategy (eligible repo context)\",\n  \"description\": \"M4: Define what repo content is eligible as context.\",\n  \"status\": \"open\",\n  \"priority\": 2,\n  \"issue_type\": \"task\",\n  \"created_at\": \"2025-12-17T13:19:51.637139286-08:00\",\n  \"updated_at\": \"2025-12-18T11:04:24.294958116-08:00\",\n  \"labels\": [\n    \"milestone:M4\",\n    \"prd-agent\"\n  ],\n  \"waif\": {\n    \"score\": -1763006391.637,\n    \"rationale\": \"priority 2 + earlier created\",\n    \"rank\": 1,\n    \"metadata\": {\n      \"priority\": 2,\n      \"created_at\": \"2025-12-17T13:19:51.637139286-08:00\",\n      \"tie_break\": \"created_at\",\n      \"issuesSource\": \"bd\",\n      \"bvSource\": \"none\"\n    }\n  }\n} include the computed match metadata (matchedFields, matchScore, originalBVScore)?\n\nProposed next step\nUPDATE PRD at: docs/dev/prd-command-next.md\nRecommended next command: /prd docs/dev/prd-command-next.md \u003cthis-issue-id\u003e\n\n\nDecisions recorded:\n- fuzzy matching via fuse.js\n- weights: title +20%, description +10%\n- strategy: request top_n=10 from bv, then fuzzy-match those candidates\n- CLI UX: positional arg\n- JSON output: unchanged\n\nBlocked-by:\n- wf-3ur.1 (Add --number/-n option to 'waif next' to return multiple suggestions)\n","notes":"Finalized: merged UX tweak PR #83 and merged feature work into main; cleaning up branches","status":"closed","priority":2,"issue_type":"feature","assignee":"@map","created_at":"2025-12-30T11:21:03.664416059-08:00","updated_at":"2025-12-30T13:46:47.2098735-08:00","closed_at":"2025-12-30T13:46:47.209879563-08:00","external_ref":"gh-PR: https://github.com/SorraTheOrc/waif/pull/82","dependencies":[{"issue_id":"wf-c2n","depends_on_id":"wf-3ur.1","type":"blocks","created_at":"2025-12-30T11:30:44.548317812-08:00","created_by":"daemon"}]}
{"id":"wf-c72j","title":"Fix duplicate maybeRunStartupCatchups in src/commands/ooda.ts","notes":"Fixed duplicate and CI green","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T23:52:59.575492136-08:00","created_by":"WAIF","updated_at":"2026-01-14T23:55:18.41893422-08:00","closed_at":"2026-01-14T23:55:18.41894302-08:00","dependencies":[{"issue_id":"wf-c72j","depends_on_id":"wf-aonm","type":"discovered-from","created_at":"2026-01-14T23:52:59.586967137-08:00","created_by":"WAIF"}]}
{"id":"wf-c7b","title":"Create default ooda schedule","description":"# Intake draft — Create default ooda schedule\n\nWorking title\n\nCreate default ooda schedule\n\nProblem\n\nThere is no canonical, repo-local example OODA scheduler config in the repository that an operator can drop in and run as a first-class default. Operators discovering `waif ooda` need a validated sample `.waif/ooda-scheduler.yaml` with at least one practical example job (e.g., `daily-health`) and clear documentation so they can run the scheduler locally without crafting config from scratch.\n\nUsers\n\n- Primary: Local operators / developers who run `waif ooda` interactively (tmux panes, developer laptops)\n\nSuccess criteria\n\n1) A default `.waif/ooda-scheduler.yaml` file exists in the repo root (or repo-suggested location) and validates against `src/lib/schemas/ooda-scheduler.schema.json`.\n2) Example job(s) included (e.g., `daily-health`, `hello-5s` fixture) and linked from docs/commands/ooda.md and docs/usage/ooda.md so operators can copy/use it easily.\n\nConstraints\n\n- Follow the existing schema: `src/lib/schemas/ooda-scheduler.schema.json` must validate the example config.\n- Keep the example config operator-friendly (no secrets, simple commands, short timeouts for local testing).\n- Respect repository conventions: place ephemeral examples under tests/fixtures when intended for tests; production-like default config should be `.waif/ooda-scheduler.yaml` in repo root or suggested path in docs.\n- Do not change the existing `ooda` command behavior or tests beyond adding example files and docs references.\n\nExisting state\n\n- `waif ooda` CLI (scheduler + run-job) is implemented in `src/commands/ooda.ts` and documented in `docs/commands/ooda.md` and `docs/usage/ooda.md`.\n- There are existing fixtures and tests (e.g., tests/fixtures/ooda.hello-5s.yaml, tests/fixtures/ooda.valid.yaml) and example PRD `docs/dev/prd-ooda-loop.md` describing the canonical OODA scheduler.\n\nDesired change\n\n- Add a default example file at `.waif/ooda-scheduler.yaml` with: 1–3 sample jobs (including `daily-health`), validated against the schema, short timeouts and retention settings suitable for local dev; include comments and usage notes.\n- Add a short example snippet and pointer in `docs/commands/ooda.md` and `docs/usage/ooda.md` linking to the file and showing `waif ooda schedule run \u003cjob\u003e` and `waif ooda run-job` usage.\n- Optionally add a test fixture (e.g., tests/fixtures/ooda.default.yaml) or link existing hello-5s fixture if it already meets requirements.\n\nLikely duplicates / related docs\n\n- docs/usage/ooda.md — user-facing OODA usage and examples\n- docs/commands/ooda.md — CLI usage and job examples\n- docs/dev/prd-ooda-loop.md — PRD for Cron-style OODA Scheduler (existing planning artifact)\n- docs/operational/ooda-ci.md — CI validation and smoke testing notes\n- tests/fixtures/ooda.hello-5s.yaml — existing fixture used as an example\n- src/lib/schemas/ooda-scheduler.schema.json — JSON Schema to validate the scheduler config\n- src/commands/ooda.ts — CLI implementation to ensure examples align with flags/behavior\n\nRelated issues (Beads ids)\n\n- wf-cvz — (epic) ooda command / monitor: possible parent for broader OODA work\n- wf-bkt — (feature, closed) run-job subcommand + job runner (run-job landed)\n- wf-4cv — (chore) docs: ooda scheduler command documentation (docs already added/updated)\n- wf-633 — (chore) docs: update ooda docs for run-job CLI and deprecate --once/--events\n- wf-4bx — (task) CLI integration hangs for ooda --once (investigation may be relevant)\n\nRecommended next step\n\nUPDATE PRD at: docs/dev/prd-ooda-loop.md — incorporate the addition of the default `.waif/ooda-scheduler.yaml` example and the small docs edits as the next, scoped implementation step. If you prefer a standalone PRD, we can create: `docs/prd/create_default_ooda_schedule_PRD.md` instead.\n\nImmediate next tasks (suggested):\n\n- Add `.waif/ooda-scheduler.yaml` to the repo root (example config with 1–3 jobs, comments, short timeouts, and retention settings).\n- Add `tests/fixtures/ooda.default.yaml` mapping to the example with short intervals suitable for CI.\n- Update `docs/commands/ooda.md` and `docs/usage/ooda.md` with a pointer and a short example showing `waif ooda schedule run \u003cjob\u003e` and `waif ooda run-job --config .waif/ooda-scheduler.yaml --job \u003cid\u003e`.\n- Open a PR with the new files and link this bead; include tests that validate the config against `src/lib/schemas/ooda-scheduler.schema.json`.\n- If this work is part of a broader epic, create the bead as a child/sub-issue under the identified parent (e.g., wf-cvz).\n\n\nNotes / open questions (need your confirmation)\n\n- Confirm preferred location for the default file: repo root `.waif/ooda-scheduler.yaml` (recommended) or docs/fixtures/ or another path?\n- Should we add a new tests fixture `tests/fixtures/ooda.default.yaml` for CI, or reuse `tests/fixtures/ooda.hello-5s.yaml`?\n- Are there any required example jobs beyond a simple `daily-health` or `hello-5s` that you want included?\n\n\n---\n\nThis draft will be used to create the Beads issue description if you approve; tell me any edits and I will incorporate them before proceeding to the five review stages.\n","notes":"PR #120 merged; implementation landed on main. Closing epic wf-c7b. Child tasks completed.","status":"closed","priority":1,"issue_type":"epic","assignee":"rgardler","created_at":"2026-01-14T01:33:36.288368801-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:09:14.650804828-08:00","closed_at":"2026-01-14T02:09:14.65081278-08:00","external_ref":"gh-PR: https://github.com/SorraTheOrc/waif/pull/120","labels":["Status: Intake Completed","Status: PR Created"]}
{"id":"wf-c7b.1","title":"Fix src/commands/ooda.ts: remove duplicate scheduler loop, extract header printer, call from run-job","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T01:52:49.7580068-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:57:20.159188689-08:00","closed_at":"2026-01-14T01:57:20.159188689-08:00","close_reason":"Completed: extracted header helper in ooda.ts and applied to run-job; tests passed","dependencies":[{"issue_id":"wf-c7b.1","depends_on_id":"wf-c7b","type":"parent-child","created_at":"2026-01-14T01:52:49.761968043-08:00","created_by":"WAIF"}]}
{"id":"wf-c7b.2","title":"Remove daily-health and hello jobs from default scheduler and fixtures","description":"Remove the example daily-health and hello jobs from .waif/ooda-scheduler.yaml and any test fixtures (e.g., tests/fixtures/ooda.default.yaml or hello fixture). Update tests/docs if they reference these jobs.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T01:59:39.079320666-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:00:08.407710774-08:00","closed_at":"2026-01-14T02:00:08.407710774-08:00","close_reason":"Completed: removed daily-health and hello jobs from .waif/ooda-scheduler.yaml and fixtures","dependencies":[{"issue_id":"wf-c7b.2","depends_on_id":"wf-c7b","type":"parent-child","created_at":"2026-01-14T01:59:39.080319148-08:00","created_by":"WAIF"}]}
{"id":"wf-c7b.3","title":"Print OODA Loop Started timestamp when scheduler starts","description":"When the ooda scheduler starts, print 'HH:MM:SS OODA Loop Started' followed by a blank line (only in non-json mode). Implement as a top-level helper using existing formatTime() and ensure it's called once before the scheduler loop begins.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T02:00:16.266409511-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:00:32.649928837-08:00","closed_at":"2026-01-14T02:00:32.649928837-08:00","close_reason":"Completed: print OODA Loop Started timestamp when scheduler starts","dependencies":[{"issue_id":"wf-c7b.3","depends_on_id":"wf-c7b","type":"parent-child","created_at":"2026-01-14T02:00:16.267224947-08:00","created_by":"WAIF"}]}
{"id":"wf-c7b.4","title":"Make OODA timestamps green and add green separators for start and job headers","description":"Color the time (HH:MM:SS) green and print a green line of '-' characters above and below the OODA Loop Started line and per-job header (only in non-json mode). Update printJobHeader and start print accordingly.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T02:02:12.138179246-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:02:37.494090746-08:00","closed_at":"2026-01-14T02:02:37.494090746-08:00","close_reason":"Completed: added green separators and colored timestamps for start and job headers","dependencies":[{"issue_id":"wf-c7b.4","depends_on_id":"wf-c7b","type":"parent-child","created_at":"2026-01-14T02:02:12.139486092-08:00","created_by":"WAIF"}]}
{"id":"wf-c7b.5","title":"Restore tests/fixtures/ooda.default.yaml and tests/fixtures/ooda.hello-5s.yaml","description":"Recreate the two test fixtures that were removed earlier: tests/fixtures/ooda.default.yaml and tests/fixtures/ooda.hello-5s.yaml. Ensure contents match previous fixture definitions for hello-5s.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T02:06:58.06623948-08:00","created_by":"WAIF","updated_at":"2026-01-14T02:07:23.087655856-08:00","closed_at":"2026-01-14T02:07:23.087655856-08:00","close_reason":"Completed: restored two test fixtures","dependencies":[{"issue_id":"wf-c7b.5","depends_on_id":"wf-c7b","type":"parent-child","created_at":"2026-01-14T02:06:58.067590764-08:00","created_by":"WAIF"}]}
{"id":"wf-c8j","title":"Docs: ensure GitHub links point to SorraTheOrc forks","description":"Audit docs in this change for GitHub links; ensure all references use SorraTheOrc forks (not upstream orgs).","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-20T15:15:19.019713684-08:00","updated_at":"2025-12-20T15:15:25.059980078-08:00","closed_at":"2025-12-20T15:15:25.059980078-08:00","dependencies":[{"issue_id":"wf-c8j","depends_on_id":"wf-s5d","type":"discovered-from","created_at":"2025-12-20T15:15:19.02481849-08:00","created_by":"daemon"}]}
{"id":"wf-ca1","title":"Beads evaluation tasks: Intake brief","description":"- Problem\n  - This repo (WAFI) needed an initial evaluation of using Beads (`bd` + optional `bv`) as the single source of truth for issue tracking, and guidance for agents so planning doesn't drift into TODO lists or external trackers.\n  - The immediate problem was that workflow/PRD documents referenced a Beads evaluation workstream (wf-ca1), but the issue itself had no description, making the reference confusing and leaving wf-ba2 shown as blocked.\n\n- Users\n  - Primary: a single PM working inside the git repo using the WAFI CLI + OpenCode.\n  - Secondary: coding/doc agents operating via the same repo-first workflow; future TUI users.\n\n- Success criteria\n  - wf-ca1 clearly explains what it tracked and what artifacts resulted.\n  - References in docs point to concrete repo artifacts (PRDs/workflow guidance) and/or successor issues.\n  - Closing wf-ca1 should not leave wf-ba2 blocked by an undefined item.\n\n- Constraints\n  - Beads (`bd`) remains canonical for all issue tracking.\n  - Workflow artifacts live in-repo (primarily `docs/`); no duplicate task lists.\n  - Keep the change minimal: document and close the missing issue rather than inventing new scope.\n\n- Existing state (if applicable)\n  - `wf-ca1` existed as an open epic, with an empty description.\n  - Most historical wf-ca1.* evaluation subtasks were tombstoned during a cleanup.\n  - The learnings/requirements are already captured in repo docs (see below).\n\n- Desired change (if applicable)\n  - Document wf-ca1 as the intake/evaluation brief that led to:\n    - Beads-first workflow guidance in `AGENTS.md`.\n    - Product requirements referencing Beads usage in `docs/dev/CLI_PRD.md` and `docs/Workflow.md`.\n  - Close wf-ca1 as completed to avoid being an unexplained blocker.\n\n- Likely duplicates / related docs (file paths)\n  - `docs/dev/CLI_PRD.md`\n  - `docs/Workflow.md`\n  - `docs/dev/TUI_PRD.md`\n  - `AGENTS.md`\n  - `.github/copilot-instructions.md`\n\n- Related issues (Beads ids)\n  - `wf-dt1` (Evaluate beads for issue tracking) (closed)\n  - `wf-ba2` (PM Agent MVP) (in_progress; originally blocked by wf-ca1)\n  - `wf-t31` (Add template usage guidance to bd onboard output) (open)\n\n- Clarifying questions\n  1. Should wf-ba2 keep an explicit dependency edge to wf-ca1 now that wf-ca1 is closed, or should the dependency be removed for clarity?\n  2. Do we want a dedicated issue (or epic) for ongoing Beads workflow evolution, separate from the initial evaluation?\n  3. Should the doc cross-references continue pointing at wf-ca1, or be updated to reference wf-dt1 (or another successor) instead?\n\n- Proposed next step:\n  - UPDATE PRD at: `docs/dev/CLI_PRD.md` (only if we want to change cross-references away from wf-ca1)\n  - Recommended next command: `/prd docs/dev/CLI_PRD.md wf-ca1`\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T13:12:40.598302523-08:00","updated_at":"2025-12-19T11:21:19.802456129-08:00","closed_at":"2025-12-19T11:21:19.802456129-08:00","labels":["Chore"]}
{"id":"wf-ca1.11","title":"Evaluate issue creation and templates","description":"Test bd create command, issue types (bug/feature/task/epic/chore), priorities, and template support\n\n## Recommended Learning Path\n\n1. **Basic Issue Creation**\n   - Run: `bd create \"My first issue\" --json`\n   - Run: `bd create \"Test issue\" -t bug -p 1 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/quickstart.md\n\n2. **Issue Types**\n   - Test each type: bug, feature, task, epic, chore\n   - Run: `bd create \"Bug example\" -t bug --json`\n   - Run: `bd create \"Feature example\" -t feature --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/issue-types.md\n\n3. **Priorities**\n   - Test priorities 0-4 (critical to backlog)\n   - Run: `bd create \"Critical bug\" -t bug -p 0 --json`\n   - Run: `bd create \"Nice to have\" -t feature -p 3 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/priorities.md\n\n4. **Templates**\n   - Run: `bd template list --json`\n   - Run: `bd template create bug-report --json`\n   - Run: `bd create --from-template bug-report --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/templates.md\n\n5. **Batch Creation**\n   - Create issues from markdown file\n   - Run: `bd create --from-file issues.md --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/batch-operations.md\n\n6. **Advanced Options**\n   - Test --assignee, --labels, --parent flags\n   - Run: `bd create --help` to see all available options\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#create","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-15T15:49:18.497976711-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.12","title":"Evaluate dependency management","description":"Test dependency tracking (blocks/blocked-by/discovered-from), bd dep command, and dependency visualization\n\n## Recommended Learning Path\n\n1. **Basic Dependencies**\n   - Create issues with dependencies\n   - Run: `bd create \"Task A\" --json`\n   - Run: `bd create \"Task B\" --deps blocks:beads-testing-ca1.12 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/dependencies.md\n\n2. **Dependency Types**\n   - Test blocks, blocked-by, discovered-from relationships\n   - Run: `bd dep add beads-testing-ca1.12 blocks beads-testing-ca1.13 --json`\n   - Run: `bd dep add beads-testing-ca1.12 discovered-from beads-testing-ca1.11 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/dependency-types.md\n\n3. **Managing Dependencies**\n   - Run: `bd dep list beads-testing-ca1.12 --json`\n   - Run: `bd dep remove beads-testing-ca1.12 blocks beads-testing-ca1.13 --json`\n   - Run: `bd show beads-testing-ca1.12 --json` (includes dependencies)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#dep\n\n4. **Blocking Analysis**\n   - Run: `bd blocked --json` (show all blocked issues)\n   - Run: `bd ready --json` (show unblocked issues)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/workflow.md#blocking\n\n5. **Dependency Validation**\n   - Run: `bd repair-deps --json` (find orphaned dependencies)\n   - Run: `bd validate --json` (comprehensive health check)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/maintenance.md\n\n6. **Discovered-From Pattern**\n   - Use when finding new work while working on an issue\n   - Run: `bd create \"Found bug\" -p 1 --deps discovered-from:beads-testing-ca1.12 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/ai-workflows.md#discovered-work","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:23.684771562-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.13","title":"Evaluate workflow commands","description":"Test bd ready, bd blocked, bd stale, and issue status transitions (open/in_progress/done/closed)\n\n## Recommended Learning Path\n\n1. **Status Transitions**\n   - Run: `bd update beads-testing-ca1.13 --status in_progress --json`\n   - Run: `bd update beads-testing-ca1.13 --status done --json`\n   - Run: `bd reopen beads-testing-ca1.13 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/status-workflow.md\n\n2. **Finding Ready Work**\n   - Run: `bd ready --json` (unblocked, open or in-progress)\n   - Run: `bd ready --status open --json` (only open issues)\n   - Run: `bd ready --priority 1 --json` (high priority only)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/workflow.md#ready-work\n\n3. **Blocked Issues**\n   - Run: `bd blocked --json` (all blocked issues)\n   - Run: `bd blocked --show-deps --json` (with blocking dependencies)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/workflow.md#blocked-issues\n\n4. **Stale Issues**\n   - Run: `bd stale --json` (default: 90+ days)\n   - Run: `bd stale --days 30 --json` (custom threshold)\n   - Run: `bd stale --status in_progress --json` (stale WIP)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/maintenance.md#stale-detection\n\n5. **Closing Issues**\n   - Run: `bd close beads-testing-ca1.13 --reason \"Completed\" --json`\n   - Run: `bd close beads-testing-ca1.13 --reason \"Won't fix\" --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#close\n\n6. **Workflow Integration**\n   - Run: `bd prime --json` (AI workflow context)\n   - Test full workflow: ready → claim → work → complete\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/ai-workflows.md","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:28.863913806-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.14","title":"Evaluate git integration and sync","description":"Test bd sync, git hooks, JSONL export/import, auto-flush, and branch-aware tracking\n\n## Recommended Learning Path\n\n1. **Git Hooks Setup**\n   - Run: `bd hooks install --json` (installs pre-commit/post-merge hooks)\n   - Run: `bd hooks status --json` (check hook status)\n   - Run: `bd hooks uninstall --json` (remove hooks)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/git-integration.md#hooks\n\n2. **Manual Export/Import**\n   - Run: `bd export --json` (export to .beads/issues.jsonl)\n   - Run: `bd import --json` (import from JSONL)\n   - Check: `cat .beads/issues.jsonl | head -5`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/jsonl-format.md\n\n3. **Auto-Flush Behavior**\n   - Create/update issues and observe 5s debounce\n   - Run: `bd info --json` (check flush status)\n   - Test: `bd create \"Test\" --no-auto-flush --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/auto-sync.md\n\n4. **Sync with Remote**\n   - Run: `bd config set sync.branch beads-sync --json`\n   - Run: `bd sync --json` (commit and push to sync branch)\n   - Run: `bd migrate-sync --json` (migrate to sync workflow)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/sync.md\n\n5. **Branch-Aware Tracking**\n   - Create branch: `git checkout -b feature-branch`\n   - Create issues on branch\n   - Test merge behavior with JSONL conflicts\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/branching.md\n\n6. **Merge Resolution**\n   - Run: `bd merge --json` (JSONL merge driver)\n   - Run: `bd clean --json` (clean merge artifacts)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/merge-conflicts.md","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:34.30923294-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.15","title":"Evaluate search and filtering","description":"Test bd list, bd search, bd show, filtering by status/priority/type/labels, and count/stats commands\n\n## Recommended Learning Path\n\n1. **Basic Listing**\n   - Run: `bd list --json` (all issues)\n   - Run: `bd list --status open --json`\n   - Run: `bd list --priority 1 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#list\n\n2. **Advanced Filtering**\n   - Run: `bd list --status open --priority 1 --type bug --json`\n   - Run: `bd list --assignee @me --json`\n   - Run: `bd list --labels urgent,security --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/filtering.md\n\n3. **Text Search**\n   - Run: `bd search \"authentication\" --json`\n   - Run: `bd search \"bug\" --type bug --json`\n   - Run: `bd search \"security\" --priority 0 --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/search.md\n\n4. **Issue Details**\n   - Run: `bd show beads-testing-ca1.15 --json`\n   - Run: `bd show beads-testing-ca1.15 --with-comments --json`\n   - Run: `bd show beads-testing-ca1.15 --with-history --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#show\n\n5. **Counting and Statistics**\n   - Run: `bd count --json` (count all issues)\n   - Run: `bd count --status open --type bug --json`\n   - Run: `bd stats --json` (comprehensive statistics)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/analytics.md\n\n6. **Output Formatting**\n   - Compare: `bd list` vs `bd list --json`\n   - Test: `bd list --quiet --json`\n   - Try: `bd list --format table` (if available)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/output-formats.md","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:39.59544169-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.16","title":"Evaluate epic and hierarchical issues","description":"Test bd epic command, parent-child relationships, subtask creation with --parent flag, and hierarchical IDs\n\n## Recommended Learning Path\n\n1. **Creating Epics**\n   - Run: `bd create \"Major feature\" -t epic --json`\n   - Run: `bd epic create \"Large project\" --json`\n   - Observe epic-specific features and workflow\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/epics.md\n\n2. **Adding Subtasks**\n   - Run: `bd create \"Subtask 1\" --parent \u003cepic-id\u003e --json`\n   - Run: `bd create \"Subtask 2\" --parent \u003cepic-id\u003e --json`\n   - Note hierarchical IDs: epic-id.1, epic-id.2\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/hierarchical-issues.md\n\n3. **Nested Hierarchies**\n   - Create subtask of a subtask\n   - Run: `bd create \"Sub-subtask\" --parent \u003csubtask-id\u003e --json`\n   - Test multi-level IDs: epic-id.1.1\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/hierarchical-issues.md#nesting\n\n4. **Epic Management**\n   - Run: `bd epic list --json` (all epics)\n   - Run: `bd epic show \u003cepic-id\u003e --json` (with children)\n   - Run: `bd show \u003cepic-id\u003e --with-children --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#epic\n\n5. **Epic Progress Tracking**\n   - Run: `bd epic progress \u003cepic-id\u003e --json`\n   - Close subtasks and observe epic progress\n   - Test auto-completion when all subtasks done\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/epics.md#progress\n\n6. **Hierarchical Filtering**\n   - Run: `bd list --parent \u003cepic-id\u003e --json` (all children)\n   - Run: `bd list --type epic --json` (all epics)\n   - Test filtering by hierarchy level\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/filtering.md#hierarchy","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:44.846779881-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.17","title":"Evaluate comments and labels","description":"Test bd comment/comments commands and bd label management for organizing issues\n\n## Recommended Learning Path\n\n1. **Adding Comments**\n   - Run: `bd comment beads-testing-ca1.17 \"First comment\" --json`\n   - Run: `bd comments add beads-testing-ca1.17 \"Second comment\" --json`\n   - Test multi-line comments with quotes\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/comments.md\n\n2. **Viewing Comments**\n   - Run: `bd comments list beads-testing-ca1.17 --json`\n   - Run: `bd show beads-testing-ca1.17 --with-comments --json`\n   - Check comment metadata (author, timestamp)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/cli-reference.md#comments\n\n3. **Managing Comments**\n   - Run: `bd comments delete beads-testing-ca1.17 \u003ccomment-id\u003e --json`\n   - Run: `bd comments edit \u003ccomment-id\u003e \"Updated text\" --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/comments.md#management\n\n4. **Adding Labels**\n   - Run: `bd label add beads-testing-ca1.17 urgent --json`\n   - Run: `bd label add beads-testing-ca1.17 documentation testing --json`\n   - Create custom labels for organization\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/labels.md\n\n5. **Label Management**\n   - Run: `bd label list --json` (all labels in use)\n   - Run: `bd label remove beads-testing-ca1.17 urgent --json`\n   - Run: `bd list --labels urgent --json` (filter by label)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/labels.md#management\n\n6. **Organizing with Labels**\n   - Create label taxonomy (e.g., team:frontend, priority:urgent)\n   - Run: `bd list --labels team:frontend --json`\n   - Combine with other filters\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/labels.md#best-practices","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:50.026537472-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","comments":[{"id":13,"issue_id":"wf-ca1.17","author":"rogardle","text":"This task is interesting","created_at":"2025-12-24T00:43:53Z"}],"deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.18","title":"Evaluate daemon and performance","description":"Test bd daemon for background operations, RPC communication, and performance with large issue counts\n\n## Recommended Learning Path\n\n1. **Daemon Basics**\n   - Run: `bd daemon status --json` (check if running)\n   - Run: `bd daemon start --json` (start daemon)\n   - Run: `bd daemon stop --json` (stop daemon)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/daemon.md\n\n2. **Daemon Configuration**\n   - Run: `bd info --json` (shows daemon connection info)\n   - Test: `bd create \"Test\" --no-daemon --json` (bypass daemon)\n   - Check: `bd config get auto-start-daemon --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/daemon.md#configuration\n\n3. **Multiple Daemons**\n   - Run: `bd daemons list --json` (all running daemons)\n   - Test multiple project daemons\n   - Run: `bd daemons stop-all --json`\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/daemon.md#multiple-daemons\n\n4. **RPC Communication**\n   - Monitor daemon logs during operations\n   - Test concurrent operations from multiple terminals\n   - Verify background auto-flush\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/daemon.md#rpc\n\n5. **Performance Testing**\n   - Create 100+ issues: `for i in {1..100}; do bd create \"Test $i\" --json; done`\n   - Run: `bd stats --json` (performance with scale)\n   - Test: `bd list --json` (query performance)\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/performance.md\n\n6. **Troubleshooting**\n   - Run: `bd doctor --json` (health check)\n   - Run: `bd validate --json` (database validation)\n   - Check daemon logs for errors\n   - Documentation: https://github.com/steveyegge/beads/blob/main/docs/troubleshooting.md","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-15T15:49:55.263772097-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-ca1.2","title":"Evaluate perles (beads UI)","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-15T15:38:52.254683574-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-chore","title":"Ongoing Maintenance (Chore)","description":"An evergreen issue to act as an epic for maintenance tasks that come up during development.","status":"open","priority":2,"issue_type":"task","owner":"ross@gardler.org","created_at":"2026-01-19T03:47:03.163401798-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:47:03.163401798-08:00"}
{"id":"wf-chv","title":"Context command: make output idempotent by excluding generated CONTEXT_PACK.md from scan","description":"Problem: running 'waif context' overwrites or changes docs/dev/CONTEXT_PACK.md between runs because generated file is included in the scan. Fix scanDocs to ignore the generated output or ensure the context command writes deterministically. Acceptance: second run produces identical file to first run without requiring --force.","status":"open","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T20:28:42.385208784-08:00","created_by":"WAIF","updated_at":"2026-01-08T20:28:42.385208784-08:00","dependencies":[{"issue_id":"wf-chv","depends_on_id":"wf-8e9","type":"blocks","created_at":"2026-01-08T20:28:42.395021444-08:00","created_by":"WAIF"}]}
{"id":"wf-cnw","title":"Project Initialization: waif init","description":"# Project Initialization: `waif init`\n\n## Problem\nNew projects need a reproducible way to get WAIF’s local config and scripts in place so developers can start the WAIF workflow quickly. Copying required files (OpenCode plugin, `config/`, and `scripts/`) is currently manual and error-prone, delaying onboarding and increasing support requests.\n\n## Users\n- Primary: repository maintainers and developers who want to onboard WAIF into a new project quickly.\n- Secondary: PMs and agent operators who need predictable local environments for running agent-driven workflows and tests.\n\n## Success criteria\nRunning `cd project_dir; waif init; ./scripts/start-workflow-tmux.sh` starts a tmux session where panes are configured per `config/workflow_agents.yaml` and a full WAIF workflow environment (OpenCode plugin files, `config/`, and `scripts/`) is present. `waif init` is idempotent and safe to re-run. It must NOT copy `.beads/` (users should run `beads init` separately to create repository beads).\n\n## Constraints\n- Must NOT copy the repository’s `.beads/` folder.\n- Default behavior on conflicts: abort and explain how to use idempotent runs; do not overwrite silently.\n- Must not require elevated privileges or alter remote state; must be safe on repeated runs.\n- Must be compatible with existing `waif` CLI behavior and tests.\n\n## Existing state\n- `scripts/start-workflow-tmux.sh` (tmux startup script)\n- `config/workflow_agents.yaml` (tmux pane definitions)\n- `docs/dev/opencode_integration_PRD.md` (related setup PRD)\n- `docs/dev/context_pack_PRD.md` (related agent context PRD)\n- `docs/Workflow.md` (workflow guidance)\n\n## Desired change\nAdd a `waif init` CLI command that:\n- Runs `bd init --branch beads-wync --prefix \u003cprefix\u003e` in the target repo before copying files to create the beads sync worktree and avoid copying `.beads/`.\n- Copies the following template files into a target project: the entire `.opencode/` directory, `config/`, `scripts/`, and `docs/dev/`.\n- Do NOT copy `.beads/`.\n- Default conflict policy: abort with an explanation and guidance on idempotent re-runs.\n- Provide `--dry-run`, `--minimal` (only `config/`), and `--full` (config + scripts + `.opencode/` + `docs/dev/`) modes.\n- Optionally provide `--force-backup` for implementers to support backups (PRD will define exact flags).\n- Validate that `./scripts/start-workflow-tmux.sh` exists and is executable; output the command to start the workflow.\n\n## Likely duplicates / related docs\n- `docs/dev/opencode_integration_PRD.md`\n- `docs/dev/context_pack_PRD.md`\n- `docs/Workflow.md`\n- `config/workflow_agents.yaml`\n- `scripts/start-workflow-tmux.sh`\n- `config/waif_pacakges.yaml`\n\n## Related issues (Beads ids)\n- `wf-ba2.3.5` — Per-repo config file (template + lint rules)\n- `wf-jax`, `wf-jax.1` — Context/plugin PRD updates\n- `wf-moa` — Context pack default behavior\n- `wf-ba2.5.4.4` — Overflow handling for context pack\n\n## Clarifying questions\n1. Confirmed default file set: copy `.opencode/`, `config/`, `scripts/`, and `docs/dev/` (do not copy `.beads/`).\n2. Overwrite policy: default abort on conflict; PRD will define `--force-backup` and `--dry-run` flags.\n3. Modes: `--minimal` and `--full` are proposed; confirm names in PRD.\n4. Should `waif init` include a `--link` (symlink) mode? (default: no, copy only)\n5. Acceptance tests: include an E2E smoke test that runs `waif init` in a temp dir and asserts the presence of the expected files.\n6. Parenting: create standalone feature or attach to `wf-ba2.3.5` as parent? (left standalone)\n\n## Proposed next step\n- NEW PRD at: `docs/dev/waif_init_PRD.md`\n- Recommended next command (after bead creation): `/prd docs/dev/waif_init_PRD.md \u003cnew-issue-id\u003e`\n","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-30T22:37:36.515426006-08:00","updated_at":"2026-01-03T00:08:04.786966014-08:00","closed_at":"2026-01-03T00:08:04.786966014-08:00","close_reason":"Merged PR #94: description update landed","dependencies":[{"issue_id":"wf-cnw","depends_on_id":"wf-ba2.3.5","type":"related","created_at":"2025-12-30T22:37:44.440821101-08:00","created_by":"daemon"},{"issue_id":"wf-cnw","depends_on_id":"wf-jax","type":"related","created_at":"2025-12-30T22:37:44.549682051-08:00","created_by":"daemon"},{"issue_id":"wf-cnw","depends_on_id":"wf-jax.1","type":"related","created_at":"2025-12-30T22:37:44.612160291-08:00","created_by":"daemon"},{"issue_id":"wf-cnw","depends_on_id":"wf-moa","type":"related","created_at":"2025-12-30T22:37:44.670719121-08:00","created_by":"daemon"},{"issue_id":"wf-cnw","depends_on_id":"wf-ba2.5.4.4","type":"related","created_at":"2025-12-30T22:37:44.723204521-08:00","created_by":"daemon"},{"issue_id":"wf-cnw","depends_on_id":"wf-5e2","type":"blocks","created_at":"2025-12-31T13:50:11.322925671-08:00","created_by":"daemon"}],"comments":[{"id":79,"issue_id":"wf-cnw","author":"rgardler","text":"Changed description to include running 'bd init --branch beads-wync --prefix \u003cprefix\u003e' before waif init and to copy .opencode/, config/, scripts/, and docs/dev/. Commands run: wrote tmp/wf-cnw-desc-updated.md, bd update wf-cnw --description-file ./tmp/wf-cnw-desc-updated.md, bd sync. Files touched by this landing session: .beads/issues.jsonl (updated), .git/beads-worktrees/beads-sync/.beads/issues.jsonl (updated). Created a commit 'chore(bd): sync updated wf-cnw description from bd sync' and opened PR https://github.com/SorraTheOrc/waif/pull/94. Next: please review PR and merge when ready.","created_at":"2026-01-03T08:02:18Z"},{"id":80,"issue_id":"wf-cnw","author":"rgardler","text":"PR #94 merged. Description update landed; closing wf-cnw.","created_at":"2026-01-03T08:08:04Z"}]}
{"id":"wf-cof","title":"Make waif startWork run agents in foreground (no-daemon)","description":"What\\n- Implement Alternative A: ensure the  command (and any agent launcher invoked by it) runs the agent runtime in the foreground when started inside a tmux pane, avoiding immediate daemonization/forking. This guarantees the long-lived process in the pane keeps the canonical agent environment (BD_ACTOR/WAIF_AGENT/OPENCODE_AGENT) on its PID so probes (ooda) can reliably detect agent identity via /proc.\u003cnewline\u003e\u003cnewline\u003eWhy\\n- Problem: if the agent process daemonizes (forks), the PID visible to tmux may be a short-lived wrapper or shell; the actual agent process may have a different PID or environment, breaking /proc-based detection.\\n- Solution: add a no-daemon/foreground mode to startWork (honor BEADS_NO_DAEMON env or add --no-daemon flag) so the agent process remains the foreground process of the pane.\\n\\nScope (what this issue is NOT)\\n- Not changing production service behavior except when explicitly requested by pane startup scripts or interactive invocation. This is targeted at interactive tmux panes and dev/test runs.\\n\\nDeliverables\\n1) Code: Modify src/commands/startWork.ts to:\\n   - Honor an environment variable (BEADS_NO_DAEMON=1) or accept a flag (e.g., --no-daemon) to run the agent process in foreground (do not fork/daemonize).\\n   - Document behavior in command help and code comments.\\n2) Tests: Unit tests and/or integration tests that validate startWork launches an interactive shell process with environment vars set (mock spawn behavior). Add tests to tests/ to cover both normal and no-daemon behavior.\\n3) Docs: Update docs/Workflow.md (or add small doc) describing the no-daemon convention and when to use it.\\n4) Validation: Manual end-to-end test instructions and checklist (run scripts/start-workflow-tmux.sh then waif ooda --once and confirm mapping).\\n5) Beads cross-links: Link wf-cvz.1 and wf-vaq as related items.\\n\\nImplementation steps (suggested)\\n1) Design RFC (quick note in issue): choose runtime mechanism (env var vs flag). Recommend supporting BEADS_NO_DAEMON env var for minimal changes to startup scripts.\\n2) Code change: in src/commands/startWork.ts, when BEADS_NO_DAEMON=1 or --no-daemon passed, avoid any behavior that would background or exec a separate daemon process; ensure spawnSync/spawn usage preserves foreground process semantics. If the underlying agent runtime has a built-in daemon mode, pass a flag to disable it.\\n3) Tests: Add unit tests mocking child_process spawn/spawnSync to ensure the environment and command-line used when BEADS_NO_DAEMON=1 results in foreground process invocation and that the PID in the pane can be inspected.\\n4) Docs \u0026 startup: ensure scripts/start-workflow-tmux.sh sets BEADS_NO_DAEMON=1 when launching panes (already done in recent change) and document the expected behavior.\\n5) Validation: run start-workflow-tmux.sh on a Linux host and check inside a pane: patch and run Agent     | Status | Title                                                                                              \n----------+--------+----------------------------------------------------------------------------------------------------\nmuse      | Free   | Muse (Design)                                                                                      \nmap       | Free   | Map (PM)                                                                                           \nmuse      | Free   | Muse (Design)                                                                                      \npatch     | Free   | Patch (Impl)                                                                                       \nscribbler | Free   | Scribbler (Docs)                                                                                   \npixel     | Free   | Pixel (Art)                                                                                        \nprobe     | Free   | Probe (QA)                                                                                         \nship      | Free   | Ship (DevOps)                                                                                       to verify mapping.\\n6) Rollout: merge change behind a short migration note; this behavior only impacts interactive panes and should be safe for CI or server usage where daemonization may still be desired unless BEADS_NO_DAEMON is set.\\n\\nSuccess criteria\\n- When BEADS_NO_DAEMON=1 (or --no-daemon used),  runs as the foreground process (no immediate background daemonizing) and the PID of the pane process corresponds to the agent process that inherits BD_ACTOR/WAIF_AGENT.\\n- ooda probe maps panes to canonical agent names reliably in manual end-to-end tests.\\n- Tests added and passing locally (npm run build \u0026\u0026 npm test).\\n\\nOwner suggestion and schedule\\n- Owner: patch (implementation), map (PM) to coordinate and review docs.\\n- ETA: small change — 1-2 days for implementation, tests and PR review.\\n\\nRisks \u0026 mitigations\\n- Risk: Some use-cases expect daemonization (e.g., running agents under supervisor/daemon). Mitigation: this change is opt-in via env var or CLI flag — default behavior unchanged.\\n- Risk: Interactive shells or third-party tools may still background themselves. Mitigation: document the limitation; prefer process env detection as primary signal and maintain fallbacks.\\n\\nFollow-ups\\n- After merge, update scripts/start-workflow-tmux.sh and any pane spawners to set BEADS_NO_DAEMON for interactive panes (already changed in branch).\\n- Monitor any user reports about changed behavior and provide a rollback path (remove BEADS_NO_DAEMON export in startup scripts).\\n","notes":"Follow-up: implement no-daemon/foreground mode for waif startWork per plan. Created as follow-up to wf-cvz.1 spike; PR 58 merged with tmux exports. Next step: implement code and tests in src/commands/startWork.ts to honor BEADS_NO_DAEMON or --no-daemon. Owner: patch.","status":"open","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T20:47:39.845068725-08:00","updated_at":"2025-12-23T21:27:39.030160924-08:00","dependencies":[{"issue_id":"wf-cof","depends_on_id":"wf-cvz.1","type":"discovered-from","created_at":"2025-12-23T20:47:39.854039606-08:00","created_by":"daemon"}]}
{"id":"wf-cr4","title":"Docs: Add release checklist and publish steps","description":"Problem: Release owners need a concise, actionable checklist to perform reliable releases for this Node.js CLI project.\\n\\nUsers: Release agent (human or automated release agent) who performs or supervises releases.\\n\\nSuccess criteria:\\n- A single, easy-to-follow checklist in  that a release owner can follow to: bump version, run local quality gates, open PR, tag, publish artifact, and perform post-release verification.\\n- Checklist contains concrete commands that can be executed locally and automated in CI.\\n- Checklist documents publish options (npm vs GitHub Releases) and recommended CI enforcement checks.\\n\\nConstraints:\\n- Follow best practices for Node applications and existing project conventions (use  version as source of truth, use annotated tags like ).\\n- Do not change release tooling in this task (only documentation).\\n\\nExisting state:  contains an initial proposed release process but lacks a concise checklist and explicit publish commands.\\n\\nDesired change: Add a new \"Release Checklist\" section to  with step-by-step commands and CI guidance.\\n\\nRelated docs/issues:  (existing), epic  (Document Review).\\n\\nClarifying questions:\\n1) Should we recommend  for releases (default) or leave publish steps generic?\\n2) Do you want an example GitHub Actions workflow snippet included in this task or left for a follow-up?\\n\\nProposed next step: Update  to include the Release Checklist and small examples for  and Manage releases\n\nUSAGE\n  gh release \u003ccommand\u003e [flags]\n\nGENERAL COMMANDS\n  create:      Create a new release\n  list:        List releases in a repository\n\nTARGETED COMMANDS\n  delete:      Delete a release\n  delete-asset: Delete an asset from a release\n  download:    Download release assets\n  edit:        Edit a release\n  upload:      Upload assets to a release\n  view:        View information about a release\n\nFLAGS\n  -R, --repo [HOST/]OWNER/REPO   Select another repository using the [HOST/]OWNER/REPO format\n\nINHERITED FLAGS\n  --help   Show help for command\n\nLEARN MORE\n  Use `gh \u003ccommand\u003e \u003csubcommand\u003e --help` for more information about a command.\n  Read the manual at https://cli.github.com/manual commands. Then open a PR from .","notes":"PR: https://github.com/SorraTheOrc/waif/pull/11","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T21:44:21.510822947-08:00","updated_at":"2025-12-19T23:10:08.227179711-08:00","closed_at":"2025-12-19T23:10:08.227179711-08:00"}
{"id":"wf-cuq","title":"Epic: OODA Security Review \u0026 Threat Model","description":"Threat model and security hardening for OODA runner/snapshots","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-12T02:10:07.418624944-08:00","created_by":"WAIF","updated_at":"2026-01-12T02:10:07.418624944-08:00","dependencies":[{"issue_id":"wf-cuq","depends_on_id":"wf-e6r","type":"discovered-from","created_at":"2026-01-12T02:10:07.420798596-08:00","created_by":"WAIF"}]}
{"id":"wf-cvz","title":"ooda command that will monitor the state of the project and agents within it and periodicaly issue instructions: Intake brief","description":"\n\nMap session log (2025-12-23):\n- Actions executed:\n  - bd ready --json  # inspected ready queue\n  - bd update wf-cvz --status in_progress --json  # claimed this item for a tech spike\n  - bd show wf-cvz --json  # re-read issue state\n  - read: src/lib/bd.ts  # checked bd helper used for PRD linking fallback\n\n- Files/paths referenced during triage:\n  - docs/Workflow.md\n  - docs/dev/TUI_PRD.md\n  - docs/dev/CLI_PRD.md\n  - docs/dev/idle_scheduler_module.md\n  - .beads/issues.jsonl\n  - src/lib/bd.ts\n\n- Recommended immediate next steps (owner: ship):\n  1) Spike: probe local tmux to collect real pane data (run on a developer workstation, not on CI):\n     - Command to run interactively:\n       tmux list-panes -a -F '%#{session_name}:%#{window_index}.%#{pane_index} %#{pane_title} #{pane_pid}'\n     - For each pane PID, sample process state and CPU briefly:\n       ps -p \u003cpid\u003e -o pid,comm,stat,etimes,%cpu\n     - Save raw output to history/ooda_probe_1766538243.txt\n  2) Propose Busy/Free heuristics in a short note (history/ooda_heuristics.md):\n     - Primary: pane title keywords (busy, in_progress, running, agent-name) and presence of an active agent bd id\n     - Secondary: PID exists and %CPU\u003e0 or process state not 'S' (sleeping) within a 2s sample window\n     - Fallback: mark 'Free' if pane title contains 'idle' or is empty\n  3) Polling strategy:\n     - Default poll interval: 5s, with lightweight jitter + exponential backoff when no state changes for N cycles (N=12 -\u003e backoff to 60s)\n  4) Deliverables for spike (owner 'ship'):\n     - history/ooda_probe_\u003cts\u003e.txt (raw probe)\n     - history/ooda_heuristics.md (decision record)\n     - proof-of-concept script at scripts/ooda_probe.sh (small, non-invasive, read-only) with usage notes\n     - PRD draft: history/ooda_command_PRD.md capturing proposed lifecycle, UX (start/stop), and success criteria\n     - Post a brief bd comment on wf-cvz summarizing outcomes and link files\n\n- Success criteria for this iteration (spike complete):\n  - A working probe script prints a width-aware table: agent | Busy/Free | Title\n  - Probe artifacts saved to history/ and linked from bd notes\n  - Heuristics doc lists at least 2 reliable signals and a recommended default poll interval\n\n- Risks and mitigations:\n  - Risk: Pane title heuristics brittle — Mitigation: include PID/process checks as secondary signal and make heuristics configurable\n  - Risk: Running probes on production tmux may interfere — Mitigation: run spike on a dev workstation and keep probe read-only\n  - Risk: Automated 'waif ask' directives could conflict — Mitigation: keep first iteration read-only and defer automation policy to a later PRD\n\n- Hand-off / next owner recommendation:\n  - Owner: ship (continue spike). If ship is unavailable, Map will coordinate with Forge or a named human with terminal access.\n\nCommands executed in this session (for audit):\n- bd ready --json\n- bd update wf-cvz --status in_progress --json\n- bd show wf-cvz --json\n- read src/lib/bd.ts\n\nNo files were created or edited in this session. Planned files to be created by the spike (in history/):\n- history/ooda_probe_\u003cts\u003e.txt\n- history/ooda_heuristics.md\n- history/ooda_command_PRD.md\n- scripts/ooda_probe.sh (small shim script)\n\nMap will stand by to draft the PRD (history/ooda_command_PRD.md) once raw probe output and heuristics are posted.  ","notes":"Map: Per user request, assigned wf-cvz to 'ship' to run a technical feasibility spike and/or pilot integration. Actions performed: bd ready --json; bd update wf-cvz (initial notes); repo grep for 'ship' references. Files referenced: docs/Workflow.md, docs/dev/TUI_PRD.md, docs/dev/CLI_PRD.md, docs/dev/idle_scheduler_module.md, .beads/issues.jsonl. Outstanding risks: start/stop UX undefined; Busy/Free heuristics brittle if based only on tmux titles; automation risk when sending 'waif ask'—need curation. Recommended next steps for ship: 1) run a quick probe to list tmux panes and their titles on a dev machine; 2) propose Busy heuristics and poll interval; 3) decide whether PRD draft should live in history/docs and hand back to Map for PRD writing. Map will stand by for follow-up. Recorded by Map.","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-22T16:02:37.969539666-08:00","updated_at":"2025-12-30T01:32:00.584481772-08:00","closed_at":"2025-12-30T01:32:00.584486983-08:00","dependencies":[{"issue_id":"wf-cvz","depends_on_id":"wf-gn7","type":"blocks","created_at":"2025-12-24T12:43:14.917518999-08:00","created_by":"daemon"}],"comments":[{"id":16,"issue_id":"wf-cvz","author":"map","text":"Linked PRD: docs/dev/prd-ooda-loop.md","created_at":"2025-12-24T01:11:37Z"},{"id":17,"issue_id":"wf-cvz","author":"map","text":"Created child issues for implementation: wf-1ne (probe spike), wf-czs (CLI), wf-367 (heuristics), wf-5w2 (logging), wf-ij4 (tests \u0026 QA). Owner set to patch.","created_at":"2025-12-24T01:13:30Z"},{"id":18,"issue_id":"wf-cvz","author":"map","text":"Assigned owners to child issues: wf-1ne -\u003e ship, wf-czs -\u003e patch, wf-367 -\u003e forge, wf-5w2 -\u003e patch, wf-ij4 -\u003e qa","created_at":"2025-12-24T01:14:46Z"},{"id":19,"issue_id":"wf-cvz","author":"map","text":"Replaced flat follow-ups with hierarchical children: wf-cvz.1 (probe), wf-cvz.2 (CLI), wf-cvz.3 (Heuristics), wf-cvz.4 (Logging), wf-cvz.5 (Tests \u0026 QA).","created_at":"2025-12-24T01:18:40Z"},{"id":20,"issue_id":"wf-cvz","author":"map","text":"Closed original flat follow-ups (wf-1ne, wf-czs, wf-367, wf-5w2, wf-ij4) in favor of hierarchical children wf-cvz.1..wf-cvz.5.","created_at":"2025-12-24T01:20:07Z"},{"id":22,"issue_id":"wf-cvz","author":"map","text":"Delegation record: Patch was sent a live prompt to implement wf-cvz.1 (npm run start -- ask patch to /implement wf-cvz.1). PR currently at https://github.com/SorraTheOrc/waif/pull/58 per wf-cvz.1 notes. Map updated wf-2ia to dedupe prior duplicate entries.","created_at":"2025-12-24T01:40:07Z"}]}
{"id":"wf-cvz.1","title":"Spike: collect tmux probe data for ooda","description":"Run non-invasive tmux probes, save raw output to history/ooda_probe_\u003cts\u003e.txt, and produce history/ooda_heuristics.md. Owner: ship.","notes":"Implemented /proc-based agent detection for ooda probe:\\n- Added getAgentFromProc to prefer BD_ACTOR/WAIF_AGENT/OPENCODE_AGENT from /proc/\u003cpid\u003e/environ and fallback to cmdline flags.\\n- listPanes now prefers process-based identity, then workflow_agents.yaml window disambiguation, then .opencode/agent_map.yaml, then raw pane/window name.\\n- Tests added: tests/ooda-mapping.test.ts.\\n- Files edited/added: src/commands/ooda.ts, tests/ooda-mapping.test.ts.\\nNext: update start-workflow-tmux to export BD_ACTOR in pane envs (recommended) and implement wf-cvz.2 CLI polish.\\nRisks: /proc is Linux-specific; probe will gracefully fall back on other platforms.\\n,--json:true","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T17:18:26.954095437-08:00","updated_at":"2025-12-23T20:53:15.681232809-08:00","closed_at":"2025-12-23T20:53:15.681232809-08:00","close_reason":"Spike implemented and PR merged: ooda probe, tmux env exports, docs","external_ref":"PR: https://github.com/SorraTheOrc/waif/pull/58","dependencies":[{"issue_id":"wf-cvz.1","depends_on_id":"wf-cvz","type":"parent-child","created_at":"2025-12-23T17:18:26.955082547-08:00","created_by":"daemon"}],"comments":[{"id":21,"issue_id":"wf-cvz.1","author":"patch","text":"Spike draft artifacts added:\n- scripts/ooda_probe.sh (read-only tmux probe with Busy/Free heuristics, logging, sample mode)\n- history/ooda_probe_1766540000.txt (sample run)\n- history/ooda_heuristics.md (heuristics and interval/backoff defaults)\n- history/ooda_command_PRD.md (v0 lifecycle/UX draft)\n","created_at":"2025-12-24T01:34:02Z"}]}
{"id":"wf-cvz.2","title":"Implement CLI: waif ooda start/stop and logging","description":"Implement CLI surface and flags: --interval, --log, --once. Ensure graceful failure when tmux missing. Owner: patch.","notes":"Set to in_progress per Producer request. Context: previous session aborted then landed; preserved branch created origin/feature/wf-cvz.2-ooda-cli.landed and local feature/wf-cvz.2-ooda-cli was deleted. Files referenced: src/commands/ooda.ts, .beads/issues.jsonl. PR #60 (https://github.com/SorraTheOrc/waif/pull/60) was closed. Remaining follow-ups: (1) implement fix for agent mapping/status reporting (ooda mapping), (2) add unit test(s) for mapping edge cases, (3) decide whether to continue on preserved branch or create a fresh branch. Commands executed in landing session: git reset, git pull, bd sync, git push, gh pr create/close, git branch rename/push, git branch -D. See history/ for planning notes if needed.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T17:18:29.800589245-08:00","updated_at":"2025-12-29T23:21:53.921466638-08:00","closed_at":"2025-12-29T23:21:53.921473138-08:00","dependencies":[{"issue_id":"wf-cvz.2","depends_on_id":"wf-cvz","type":"parent-child","created_at":"2025-12-23T17:18:29.813270648-08:00","created_by":"daemon"},{"issue_id":"wf-cvz.2","depends_on_id":"wf-r1d","type":"blocks","created_at":"2025-12-26T17:54:13.203448655-08:00","created_by":"daemon"}],"comments":[{"id":26,"issue_id":"wf-cvz.2","author":"patch","text":"Aborting work and removing branch per Producer request; preserve branch history if needed. Files changed: src/commands/ooda.ts. PR: https://github.com/SorraTheOrc/waif/pull/60","created_at":"2025-12-24T21:51:21Z"},{"id":50,"issue_id":"wf-cvz.2","author":"map","text":"Added dependency: wf-r1d is now a blocker for wf-cvz.2. See history/bd-comment-wf-cvz.2.add-dep-wf-r1d.txt for details.","created_at":"2025-12-27T01:54:39Z"}]}
{"id":"wf-cvz.3","title":"Heuristics: define and unit-test Busy/Free rules","description":"Codify heuristics and add unit tests with simulated tmux outputs. Owner: forge.","notes":"Map: delegated /implement wf-cvz.3 to Probe (QA) via 'waif ask'. Commands executed: 1) bd show wf-cvz.3 --json 2) WAIF_TMUX_PANES=$'waif-workflow:specialist.1\\tProbe (QA)' npx tsx src/index.ts ask probe to /implement wf-cvz.3 --json. Ask log: /home/rgardler/.waif/logs/ask.log. Files referenced: .beads/issues.jsonl, .opencode/command/implement.md, .opencode/agent/probe.md. Files created/edited: none. Next actions: Probe should claim the issue (bd update wf-cvz.3 --status in_progress --assignee probe) and post PR URL when available. Remaining risks: none immediate; confirm Probe availability and tmux session access.","status":"closed","priority":1,"issue_type":"task","assignee":"forge","created_at":"2025-12-23T17:18:32.649434435-08:00","updated_at":"2025-12-29T23:21:43.689761003-08:00","closed_at":"2025-12-29T23:21:43.689836405-08:00","dependencies":[{"issue_id":"wf-cvz.3","depends_on_id":"wf-cvz","type":"parent-child","created_at":"2025-12-23T17:18:32.677337914-08:00","created_by":"daemon"}]}
{"id":"wf-cvz.4","title":"Logging: implement history/ persisted logs and redaction policy","description":"Implement --log behavior, file naming, permissions, and a redaction policy. Owner: patch.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T17:18:35.153091923-08:00","updated_at":"2025-12-29T23:22:05.072233094-08:00","closed_at":"2025-12-29T23:22:05.072237694-08:00","dependencies":[{"issue_id":"wf-cvz.4","depends_on_id":"wf-cvz","type":"parent-child","created_at":"2025-12-23T17:18:35.160657132-08:00","created_by":"daemon"}]}
{"id":"wf-cvz.5","title":"Tests \u0026 QA: integration tests and manual acceptance","description":"Add integration tests for tmux parsing, CLI flags, and logging. Include manual acceptance checklist. Owner: qa.","status":"closed","priority":1,"issue_type":"task","assignee":"qa","created_at":"2025-12-23T17:18:37.837378405-08:00","updated_at":"2025-12-29T23:22:10.71968525-08:00","closed_at":"2025-12-29T23:22:10.719690549-08:00","dependencies":[{"issue_id":"wf-cvz.5","depends_on_id":"wf-cvz","type":"parent-child","created_at":"2025-12-23T17:18:37.850699698-08:00","created_by":"daemon"}]}
{"id":"wf-czs","title":"Implement CLI: waif ooda start/stop and logging","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-23T17:13:20.577208208-08:00","updated_at":"2025-12-23T17:19:54.928643931-08:00","closed_at":"2025-12-23T17:19:54.928643931-08:00","close_reason":"Replaced by hierarchical child wf-cvz.2","dependencies":[{"issue_id":"wf-czs","depends_on_id":"wf-cvz","type":"discovered-from","created_at":"2025-12-23T17:13:20.583280287-08:00","created_by":"daemon"},{"issue_id":"wf-czs","depends_on_id":"wf-cvz","type":"blocks","created_at":"2025-12-23T17:16:34.70448272-08:00","created_by":"daemon"}]}
{"id":"wf-d0y","title":"Integration \u0026 CI: wf-e6r.1 tests","description":"Implement integration E2E tests that exercise the scheduler and run-job end-to-end in a sandboxed CI environment. Deliverables:\\n- Integration test(s) that run a mock scheduled job and assert snapshot JSONL content and retention.\\n- CI workflow or runner config that runs the E2E in isolation (coordinate with @ship for runner selection).\\n- Documentation on how to run the E2E locally and in CI.","notes":"PR #122 fixed CI uploads; see workflow run https://github.com/SorraTheOrc/waif/actions/runs/21019385657 and PR #122 merged. Probe: please re-run verification and close wf-0rf when satisfied.","status":"closed","priority":1,"issue_type":"task","assignee":"ship","created_at":"2026-01-12T20:09:05.233499156-08:00","created_by":"WAIF","updated_at":"2026-01-14T20:09:37.856951463-08:00","closed_at":"2026-01-14T19:04:17.657563847-08:00","close_reason":"PR #112 merged; E2E PR merged and validated","labels":["owner:probe","owner:ship"],"dependencies":[{"issue_id":"wf-d0y","depends_on_id":"wf-e6r.1.2","type":"discovered-from","created_at":"2026-01-12T20:09:05.237960458-08:00","created_by":"WAIF"}],"comments":[{"id":162,"issue_id":"wf-d0y","author":"rgardler","text":"Picked up wf-d0y and started work. Initial commands run:\n\n- git fetch origin\n- git checkout wf-d0y/ci-sandbox || git checkout -b wf-d0y/ci-sandbox origin/main\n- git status --porcelain\n\nCommand output (exact):\nAlready on 'wf-d0y/ci-sandbox'\nM\t.opencode/agent/beta.md\nM\t.opencode/agent/build.md\nM\t.opencode/agent/forge.md\nM\t.opencode/agent/muse.md\nM\t.opencode/agent/patch.md\nM\t.opencode/agent/pixel.md\nM\t.opencode/agent/probe.md\nM\t.opencode/agent/scribbler.md\nM\t.opencode/agent/ship.md\nM\t.opencode/command/design.md\nM\t.opencode/command/doc.md\nM\t.opencode/command/implement.md\nM\t.opencode/command/intake.md\nM\t.opencode/command/landThePlane.md\nM\t.opencode/command/milestones.md\nM\t.opencode/command/plan.md\nM\t.opencode/command/prd.md\nM\t.opencode/command/review.md\nM\t.opencode/command/testplan.md\nM\t.opencode/command/wf-help.md\n?? .opencode/command/refactor.md\n?? history/ooda_snapshot_1768295898251.jsonl\n?? history/ooda_snapshot_1768295899148.jsonl\n\nI claimed the bead (bd update wf-d0y --status in_progress) and will proceed with implementing tests + CI workflow. Files added in this session:\n- tests/integration/ooda-scheduler-e2e.test.ts\n- .github/workflows/ooda-e2e.yml\n- history/wf-d0y-E2E.md\n\nNext steps: run local tests (npm ci \u0026\u0026 npm test) to validate. PR opened: https://github.com/SorraTheOrc/waif/pull/112\n","created_at":"2026-01-14T04:05:50Z"}]}
{"id":"wf-d3r","title":"Record: add /help command summary","description":"Add .opencode/command/help.md implementing /help that prints a concise Markdown summary of docs/dev/Workflow.md. Files: .opencode/command/help.md, .beads/issues.jsonl. PR: https://github.com/SorraTheOrc/waif/pull/97","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-07T19:47:22.481434239-08:00","created_by":"WAIF","updated_at":"2026-01-07T20:05:29.493999439-08:00","closed_at":"2026-01-07T20:05:29.493999439-08:00","close_reason":"Merged PR #97"}
{"id":"wf-dak","title":"Agent-specific waif next","description":"# Agent-specific waif next\n\n- Problem\n  waif next currently recommends a single \"best\" open, unblocked issue for the invoking user. There is no first-class way to request recommendations tailored for a specific agent persona (e.g., map, patch, probe), which reduces precision when agents are invoked directly or when a producer needs agent-aware suggestions.\n\n- Users\n  - Primary: agent runtimes and agent operators invoking waif next for a named agent (e.g., map, patch).\n  - Secondary: Producers/PMs who want a deterministic way to ask \"what should this agent work on next?\"\n\n- Success criteria\n  1. CLI: Add --agent \u003cname\u003e to waif next such that:\n     - When called with --agent \u003cname\u003e, waif next filters candidate issues by assignee === \u003cname\u003e and uses the existing waif selection heuristics only on that filtered set.\n     - If one or more issues are assigned to \u003cname\u003e, waif next returns the selected assigned issue (human one-row table annotated with agent and short rationale; --json returns the issue object augmented with a waif metadata key as before).\n     - If zero issues are assigned to \u003cname\u003e, waif next prints a clear message: \"No assigned issues for \u003cname\u003e\" and exits with a non-error status (and --json returns an object noting no_assigned: true).\n     - Behavior is deterministic for a given bd state and input (same inputs + unchanged bd state -\u003e same result).\n  2. Tests \u0026 docs: Unit/integration tests covering the new flag, the assigned-filtering behavior, and the \"no assigned issues\" response; CLI docs (README and docs/dev/CLI_PRD.md) updated with examples.\n  3. Backwards compatibility: Default waif next behavior (no --agent) remains unchanged.\n\n- Heuristics (applied order -- conservative, explainable)\n  1. Primary filter: assignee === \u003cagent\u003e (only consider assigned issues).\n  2. If assigned issues exist: apply the existing waif heuristics (priority, blockers, issue_type, recent activity) to pick the best assigned issue.\n  3. If no assigned issues exist: do not fall back to label mapping -- report \"No assigned issues for \u003cagent\u003e\".\n\n- Constraints\n  - Keep heuristics conservative and explainable (no heavy ML or opaque scoring). Use repo-available signals only (beads metadata, labels, assignee, recent comments).\n  - Respect ignore boundaries and agent safety rules (no secret/excluded-file exposure).\n  - Do not change existing default behavior unless --agent is used.\n  - Implementation should be testable without modifying remote Beads state.\n\n- Risks \u0026 assumptions (short bullets)\n  - Risks:\n    - Misattribution: assignees may be out-of-date or not reflect agent capability, causing false negatives.\n    - Agent idle state: many agents may have no assigned tasks at any given time; the CLI must clearly indicate that state.\n  - Assumptions:\n    - Beads metadata (assignee) is the primary, accepted signal for agent targeting for this phase.\n    - Label-\u003eagent mapping and any fallback heuristics will be designed and implemented later once conventions are agreed.\n\n- Existing state (relevant artifacts found)\n  - README.md (waif next description)\n  - src/commands/next.ts (current implementation surface for waif next)\n  - docs/dev/prd/TUI_PRD.md (references waif next / CLI interactions)\n  - .opencode/command/prd.md (PRD authoring command template / interview rules)\n  - .beads/issues.jsonl (existing beads; related issues exist for waif next enhancements)\n  - Existing related beads: wf-3ur.1 (add -n), wf-4y2 (clipboard behavior), wf-64m (cross-command UX)\n\n- Likely duplicates / related docs (files I read)\n  - README.md -- CLI overview \u0026 waif next description\n  - src/commands/next.ts -- implementation referenced for changes\n  - docs/dev/prd/TUI_PRD.md -- TUI PRD that references waif next workflows\n  - .opencode/command/prd.md -- PRD authoring spec (process conventions)\n  - .beads/issues.jsonl -- beads DB (I scanned for related issues)\n\n- Related issues (Beads ids)\n  - wf-3ur.1 -- \"Add --number/-n option to 'waif next'\"\n  - wf-4y2 -- \"waif next copies recommended issue ID to clipboard\"\n  - wf-64m -- \"CLI: when 'waif in-progress' finds no in_progress items, inform user and run 'waif next'\"\n  - wf-3ur.2 -- \"Add workflow stage tracking to WAIF CLI: Intake brief\"\n\n- Recommended next step\n  - UPDATE PRD at: docs/dev/CLI_PRD.md (seed or update the CLI PRD with the agent-aware waif next spec and acceptance criteria above). After PRD update, open or link an implementation bead (feature) that references this PRD and includes tests/README updates.\n","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-07T22:44:59.583577243-08:00","created_by":"WAIF","updated_at":"2026-01-07T22:44:59.583577243-08:00","labels":["stage:in_progress"],"dependencies":[{"issue_id":"wf-dak","depends_on_id":"wf-3ur","type":"parent-child","created_at":"2026-01-19T03:53:06.474687314-08:00","created_by":"WAIF"}]}
{"id":"wf-dqn","title":"Implement /implement command argument handling and fallback logic","description":"Problem\n\nThe WAIF CLI lacks a well-defined `/implement` command flow for agents to start implementation work tied to a Beads issue. Users expect `/implement \u003cbd-id\u003e` to claim and begin work; when no id is provided the command should detect the current in-progress bead (via `waif in-progress`) and fall back to `waif next` if nothing is in progress. If no id can be determined, the command should ask the user for the missing id and abort. The current repo has related commands (in-progress, next) but the intended `/implement` behavior and argument-handling rules are not captured in a single, testable implementation.\n\nUsers\n\n- Primary: AI agents and developers invoking the WAIF CLI to begin work tied to Beads issues.\n- Secondary: PMs and reviewers who rely on consistent branch \u0026 bd workflows.\n\nSuccess criteria\n\n- `/implement \u003cbd-id\u003e` accepts an explicit bead id and proceeds to create the topic branch and claim the issue (no merge/close).\n- If run without arguments: command runs the existing `waif in-progress`; if that returns an issue id, use it. If not, run `waif next` and use that id.\n- If no id can be determined after the above, the command prompts the user for the id and exits without making changes.\n- The command enforces the repo safety gate: if working tree is dirty, it stops and describes options (A–E) rather than making changes.\n- Unit/integration tests cover the three main flows: explicit id, auto-detect fallback to in-progress-\u003enext, and the 'no id' prompting behavior.\n\nConstraints\n\n- Must use `bd` for all issue tracking. Do not create markdown TODO lists.\n- Keep changes minimal and scoped to command arg handling and safety gate logic.\n- Follow existing branch naming and commit rules: do not commit directly to main; create a topic branch per issue.\n- Do not close the Beads issue until the PR is merged.\n\nExisting state\n\n- Existing CLI commands live under `src/commands/` (e.g., `inProgress.ts`, `next.ts`, `startWork.ts`).\n- No dedicated `/implement` command exists yet.\n- Relevant docs: `AGENTS.md`, `.github/copilot-instructions.md`, and `.opencode/command/intake.md` describe expectations for agent-driven workflows.\n\nDesired change\n\n- Add a new CLI command `implement` (e.g., `src/commands/implement.ts`) that implements the argument handling and safety gate described above.\n- Add tests under `tests/` covering argument parsing and the three canonical flows.\n- Update docs or add a short note in `docs/Workflow.md` or `AGENTS.md` if required to reflect the new command behavior.\n\nLikely duplicates / related docs\n\n- docs/Workflow.md\n- AGENTS.md\n- .github/copilot-instructions.md\n- .opencode/command/intake.md\n\nRelated issues\n\n- No obvious existing issue implements this exact behavior (search done prior to creation).\n\nClarifying questions\n\n1. Should the command automatically create the branch from `origin/main` (recommended) or from the current branch when the repo is ahead/uncommitted? (Default: create from `origin/main` and carry uncommitted changes onto the new branch.)\n2. When invoking interactive prompt for missing id, should the CLI offer a list of `bd ready` candidates or only accept a typed id? (Default: accept typed id; later enhancement could offer candidate selection.)\n3. Are there naming conventions for the new branch beyond including the bd id? Suggested: `feature/\u003cbd-id\u003e/\u003cshort-desc\u003e` or `bug/\u003cbd-id\u003e/\u003cshort-desc\u003e` depending on issue type.\n\nProposed next step\n\n- Create this Beads feature (this issue) and start a small implementation PR that:\n  1) Adds `src/commands/implement.ts` with the arg handling logic and safety gate checks.\n  2) Adds tests verifying behavior.\n  3) Creates a topic branch following the naming conventions and claims the bd issue when implementation begins.\n\nThis issue is intended to be the parent work item; implementation should create any follow-up tasks (tests, docs) as discovered-from dependencies.\n","notes":"Merged and landed via PR #79","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-30T01:36:41.551850098-08:00","updated_at":"2025-12-30T01:54:24.315452147-08:00","closed_at":"2025-12-30T01:54:24.315459175-08:00","external_ref":"gh-79"}
{"id":"wf-dqud","title":"Code: replace payload.waif metadata key to payload.wf where appropriate","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-16T17:39:39.681964908-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:39:39.681964908-08:00","dependencies":[{"issue_id":"wf-dqud","depends_on_id":"wf-k5um.7","type":"discovered-from","created_at":"2026-01-16T17:39:39.685179475-08:00","created_by":"WAIF"},{"issue_id":"wf-dqud","depends_on_id":"wf-chore","type":"parent-child","created_at":"2026-01-19T03:52:22.068246167-08:00","created_by":"WAIF"}]}
{"id":"wf-dr1","title":"MVP: Show in-progress beads in waif next","description":"## Feature Request\n\nIn waif next, if there are any beads with status in_progress, display them in a table before the normal next-issue recommendation output.\n\nThe table info includes: ID, Title, Priority, Blockers (count), Assignee.\n\nThe code that renders the table must live in a reusable function so other commands/features can reuse it.\n\n## Motivation\n\nSurface active work immediately to avoid starting duplicate work and to encourage finishing in-flight items.\n\n## Use Cases\n\n1. Running waif next shows what is already in progress.\n2. Users avoid starting work already owned by someone else.\n\n## Proposed Solution\n\n- Query beads for in-progress issues at the start of waif next.\n- If any exist, print an In Progress section containing a table with the required columns.\n- Then print the existing next recommendation output unchanged.\n","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/5","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-19T09:21:08.550415219-08:00","updated_at":"2025-12-19T11:10:03.19560855-08:00","closed_at":"2025-12-19T11:10:03.195614377-08:00","labels":["feature"]}
{"id":"wf-dre","title":"ooda: stream-read .opencode/logs/events.jsonl to avoid OOM","description":"Replace readOpencodeEvents with a streaming implementation that parses the JSONL line-by-line and builds the latest-per-agent map without loading the entire file into memory. Also update dist build and tests.","acceptance_criteria":"1) readOpencodeEvents must use stream/readline and return parsed array or latest-per-agent map without reading the entire file into memory. 2) Unit tests updated to cover streaming behavior and existing callers unchanged. 3) Tests pass.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-27T20:44:08.809853397-08:00","updated_at":"2025-12-28T14:22:03.311047777-08:00","closed_at":"2025-12-28T14:22:03.311047777-08:00","close_reason":"Implemented streaming reader; tests pass"}
{"id":"wf-dt1","title":"Evaluate beads for issue tracking","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-16T16:30:48.189041177-08:00","updated_at":"2025-12-19T10:49:47.930625491-08:00","closed_at":"2025-12-19T10:49:47.930631533-08:00","labels":["Chore"]}
{"id":"wf-dt1.4","title":"Explore beads examples repository","description":"Review and learn from the example projects in https://github.com/steveyegge/beads/tree/main/examples\n\nThis will help understand real-world beads usage patterns and best practices.\n\n## Examples to Review:\n\n1. **Basic Examples**: Simple issue creation and management workflows\n2. **Integration Examples**: How beads integrates with other tools\n3. **Workflow Examples**: Complete development workflows using beads\n4. **Advanced Patterns**: Complex dependency graphs, epic management, etc.\n\n## Goals:\n\n- Understand common usage patterns\n- Learn best practices from example code\n- Identify useful patterns to apply in our evaluation\n- Document any interesting findings or techniques","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-16T16:54:22.459728697-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-dt1.6","title":"Evaluate beads-tui","description":"Evaluate https://github.com/andynu/beads-tui for suitability with this project: install/run notes, key features, UX, and how it compares to other beads UIs.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-17T09:50:33.00029606-08:00","updated_at":"2025-12-18T13:45:05.826156917-08:00","deleted_at":"2025-12-18T13:45:05.826156917-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-dzmc","title":"ooda: default 'waif ooda' to run scheduler subcommand","description":"Make the top-level 'waif ooda' command default to running the 'scheduler' subcommand when no subcommand is provided.\\n\\nAcceptance criteria:\\n1) Running 'waif ooda' with no additional args is equivalent to 'waif ooda scheduler' (same options behavior).\\n2) No change to existing subcommands or their flags.\\n3) Unit test added to cover default behavior.\\n4) Update docs/usage/ooda.md to mention the default.\\n\\nImplementation notes:\\n- Implement by invoking the scheduler action when the root command is executed without subcommands, or by setting up commander to forward to 'scheduler'.\\n- Prefer keeping scheduler logic in one place: factor scheduler action into a callable function and reuse it for the root action.\\n- Use branch naming convention: wf-9ujx.default-ooda-scheduler.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T22:33:47.730523948-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:42:04.395884923-08:00","closed_at":"2026-01-14T22:42:04.395884923-08:00","close_reason":"Merged in PR #125"}
{"id":"wf-e6r","title":"Cron-style OODA Scheduler","description":"# Cron-style OODA Scheduler — Full Specification\n\n## Problem\n\nThe current OODA implementation (tmux/probe + event-driven hybrid) must be replaced with a single, cron-style scheduler that executes configured commands on a schedule, produces sanitized, auditable snapshots to `history/`, and becomes the canonical OODA implementation. The legacy tmux/probe and mixed event-driven wiring should be removed once the new scheduler is verified.\n\n## Users\n\n- Primary: Operators, Producers, and automation workflows needing periodic, reproducible probes or scheduled checks for situational awareness.\n- Secondary: Developers and CI owners who want deterministic scheduled runs and historical snapshots for audits and alerts.\n\n## Success criteria\n\n1) Scheduler reliably runs configured commands on schedule and appends sanitized JSONL snapshots to `history/` with shape:\n\n   { \"time\":\"\u003cISO8601\u003e\", \"job_id\":\"\u003cid\u003e\", \"name\":\"\u003cname\u003e\", \"command\":\"\u003ccmd\u003e\", \"exit_code\":0, \"status\":\"success|failure|timeout\", \"summary\":\"\u003cshort\u003e\", \"sanitized_output\":\"\u003ctrimmed/redacted text\u003e\" }\n\n2) Config-driven schedules using cron syntax stored at `.waif/ooda-scheduler.yaml` (entries: `id`, `name`, `command`, `schedule`, `cwd?`, `env?`, `capture: [stdout,stderr]`, `redact: true`, `retention: { keep_last:100 }`).\n\n3) Remove all traces of the current OODA functionality from code, tests and docs (code paths, tests, docs referencing legacy tmux/probe logic must be removed or replaced) as part of the rollout/cleanup acceptance.\n\n4) Safe-by-default: sanitizer/redaction MUST reuse `src/lib/redact.ts`; never persist secrets or full message bodies. Default execution: repo-trusted, run as current user; per-job timeout default 60s (configurable).\n\n5) Observability and CI:\n   - CLI: `waif ooda schedule start|stop|run|status`; map `waif ooda --once` semantics to job runs for compatibility.\n   - Per-run logs, exit codes, and retention enforcement; optional `--log \u003cpath\u003e` that appends to `history/ooda_scheduler_\u003cjob\u003e.jsonl`.\n   - Tests: unit tests for scheduler logic; integration tests for run/write; CI E2E that runs a mock job and asserts snapshot creation.\n\n6) Rollout \u0026 migration:\n   - Implement the scheduler and tests on a feature branch; verify via CI E2E (mock job) and manual acceptance (`waif ooda schedule run \u003cid\u003e`).\n   - After verification, remove legacy code/tests/docs either in the same EPIC PR or via a paired cleanup PR linked in the epic; the removal is a required acceptance step.\n\n## Constraints\n\n- Must obey `.gitignore` and context-pack redaction rules; never persist secrets.\n- Default config path: `.waif/ooda-scheduler.yaml` (recommend file-permissions guidance in docs: `chmod 600`).\n- Default per-job timeout: 60s (overridable in config).\n- Retention default: `keep_last = 100` snapshots per job.\n- Scheduler MUST NOT invoke OpenCode slash-commands or agents.\n- Implementation must be idempotent; replacement goes live only after tests and manual acceptance.\n\n## Existing state (relevant)\n\n- `docs/dev/prd-ooda-loop.md` (current PRD to update)\n- `docs/dev/ooda_implementation_plan.md` (implementation plan)\n- `src/commands/ooda.ts` (current implementation to replace/refactor)\n- `.opencode/plugin/waif-ooda.ts` (plugin: review/retire as needed)\n- `src/lib/redact.ts` (redaction helper to reuse)\n- `tests/ooda*.test.ts` (update/remove as required)\n- `history/` pattern for snapshots exists (new snapshots to follow `history/ooda_scheduler_\u003cjob\u003e.jsonl` pattern)\n- Beads parent/related: `wf-r1d`, `wf-r1d.5`, `wf-cvz.*`, `wf-ss7.*`, `wf-gmn`, `wf-xcq`.\n\n## Desired change (high-level)\n\nReplace existing OODA with Cron-style OODA Scheduler:\n\n- CLI and UX: `waif ooda schedule start|stop|run|status`; map `waif ooda --once/--json` semantics to job runs.\n- Config: `.waif/ooda-scheduler.yaml` (cron syntax); validate schema on load and warn on suspicious patterns.\n- Execution: run jobs on schedule, enforce timeout, capture stdout/stderr, sanitize output using `src/lib/redact.ts`, append JSONL snapshot to `history/`, and enforce retention policy.\n- Operators: immediate run (`waif ooda schedule run \u003cid\u003e`) for CI/testing and a safe enable/disable path.\n- Tests \u0026 CI: unit tests, integration tests, and CI E2E; include redaction unit tests for common secret patterns.\n- Cleanup: identify and remove or refactor legacy tmux/probe codepaths, tests, and docs after new implementation verification.\n\n## Files likely to be updated/removed (implementation owner to verify)\n\n- `docs/dev/prd-ooda-loop.md` (update canonical PRD)\n- `docs/dev/ooda_implementation_plan.md`\n- `src/commands/ooda.ts`\n- `.opencode/plugin/waif-ooda.ts`\n- `tests/ooda.*.test.ts` (add scheduler tests; remove legacy tests)\n- `history/ooda_scheduler_\u003cjob\u003e.jsonl` pattern and retention enforcer\n- `docs/Workflow.md`, `README.md` (CLI examples)\n\n## Risks \u0026 assumptions\n\nRisks\n- Unsafe command execution: scheduled jobs can run arbitrary shell commands; require operator guidance and config permissions.\n- Secrets leakage: redaction helper may miss custom secret patterns; add unit tests and extend patterns as needed.\n- Timing-related test flakiness in CI E2E.\n- Platform differences (shell, PATH, permissions) may cause inconsistent behavior across OSs.\n\nAssumptions\n- Operators will restrict config file permissions and control jobs.\n- Scheduler runs as current user and is not privileged.\n- Redaction helper will be extended and unit-tested for new job outputs.\n- Legacy removal will occur only after successful CI and manual verification.\n\n## Recommended next step\n\n- UPDATE `docs/dev/prd-ooda-loop.md` to document Cron-style OODA Scheduler as canonical OODA, including: CLI, config schema, snapshot JSONL shape, retention, safety/redaction guidance, and migration checklist.\n- Create/update an EPIC under `wf-r1d` (done: `wf-e6r`) with sub-beads: implementation (patch), tests (patch), docs (scribbler), cleanup (patch + scribbler). Assign implementation owner (patch) and PM coordination (map). Link related beads: `wf-r1d.5`, `wf-xcq`, `wf-ss7.*`.\n\n## Example config snippet\n\n`.waif/ooda-scheduler.yaml`\n\n```yaml\njobs:\n  - id: daily-health\n    name: \"Daily health probe\"\n    schedule: \"0 6 * * *\"  # daily at 06:00 UTC\n    command: \"scripts/health_check.sh\"\n    cwd: \".\"\n    env:\n      NODE_ENV: production\n    capture: [\"stdout\",\"stderr\"]\n    redact: true\n    timeout_seconds: 60\n    retention:\n      keep_last: 100\n```\n\n## Example snapshot line (JSONL)\n\n```json\n{\"time\":\"2026-01-08T12:00:00Z\",\"job_id\":\"daily-health\",\"name\":\"Daily health probe\",\"command\":\"scripts/health_check.sh\",\"exit_code\":0,\"status\":\"success\",\"summary\":\"All checks passed\",\"sanitized_output\":\"OK: disk 70% - [REDACTED]\"}\n```\n\n## Notes\n\n- Scheduler MUST NOT invoke OpenCode slash-commands or agents (per product decision).\n- Reuse `src/lib/redact.ts` for sanitization; add tests to extend patterns where needed.\n- Legacy code/tests/docs removal is destructive; perform only after verifying new implementation in CI and manual acceptance.","notes":"Marking epic in_progress to start implementation planning and work.\\n\\nCommands executed in this session:\\n- bd update wf-e6r --status in_progress --notes \u003cthis note\u003e\\n- bd show wf-e6r --json (verify)\\n\\nFiles changed:\\n- .beads/issues.jsonl (updated status/notes)\\n\\nNext steps (recommendation):\\n- Assign owners for Implement tasks (e.g., wf-e6r.1.1, wf-e6r.2.1) and claim the appropriate child tasks before starting code.\\n- Prepare implementation branch for wf-e6r.1 (branch name: wf-e6r.1/\u003cshort-desc\u003e) and wf-e6r.2 (wf-e6r.2/\u003cshort-desc\u003e).\\n- If you want I can prepare the implementation branch plan (files to create + acceptance criteria) for wf-e6r.1 + wf-e6r.2.,","status":"closed","priority":0,"issue_type":"epic","created_at":"2026-01-08T00:18:32.917997403-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:29:01.271317353-08:00","closed_at":"2026-01-16T01:29:01.271317353-08:00","close_reason":"All tests passed; implementation verified via local test suite","labels":["Status: Plan Created"]}
{"id":"wf-e6r.1","title":"Scheduler Engine","description":"Core scheduler that evaluates cron expressions and emits run events. See wf-e6r for context.\\n\\n## Acceptance Criteria\\n- Schedules defined jobs reliably per cron syntax (minute-level).\\n- Emits 'run' events for scheduled jobs.\\n- Unit tests for parsing and next-run calculation.\\n\\n## Minimal Implementation\\n- Add src/lib/scheduler.ts using node-cron/cron-parser.\\n- Wire sample job and unit tests.\\n","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-08T00:39:10.059429857-08:00","created_by":"WAIF","updated_at":"2026-01-15T22:26:39.493244145-08:00","closed_at":"2026-01-15T22:26:39.493244145-08:00","close_reason":"Implementation \u0026 unit tests merged; scheduler engine validated per acceptance criteria","labels":["Status: PR Created","feature"],"dependencies":[{"issue_id":"wf-e6r.1","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:10.061395782-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.1","depends_on_id":"wf-e6r.2","type":"blocks","created_at":"2026-01-08T00:39:33.094572298-08:00","created_by":"WAIF"}],"comments":[{"id":144,"issue_id":"wf-e6r.1","author":"rgardler","text":"Acceptance: implement src/lib/scheduler.ts; unit tests for cron parsing and next-run calculation; export Scheduler API for CLI wiring.","created_at":"2026-01-12T10:10:00Z"},{"id":159,"issue_id":"wf-e6r.1","author":"rgardler","text":"Kickoff: Scheduler implementation is green-lit. Suggested branch: wf-e6r.1/scheduler-engine. Owner: patch. Acceptance: see history/wf-e6r-implementation-plan.md. Next: create branch, implement src/lib/scheduler.ts, add tests, open PR referencing wf-e6r.1.","created_at":"2026-01-13T02:31:47Z"},{"id":160,"issue_id":"wf-e6r.1","author":"rgardler","text":"Resume pickup: @patch was interrupted while implementing the Scheduler Engine. Requesting @patch resume work on branch 'wf-e6r.1/scheduler-engine' and continue with remaining children: wf-e6r.1.1 (implement remaining surface), wf-e6r.1.2 (tests), wf-e6r.1.3 (docs).\\n\\nObserved working tree (from coordinator check): branch 'wf-e6r.1/scheduler-engine' exists and tracks origin/wf-e6r.1/scheduler-engine. Untracked file present: history/wf-e6r-implementation-plan.md.\\n\\nChecklist for @patch before coding:\\n1) On your local machine, verify branch: git rev-parse --abbrev-ref HEAD (expect wf-e6r.1/scheduler-engine).\\n2) Resolve untracked/uncommitted files: either commit history/wf-e6r-implementation-plan.md to the feature branch, move it under history/ and commit, or stash/clean before switching branches. Do NOT lose the plan document.\\n3) Ensure branch is up to date with origin/main (git fetch origin \u0026\u0026 git rebase origin/main) or create a fresh branch wf-e6r.1/\u003cshort-desc\u003e from origin/main if you prefer.\\n4) Continue implementation per acceptance: implement src/lib/scheduler.ts (Scheduler class that parses cron expressions, calculates next run, emits run events), add unit tests (tests/scheduler.test.ts) for parsing/next-run calculation, export Scheduler API for CLI wiring.\\n5) Run unit tests and linters locally; push branch and open a PR referencing wf-e6r.1 and child beads.\\n\\nCommands run by coordinator in this handoff (for traceability): git status --porcelain; git rev-parse --abbrev-ref HEAD; git fetch origin --quiet; bd show wf-e6r.1 --json; bd ready --json; bd list --status=open --json.\\n\\nFiles noted (no files were modified by this coordinator): history/wf-e6r-implementation-plan.md (untracked); .beads/issues.jsonl (bd updates may be written).\\n\\nIf you want me to create a focused claim on the implement subtask, reply 'assign' and I will mark wf-e6r.1.1 in_progress and assign to @patch. Otherwise reply 'resume' once you've prepared your branch and I'll create a PR checklist for you.","created_at":"2026-01-13T02:44:24Z"}]}
{"id":"wf-e6r.1.1","title":"Implement: wf-e6r.1 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","notes":"PR #109 merged; scheduler module and tests delivered. Tests: npm test.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T00:41:31.873855035-08:00","created_by":"WAIF","updated_at":"2026-01-12T19:18:08.015607415-08:00","closed_at":"2026-01-12T19:18:08.01562218-08:00","dependencies":[{"issue_id":"wf-e6r.1.1","depends_on_id":"wf-e6r.1","type":"parent-child","created_at":"2026-01-08T00:41:31.875413193-08:00","created_by":"WAIF"}],"comments":[{"id":161,"issue_id":"wf-e6r.1.1","author":"rgardler","text":"Delegation record: /delegate wf-e6r.1.1 patch requested by Producer. Work has been handed to @patch and wf-e6r.1.1 is in_progress and assigned.\\n\\nWhat happened in this session:\\n- Attempted to run opencode slash command '/delegate wf-e6r.1.1 patch' but the environment did not expose a /delegate executable. Instead, coordination proceeded via bd and an OpenCode agent run.\\n- An implementation agent produced scheduler code and tests locally (see files list below) but DID NOT commit or push changes.\\n\\nFiles created (uncommitted in working tree):\\n- src/lib/scheduler.ts\\n- tests/scheduler.test.ts\\n- history/wf-e6r-implementation-plan.md\\n- history/ooda_snapshot_1768272555888.jsonl\\n- history/ooda_snapshot_1768272556666.jsonl\\n\\nActions requested of @patch (next steps):\\n1) On your workstation, switch to branch 'wf-e6r.1/scheduler-engine' (or create a fresh branch named 'wf-e6r.1/\u003cshort-desc\u003e' from origin/main).\\n2) Add and commit the new files with a clear commit message that references wf-e6r.1.1 and wf-e6r.1 (e.g., wf-e6r.1.1:","created_at":"2026-01-13T02:49:44Z"}]}
{"id":"wf-e6r.1.2","title":"Tests: wf-e6r.1 - ","description":"Tests: wf-e6r.1 - detailed test plan\n\nScope (in):\n- Unit tests for scheduler core: nextRun edge cases, parser compatibility across cron-parser versions, error handling for invalid schedules, and dynamic add/start behavior.\n- Integration tests: run-job uses scheduler API and writes snapshots with required fields; retention trimming behavior.\n- E2E CI job: sandboxed CI job that runs a mock scheduled job and verifies snapshot creation + retention.\n\nScope (out):\n- Snapshot persistence engine refactors beyond minimal enforcement (will be tracked under wf-e6r.5).\n- Security hardening beyond capture opt-in (tracked under wf-cuq).\n\nWhat to deliver:\n- Unit tests under tests/ covering nextRun and Scheduler behaviour (existing tests/scheduler.test.ts should be extended).\n- Integration test(s) that create a temporary config, invoke run-job/ooda scheduler in a sandbox and assert snapshot lines and retention.\n- CI workflow entry (docs or workflow) that runs the sandboxed E2E.\n- Test run instructions: \"npm test\" (local) and CI should run vitest.\n\nDependencies / blockers:\n- wf-e6r.1 (Scheduler Engine) must be merged (done for core pieces; see wf-e6r.1.1).\n- wf-e6r.5 for snapshot module changes if schema changes are required.\n\nRisks:\n- Tests that spawn processes may be flaky on shared CI runners; prefer sandboxed container or self-hosted runner for E2E.\n- cron-parser version differences across environments; include compatibility assertions.\n\nOwners / estimate:\n- Suggested assignee: probe (QA) for E2E; patch for unit tests.\n- Estimate: 4-8h depending on CI sandbox availability\n","acceptance_criteria":"1) Unit tests added: nextRun edge cases, invalid cron handling, dynamic add behavior; all pass locally (vitest).\\n2) Integration test that runs a scheduled mock job and asserts a snapshot JSONL line with required fields (time, job_id, status, exit_code, durationMs, metadata_version).\\n3) Retention enforcement test: simulate keep_last trimming and assert only last N non-empty lines remain.\\n4) CI: documented CI step (or workflow) exists that runs the E2E in an isolated sandbox.\\n5) Tests documented in issue with how to run locally and expected outputs.","notes":"Decision: snapshots will NOT be committed to git. Use history/ (gitignored) for local runs and CI artifacts for verification. Probe: please re-run the merged PR (run 21020127965) or adjust tests to emit snapshot JSONL into test-artifacts/ or history/ so CI uploads them, then verify snapshot JSONL fields and retention and close this bead when satisfied.","status":"closed","priority":1,"issue_type":"task","assignee":"probe","created_at":"2026-01-08T00:41:31.983487636-08:00","created_by":"WAIF","updated_at":"2026-01-14T21:01:24.015605968-08:00","closed_at":"2026-01-14T21:01:24.015605968-08:00","close_reason":"Closed","labels":["owner:probe"],"dependencies":[{"issue_id":"wf-e6r.1.2","depends_on_id":"wf-e6r.1","type":"parent-child","created_at":"2026-01-08T00:41:31.984351486-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.1.3","title":"Docs: wf-e6r.1 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:32.113378034-08:00","created_by":"WAIF","updated_at":"2026-01-14T21:14:48.545875552-08:00","closed_at":"2026-01-14T21:14:48.545875552-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-e6r.1.3","depends_on_id":"wf-e6r.1","type":"parent-child","created_at":"2026-01-08T00:41:32.114201692-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.1.4","title":"Implement: Scheduler engine (wf-e6r.1.impl)","description":"Implement src/lib/scheduler.ts: Scheduler class that parses cron expressions, calculates next run, and emits run events. Add unit tests in tests/scheduler.test.ts. Export Scheduler API for CLI wiring.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:56.865117115-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:46.836543185-08:00","closed_at":"2026-01-12T18:31:46.836543185-08:00","close_reason":"Duplicate: merged into wf-e6r.1","dependencies":[{"issue_id":"wf-e6r.1.4","depends_on_id":"wf-e6r.1","type":"parent-child","created_at":"2026-01-12T18:29:56.868428517-08:00","created_by":"WAIF"}],"comments":[{"id":150,"issue_id":"wf-e6r.1.4","author":"rgardler","text":"Closing duplicate — merged into existing scheduler work (wf-e6r.1.1 / wf-e6r.1). Use wf-e6r.1.1 and wf-e6r.1.2 as canonical tasks.","created_at":"2026-01-13T02:31:46Z"}]}
{"id":"wf-e6r.1.5","title":"Tests: Scheduler engine (wf-e6r.1.tests)","description":"Add unit tests for cron parsing, next-run calculation, and edge cases (invalid cron, DST, timezone).* Use cron-parser or sinon fake timers for deterministic tests.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:56.941388144-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:46.965444496-08:00","closed_at":"2026-01-12T18:31:46.965444496-08:00","close_reason":"Duplicate: merged into wf-e6r.1","dependencies":[{"issue_id":"wf-e6r.1.5","depends_on_id":"wf-e6r.1","type":"parent-child","created_at":"2026-01-12T18:29:56.94255053-08:00","created_by":"WAIF"}],"comments":[{"id":151,"issue_id":"wf-e6r.1.5","author":"rgardler","text":"Closing duplicate — tests tracked on wf-e6r.1.2 and wf-e6r.1.5 was redundant.","created_at":"2026-01-13T02:31:46Z"}]}
{"id":"wf-e6r.2","title":"Config Loader \u0026 Validation","description":"Load .waif/ooda-scheduler.yaml and validate schema. See wf-e6r for context.\\n\\n## Acceptance Criteria\\n- Reads config file and validates schema and cron syntax.\\n- Non-zero exit on invalid config with clear error.\\n- Unit tests for validation and reload behavior.\\n\\n## Minimal Implementation\\n- Implement src/lib/config.ts with YAML parsing and AJV schema validation.\\n- Provide --config flag for CLI.\\n","notes":"Build: status review (2026-01-10). Summary: Config loader work mostly implemented and test cases for schema/negative paths merged to implementation branch. Several test-case beads (wf-e6r.2.4..wf-e6r.2.15) are closed/merged. Remaining work: finalize wf-e6r.2.1 implementation branch, implement scheduler engine (wf-e6r.1), job runner (wf-e6r.4), snapshot writer/retention (wf-y6o), tests for runJobCommand (wf-uba), and docs (wf-e6r.2.3). Blocker: working tree has uncommitted change to history/ooda_daily-health.jsonl and current branch is a merge topic (merge/wf-e6r.2.1.1-into-wf-e6r.2.1.config). Action needed: stash/commit/finish merge or switch to a clean feature branch named wf-e6r.2/\u003cshort-desc\u003e before continuing. Risks: potential E2E flakiness, redaction gaps, unsafe job commands — see epic wf-e6r for mitigation. Next steps recommended: 1) Resolve local merge/uncommitted file. 2) Patch: complete wf-e6r.2.1 and open PR. 3) Patch: implement wf-e6r.4 + wf-y6o and wf-uba tests. 4) Scribbler: deliver docs before merge. 5) Run CI E2E and manual acceptance then remove legacy. Files referenced in this review: history/ooda_daily-health.jsonl, src/lib/config.ts, src/lib/redact.ts, tests/wf-e6r.* (see bead notes).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T00:39:13.298086401-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:46:33.175802127-08:00","closed_at":"2026-01-12T00:46:33.175807943-08:00","labels":["feature"],"dependencies":[{"issue_id":"wf-e6r.2","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:13.303395494-08:00","created_by":"WAIF"}],"comments":[{"id":135,"issue_id":"wf-e6r.2","author":"rgardler","text":"Audit summary: Config loader \u0026 validation implemented and merged. Findings:\\n\\n- Implementation: src/lib/config.ts implements YAML parsing, AJV schema validation (src/lib/schemas/ooda-scheduler.schema.json), cron expression validation with robust cron-parser interop, error formatting, and redact-safe error messages. loadConfig(path) throws a combined, human-friendly error on invalid config.\\n\\n- Tests: multiple test-case beads and tests were merged covering positive and negative cases: tests/wf-e6r.2.4.valid.test.ts, tests/wf-e6r.2.7.invalid-cron.test.ts, tests/wf-e6r.2.10.invalid-retention.test.ts, tests/wf-e6r.2.11.invalid-yaml.test.ts, tests/wf-e6r.2.12.config-missing.test.ts, tests/wf-e6r.2.13.unreadable.test.ts, tests/wf-e6r.2.14.cli-e2e.test.ts, tests/wf-e6r.2.15.hot-reload.test.ts. CI deterministic E2E for CLI also merged and passing.\\n\\n- Acceptance criteria status: \\n  * Reads config file and validates schema + cron syntax: YES (loadConfig + validateConfig + validateCronExpressions).\\n  * Non-zero exit on invalid config with clear error: YES (loadConfig throws Error with details; CLI E2E verifies non-zero exit on invalid).\\n  * Unit tests for validation and reload behavior: YES (test cases merged; hot-reload test present).\\n\\nRemaining related work (tracked as separate beads):\\n- wf-e6r.1 Scheduler Engine (open) — implement scheduling \u0026 event emission.\\n- wf-e6r.4 Job Runner \u0026 Process Management (open) — runner implementation and integration with scheduler.\\n- wf-e6r.2.3 Docs (open) — operator docs and migration guidance pending.\\n- wf-e6r.2.2 Test consolidation (open) — coordination of tests and CI placement (many test-case beads are merged).\\n\\nRecommendation: close wf-e6r.2 now. The loader/validation acceptance criteria are met; remaining work is separate feature implementation (scheduler/runner) and docs, tracked in child beads. If you want me to keep wf-e6r.2 open until wf-e6r.2.3 and wf-e6r.2.2 are closed, say so and I will leave it open. Otherwise I will close it per this audit. ","created_at":"2026-01-12T08:46:30Z"}]}
{"id":"wf-e6r.2.1","title":"Implement: wf-e6r.2 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","notes":"Context command idempotency (wf-0fy) fixed and merged: commit 117a62dae55e98cf65a385ad82221045c082467f. Full suite now passing.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T00:41:32.268760246-08:00","created_by":"WAIF","updated_at":"2026-01-11T23:20:38.066943139-08:00","closed_at":"2026-01-11T23:20:38.066943139-08:00","close_reason":"Merged (PRs #101/#102/#103/#104) — implementation, tests, and docs verified locally; follow-ups tracked separately","labels":["Assigned: patch","Related: Test Plan","Status: Blocked","Status: PR Created"],"dependencies":[{"issue_id":"wf-e6r.2.1","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T00:41:32.269472646-08:00","created_by":"WAIF"}],"comments":[{"id":116,"issue_id":"wf-e6r.2.1","author":"rgardler","text":"Validation and verification complete: ran unit and integration tests locally (runner + runJobCommand + ooda run-job tests). Key merged PRs: #101 (runner \u0026 snapshots tests), #102 (run-job + CLI + snapshots), #103 (runJobCommand timeout \u0026 large-output tests), #104 (publish local commits). Files that implement the scope: src/lib/runner.ts, src/commands/ooda.ts, src/lib/config.ts, src/lib/schemas/ooda-scheduler.schema.json, tests/lib/runner.test.ts, tests/lib/snapshots.test.ts, tests/ooda-run-job.test.ts, tests/runJobCommand.*.test.ts, docs/commands/ooda.md. All relevant tests for wf-e6r.2.1 passed locally. Closing the bead as the implementation, tests, and docs are merged. Follow-ups (tracked separately): wf-mtc.3 (run-job CLI polishing), wf-y6o (snapshot writer polish), wf-kpp (echo behavior review), security review for runJobCommand sandboxing.","created_at":"2026-01-12T07:20:35Z"}]}
{"id":"wf-e6r.2.1.1","title":"Implement: align code to updated PRD (job.command, remove --once/--events, execute arbitrary job.command)","notes":"Implemented job.command execution with redaction/timeout/retention and run-job snapshot logging. Added validation fixtures, unit coverage for runJobCommand, and deterministic CLI E2E without legacy --once/--events flags. Files: package.json, package-lock.json, src/commands/ooda.ts, src/lib/config.ts, tests/fixtures/ooda.*yaml, tests/wf-e6r.2.14.cli-e2e.test.ts, tests/ooda-run-job.test.ts. Commands: git fetch, git rebase origin/main, npm test, git push, gh pr create.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T19:28:07.310144716-08:00","created_by":"WAIF","updated_at":"2026-01-11T22:05:10.892539768-08:00","closed_at":"2026-01-11T22:05:10.892539768-08:00","close_reason":"Merged (PR #102) — work landed on main; follow-ups tracked separately","dependencies":[{"issue_id":"wf-e6r.2.1.1","depends_on_id":"wf-e6r.2.1","type":"parent-child","created_at":"2026-01-08T19:28:07.317800056-08:00","created_by":"WAIF"}],"comments":[{"id":84,"issue_id":"wf-e6r.2.1.1","author":"rgardler","text":"Completed Subtask A (wf-8e9): added deterministic CLI E2E test on branch wf-8e9/cli-e2e-deterministic (uses programmatic createOodaCommand + mock writeSnapshots).","created_at":"2026-01-09T04:22:13Z"},{"id":99,"issue_id":"wf-e6r.2.1.1","author":"rgardler","text":"Patch continued implementation on branch wf-e6r.2.1.1/job-command. Pushed branch and opened PR: https://github.com/SorraTheOrc/waif/pull/102. Changes: implemented arbitrary job.command execution, removed legacy CLI flags --once/--events, added runJobCommand helper, updated unit + E2E tests. Files changed: package.json, package-lock.json, src/commands/ooda.ts, src/lib/config.ts, tests/fixtures/ooda.*.yaml, tests/wf-e6r.2.14.cli-e2e.test.ts, tests/ooda-run-job.test.ts. Local tests: all pass (npm test). Next: review PR and address CI comments.","created_at":"2026-01-12T05:00:03Z"},{"id":108,"issue_id":"wf-e6r.2.1.1","author":"rgardler","text":"Merged PR #102 (wf-e6r.2.1.1 -\u003e main). Merge commit: e7ea93b5dddad2773511ba2099b23e4a16eb495d. Files merged: .github/workflows/ci-tests.yml, README.md, docs/commands/ooda.md, docs/dev/prd/prd-ooda-loop.md, package-lock.json, package.json, src/commands/ooda.ts, src/lib/config.ts, src/lib/schemas/ooda-scheduler.schema.json, tests/fixtures/ooda.hello-5s.yaml, tests/fixtures/ooda.invalid-capture.yaml, tests/fixtures/ooda.invalid-cron.yaml, tests/fixtures/ooda.invalid-id.yaml, tests/fixtures/ooda.invalid-retention.yaml, tests/fixtures/ooda.missing-command.yaml, tests/fixtures/ooda.missing-name.yaml, tests/fixtures/ooda.valid.yaml, tests/ooda-echo.test.ts, tests/ooda-hello-5s.test.ts, tests/ooda-run-job.test.ts, tests/ooda.test.ts, tests/wf-e6r.2.10.invalid-retention.test.ts, tests/wf-e6r.2.14.cli-e2e.test.ts, tests/wf-e6r.2.4.valid.test.ts, tests/wf-e6r.2.6.missing-required.test.ts, tests/wf-e6r.2.7.invalid-cron.test.ts, tests/wf-e6r.2.9.invalid-capture.test.ts. Deleted branch: wf-e6r.2.1.1/job-command. Local snapshot file removed: history/ooda_snapshot_1768196288050.jsonl.","created_at":"2026-01-12T05:57:31Z"}]}
{"id":"wf-e6r.2.10","title":"Test Case: Invalid retention value -\u003e error","description":"Purpose: Enforce retention.keep_last \u003e= 1.\\nPreconditions/Data: retention: {keep_last: 0}.\\nSteps: validate/load.\\nExpected Results: AJV error referencing retention.keep_last.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: schema\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 9bb51fc). Files added: tests/wf-e6r.2.10.invalid-retention.test.ts, tests/fixtures/ooda.invalid-retention.yaml","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.578755871-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.885353383-08:00","closed_at":"2026-01-08T03:09:31.885353383-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 9bb51fc)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","Status: In Progress","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.10","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.579594267-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.11","title":"Test Case: YAML syntax error -\u003e error","description":"Purpose: Parser surface YAML syntax errors with readable message.\\nPreconditions/Data: invalid YAML file.\\nSteps: call loadConfig.\\nExpected Results: Error thrown mentioning YAML parse error and file; CLI exit non-zero.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: negative\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 1dcac44). Files added: tests/wf-e6r.2.11.invalid-yaml.test.ts, tests/fixtures/ooda.invalid-yaml.yaml","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.632146261-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:32.013216307-08:00","closed_at":"2026-01-08T03:09:32.013216307-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 1dcac44)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","Status: In Progress","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.11","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.633464156-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.12","title":"Test Case: Config file not found -\u003e non-zero exit","description":"Purpose: Missing config should surface clear error and non-zero exit.\\nPreconditions/Data: no .waif/ooda-scheduler.yaml present.\\nSteps: run CLI load path or loadConfig default.\\nExpected Results: loadConfig throws or CLI exits non-zero with message about missing file.\\nAutomation Level: integration. Tool: shell/CI. Mocking: filesystem. Coverage: negative\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 8f89e6f). Files added: tests/wf-e6r.2.12.config-missing.test.ts","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.688769839-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:32.123443138-08:00","closed_at":"2026-01-08T03:09:32.123443138-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 8f89e6f)","labels":["Assigned: patch","Status: Done","Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.12","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.690365033-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.13","title":"Test Case: Unreadable file (permissions) -\u003e non-zero exit","description":"Purpose: Permission errors are surfaced clearly.\\nPreconditions/Data: create config file with 000 permissions.\\nSteps: call loadConfig.\\nExpected Results: Error indicating permission issue; non-zero exit.\\nAutomation Level: integration. Tool: node + shell. Mocking: filesystem. Coverage: negative, ops\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 8f89e6f). Files added: tests/wf-e6r.2.13.unreadable.test.ts (used fs.readFile mock for EACCES)","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.742053031-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:32.270810212-08:00","closed_at":"2026-01-08T03:09:32.270810212-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 8f89e6f)","labels":["Assigned: patch","Status: Done","Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.13","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.742778328-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.14","title":"Test Case: CLI integration - run and exit codes (E2E)","description":"Purpose: End-to-end CLI scenario: run waif ooda schedule run \u003cjob\u003e uses loader and returns proper exit code on valid/invalid config.\\nPreconditions/Data: valid and invalid configs.\\nSteps: invoke CLI with valid, then invalid config.\\nExpected Results: valid -\u003e exit 0; invalid -\u003e exit non-zero and stderr contains human-friendly message.\\nAutomation Level: e2e. Tool: GitHub Actions / shell. Mocking: minimal. Coverage: e2e, ci\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Triaged and implemented deterministic CLI E2E test. Added --events CLI option and refactored test to call the ooda command handler in-process with mocked event reading. Merged triage branch into wf-e6r.2.1/config-loader (commit cfe7998). Test now passes deterministically in CI. If QA prefers true process spawn tests, create a follow-up discovered-from wf-e6r.2.14.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.796122819-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:27:24.816509117-08:00","closed_at":"2026-01-08T03:27:24.816509117-08:00","close_reason":"Implemented deterministic CLI E2E test and merged to wf-e6r.2.1/config-loader (commit cfe7998)","labels":["Assigned: patch","Status: Blocked","Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.14","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.796753516-08:00","created_by":"WAIF"}],"comments":[{"id":81,"issue_id":"wf-e6r.2.14","author":"rgardler","text":"Started triage on wf-e6r.2.14/cli-e2e-triage; initial vitest E2E times out (ooda --once never exits). Investigating CLI exit behavior.","created_at":"2026-01-08T11:20:16Z"},{"id":82,"issue_id":"wf-e6r.2.14","author":"rgardler","text":"Findings: running tests/wf-e6r.2.14.cli-e2e.test.ts times out because 'node dist/index.js ooda --once ...' blocks ~19s reading .opencode/logs/events.jsonl (3.4MB) even with --once. WAIF_CONFIG configs are ignored by ooda command (no config load). Running with --json exits quickly (~12s timeout reached when synchronous file scan). Manual run against empty fixtures still reads .opencode/logs/events.jsonl and exits only after finishing read. Need to decide: change CLI to respect WAIF_CONFIG/skip OpenCode log read or refactor test to call handler directly and mock readOpencodeEvents so deterministic. Next step: adjust test to call createOodaCommand action directly with mocked readOpencodeEvents to bypass long-running file read.","created_at":"2026-01-08T11:23:19Z"}]}
{"id":"wf-e6r.2.15","title":"Test Case: Hot-reload config change triggers validate and update","description":"Purpose: When config file changes, loader validates new config and triggers callback (watch) or returns error for invalid.\\nPreconditions/Data: watcher enabled in loader (optional helper).\\nSteps: start process with watcher; modify file to invalid then valid.\\nExpected Results: invalid -\u003e process logs error but continues (or disables job); valid -\u003e process accepts new config.\\nAutomation Level: integration. Tool: node + fs events. Mocking: filesystem. Coverage: reload, resilience\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 9256a892; additional related fix merged at 117a62d). Files added/edited: tests/wf-e6r.2.15.hot-reload.test.ts, src/lib/config.ts","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.845552225-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:32.376256097-08:00","closed_at":"2026-01-08T03:09:32.376256097-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 9256a892; subsequent fix 117a62d)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.15","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.846255222-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.2","title":"Tests: wf-e6r.2 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","notes":"Assigned to @patch: own the test plan and iterate through sibling test-case beads (wf-e6r.2.6..wf-e6r.2.15). Follow the project's bd workflow and Option 1 per-test branching rules.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T00:41:32.363668394-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:47:36.218235063-08:00","closed_at":"2026-01-12T00:47:36.218243162-08:00","labels":["Assigned: patch","Status: Test Plan Created"],"dependencies":[{"issue_id":"wf-e6r.2.2","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T00:41:32.364444169-08:00","created_by":"WAIF"}],"comments":[{"id":136,"issue_id":"wf-e6r.2.2","author":"rgardler","text":"Audit: Test consolidation complete. Evidence: individual test-case beads wf-e6r.2.4..wf-e6r.2.15 were implemented and merged; representative test files added: tests/wf-e6r.2.4.valid.test.ts, tests/wf-e6r.2.7.invalid-cron.test.ts, tests/wf-e6r.2.10.invalid-retention.test.ts, tests/wf-e6r.2.11.invalid-yaml.test.ts, tests/wf-e6r.2.12.config-missing.test.ts, tests/wf-e6r.2.13.unreadable.test.ts, tests/wf-e6r.2.14.cli-e2e.test.ts, tests/wf-e6r.2.15.hot-reload.test.ts. CI deterministic E2E for CLI passes. Acceptance criteria satisfied: unit tests cover edge cases and CI includes E2E. Closing consolidation task and linking parent wf-e6r.2 (now closed).","created_at":"2026-01-12T08:47:31Z"}]}
{"id":"wf-e6r.2.3","title":"Docs: wf-e6r.2 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","notes":"Assigned to @scribbler: produce operator and repo docs required before PR merge. Deliverables: 1) docs/dev/prd-ooda-loop.md — update to describe Cron-style OODA Scheduler as canonical OODA, include CLI (waif ooda schedule start|stop|run|status), config schema summary, snapshot JSONL shape, retention, safety/redaction guidance, migration checklist; 2) docs/usage/ooda.md — quickstart + CLI examples and run modes (--once, --events); 3) history/ooda-config-examples.md — full example configs and fixtures used by tests (put in history/ per AI-doc policy); 4) docs/operational/ooda-ci.md — CI notes for E2E (secrets/timeouts/matrix), how to run the deterministic E2E test added in wf-e6r.2.14; 5) SHORT SUMMARY in repo root (docs/CHANGELOG or PR body snippet) for reviewers.\n\nAcceptance criteria:\n- Files created/updated as above and committed on a feature branch named wf-e6r.2.3/\u003cshort-desc\u003e from origin/main; add PR or PR draft referencing wf-e6r.2.1 when ready.\n- Content includes one config example snippet and one sample snapshot JSONL line, operator checklist (permissions, redaction, run-as guidance), and CI steps for running the E2E test.\n- All AI-generated docs go into history/ (examples) unless they are canonical docs (docs/). Keep history/ for ephemeral planning docs.\n\nNotes for scribbler: follow repo doc conventions, keep docs concise (operator checklist first), add cross-links to src/lib/config.ts and src/lib/schemas/ooda-scheduler.schema.json, reference closed beads for tests (wf-e6r.2.*). If you need editorial review or assignees for approval, ask Build. Timeline: please provide a first draft within this session or indicate ETA. ","status":"closed","priority":2,"issue_type":"task","assignee":"scribbler","created_at":"2026-01-08T00:41:32.480154489-08:00","created_by":"WAIF","updated_at":"2026-01-12T02:05:31.395912061-08:00","closed_at":"2026-01-12T02:05:31.395912061-08:00","close_reason":"Docs implemented \u0026 merged (PR #108 / commit ee4dc6a)","labels":["Assigned: scribbler"],"dependencies":[{"issue_id":"wf-e6r.2.3","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T00:41:32.482348456-08:00","created_by":"WAIF"}],"comments":[{"id":137,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Docs work pending: scribbler assigned. Evidence: docs/commands/ooda.md updated as part of wf-mtc.3 (run-job docs) and history examples created; however, operator PRD and dedicated scheduler docs (docs/dev/prd-ooda-loop.md, docs/operational/ooda-ci.md, history/ooda-config-examples.md) remain outstanding. Recommendation: keep wf-e6r.2.3 open until scribbler confirms PR with these files or marks as complete. If you want me to close it now despite outstanding deliverables, confirm and I will close it.","created_at":"2026-01-12T08:47:42Z"},{"id":138,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Delegation: Producer assigns this docs task to scribbler. Tasks: 1) Create docs/dev/prd-ooda-loop.md (PRD + migration checklist). 2) Create docs/operational/ooda-ci.md (CI E2E guidance \u0026 secrets handling). 3) Create history/ooda-config-examples.md (sample configs used by tests). 4) Create docs/usage/ooda.md quickstart + CLI examples. Include one example snapshot JSONL line and operator checklist. Commit to branch wf-e6r.2.3/docs (name can be adjusted). Provide draft PR and set issue status to in_progress when PR exists. Timeline: please provide a first draft within 24 hours or report ETA.","created_at":"2026-01-12T08:49:04Z"},{"id":139,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Docs drafted and PR opened: https://github.com/SorraTheOrc/waif/pull/108 (draft). Commit ee4dc6a adds docs/dev/prd-ooda-loop.md; docs/operational/ooda-ci.md; docs/usage/ooda.md; history/ooda-config-examples.md. Notes/follow-ups: CLI currently implements  +  (not ). Snapshot JSONL fields confirmed in code: time, job_id, name, command, status, exit_code, stdout?, stderr?; PRD flags missing desired fields summary + explicit truncation/sanitized flags. Tests: vitest E2E specs passed (run-job.e2e, wf-e6r.2.14.cli-e2e).","created_at":"2026-01-12T09:43:28Z"},{"id":140,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Correction: prior comment lost CLI backticks due to shell evaluation. Canonical CLI implemented today: (1) `waif ooda scheduler` (long-lived loop) and (2) `waif ooda run-job --job \u003cid\u003e` (deterministic one-shot). Follow-up: consider adding alias surface `waif ooda schedule start|stop|run|status` if desired.","created_at":"2026-01-12T09:43:34Z"},{"id":141,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Closing wf-e6r.2.3: docs delivered and merged.\n\nSummary of work:\n- PR merged: https://github.com/SorraTheOrc/waif/pull/108 (branch wf-e6r.2.3/docs)\n- Commit: ee4dc6a\n- Files added: docs/dev/prd-ooda-loop.md, docs/operational/ooda-ci.md, docs/usage/ooda.md, history/ooda-config-examples.md\n- Verification: local vitest runs passed (tests/run-job.e2e.test.ts and tests/wf-e6r.2.14.cli-e2e.test.ts).\n\nFollow-ups (tracked separately):\n- wf-m0u: snapshot JSONL metadata enhancement (summary, sanitized, truncated) — assigned to patch\n- wf-jgy: support array-form job.command and validation — assigned to patch\n\nStatus: closing this docs task; operator/user docs are now in main. If additional edits are needed, please open a new bead or request a PR on the docs files.,--json","created_at":"2026-01-12T09:57:13Z"},{"id":142,"issue_id":"wf-e6r.2.3","author":"rgardler","text":"Closing: docs delivered and merged (PR #108 / commit ee4dc6a). Files created/updated: docs/dev/prd-ooda-loop.md, docs/usage/ooda.md, docs/operational/ooda-ci.md, docs/commands/ooda.md, history/ooda-config-examples.md. Verification: local vitest E2E tests for run-job passed. Follow-ups (wf-m0u, wf-jgy) tracked separately.","created_at":"2026-01-12T10:05:29Z"}]}
{"id":"wf-e6r.2.4","title":"Test Case: Valid config loads","description":"Purpose: Ensure a well-formed .waif/ooda-scheduler.yaml parses and validates.\\nPreconditions/Data: a valid YAML file at .waif/ooda-scheduler.yaml with one job (valid id, cron, command).\\nSteps: call loadConfig() or run CLI that invokes loader.\\nExpected Results: loadConfig resolves to Config object; CLI exits 0.\\nAutomation Level: unit/integration. Tool: Jest/node. Mocking: none. Coverage: happy-path, config\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 11219e3). Files added: tests/wf-e6r.2.4.valid.test.ts, tests/fixtures/ooda.valid.yaml","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T01:40:08.159417656-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.358302662-08:00","closed_at":"2026-01-08T03:09:31.358302662-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 11219e3)","labels":["Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.4","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:08.163470158-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.6","title":"Test Case: Missing required field -\u003e error","description":"Purpose: Verify missing required fields (e.g., job.name) produce clear validation errors.\\nPreconditions/Data: YAML with job missing name.\\nSteps: call loadConfig(); capture thrown error.\\nExpected Results: Error thrown; message includes path and human message; CLI exit non-zero.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: negative, schema\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 16a78b1). Files added: tests/wf-e6r.2.6.missing-required.test.ts, tests/fixtures/ooda.missing-name.yaml","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.340826403-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.481398063-08:00","closed_at":"2026-01-08T03:09:31.481398063-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 16a78b1)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.6","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.3416376-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.7","title":"Test Case: Invalid cron expression -\u003e error","description":"Purpose: Ensure cron syntax validation detects and reports invalid cron expressions.\\nPreconditions/Data: YAML with job.schedule: \"60 * * * *\" (invalid).\\nSteps: call validateConfig/loadConfig.\\nExpected Results: Error with message indicating job id/index and schedule invalid.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: negative, cron\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit cf40f36). Files added/edited: tests/wf-e6r.2.7.invalid-cron.test.ts, tests/fixtures/ooda.invalid-cron.yaml, src/lib/config.ts (cron interop fixes)","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.395713688-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.587770364-08:00","closed_at":"2026-01-08T03:09:31.587770364-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit cf40f36)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","Status: In Progress","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.7","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.396446985-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.8","title":"Test Case: Invalid job id pattern -\u003e error","description":"Purpose: Validate job.id pattern enforcement (only [a-z0-9-_]).\\nPreconditions/Data: YAML with job.id: \"Daily.Health\".\\nSteps: validate/load.\\nExpected Results: AJV validation error referencing jobs[0].id.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: schema\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 56ef271). Files added: tests/wf-e6r.2.8.invalid-id.test.ts, tests/fixtures/ooda.invalid-id.yaml","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.457197947-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.709269198-08:00","closed_at":"2026-01-08T03:09:31.709269198-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 56ef271)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","Status: In Progress","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.8","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.458373142-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.2.9","title":"Test Case: Invalid capture value -\u003e error","description":"Purpose: Ensure capture enum rejects unknown values.\\nPreconditions/Data: capture: [\"stdout\",\"log\"].\\nSteps: validate/load.\\nExpected Results: AJV error referencing capture.\\nAutomation Level: unit. Tool: Jest. Mocking: none. Coverage: schema\n\n## Acceptance Criteria\n- Test case executable in automation.\n- Clear pass/fail criteria as described above.\n","notes":"Merged into wf-e6r.2.1/config-loader (commit 3e03c20). Files added: tests/wf-e6r.2.9.invalid-capture.test.ts, tests/fixtures/ooda.invalid-capture.yaml","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T01:40:22.518821005-08:00","created_by":"WAIF","updated_at":"2026-01-08T03:09:31.791167904-08:00","closed_at":"2026-01-08T03:09:31.791167904-08:00","close_reason":"Implemented and merged to wf-e6r.2.1/config-loader (commit 3e03c20)","labels":["Assigned: patch","Status: Implemented (merged to impl branch)","Status: In Progress","test-case"],"dependencies":[{"issue_id":"wf-e6r.2.9","depends_on_id":"wf-e6r.2","type":"parent-child","created_at":"2026-01-08T01:40:22.520028901-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.3","title":"CLI Surface \u0026 UX","description":"CLI commands to manage scheduler lifecycle and run jobs interactively. See wf-e6r for context.\\n\\n## Acceptance Criteria\\n- Implements: waif ooda schedule start|stop|run \u003cjob\u003e, waif ooda schedule status|list.\\n- --json structured output for automation.\\n- Integration tests simulate CLI run and assert snapshot creation.\\n\\n## Minimal Implementation\\n- Add command wiring in src/commands/ooda-schedule.ts and map waif ooda --once to run \u003cjob\u003e.\\n","notes":"Implementation delivered: subtasks completed (engine, CLI wiring, run-job, tests, docs). Docs PR #131 merged. Note: CLI implemented as 'waif ooda' (root runs scheduler), 'waif ooda scheduler' and 'waif ooda run-job' — legacy 'waif ooda schedule start|stop' verbs were not added; behavior documented in PR. Close epic.","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-08T00:39:16.378366075-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:06:04.333455306-08:00","closed_at":"2026-01-15T23:06:04.333460843-08:00","labels":["feature"],"dependencies":[{"issue_id":"wf-e6r.3","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:16.379799217-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.3","depends_on_id":"wf-e6r.1","type":"blocks","created_at":"2026-01-08T00:39:36.529825865-08:00","created_by":"WAIF"}],"comments":[{"id":145,"issue_id":"wf-e6r.3","author":"rgardler","text":"Acceptance: CLI commands for schedule start|stop|run|status; --json output; integration test that run-job triggers snapshot write.","created_at":"2026-01-12T10:10:00Z"}]}
{"id":"wf-e6r.3.1","title":"Implement: wf-e6r.3 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:32.656698973-08:00","created_by":"WAIF","updated_at":"2026-01-15T22:30:37.760724237-08:00","closed_at":"2026-01-15T22:30:37.760724237-08:00","close_reason":"Implementation merged and tests added; integration E2E tests exist and CI workflow configured (see .github/workflows/ooda-e2e.yml)","dependencies":[{"issue_id":"wf-e6r.3.1","depends_on_id":"wf-e6r.3","type":"parent-child","created_at":"2026-01-08T00:41:32.657465215-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.3.2","title":"Tests: wf-e6r.3 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:32.759822798-08:00","created_by":"WAIF","updated_at":"2026-01-15T22:30:37.770792813-08:00","closed_at":"2026-01-15T22:30:37.770792813-08:00","close_reason":"Implementation merged and tests added; integration E2E tests exist and CI workflow configured (see .github/workflows/ooda-e2e.yml)","dependencies":[{"issue_id":"wf-e6r.3.2","depends_on_id":"wf-e6r.3","type":"parent-child","created_at":"2026-01-08T00:41:32.760612656-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.3.3","title":"Docs: wf-e6r.3 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","notes":"Docs delivered: migration notes removed via wf-oe1g (PR #131 merged).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:32.86669929-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:05:52.787298631-08:00","closed_at":"2026-01-15T23:05:52.787304454-08:00","dependencies":[{"issue_id":"wf-e6r.3.3","depends_on_id":"wf-e6r.3","type":"parent-child","created_at":"2026-01-08T00:41:32.867913924-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.3.4","title":"Implement: CLI wiring for ooda scheduler (wf-e6r.3.impl)","description":"Add src/commands/ooda-schedule.ts to implement waif ooda scheduler start|stop|run|status. Integrate with Scheduler API and support --config and --log flags. Add integration test.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:56.997801347-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.081226675-08:00","closed_at":"2026-01-12T18:31:47.081226675-08:00","close_reason":"Duplicate: merged into wf-e6r.3","dependencies":[{"issue_id":"wf-e6r.3.4","depends_on_id":"wf-e6r.3","type":"parent-child","created_at":"2026-01-12T18:29:56.998631608-08:00","created_by":"WAIF"}],"comments":[{"id":152,"issue_id":"wf-e6r.3.4","author":"rgardler","text":"Duplicate implementation task — merge into wf-e6r.3 (CLI Surface).","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.3.5","title":"Implement: CLI run-job wiring (wf-e6r.3.runjob)","description":"Ensure waif ooda run-job uses runner and snapshot modules; support --json output and --log path; add tests for JSON output shape.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:57.271594203-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.197187886-08:00","closed_at":"2026-01-12T18:31:47.197187886-08:00","close_reason":"Duplicate: merged into wf-e6r.3","dependencies":[{"issue_id":"wf-e6r.3.5","depends_on_id":"wf-e6r.3","type":"parent-child","created_at":"2026-01-12T18:29:57.272581461-08:00","created_by":"WAIF"}],"comments":[{"id":153,"issue_id":"wf-e6r.3.5","author":"rgardler","text":"Duplicate run-job wiring task — merge into wf-e6r.3 (CLI Surface).","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.4","title":"Job Runner \u0026 Process Management","description":"Execute configured commands safely with timeout and capture. See wf-e6r.\\n\\n## Acceptance Criteria\\n- Executes job commands, enforces timeout, returns exit code/status.\\n- Captures stdout/stderr and provides truncated summary.\\n- Integration tests verify behavior.\\n\\n## Minimal Implementation\\n- Implement src/lib/runner.ts with child_process wrapper, timeout, and capture.\\n- Use src/lib/redact.ts to sanitize output.\\n","notes":"Runner implementation and tests complete; docs follow-up (wf-e6r.4.3) remains open.","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-08T00:39:19.151210732-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:11:45.538071952-08:00","closed_at":"2026-01-15T23:11:45.538075774-08:00","labels":["feature"],"dependencies":[{"issue_id":"wf-e6r.4","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:19.151959857-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.4","depends_on_id":"wf-e6r.2","type":"blocks","created_at":"2026-01-08T00:39:35.093047178-08:00","created_by":"WAIF"}],"comments":[{"id":146,"issue_id":"wf-e6r.4","author":"rgardler","text":"Acceptance: runner executes commands with timeout; supports capture opt-in; returns structured RunResult; unit + integration tests.","created_at":"2026-01-12T10:10:00Z"}]}
{"id":"wf-e6r.4.1","title":"Implement: wf-e6r.4 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","notes":"Implementation verified by unit tests and runner integration tests.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:33.010464374-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:11:39.767924405-08:00","closed_at":"2026-01-15T23:11:39.76795855-08:00","dependencies":[{"issue_id":"wf-e6r.4.1","depends_on_id":"wf-e6r.4","type":"parent-child","created_at":"2026-01-08T00:41:33.011181108-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.4.2","title":"Tests: wf-e6r.4 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","notes":"Tests executed and passed locally (unit + runner integration tests).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:33.124760835-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:11:41.619288675-08:00","closed_at":"2026-01-15T23:11:41.619292784-08:00","dependencies":[{"issue_id":"wf-e6r.4.2","depends_on_id":"wf-e6r.4","type":"parent-child","created_at":"2026-01-08T00:41:33.12597081-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.4.3","title":"Docs: wf-e6r.4 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","notes":"Docs updated and PR #132 merged","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:33.247297673-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:20:23.078972798-08:00","closed_at":"2026-01-15T23:20:23.078981174-08:00","external_ref":"PR: https://github.com/SorraTheOrc/waif/pull/132","labels":["Status: PR Created"],"dependencies":[{"issue_id":"wf-e6r.4.3","depends_on_id":"wf-e6r.4","type":"parent-child","created_at":"2026-01-08T00:41:33.247986456-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.4.4","title":"Implement: Job runner (wf-e6r.4.impl)","description":"Implement src/lib/runner.ts: accept command string or array, support capture opt-in, enforce timeout, return structured RunResult { status, code, stdout, stderr, durationMs, sanitized, truncated }. Use redact.ts when job.redact=true.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:57.057780417-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.339157434-08:00","closed_at":"2026-01-12T18:31:47.339157434-08:00","close_reason":"Duplicate: merged into wf-e6r.4","dependencies":[{"issue_id":"wf-e6r.4.4","depends_on_id":"wf-e6r.4","type":"parent-child","created_at":"2026-01-12T18:29:57.059473429-08:00","created_by":"WAIF"}],"comments":[{"id":154,"issue_id":"wf-e6r.4.4","author":"rgardler","text":"Duplicate implementation task — merge into wf-e6r.4 (Job Runner).","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.4.5","title":"Tests: Job runner (wf-e6r.4.tests)","description":"Unit tests for runner: array-form vs shell string, timeout behavior, capture on/off, large output truncation, redaction application.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:57.109589456-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.474812866-08:00","closed_at":"2026-01-12T18:31:47.474812866-08:00","close_reason":"Duplicate: merged into wf-e6r.4","dependencies":[{"issue_id":"wf-e6r.4.5","depends_on_id":"wf-e6r.4","type":"parent-child","created_at":"2026-01-12T18:29:57.110318475-08:00","created_by":"WAIF"}],"comments":[{"id":155,"issue_id":"wf-e6r.4.5","author":"rgardler","text":"Duplicate tests task — merge into wf-e6r.4 tests tracking.","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.5","title":"Snapshot Persistence \u0026 Redaction","description":"Sanitize outputs and append JSONL snapshots to history/, enforce retention. See wf-e6r.\\n\\n## Acceptance Criteria\\n- Appends JSONL snapshot lines for runs.\\n- Redaction uses src/lib/redact.ts and tests exist.\\n- Retention policy enforced.\\n\\n## Minimal Implementation\\n- Implement src/lib/snapshot.ts and integrate with Job Runner completion.\\n","notes":"Docs PR: https://github.com/SorraTheOrc/waif/pull/134","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-08T00:39:21.867086126-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:18:48.738144036-08:00","closed_at":"2026-01-16T01:18:48.738144036-08:00","close_reason":"Implemented; tests \u0026 docs merged","labels":["Status: Integrated","Status: PR Created","feature"],"dependencies":[{"issue_id":"wf-e6r.5","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:21.869386693-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.5","depends_on_id":"wf-e6r.4","type":"blocks","created_at":"2026-01-08T00:39:34.541908071-08:00","created_by":"WAIF"}],"comments":[{"id":147,"issue_id":"wf-e6r.5","author":"rgardler","text":"Acceptance: write JSONL snapshots with metadata (durationMs, sanitized, truncated flag); use src/lib/redact.ts; enforce retention.keep_last with tests.","created_at":"2026-01-12T10:10:00Z"}]}
{"id":"wf-e6r.5.1","title":"Implement: wf-e6r.5 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","notes":"Implemented on main: src/lib/snapshots.ts + tests + docs (merged).","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-08T00:41:33.423787124-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:13:21.235609841-08:00","closed_at":"2026-01-16T01:13:21.235618311-08:00","dependencies":[{"issue_id":"wf-e6r.5.1","depends_on_id":"wf-e6r.5","type":"parent-child","created_at":"2026-01-08T00:41:33.424474932-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.5.2","title":"Tests: wf-e6r.5 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","notes":"PR: https://github.com/SorraTheOrc/waif/pull/133","status":"closed","priority":1,"issue_type":"task","assignee":"probe","created_at":"2026-01-08T00:41:33.52472489-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:18:24.724793225-08:00","closed_at":"2026-01-16T00:18:24.724799797-08:00","labels":["Status: PR Created"],"dependencies":[{"issue_id":"wf-e6r.5.2","depends_on_id":"wf-e6r.5","type":"parent-child","created_at":"2026-01-08T00:41:33.526540448-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.5.3","title":"Docs: wf-e6r.5 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","notes":"PR: https://github.com/SorraTheOrc/waif/pull/134","status":"closed","priority":2,"issue_type":"task","assignee":"scribbler","created_at":"2026-01-08T00:41:33.637443583-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:18:26.299715518-08:00","closed_at":"2026-01-16T00:18:26.299723652-08:00","labels":["Status: PR Created"],"dependencies":[{"issue_id":"wf-e6r.5.3","depends_on_id":"wf-e6r.5","type":"parent-child","created_at":"2026-01-08T00:41:33.63823745-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.5.4","title":"Implement: Snapshot module (wf-e6r.5.impl)","description":"Create src/lib/snapshot.ts: atomic append of JSONL, add metadata fields (durationMs, sanitized, truncated, metadata_version), enforce retention.keep_last, write tests.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:57.163704297-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.58416324-08:00","closed_at":"2026-01-12T18:31:47.58416324-08:00","close_reason":"Duplicate: merged into wf-e6r.5","dependencies":[{"issue_id":"wf-e6r.5.4","depends_on_id":"wf-e6r.5","type":"parent-child","created_at":"2026-01-12T18:29:57.164540532-08:00","created_by":"WAIF"}],"comments":[{"id":156,"issue_id":"wf-e6r.5.4","author":"rgardler","text":"Duplicate implementation task — merge into wf-e6r.5 (Snapshot Persistence).","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.5.5","title":"Tests: Snapshot module (wf-e6r.5.tests)","description":"Unit tests for snapshot writing, metadata fields present, redaction applied, retention trimming to last N non-empty lines.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T18:29:57.217694421-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.727151219-08:00","closed_at":"2026-01-12T18:31:47.727151219-08:00","close_reason":"Duplicate: merged into wf-e6r.5","dependencies":[{"issue_id":"wf-e6r.5.5","depends_on_id":"wf-e6r.5","type":"parent-child","created_at":"2026-01-12T18:29:57.218630639-08:00","created_by":"WAIF"}],"comments":[{"id":157,"issue_id":"wf-e6r.5.5","author":"rgardler","text":"Duplicate tests task — merge into wf-e6r.5 tests tracking.","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.6","title":"Tests \u0026 CI E2E","description":"Unit and E2E tests for scheduler, runner, snapshot, and CLI. See wf-e6r.\\n\\n## Acceptance Criteria\\n- Unit tests for modules; CI job that runs E2E mock job and asserts snapshot created.\\n\\n## Minimal Implementation\\n- Add test harness and GitHub Actions workflow step for E2E.\\n","notes":"Merged PR #137 (docs cleanup) and PR #136/135 merged; legacy tmux/probe cleanup confirmed. Closing wf-e6r.6 per Producer request.","status":"closed","priority":2,"issue_type":"feature","assignee":"probe","created_at":"2026-01-08T00:39:24.724102771-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:56:00.022997248-08:00","closed_at":"2026-01-16T00:56:00.023005029-08:00","labels":["Status: PR Created","feature"],"dependencies":[{"issue_id":"wf-e6r.6","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:24.725228138-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.6","depends_on_id":"wf-e6r.5","type":"blocks","created_at":"2026-01-08T00:39:38.558568219-08:00","created_by":"WAIF"}],"comments":[{"id":148,"issue_id":"wf-e6r.6","author":"rgardler","text":"Acceptance: unit tests for scheduler/runner/snapshot; CI E2E job that runs a mock job and asserts snapshot created and retention enforced.","created_at":"2026-01-12T10:10:01Z"}]}
{"id":"wf-e6r.6.1","title":"Implement: wf-e6r.6 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:33.78171751-08:00","created_by":"WAIF","updated_at":"2026-01-08T00:41:33.78171751-08:00","dependencies":[{"issue_id":"wf-e6r.6.1","depends_on_id":"wf-e6r.6","type":"parent-child","created_at":"2026-01-08T00:41:33.782411385-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.6.2","title":"Tests: wf-e6r.6 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:33.873902698-08:00","created_by":"WAIF","updated_at":"2026-01-08T00:41:33.873902698-08:00","dependencies":[{"issue_id":"wf-e6r.6.2","depends_on_id":"wf-e6r.6","type":"parent-child","created_at":"2026-01-08T00:41:33.874675007-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.6.3","title":"Docs: wf-e6r.6 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:33.972600889-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:41:02.512559976-08:00","closed_at":"2026-01-19T03:41:02.51256354-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-e6r.6.3","depends_on_id":"wf-e6r.6","type":"parent-child","created_at":"2026-01-08T00:41:33.973372222-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.6.4","title":"Chore: Add sandboxed CI job for run-job E2E (wf-e6r.6.ci)","description":"Add GitHub Actions job that runs run-job E2E tests in a container sandbox; ensure it runs on dedicated runner or container and does not execute untrusted host commands.","status":"closed","priority":1,"issue_type":"chore","assignee":"ship","created_at":"2026-01-12T18:29:57.326743884-08:00","created_by":"WAIF","updated_at":"2026-01-12T18:31:47.838591668-08:00","closed_at":"2026-01-12T18:31:47.838591668-08:00","close_reason":"Duplicate: merged into wf-e6r.6 / wf-mr1","dependencies":[{"issue_id":"wf-e6r.6.4","depends_on_id":"wf-e6r.6","type":"parent-child","created_at":"2026-01-12T18:29:57.327589132-08:00","created_by":"WAIF"}],"comments":[{"id":158,"issue_id":"wf-e6r.6.4","author":"rgardler","text":"Duplicate chore — merge into wf-e6r.6 CI tracking (wf-mr1 exists for CI sandbox).","created_at":"2026-01-13T02:31:47Z"}]}
{"id":"wf-e6r.7","title":"Docs \u0026 Operator Guidance","description":"Update PRD, CLI docs, config examples, and operator migration checklist for scheduler. See wf-e6r.\\n\\n## Acceptance Criteria\\n- PRD updated, README/Workflow updated with examples, operator checklist added.\\n\\n## Minimal Implementation\\n- Draft docs/dev/prd-ooda-loop.md update and add docs/usage/ooda_scheduler.md.\\n","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T00:39:27.394462554-08:00","created_by":"WAIF","updated_at":"2026-01-12T02:10:00.377181979-08:00","closed_at":"2026-01-12T02:10:00.377181979-08:00","close_reason":"Verified: docs merged (PR #108 / ee4dc6a)","labels":["feature"],"dependencies":[{"issue_id":"wf-e6r.7","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:27.395288271-08:00","created_by":"WAIF"}],"comments":[{"id":143,"issue_id":"wf-e6r.7","author":"rgardler","text":"Verified: docs present (docs/commands/ooda.md). PR #108 / commit ee4dc6a.","created_at":"2026-01-12T10:10:00Z"}]}
{"id":"wf-e6r.7.1","title":"Implement: wf-e6r.7 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:34.129288843-08:00","created_by":"WAIF","updated_at":"2026-01-08T00:41:34.129288843-08:00","dependencies":[{"issue_id":"wf-e6r.7.1","depends_on_id":"wf-e6r.7","type":"parent-child","created_at":"2026-01-08T00:41:34.129990843-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.7.2","title":"Tests: wf-e6r.7 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:34.231892776-08:00","created_by":"WAIF","updated_at":"2026-01-08T00:41:34.231892776-08:00","dependencies":[{"issue_id":"wf-e6r.7.2","depends_on_id":"wf-e6r.7","type":"parent-child","created_at":"2026-01-08T00:41:34.232650351-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.7.3","title":"Docs: wf-e6r.7 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:34.338335502-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:41:02.50879731-08:00","closed_at":"2026-01-19T03:41:02.508804438-08:00","labels":["done"],"dependencies":[{"issue_id":"wf-e6r.7.3","depends_on_id":"wf-e6r.7","type":"parent-child","created_at":"2026-01-08T00:41:34.339125902-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8","title":"Cleanup: Legacy OODA Removal","description":"Inventory and remove/refactor legacy tmux/probe and event-driven OODA code/tests/docs after new scheduler verified. See wf-e6r.\\n\\n## Acceptance Criteria\\n- Legacy codepaths removed or refactored and tests updated.\\n- Cleanup PR passes CI with E2E green.\\n\\n## Minimal Implementation\\n- Produce inventory and plan; implement small refactors and final cleanup PR.\\n","notes":"Cleanup-only scope satisfied; closed remaining housekeeping dependents as requested by Producer. All legacy tmux/probe cleanup chores complete and docs PR merged.","status":"closed","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-08T00:39:30.676627509-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:00:15.702134967-08:00","closed_at":"2026-01-16T01:00:15.702139965-08:00","labels":["feature"],"dependencies":[{"issue_id":"wf-e6r.8","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:39:30.677568926-08:00","created_by":"WAIF"},{"issue_id":"wf-e6r.8","depends_on_id":"wf-e6r.6","type":"blocks","created_at":"2026-01-08T00:39:40.433434302-08:00","created_by":"WAIF"}],"comments":[{"id":149,"issue_id":"wf-e6r.8","author":"rgardler","text":"Acceptance: inventory legacy ooda code/tests/docs; plan and small cleanup PRs post-verification.","created_at":"2026-01-12T10:10:01Z"}]}
{"id":"wf-e6r.8.1","title":"Implement: wf-e6r.8 - ","description":"Implement core functionality for .\\n\\n## Acceptance Criteria\\n- Module implemented and exported at expected path.\\n- Unit tests added where applicable.\\n- Integration points documented.\\n","notes":"Not relevant to cleanup epic; closing as housekeeping per Producer decision — legacy cleanup only.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:34.49780784-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:00:13.716615309-08:00","closed_at":"2026-01-16T01:00:13.716622326-08:00","dependencies":[{"issue_id":"wf-e6r.8.1","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-08T00:41:34.498683282-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.2","title":"Tests: wf-e6r.8 - ","description":"Add unit and integration tests for .\\n\\n## Acceptance Criteria\\n- Unit tests cover edge cases and error paths.\\n- E2E test(s) exercising feature integrated into CI.\\n","notes":"Not relevant to cleanup epic; closing as housekeeping per Producer decision — legacy cleanup only.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T00:41:34.619362419-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:00:13.72109545-08:00","closed_at":"2026-01-16T01:00:13.721099776-08:00","dependencies":[{"issue_id":"wf-e6r.8.2","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-08T00:41:34.620724061-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.3","title":"Docs: wf-e6r.8 - ","description":"Add docs and operator guidance for .\\n\\n## Acceptance Criteria\\n- PRD or docs updated with usage examples.\\n- Config examples and migration notes included.\\n","notes":"Not relevant to cleanup epic; closing as housekeeping per Producer decision — legacy cleanup only.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T00:41:34.727036245-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:00:13.724293574-08:00","closed_at":"2026-01-16T01:00:13.724296746-08:00","dependencies":[{"issue_id":"wf-e6r.8.3","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-08T00:41:34.728696779-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.4","title":"Cleanup: remove scripts/emit-events.js (low-risk)","notes":"Removed scripts/emit-events.js in feature/wf-e6r.cleanup-legacy","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:26:23.798666332-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:42:22.031144152-08:00","closed_at":"2026-01-16T00:42:22.031148931-08:00","dependencies":[{"issue_id":"wf-e6r.8.4","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:26:23.799750653-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.5","title":"Cleanup: remove scripts/dev_opencode_emitter.js (low-risk)","notes":"Removed scripts/dev_opencode_emitter.js in feature/wf-e6r.cleanup-legacy","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:26:27.873991833-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:42:24.566622129-08:00","closed_at":"2026-01-16T00:42:24.566627004-08:00","dependencies":[{"issue_id":"wf-e6r.8.5","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:26:27.874699457-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.6","title":"Cleanup: remove scripts/parse-workflow-config.js if unused (low-risk)","description":"Consider removing parse-workflow-config.js if start-workflow-tmux is no longer used or has been simplified; verify other scripts depend on it.","notes":"Removed in feature/wf-e6r.cleanup-legacy","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:35:14.813191357-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:39:01.092812262-08:00","closed_at":"2026-01-16T00:39:01.09281858-08:00","dependencies":[{"issue_id":"wf-e6r.8.6","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:35:14.814193809-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.7","title":"Cleanup: remove scripts/idle-scheduler.sh (review before removal)","description":"Candidate to remove if no agent idle tasks remain or if idle behavior is replaced by scheduler-based tasks. Verify start-workflow-tmux.sh no longer references it and check docs.","notes":"Removed idle-scheduler.sh and start-workflow-tmux.sh in feature/wf-e6r.cleanup-legacy","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:38:50.572091826-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:42:16.736090009-08:00","closed_at":"2026-01-16T00:42:16.736095822-08:00","dependencies":[{"issue_id":"wf-e6r.8.7","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:38:50.572997466-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.8","title":"Cleanup: remove scripts/idle-scheduler.sh (low-risk)","description":"Remove idle scheduler helper script no longer used by tmux workflow; run tests after removal.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:41:57.662719379-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:50:30.750315855-08:00","closed_at":"2026-01-16T00:50:30.75032467-08:00","dependencies":[{"issue_id":"wf-e6r.8.8","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:41:57.663778766-08:00","created_by":"WAIF"}]}
{"id":"wf-e6r.8.9","title":"Docs: remove tmux instructions and add OODA migration notes","description":"Update README.md and docs to remove references to removed tmux scripts, add migration instructions pointing to .waif/ooda-scheduler.yaml and 'waif ooda' usage. Include examples and note removal of scripts/start-workflow-tmux.sh and scripts/idle-scheduler.sh.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-16T00:47:06.7745859-08:00","created_by":"WAIF","updated_at":"2026-01-16T00:48:20.11655048-08:00","closed_at":"2026-01-16T00:48:20.11655644-08:00","dependencies":[{"issue_id":"wf-e6r.8.9","depends_on_id":"wf-e6r.8","type":"parent-child","created_at":"2026-01-16T00:47:06.775281669-08:00","created_by":"WAIF"}]}
{"id":"wf-ee7v","title":"Refactor: unify snapshot writer API (writeJobSnapshot)","description":"Consolidate snapshot writer APIs and usage into a single, well-documented helper to avoid confusion and duplication.\\n\\nBackground:\\nCurrently there are two similarly named functions: a CLI helper writeJobSnapshot in src/commands/ooda.ts and the module-level writeJobSnapshot/appendSnapshotFile in src/lib/snapshots.ts. This refactor standardises the API, documents the exported function, updates callers, and leaves clear migration notes.\\n\\nAcceptance Criteria:\\n- Provide a single exported API in src/lib/snapshots.ts (e.g. appendSnapshotFile as canonical) with a small wrapper if needed for CLI ergonomics.\\n- Update src/commands/ooda.ts to call the canonical API and remove the duplicate CLI-local helper.\\n- Add/adjust unit tests so snapshot writing behavior (redaction, metadata, retention) remains identical.\\n- Add a short note in history/ or docs briefly describing the API change for reviewers.\\n","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-16T01:18:48.494702699-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:25:20.538694611-08:00","labels":["Refactor"],"dependencies":[{"issue_id":"wf-ee7v","depends_on_id":"wf-e6r.5","type":"discovered-from","created_at":"2026-01-16T01:18:48.518559799-08:00","created_by":"WAIF"}]}
{"id":"wf-esf","title":"Create Implementation Skill","description":"Final headline\n\nImplement an agent \"Implementation skill\" that, given a Producer-specified bead or intake, creates a feature branch, implements code changes (with tests and docs), pushes the branch, opens a GitHub PR with testing instructions and bead links, and records actions back to Beads. The agent may push branches and open PRs automatically; merges require a human reviewer after CI passes.\n\n\nProblem\n- There is no repo-scoped Implementation skill that can take a Producer request and produce a complete code change (branch + commits + tests + docs) and a GitHub PR. This slows delivery because engineers must manually implement trivial wiring and plumbing that could be automated, and it increases handoff friction for small, well-scoped work.\n\nUsers\n- Primary: Producers / PMs who request implementation work from the agent stack.\n- Secondary: Engineers and reviewers who will review, test, and merge PRs; automation (CI) that validates changes.\n\nSuccess criteria\n- Given a beads issue and confirmed scope, the Implementation skill:\n  1) Creates a topic branch following repo convention (\u003cbeads_prefix\u003e-\u003cbd-id\u003e/\u003cshort-desc\u003e) and produces one or more commits implementing the requested change, including tests and concise documentation.\n  2) Opens a GitHub PR with a clear body containing: intent, implementation overview, testing instructions (automated \u0026 manual), and links to the source bead(s).\n  3) Updates the originating bead(s) / epic(s) with links to the created PR(s) and a short summary of changed files; adds a \"next steps\" list for discovered but out-of-scope follow-ups.\n  4) Ensures CI/lint/tests pass before recommending merge; merges only after human reviewer approval (human-merge).\n  5) Is idempotent: re-running against the same bead does not create duplicate PRs or duplicate bead links.\n  - Done-test (explicit example): Running the skill against bd-123 creates branch bd-123/\u003cshort-desc\u003e, opens PR linking bd-123, includes relevant tests and docs, CI passes, and bd-123 is updated with an external-ref to the PR and a short summary of files changed.\n\nConstraints\n- Security: No secrets may be added to commits, PR bodies, logs, or bead comments.\n- Branch \u0026 PR policy: Agent may push branches and open PRs automatically; merges require a human reviewer (no auto-merge).\n- Branch naming: Must follow \u003cbeads_prefix\u003e-\u003cbd-id\u003e/\u003cshort-desc\u003e.\n- Implementation must include tests and concise documentation and include clear instructions for automated and manual verification in the PR body.\n- The agent must not unilaterally change bead assignees without explicit Producer instruction (propose-only for assignment changes unless explicitly told otherwise).\n\nExisting state\n- .opencode/command/intake.md — intake process \u0026 interview templates to capture scope (agent: build).\n- .opencode/command/implement.md — implementation workflow for agents (agent: patch). Defines safety gate for uncommitted changes, definition checklist, automated review stages, commit/push/PR steps, and bead update rules.\n- .opencode/command/doc.md — docs authoring command (agent: scribbler). Defines pre-implementation doc responsibilities, temp draft location, and bead write-back process.\n- Other relevant .opencode/command files: plan.md, prd.md, review.md, testplan.md, landThePlane.md, design.md, milestones.md — these define adjacent steps (planning, PRD authoring, test guidance, review, landing) that the Implementation skill must integrate with or respect.\n- docs/dev/prd/opencode_integration_PRD.md — OpenCode integration PRD (parent epic wf-gn7).\n- docs/dev/CONTEXT_PACK.md, docs/Workflow.md — repo context \u0026 PRD-driven workflow guidance.\n- Beads: wf-gn7 (OpenCode integration epic — chosen parent), wf-70j.* (PM/skill family: intake, PRD linking, plan generation), wf-5e2 (PM: decompose PRD into bead plan).\n\nDesired change\n- Implement an agent skill (\"Implementation skill\") that accepts a Producer-specified bead (or freeform request per /intake), implements the requested code changes on a branch, pushes the branch, opens a PR (with tests \u0026 docs), and records actions back to beads. Produce \"next step\" recommendations for any discovered out-of-scope work and link them from the bead.\n\nLikely duplicates / related docs\n- docs/dev/CONTEXT_PACK.md — repo context \u0026 agent guidance\n- .opencode/command/intake.md — intake command and interview templates (read)\n- .opencode/command/implement.md — implementation command (defines expected implement flow)\n- .opencode/command/doc.md — documentation authoring command (pre-implementation docs)\n- docs/Workflow.md — PRD-driven workflow \u0026 policies\n- docs/dev/prd/opencode_integration_PRD.md — OpenCode integration PRD\n\nRelated issues (Beads ids)\n- wf-gn7 — OpenCode integration (recommended parent)\n- wf-70j, wf-70j.1, wf-70j.2, wf-70j.3, wf-70j.4, wf-70j.5, wf-70j.6 — PM skill and intake/PRD/bead-plan family (reference)\n- wf-5e2 — PM: decompose PRD into bead plan (related)\n\nRisks \u0026 assumptions\n- Branch protection or GitHub permissions may block agent pushes or PR creation depending on repository settings (confirm actor \u0026 permissions).\n- The PR actor (bot vs named user) affects branch protections, CI permissions, and audits — confirm desired actor.\n- Tests selection: the skill must determine the minimal, relevant tests to run; mis-selection could lead to false confidence.\n- Flaky CI/tests may delay human-merge or give false green status.\n- Idempotence detection: the skill must reliably detect existing PRs/branches to avoid duplicates (branch name + external-ref matching).\n- Human-merge delay: merges will wait for human approval which may lengthen cycle time.\n- Secret leakage risk: commits/PR bodies must be scanned to ensure no secrets are added.\n\nRecommended next step\n- UPDATE PRD at: docs/dev/prd/opencode_integration_PRD.md to add the Implementation-skill scope, security boundaries, acceptance tests, and enablement checklist; create the bead as a sub-issue under wf-gn7 once this intake is approved.\n\nAreas that could benefit from expansion (clarifying questions)\n- Audit trail format: do you want a mandatory bead comment format for every automated action (time, action, branch, PR URL)? (recommended)\n- CI gating: must CI be green before a human may merge, or should the skill only \"recommend merge\" when CI is green? (current draft assumes the skill requires CI green before recommending merge; human merges)\n- GitHub actor: should PRs appear from an agent bot account or a named human account? This affects CI permissions and branch protections.\n\nFiles / commands referenced\n- Files read:\n  - docs/dev/CONTEXT_PACK.md\n  - .opencode/command/intake.md\n  - .opencode/command/implement.md\n  - .opencode/command/doc.md\n  - docs/dev/prd/opencode_integration_PRD.md (path discovered)\n- Command refs: bd create, bd update, bd sync, git commands per .opencode/command/implement.md\n\n","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/95. Branch: wf-esf/create-implementation-skill. Files changed: .beads/.gitignore,.beads/issues.jsonl,.opencode/agent/build.md,.opencode/agent/patch.md,.opencode/agent/pixel.md,.opencode/command/doc.md,.opencode/command/implement.md,.opencode/command/intake.md,.opencode/command/landThePlane.md,.opencode/command/milestones.md,.opencode/command/plan.md,.opencode/command/prd.md,.opencode/command/testplan.md,docs/dev/Workflow.md,docs/dev/implementation_plans/ooda_implementation_plan.md,docs/dev/prd/CLI_PRD.md,docs/dev/prd/PRD-command-in-progress.md,docs/dev/prd/TUI_PRD.md,docs/dev/prd/context_pack_PRD.md,docs/dev/prd/opencode_integration_PRD.md,docs/dev/prd/prd-command-next.md,docs/dev/prd/prd-ooda-loop.md,tmp/wf-cnw-desc-updated.md","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-07T01:38:07.741092002-08:00","created_by":"WAIF","updated_at":"2026-01-07T01:57:42.736111178-08:00","closed_at":"2026-01-07T01:57:42.736111178-08:00","close_reason":"PR merged: gh-95","external_ref":"gh-95","labels":["Status: Intake Completed","Status: PR Created","Status: PR Merged"]}
{"id":"wf-et5y","title":"Update tests and CI to use 'wf' instead of 'waif'","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-16T17:39:36.094147715-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:39:36.094147715-08:00","dependencies":[{"issue_id":"wf-et5y","depends_on_id":"wf-k5um.7","type":"discovered-from","created_at":"2026-01-16T17:39:36.095002415-08:00","created_by":"WAIF"}]}
{"id":"wf-f2vv","title":"Standardize TMUX removal error text and tests","description":"Decide canonical user-facing error message when TMUX integration is invoked after removal. Update tests to assert the exact message to avoid future test breakage. Do not change runtime code without approval; if runtime change approved, implement in src and update tests together.","notes":"Canonical message recorded in src/lib/tmux-removed.ts; tests updated to assert ensureTmuxRemoved() is thrown. Verified PR #150 merged and main builds/tests locally. Closing bead.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T20:49:34.292946585-08:00","created_by":"WAIF","updated_at":"2026-01-16T21:02:36.285223344-08:00","closed_at":"2026-01-16T21:02:36.28523256-08:00"}
{"id":"wf-fbo","title":"Decision: Choose release publish target and CI enforcement","description":"Decide whether to publish to npm, GitHub Releases, or both, and whether to enforce version/tag correctness in CI; document outcome in docs/release_management.md.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:44.861514996-08:00","updated_at":"2025-12-19T22:11:35.675900992-08:00","dependencies":[{"issue_id":"wf-fbo","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.532513538-08:00","created_by":"daemon"}]}
{"id":"wf-fzov","title":"in-progress output missing dependency relationships in bd show","description":"Problem: dependency relationships are not being shown in 'bd show' output for items displayed by 'bd ready' / in-progress view. Example missing relationship: 'Depends on (1): → ge-hch.5: M2 — AI-assisted branching integration [P1]'.\\n\\nImpact: incorrect or incomplete dependency information in in-progress listings can cause work to be started or merged out of order, leading to integration issues and missed blockers.\\n\\nAcceptance criteria:\\n- 'bd ready' and in-progress listings include 'Depends on' lines for items that have dependencies, matching the full dependency list shown by 'bd show'.\\n- 'bd show \u003cid\u003e' output and the in-progress summary use the same dependency formatting and include linked IDs and titles.\\n- Added unit/integration test(s) that validate in-progress output includes dependencies when present.\\n- Documentation note added explaining the expected display behavior and how dependencies are represented.\\n\\nNotes: This is P0 (critical) because it affects correctness of task scheduling and blocking semantics.\\n,--json","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-18T17:10:02.904342688-08:00","created_by":"WAIF","updated_at":"2026-01-19T00:12:56.554494441-08:00","closed_at":"2026-01-19T00:12:56.554494441-08:00","close_reason":"Merged PR #159","external_ref":"https://github.com/SorraTheOrc/waif/pull/159","labels":["Status: PR Created"]}
{"id":"wf-g07o","title":"Refactor: clarify timeout calculation in ooda runJobCommand","description":"Simplify timeout calculation in ooda runJobCommand and add unit coverage.\\n\\nBackground:\\nThe computation of timeoutMs uses a compact expression that is correct but hard to read: (job.timeout_seconds ?? DEFAULT_TIMEOUT_MS / 1000) * 1000. Refactor to a clearer sequence and add tests to prove semantics for default, configured, and edge values.\\n\\nAcceptance Criteria:\\n- Refactor timeout computation to explicit steps (determine timeout seconds, coerce to number, compute ms).\\n- Add unit tests covering: default timeout, explicit timeout_seconds (e.g., 1, 60), and extremely small/zero values (coerced to minimum 1 ms).\\n- Ensure behavior is identical to existing behavior (no change in runtime semantics).\\n","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-16T01:18:48.628796814-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:25:20.620686105-08:00","labels":["Refactor"],"dependencies":[{"issue_id":"wf-g07o","depends_on_id":"wf-e6r.5","type":"discovered-from","created_at":"2026-01-16T01:18:48.630361686-08:00","created_by":"WAIF"}]}
{"id":"wf-g84u","title":"Fix: CI artifact should include scheduler snapshot JSONL","description":"CI OODA E2E run 21019385657 (PR #122) only uploaded vitest-results.json; no ooda_snapshot_*.jsonl artifact present. Acceptance for wf-e6r.1.2 requires verifying snapshot JSONL fields (time, job_id, status, exit_code, durationMs, metadata_version) and retention. Action: update workflow to upload snapshot JSONL (tests/**/ooda_snapshot_*.jsonl or history/ooda_snapshot_*.jsonl) and re-run CI. Link back to wf-e6r.1.2.","notes":"PR merged and branch cleaned up locally. tmp-artifacts removed from index and tmp-artifacts/ added to .gitignore. Note: cleanup commit must be PR'd to main due to branch protection; local reset to origin/main.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T20:43:41.548271595-08:00","created_by":"WAIF","updated_at":"2026-01-14T20:53:20.39111309-08:00","closed_at":"2026-01-14T20:53:20.39111309-08:00","close_reason":"Closed by request: PR #123 merged. Probe to verify wf-e6r.1.2 separately.","labels":["Status: Merged","Status: PR Created"],"dependencies":[{"issue_id":"wf-g84u","depends_on_id":"wf-e6r.1.2","type":"discovered-from","created_at":"2026-01-14T20:43:41.551992009-08:00","created_by":"WAIF"}]}
{"id":"wf-gkf","title":"Config-driven tmux workflow agents","description":"# Overview\nstart-workflow-tmux.sh currently hard-codes the agent panes (pm/design/build/docs/review/user) and inlines the PM idle_task override. We need a declarative YAML config (e.g., config/workflow_agents.yaml) listing each agent pane plus their idle scheduler behavior so tweaks don\u0019t require editing the script.\n\n# Scope / Requirements\n- New YAML config entries should include: agent name/role, optional worktree override, optional env overrides (incl. BD_ACTOR call sign), optional idle settings (task snippet + frequency/variance numbers).\n- Update start-workflow-tmux.sh to parse the YAML (python or node helper) and spawn panes in the order defined; fall back to today\u0012s defaults when the config is missing.\n- When an idle.task is defined, define idle_task() with the provided shell snippet (single command for now) and source scripts/idle-scheduler.sh using the configured frequency/variance (default 30 \u001c10 when unspecified).\n- Apply env overrides before waif startWork, so BD_ACTOR can reflect each agent\u0019s call-sign.\n- Error loudly on malformed YAML or unknown agent names.\n- Document the config format/behavior in docs/Workflow.md and docs/dev/idle_scheduler_module.md.\n\n# Non-Goals\n- Sequential idle commands (can revisit later).\n- Changing pane layout or adding GUIs.\n- Introducing new background daemons beyond the existing idle scheduler.\n\n# Open Questions\n- Preferred YAML parser (python vs node)?\n- Should we allow pointing to an alternate config path via env var?\n- How should we validate missing agent files or idle scripts?","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-20T16:59:36.867772945-08:00","updated_at":"2025-12-20T22:35:02.492004875-08:00","closed_at":"2025-12-20T22:35:02.492004875-08:00"}
{"id":"wf-gmn","title":"Feature: CI E2E test for ooda ingestion","description":"Acceptance criteria:\\n- Dev emitter script that can append sample events to .opencode/logs/events.jsonl\\n- GitHub Actions job that runs the emitter + waif ooda --once --json and asserts expected output\\n- Jobs are non-flaky in CI and included in PRs that change ooda logic","status":"tombstone","priority":2,"issue_type":"feature","created_at":"2025-12-28T16:00:43.021422062-08:00","updated_at":"2026-01-19T04:10:50.003006329-08:00","dependencies":[{"issue_id":"wf-gmn","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T16:00:43.031071497-08:00","created_by":"daemon"}],"deleted_at":"2026-01-19T04:10:50.003006329-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"feature"}
{"id":"wf-gn7","title":"OpenCode integration","description":"OpenCode integration (wf-gn7)\n\nCanonical PRD: docs/dev/opencode_integration_PRD.md\n\nSession triage completed — see the PRD for full scope, acceptance criteria, and deliverables.\n\nNote: The PRD references the package manifest at config/waif_pacakges.yaml (preserves the preferred filename). Child issues wf-gn7.* remain present, open, and unassigned.\n","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-24T12:07:41.589893752-08:00","updated_at":"2025-12-30T01:31:38.298205724-08:00","closed_at":"2025-12-30T01:31:38.298215839-08:00","comments":[{"id":32,"issue_id":"wf-gn7","author":"muse","text":"Session update: ran workspace triage and surface readiness.\n\nCommands executed: bd ready --json; bd show wf-2ia --json; grep 'wf-gn7' -R to locate related issues and artifacts.\n\nFindings: confirmed parent epic wf-gn7 and child issues wf-gn7.2.1..wf-gn7.2.7 exist (hook CLI, installer, priming utils, opt-in skills, MCP fallback, CI E2E, security/redaction).\n\nFiles referenced/created: history/wf-gn7.claude-spike.md (exists), history/design-opencode-agent-integration-body.txt, .opencode/command/*, docs/dev/CLI_PRD.md, docs/Workflow.md. Temporary planning artifacts live under history/.\n\nNext steps recommended: draft PRD at docs/dev/opencode_integration_PRD.md; implement wf-gn7.2.1 (waif prime/opencode CLI); implement installer wf-gn7.2.2; add priming utilities wf-gn7.2.3; run security review wf-gn7.2.7; add CI E2E wf-gn7.2.6; then opt-in skills and MCP fallback.\n\nRemaining risks: potential secrets leakage in priming (need redaction); installer requiring sudo/system packages (decide policy); CI infra access for Linux runners.\n\nPlease assign owners or confirm prioritization to proceed.\n","created_at":"2025-12-25T03:46:48Z"},{"id":33,"issue_id":"wf-gn7","author":"muse","text":"Session update: ran workspace triage and surface readiness.\n\nCommands executed: bd ready --json; bd show wf-2ia --json; grep 'wf-gn7' -R to locate related issues and artifacts.\n\nFindings: confirmed parent epic wf-gn7 and child issues wf-gn7.2.1..wf-gn7.2.7 exist (hook CLI, installer, priming utils, opt-in skills, MCP fallback, CI E2E, security/redaction).\n\nFiles referenced/created: history/wf-gn7.claude-spike.md (exists), history/design-opencode-agent-integration-body.txt, .opencode/command/*, docs/dev/CLI_PRD.md, docs/Workflow.md. Temporary planning artifacts live under history/.\n\nNext steps recommended: draft PRD at docs/dev/opencode_integration_PRD.md; implement wf-gn7.2.1 (waif prime/opencode CLI); implement installer wf-gn7.2.2; add priming utilities wf-gn7.2.3; run security review wf-gn7.2.7; add CI E2E wf-gn7.2.6; then opt-in skills and MCP fallback.\n\nRemaining risks: potential secrets leakage in priming (need redaction); installer requiring sudo/system packages (decide policy); CI infra access for Linux runners.\n\nPlease assign owners or confirm prioritization to proceed.\n","created_at":"2025-12-25T04:10:21Z"},{"id":34,"issue_id":"wf-gn7","author":"muse","text":"Title: WAIF — OpenCode Integration PRD\n\nOverview\nWAIF must provide a reproducible, testable integration with OpenCode so developers can install, register, and use an OpenCode runtime for local development and agent workflows. This PRD defines the waif setup flow, the package manifest location, hook lifecycle, CLI primitives (waif prime/opencode), acceptance criteria, security constraints, test plan, and rollout guidance.\n\nGoals / Success criteria\n- Developers can run a single command (waif setup opencode-hooks) that validates prerequisites, optionally installs required system packages (with confirmation), and registers WAIF plugin(s) with a local OpenCode server.\n- A waif prime/opencode command exists to inject compact priming context during lifecycle events (session.start, pre-compact).\n- Priming payloads are budgeted to ~1k–2k tokens by default; summarization/token utilities exist (summarize(text,targetTokens), countTokens(text)).\n- Installer exposes a health-check: emits a test OpenCode event and verifies OODA loop consumption.\n- Security: priming context never leaks secrets; a redaction utility and threat-model checklist exist before enabling any skills.\n- Full CI coverage: E2E tests run on Linux runners exercising installer, priming, event emission, and OODA detection.\n\nConstraints\n- Platform: Linux only (including WSL). No macOS-specific automation.\n- Package list: externalized in config/waif_pacakges.yaml (editable YAML).\n- Default: do NOT enable plugin-specific skills by default. Opt-in flag required to enable.\n- Installer policy: waif setup may attempt sudo apt installs after explicit user confirmation (Option B as requested).\n- Rollback policy: on partial failure waif setup will NOT attempt full automatic rollback; it will emit clear diagnostics and manual cleanup instructions (Option 2).\n\nNon-Goals\n- Do not ship a default enabled set of OpenCode skills. Skills are opt-in only.\n- Do not attempt to manage external CI runner credentials or cloud infra in the initial implementation.\n\nUser flows\n1) Developer installs prerequisites (manual or via waif setup):\n   - waif setup opencode-hooks\n     - Validate OpenCode server is reachable (local socket/HTTP) or provide instructions to start one\n     - Validate required system packages from config/waif_pacakges.yaml\n     - Prompt user to allow sudo installs (apt) when packages missing; on confirmation, run sudo apt install \u003cpackages\u003e\n     - Register WAIF OpenCode plugin with the OpenCode runtime\n     - Run smoke health check: emit a test event and assert OODA notices it\n     - On success: print verification and uninstall instructions\n     - On failure: print diagnostics and manual cleanup steps\n\n2) Developer runs WAIF prime to inject compact context\n   - waif prime opencode --issue bd-123 --budget 1500\n     - Loads issue context (title, short description, latest comments) and runs summarize() to fit within token budget\n     - Calls OpenCode plugin registration endpoint to attach priming for session lifecycle events\n     - Optionally logs the generated priming payload to a local artifact for debugging (redacted)\n\n3) CI E2E job (Linux runner)\n   - Checkout fresh main\n   - Run waif setup opencode-hooks --noninteractive (CI mode) — CI will provide sudo if allowed by runner\n   - Run a small agent session that triggers session.start -\u003e plugin emits event -\u003e waif OODA pipeline detects and stores event\n   - Upload logs/artifacts for debugging\n\nHook lifecycle\n- session.start: emit compact context about active BD issue, assigned actor, and last 3 messages; used to seed agent session\n- pre-compact: run before compaction to provide summarization hooks; payloads should be restricted to non-sensitive metadata by default\n- Unregister: cleanup handler to remove the plugin registration from OpenCode\n\nSecurity \u0026 secrets handling\n- Primary rule: priming payloads MUST NOT contain raw secrets (API keys, tokens, passwords, private keys).\n- Provide a redaction utility (configurable patterns) that removes:\n  - strings that match common secret patterns (API keys, private keys)\n  - values in known secret paths (e.g., env var names in .env files)\n- Threat model checklist (deliverable): document where sensitive data can appear, who can access priming artifacts, and the approval process to enable skills.\n- Approval gate: enabling any skill that exposes broader context requires a security reviewer signoff (recorded in wf-gn7.2.7).\n\nTesting / CI\n- Unit tests: summarize() and countTokens() behaviors, redaction tests, CLI flag parsing\n- Integration tests: plugin registration, event emission, and OODA detection on a local OpenCode instance\n- E2E CI job: run on Linux runner; perform installer flow, run prime, assert event seen; artifact upload for logs\n- CI requirements: runner must be allowed to run sudo for apt installs in noninteractive mode (if chosen for CI). If not possible, CI should use a container image that already contains required system packages.\n\nInstaller policy \u0026 UX\n- Default behavior: detect missing system packages from config/waif_pacakges.yaml and present a prompt to the user:\n  - \"The following packages are required: \u003clist\u003e. Allow waif to run sudo apt install? [y/N]\"\n  - If user consents, run apt install; otherwise, print step-by-step instructions and exit with a non-zero status\n- Provide --yes/--noninteractive flags for scripted installs (CI) but require the runner to provide appropriate privileges\n- On failure, provide a clear diagnostics bundle and manual cleanup instructions (no automatic rollback)\n\nDeliverables / timeline (suggested)\n- M1 (1–2 days): Draft PRD (this document) and package YAML stub at config/waif_pacakges.yaml; create skeleton CLI commands: src/commands/prime_opencode.ts; src/lib/hooks/opencode.ts; basic tests stubs\n- M2 (3–5 days): Implement waif prime/opencode CLI and priming utils (summarize, countTokens) with unit tests\n- M3 (3–5 days): Implement waif setup opencode-hooks installer (with sudo flow) and smoke health-check; document manual cleanup steps\n- M4 (2–4 days): CI E2E tests and artifact upload; security review and redaction utility; opt-in skills gating\n\nFiles to add / edit\n- docs/dev/opencode_integration_PRD.md  (this file)\n- config/waif_pacakges.yaml  (package manifest stub)\n- src/commands/prime_opencode.ts  (CLI skeleton)\n- src/lib/hooks/opencode.ts  (hook registration + emitter)\n- src/lib/priming/summarize.ts  (summarize \u0026 token counting)\n- tests/unit/priming.test.ts\n- tests/e2e/opencode_hooks.test.ts\n- history/wf-gn7.*.md (spike artifacts and threat model)\n\nOwners (tentative, assigned by agents)\n- wf-gn7.2.1 (CLI hooks): patch\n- wf-gn7.2.2 (installer + health checks): ship\n- wf-gn7.2.3 (priming utils): patch\n- wf-gn7.2.4 (opt-in skills): scribbler\n- wf-gn7.2.5 (MCP fallback): ship\n- wf-gn7.2.6 (CI E2E): ship\n- wf-gn7.2.7 (security \u0026 redaction): probe\n\nOutstanding decisions \u0026 notes\n- No provider seeding required per request (opencode will handle provider configuration interactively)\n- Package YAML filename uses the provided: config/waif_pacakges.yaml\n- Installer will attempt sudo apt installs with explicit consent (Option B)\n- Rollback is manual (Option 2)\n\nAcceptance criteria (concise)\n- waif setup opencode-hooks runs on a Linux dev machine, validates prerequisites, registers WAIF plugin, and passes the smoke health-check\n- waif prime opencode registers priming hooks and emits priming payloads on session.start and pre-compact\n- Priming payloads are constrained to configured token budgets and pass redaction checks\n- CI E2E job executes on Linux and produces logs/artifacts demonstrating successful event flow\n\nNext actions (I will perform if you confirm)\n1) Create initial stub files for config/waif_pacakges.yaml and docs/dev/opencode_integration_PRD.md (Done)\n2) Create CLI skeletons and test stubs (src/commands/prime_opencode.ts, src/lib/hooks/opencode.ts, src/lib/priming/*)\n3) Post a bd comment linking the PRD and listing created files\n4) Assign owners to child bd issues (done per tentative mapping)\n\n","created_at":"2025-12-25T04:11:22Z"},{"id":35,"issue_id":"wf-gn7","author":"muse","text":"Linked PRD: docs/dev/opencode_integration_PRD.md. No implementation files were added; prototype artifacts were rolled back per Producer instruction. Child issues remain open and unassigned.","created_at":"2025-12-25T04:28:49Z"},{"id":36,"issue_id":"wf-gn7","author":"muse","text":"Assigned tentative owners: wf-gn7.1=patch, wf-gn7.2=ship, wf-gn7.3=patch, wf-gn7.4=ship, wf-gn7.5=probe. Update if different owners preferred.","created_at":"2025-12-25T04:38:07Z"},{"id":44,"issue_id":"wf-gn7","author":"map","text":"Map: Summarized epic for requester — scope, status, child issues, success criteria, deliverables, risks, and recommended next steps. Files referenced: docs/dev/opencode_integration_PRD.md, docs/Workflow.md, docs/dev/CLI_PRD.md, .opencode/command/, config/waif_pacakges.yaml, history/wf-gn7.claude-spike.md. Commands run in this session: bd show wf-gn7 --json; bd comments add. Remaining follow-ups: assign owners for child issues wf-gn7.1..wf-gn7.5, run spikes wf-gn7.2..wf-gn7.5, and create PRD artifacts/tests as listed in the epic.","created_at":"2025-12-27T00:14:46Z"}]}
{"id":"wf-gn7.1","title":"WAIF OpenCode Plugin","description":"Problem\nWAIF should provide an OpenCode plugin so WAIF can register with an OpenCode runtime, receive OpenCode events, and react programmatically. Examples: the OODA loop monitor can detect when an agent indicates work is complete; WAIF can track when an agent requests a command so the team can consider adding a permanent permission.\n\nUsers\nPrimary users: WAIF agents that consume OpenCode events (agent-side consumers such as the OODA loop monitor and other workflow agents).\nSecondary stakeholders: integrators/developers building integrations, infra/devops, docs authors, and the OpenCode community.\n\nSuccess criteria\n- An automatically-installed WAIF plugin for OpenCode that can be installed as part of .\n- Developer documentation demonstrating how to add new handlers/features to the plugin.\n- End-to-end acceptance: the OODA loop reliably detects agent busy/awaiting-user states by consuming plugin events and links to the correct Beads issue when an agent signals completion.\n\nConstraints\n- Priority: P1 (as requested).\n- No other hard timeline or compatibility constraints provided.\n- Security/permission policies deferred to a later phase.\n\nExisting state\n- OpenCode integration materials exist in docs/dev/ and .opencode/ (notably docs/dev/integrations.md, docs/Workflow.md, docs/dev/CLI_PRD.md, and .opencode/command/prd.md). The repo already contains code that integrates with OpenCode (src/lib/opencode.ts, src/commands/ask.ts) and an existing OpenCode integration epic (wf-gn7).\n\nDesired change\n- Create an installable Node/TypeScript WAIF OpenCode plugin that registers with a local OpenCode server, subscribes to a starter set of events, and emits them into WAIF's OODA/agent pipeline.\n- Wire installation into the existing  flow so the plugin is installed/registered automatically for local development.\n- Provide developer docs and examples showing how to add additional event handlers.\n- Provide acceptance tests that exercise one end-to-end event (OODA loop detection of agent busy/awaiting-user) in CI/local environment.\n\nLikely duplicates / related docs (file paths)\n- docs/Workflow.md\n- docs/dev/CLI_PRD.md\n- docs/dev/integrations.md\n- docs/dev/prd-ooda-loop.md\n- docs/dev/context_pack_PRD.md\n- .opencode/command/prd.md\n- .opencode/command/intake.md\n\nRelated issues (Beads ids)\n- wf-gn7 — OpenCode integration (parent epic)\n- wf-ba2.3.6, wf-ba2.3, wf-ba2.3.7 — PRD/CLI/OpenCode wiring tasks\n- wf-ba2.5.4 — Context Pack / intake related\n- wf-73k — Update /prd: accept bd issue ID (tombstoned; historical)\n\nClarifying questions (remaining)\n1) Initial events (confirmed): agent.session.start, agent.session.end, message.sent, command.request (starter set).\n2) Install model (confirmed): plugin installation should be part of  so local dev receives the plugin automatically.\n3) Runtime (confirmed): Node + TypeScript.\n4) Acceptance tests (confirmed): E2E test verifying OODA loop reliably detects agent busy vs awaiting-user and links to the correct Beads issue.\n5) Permissions/security: deferred to later work.\n\nProposed next step\n- NEW PRD at: docs/dev/waif_opencode_plugin_PRD.md\n- Recommended next command: /prd docs/dev/waif_opencode_plugin_PRD.md \u003cnew-issue-id\u003e\n\nNotes\n- Parent: wf-gn7 (OpenCode integration epic) as requested; if you prefer a different parent provide its beads id.\n- After the PRD file is created, run  to link the PRD into the beads issue (the workflow  command can do this for you).","status":"closed","priority":1,"issue_type":"feature","assignee":"patch","created_at":"2025-12-24T12:33:59.20203533-08:00","updated_at":"2025-12-30T01:30:58.648665804-08:00","closed_at":"2025-12-30T01:30:58.648672547-08:00","dependencies":[{"issue_id":"wf-gn7.1","depends_on_id":"wf-gn7","type":"parent-child","created_at":"2025-12-24T12:33:59.203312934-08:00","created_by":"daemon"}],"comments":[{"id":45,"issue_id":"wf-gn7.1","author":"map","text":"Map: Summarized scope and proposed plan for implementation. Commands run: bd show wf-gn7.1 --json. Files referenced: docs/dev/integrations.md, docs/Workflow.md, .opencode/command/, src/lib/opencode.ts, src/commands/ask.ts. Recommended next steps: 1) Create PRD at docs/dev/waif_opencode_plugin_PRD.md and link it to wf-gn7.1; 2) Run prototype spike wf-gn7.1.1 (1–2 day timebox) to validate context injection; 3) After spike, create implementation issues: plugin skeleton (register/subscribe/emit), developer docs, acceptance E2E test; 4) Assign owners and timeboxes for implementation and security review. Remaining risks: priming context leakage (redaction required), installer/CI constraints, and safety of autonomous task-agent features. ","created_at":"2025-12-27T00:17:41Z"}]}
{"id":"wf-gn7.1.1","title":"Spike: review opencode-beads and prototype context injection","description":"Summary\n-------\nReview opencode-beads and extract reusable patterns for WAIF\u001fOpenCode integration. Prototype a minimal \"priming\" approach and capture decisions.\n\nKey takeaway / direction change\n------------------------------\nInstead of defaulting to automatic OpenCode-session context injection (\"bd prime\") as the primary approach, prefer an **explicit priming command** design:\n\n- Provide a WAIF command like `waif prime \u003cbeads-id\u003e` (or an OpenCode command wrapper like `/waif-prime \u003cbeads-id\u003e`), which generates a context pack for the specified Beads issue.\n- Allow different agents/roles to choose different bootstrap profiles (e.g., implementer vs reviewer) by varying the context pack.\n- Treat automatic session context injection as an optional reliability layer (e.g., recovery after compaction), not the default mechanism.\n\nThis is cleaner, less error-prone, and reduces the risk of injecting the wrong issue context.\n\nWhat opencode-beads suggests (reusable ideas)\n--------------------------------------------\n- \"bd-prime\" pattern: preload session context to reduce repeated lookups and recover after compaction.\n- /bd-* command surface mirroring the bd CLI for agent convenience.\n- Concept of a beads-task-agent (autonomous completion) \u0014 promising, but safety-sensitive.\n\nWAIF-specific requirements / changes needed\n------------------------------------------\n- Privacy/scope: prime content must be scoped to the active session + issue, with expiry to avoid cross-session leakage.\n- Permissions: any write operations (create/update/close) must require explicit policy checks and likely human-in-the-loop confirmation.\n- Auditability: actions triggered from OpenCode must be logged and linked to both the Beads issue and the OpenCode event/session.\n\nPrototype produced (POC)\n-----------------------\nPR #68: https://github.com/SorraTheOrc/waif/pull/68\n\n- `scripts/wf-gn7.1-inject.js`: minimal proof-of-concept script that POSTs a context payload to an OpenCode session endpoint (non-destructive). This demonstrates feasibility of the \"inject payload\" mechanism if we later need it for recovery.\n- `history/wf-gn7.1-spike.md`: earlier decision record (content migrated here per request).\n\nHow to test\n-----------\nOption A: with a real OpenCode runtime\n1) Checkout branch:\n   - `git fetch origin`\n   - `git checkout feature/wf-gn7.1.1-spike`\n\n2) Set env vars:\n   - `OPENCODE_URL` (base URL)\n   - `OPENCODE_API_KEY` (token)\n\n3) Run:\n   - `node scripts/wf-gn7.1-inject.js --session test-session-123 --context '{\"beads\":\"example-prime\"}'`\n\nExpected output: \"Context injected successfully\" or a clear error message.\n\nOption B: without OpenCode (local mock)\n1) Start mock server:\n   - `node -e \"const http=require('http');http.createServer((req,res)=\u003e{let b='';req.on('data',c=\u003eb+=c);req.on('end',()=\u003e{console.log('RECEIVED',req.method,req.url,b);res.writeHead(200);res.end('ok');});}).listen(8080);console.log('listening 8080');\"`\n\n2) Run injector against it:\n   - `OPENCODE_URL=\"http://localhost:8080\" OPENCODE_API_KEY=dummy node scripts/wf-gn7.1-inject.js --session test-session-123 --context '{\"beads\":\"example-prime\"}'`\n\nFollow-up work recommended (create separately)\n---------------------------------------------\n- Implement `waif prime \u003cbeads-id\u003e` context pack generator (explicit priming).\n- Add OpenCode wrapper command `/waif-prime \u003cbeads-id\u003e` that calls the same generator.\n- Add automatic re-prime on compaction/session start only when bd-id is unambiguous.\n- Evaluate /bd-* command mirroring for read-only ops first.\n- Safety review for any autonomous task-agent: RBAC, rate limits, audit logs, human-in-the-loop.\n\nFiles touched in this spike\n---------------------------\n- history/wf-gn7.1-spike.md (created earlier)\n- scripts/wf-gn7.1-inject.js (created earlier)\n- PR: https://github.com/SorraTheOrc/waif/pull/68\n","status":"open","priority":3,"issue_type":"task","assignee":"patch","created_at":"2025-12-24T12:41:47.488820271-08:00","updated_at":"2025-12-26T16:43:19.268827893-08:00","dependencies":[{"issue_id":"wf-gn7.1.1","depends_on_id":"wf-gn7.1","type":"parent-child","created_at":"2025-12-24T12:41:47.489821282-08:00","created_by":"daemon"}],"comments":[{"id":46,"issue_id":"wf-gn7.1.1","author":"map","text":"@patch Please start the wf-gn7.1.1 spike: 1–2 day timebox. Goal: review opencode-beads and prototype context injection (bd-prime style). Deliverables: a short decision record at history/wf-gn7.1-spike.md (which features are reusable, required changes for privacy/security), a small prototype or runnable instructions showing context injection, and a list of recommended follow-up bd issues (command wiring, task-agent safety, security review). Keep all planning artifacts in history/. When the spike completes: update this bd issue with a brief summary, attach links to the history/ files, and create follow-ups as bd issues using --deps discovered-from:wf-gn7.1.1. If you run into infra/CI or permission questions, call me (Map) out on the issue and I will coordinate.","created_at":"2025-12-27T00:19:44Z"},{"id":47,"issue_id":"wf-gn7.1.1","author":"patch","text":"Started spike: created history/wf-gn7.1-spike.md and scripts/wf-gn7.1-inject.js (POC).\nOpened PR #68: https://github.com/SorraTheOrc/waif/pull/68\nNext: review feedback, add per-session scoping, and create follow-up issues as needed.\nFiles created: history/wf-gn7.1-spike.md, scripts/wf-gn7.1-inject.js\nPlanning artifacts live in history/.","created_at":"2025-12-27T00:24:12Z"},{"id":48,"issue_id":"wf-gn7.1.1","author":"patch","text":"Started spike: created history/wf-gn7.1-spike.md and scripts/wf-gn7.1-inject.js (POC).\nOpened PR #68: https://github.com/SorraTheOrc/waif/pull/68\nNext: review feedback, add per-session scoping, and create follow-up issues as needed.\nFiles created: history/wf-gn7.1-spike.md, scripts/wf-gn7.1-inject.js\nPlanning artifacts live in history/.","created_at":"2025-12-27T00:27:43Z"},{"id":49,"issue_id":"wf-gn7.1.1","author":"patch","text":"Updated issue description to permanently capture spike findings (migrated content from history/). Lowered priority to P3 and set status=open. PR #68 closed as aborted after deciding to prefer explicit priming ('waif prime \u003cbeads-id\u003e' and/or '/waif-prime') over automatic context injection as default.","created_at":"2025-12-27T00:43:26Z"}]}
{"id":"wf-gn7.2","title":"Spike: review beads Claude integration and capture patterns for WAIF OpenCode plugin","description":"Summary: Review Beads' Claude integration design (docs/CLAUDE_INTEGRATION.md) and gather concrete patterns we should reuse for the WAIF OpenCode plugin and OODA integration.\\n\\nSource reviewed:\\n- https://github.com/steveyegge/beads/blob/main/docs/CLAUDE_INTEGRATION.md (raw reviewed)\\n- Related directory: https://github.com/steveyegge/beads/tree/main/.claude-plugin\\n\\nKey ideas to capture (from the doc):\\n- Prefer CLI + Hooks approach (bd prime + SessionStart/PreCompact hooks) for context injection rather than embedding large MCP tool schemas.\\n- Keep context small: bd prime ~1–2k tokens to preserve attention \u0026 reduce cost/latency.\\n- Avoid shipping Claude Skills as a default; make Claude-specific enhancements optional and plugin-scoped.\\n- Provide a lightweight setup/install flow for hooks (bd setup claude) and health checks.\\n- MCP server remains an optional alternative for environments without shell access.\\n\\nPurpose:\\n- Identify which of these patterns are directly applicable to WAIF's OpenCode plugin and OODA loop (context injection approach, hooks, install UX, and rule-of-thumb guidance about skills vs CLI).\\n\\nSuccess criteria:\\n1) history/wf-gn7.claude-spike.md created with a short analysis: which patterns to adopt, which to avoid, and why (security/WAIF constraints noted).\\n2) A recommended PRD/implementation checklist for adding Hooks (bd-prime style) to WAIF OpenCode plugin, including installation commands and a minimal test plan.\\n3) A list of follow-up bd issues created or recommended (hook installer, CLI surface, MCP fallback, optional Claude-specific plugin) linked to this spike.\\n\\nSuggested next steps:\\n1) Clone and read beads .claude-plugin and docs/CLAUDE_INTEGRATION.md for concrete install and hook examples.\\n2) Draft history/wf-gn7.claude-spike.md capturing findings and recommendations.\\n3) Open follow-up issues (hook installer, policy review on skills, MCP fallback) as needed.\\n\\nCommands run while creating this issue:\\n- fetched raw CLAUDE_INTEGRATION.md from GitHub to review contents\\n- bd create (this issue)\\n\\nFiles created/edited:\\n- None yet. Spike will write history/wf-gn7.claude-spike.md if accepted.\\n\\nRisks / follow-ups:\\n- Claude-specific guidance may not map 1:1 to OpenCode; evaluate differences in hook lifecycle and available extension points.\\n- Avoid enabling Claude Skills by default; if we expose plugin-specific skills, they must be opt-in and have clear deprecation/migration plans.\\n- Assign an owner and 1–2 day timebox for the spike.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:52:19.502889552-08:00","updated_at":"2025-12-30T01:31:16.02301582-08:00","closed_at":"2025-12-30T01:31:16.023026038-08:00","dependencies":[{"issue_id":"wf-gn7.2","depends_on_id":"wf-gn7","type":"parent-child","created_at":"2025-12-24T12:52:19.503797385-08:00","created_by":"daemon"},{"issue_id":"wf-gn7.2","depends_on_id":"wf-gn7.1","type":"blocks","created_at":"2025-12-24T12:52:19.509061594-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.1","title":"Implement CLI-based OpenCode hooks for context injection","description":"Provide a CLI priming command (waif prime/opencode) and lifecycle hooks (session.start, pre-compact) to inject small, focused context into agents. Rationale: prefer CLI+hooks over embedding large MCP schemas for simpler install surface and lower attack surface.","acceptance_criteria":"1) waif prime/opencode exists and registers hooks; 2) hooks emit sample context on session.start and pre-compact; 3) docs/example in history/ show usage; 4) linked to parent wf-gn7.2","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T19:45:13.338242933-08:00","updated_at":"2025-12-24T20:15:25.744097808-08:00","dependencies":[{"issue_id":"wf-gn7.2.1","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.353367643-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.2","title":"Hook installer + health checks","description":"Create an installer command (waif setup opencode-hooks) that installs/registers hooks and runs smoke health checks verifying event emission and OODA consumption.","acceptance_criteria":"1) installer registers hooks; 2) health-check command validates hook lifecycle by emitting a test event and verifying OODA receives it; 3) clear actionable errors on failure; 4) tests/smoke in CI","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T19:45:13.422326944-08:00","updated_at":"2025-12-24T20:15:27.983909654-08:00","dependencies":[{"issue_id":"wf-gn7.2.2","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.424287981-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.3","title":"Compact priming utilities (summarize \u0026 token enforcement)","description":"Add utilities to summarize context and enforce a default priming token budget (~1-2k tokens) with token-counting helpers.","acceptance_criteria":"1) library exposes summarize(text, targetTokens) and countTokens(text); 2) default priming applied by waif prime; 3) unit tests covering limits","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-24T19:45:13.48540073-08:00","updated_at":"2025-12-24T20:15:30.066135196-08:00","dependencies":[{"issue_id":"wf-gn7.2.3","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.486595036-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.4","title":"Opt-in skills policy and implementation","description":"Define and implement an opt-in policy and CLI flags for any OpenCode-specific 'skills' so they are plugin-scoped and disabled by default.","acceptance_criteria":"1) skills disabled by default; 2) --enable-opencode-skills flag to opt-in; 3) uninstall/unregister path documented; 4) policy doc in history/","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-24T19:45:13.556706365-08:00","updated_at":"2025-12-24T20:15:32.257526062-08:00","dependencies":[{"issue_id":"wf-gn7.2.4","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.557522681-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.5","title":"MCP fallback server support","description":"Add optional MCP server fallback for environments without shell access; document trade-offs vs CLI hooks.","acceptance_criteria":"1) MCP server integration documented; 2) simple deploy/run script for dev; 3) comparison notes in history/","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T19:45:13.612878521-08:00","updated_at":"2025-12-24T20:15:33.133097122-08:00","dependencies":[{"issue_id":"wf-gn7.2.5","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.613929085-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.6","title":"End-to-end CI tests for hooks and OODA","description":"Create CI E2E tests that install hooks, run priming, emit an OpenCode event, and assert OODA loop detects agent busy/awaiting-user states.","acceptance_criteria":"1) CI job runs on Linux runner; 2) tests cover happy path and failure modes; 3) artifacts/logs stored for debugging","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-24T19:45:13.67008694-08:00","updated_at":"2025-12-24T20:15:36.147406749-08:00","dependencies":[{"issue_id":"wf-gn7.2.6","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.671385634-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.2.7","title":"Security review \u0026 secrets handling for priming content","description":"Perform a security review and implement redaction/permission boundaries to ensure priming contexts do not leak secrets.","acceptance_criteria":"1) threat model doc added to history/; 2) redaction utility implemented; 3) approval notes in issue; 4) linked remediation plan","status":"open","priority":1,"issue_type":"chore","created_at":"2025-12-24T19:45:13.783348303-08:00","updated_at":"2025-12-24T20:15:38.658008696-08:00","dependencies":[{"issue_id":"wf-gn7.2.7","depends_on_id":"wf-gn7.2","type":"discovered-from","created_at":"2025-12-24T19:45:13.78411159-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.3","title":"Spike: review and adapt Claude skills (anthropics/skills) for WAIF OpenCode","description":"Summary: Review the Claude skills repository (https://github.com/anthropics/skills) and identify skills that can be safely adapted or reimplemented for WAIF's OpenCode plugin.\\n\\nSource to review:\\n- https://github.com/anthropics/skills\\n\\nPurpose:\\n- Catalog skills that provide useful functionality (e.g., workflow helpers, context utilities, command wiring) and map them to WAIF/OpenCode extension points.\\n- Recommend which skills to reimplement as plugin-scoped, opt-in features vs. which to avoid for security/compatibility reasons.\\n\\nSuccess criteria:\\n1) history/wf-gn7.skills-anthropics.md created with a short catalog: skill name, purpose, feasibility (easy/moderate/high), recommended action (adopt/adapt/reject), and security notes.\\n2) A minimal adaptation plan for 1-2 high-value skills (implementation approach, required APIs/hooks, and test plan).\\n3) List of follow-up bd issues recommended (e.g., implement-adapt-skill-XYZ) linked to this spike.\\n\\nSuggested steps:\\n1) Browse the anthropics/skills repo and list available skills and their README/docs.\\n2) For each candidate skill, evaluate compatibility with OpenCode hook lifecycle and WAIF security model.\\n3) Draft history/wf-gn7.skills-anthropics.md capturing findings and recommended next steps.\\n4) Create follow-up issues for any skills we plan to implement or prototype.\\n\\nCommands run while creating this issue:\\n- none beyond creating this bd task (user-requested)\\n\\nFiles created/edited:\\n- None yet. Spike will write history/wf-gn7.skills-anthropics.md if accepted.\\n\\nRisks / follow-ups:\\n- Claude-specific skill lifecycles or assumptions may not match OpenCode; evaluate carefully.\\n- Skills that automate actions must be reviewed for permission and audit implications before enabling.\\n- Assign owner and timebox (recommended 1-2 days).\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:56:46.886862828-08:00","updated_at":"2025-12-30T01:31:16.033803149-08:00","closed_at":"2025-12-30T01:31:16.033809076-08:00","dependencies":[{"issue_id":"wf-gn7.3","depends_on_id":"wf-gn7","type":"parent-child","created_at":"2025-12-24T12:56:46.888698426-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.4","title":"Spike: review Opencode-Workflows (IgorWarzocha) for workflow management ideas","description":"Summary: Review the Opencode-Workflows repo (https://github.com/IgorWarzocha/Opencode-Workflows) and capture actionable ideas we can adapt for WAIF's workflow management tooling (scheduling, orchestration, event handling, UI/UX patterns).\\n\\nSource to review:\\n- https://github.com/IgorWarzocha/Opencode-Workflows\\n\\nPurpose:\\n- Identify useful design patterns, architectures, CLI/agent wiring, and data models that align with WAIF's OODA/agent pipeline and OpenCode plugin plans.\\n- Produce a short decision record summarizing which components or ideas are reusable, which need adaptation, and license/compatibility notes.\\n\\nSuccess criteria:\\n1) history/wf-gn7.opencode-workflows.md created with a concise analysis: notable patterns, potential components to adopt, required changes to fit WAIF architecture, and license considerations.\\n2) At least 2 concrete follow-up bd issues recommended (eg. prototype scheduler integration, event wiring adapter) linked to this spike.\\n3) A recommended implementation approach and test plan for any prototyped idea.\\n\\nSuggested steps:\\n1) Browse the repository (readme, code, examples) and identify core components (scheduler, event handlers, CLI entrypoints, config formats).\\n2) Map components to WAIF/OpenCode extension points and note incompatibilities or gaps.\\n3) Draft history/wf-gn7.opencode-workflows.md capturing findings and proposed next actions.\\n4) Open follow-up bd issues for high-value items to prototype or implement.\\n\\nCommands run while creating this issue:\\n- bd create (this issue)\\n\\nFiles created/edited:\\n- None yet. Spike will write history/wf-gn7.opencode-workflows.md if accepted.\\n\\nRisks / follow-ups:\\n- Ensure license compatibility (avoid copying code incompatible with project license).\\n- Some patterns may assume runtime or infra WAIF doesn't have; adapt rather than transplant.\\n- Assign an owner and 1–2 day timebox for the spike.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T13:03:09.293731338-08:00","updated_at":"2025-12-30T01:31:25.424855739-08:00","closed_at":"2025-12-30T01:31:25.424859724-08:00","dependencies":[{"issue_id":"wf-gn7.4","depends_on_id":"wf-gn7","type":"parent-child","created_at":"2025-12-24T13:03:09.294910838-08:00","created_by":"daemon"}]}
{"id":"wf-gn7.5","title":"Spike: review OpenSpec (Fission-AI/OpenSpec) for spec management ideas","description":"Summary: Review the OpenSpec project (https://github.com/Fission-AI/OpenSpec) and capture ideas we can adapt for WAIF's specification and schema management tooling (validation, doc generation, CI gating, and integration with OpenCode/Beads workflows).\\n\\nSource to review:\\n- https://github.com/Fission-AI/OpenSpec\\n\\nPurpose:\\n- Identify concrete techniques and components for managing machine-readable specifications, schema validation, doc generation, and CI enforcement that can be adapted to WAIF (e.g., spec linting, schema-ified PR checks, codegen hooks).\\n- Recommend how spec artifacts should live in repo (formats, paths), how they map to our history/ and docs/ conventions, and how to integrate validation into CI and plugin install flows.\\n\\nSuccess criteria:\\n1) history/wf-gn7.openspec.md produced with a decision record: notable patterns, recommended formats (YAML/JSON/other), suggested repo layout, CI integration patterns, and license/compatibility notes.\\n2) A short checklist for implementing spec validation (tooling, CI job outline, failure UX) that can be used as a follow-up work item.\\n3) A list of follow-up bd issues (eg. add-spec-lint-ci, spec-to-plugin-adapter, spec-docgen) linked to this spike.\\n\\nSuggested steps:\\n1) Browse OpenSpec README, examples, and tooling to identify key features (schema language, validators, generators).\\n2) Map those features to WAIF use cases: OpenCode plugin manifests, OODA heuristics config, workflow definitions, and PRD artifacts.\\n3) Draft history/wf-gn7.openspec.md capturing findings and recommendations.\\n4) Propose follow-up bd issues for implementation work.\\n\\nFiles created/edited:\\n- None yet. Spike will write history/wf-gn7.openspec.md if accepted.\\n\\nRisks / follow-ups:\\n- License compatibility: verify any copied approaches/tools are compatible with WAIF's license.\\n- Avoid over-design: start with a minimal schema and evolve as needs stabilize.\\n- Assign an owner and 1–2 day timebox for the spike.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T13:06:24.612873318-08:00","updated_at":"2025-12-30T01:31:25.433663306-08:00","closed_at":"2025-12-30T01:31:25.433667393-08:00","dependencies":[{"issue_id":"wf-gn7.5","depends_on_id":"wf-gn7","type":"parent-child","created_at":"2025-12-24T13:06:24.613957079-08:00","created_by":"daemon"}]}
{"id":"wf-hb1","title":"Add start-agent bootstrap script","description":"Create an executable shell script invokable as: start-agent NAME. It must: (1) export BD_ACTOR=NAME, (2) cd into ./ (clone repo there if missing), create/switch to branch _Workspace, (3) run waif init .","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:46:17.826208057-08:00","updated_at":"2025-12-19T14:55:04.439045643-08:00","closed_at":"2025-12-19T14:55:04.439045643-08:00"}
{"id":"wf-hn4","title":"Cleanup wf-10f intake brief (remove resolved clarifying questions; point Linked PRD to new PRD)","description":"wf-10f intake brief has resolved clarifying questions + still says Linked PRD: docs/dev/CLI_PRD.md. Update wf-10f description to reference docs/dev/PRD-command-in-progress.md, and prune obsolete questions/sections now that decisions are locked in the PRD. Keep a short pointer to CLI_PRD.md if needed, but treat PRD-command-in-progress as canonical.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T11:57:44.587133529-08:00","updated_at":"2025-12-22T12:01:07.196478532-08:00","closed_at":"2025-12-22T12:01:07.196478532-08:00","dependencies":[{"issue_id":"wf-hn4","depends_on_id":"wf-10f","type":"discovered-from","created_at":"2025-12-22T11:57:44.593190834-08:00","created_by":"daemon"}]}
{"id":"wf-hxz","title":"Convert start-agent to git worktrees","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:41:42.262855467-08:00","updated_at":"2025-12-19T15:43:56.076062984-08:00","closed_at":"2025-12-19T15:43:56.076062984-08:00"}
{"id":"wf-ibkm","title":"chore: repo cleanup dry-run (no deletions)","description":"Dry-run cleanup performed; no deletions executed. Findings:\\n- Default branch: main\\n- Open PRs targeting main: none detected\\n- Local branches merged into origin/main: none (only 'main' is merged)\\n- Candidate local branches not merged but with no remote: bd-wf-3ur.2/add-workflow-stage-prd (remote missing)\\n- Beads in_progress: wf-3ur.2 (labels: stage:prd_complete) - linked branch likely bd-wf-3ur.2/add-workflow-stage-prd\\nRecommendations:\\n- Confirm whether bd-wf-3ur.2 work is complete; if so, close bead and delete local branch. Otherwise, consider pushing branch to remote or archiving the work in history/.\\nActions executed: git fetch origin --prune; bd sync; branch inventory\\n","status":"tombstone","priority":2,"issue_type":"chore","created_at":"2026-01-18T20:22:59.017332887-08:00","created_by":"WAIF","updated_at":"2026-01-19T03:58:47.600282172-08:00","deleted_at":"2026-01-19T03:58:47.600282172-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"chore"}
{"id":"wf-ih9","title":"Docs: Add CHANGELOG and ROADMAP files","description":"Create docs/CHANGELOG.md and docs/dev/ROADMAP.md and ensure PRDs reference them correctly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:24.03020252-08:00","updated_at":"2025-12-21T17:49:02.343394538-08:00","closed_at":"2025-12-21T17:49:02.343403136-08:00","dependencies":[{"issue_id":"wf-ih9","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.107765968-08:00","created_by":"daemon"}]}
{"id":"wf-ij4","title":"Tests \u0026 QA: integration tests and manual acceptance","status":"closed","priority":1,"issue_type":"task","assignee":"qa","created_at":"2025-12-23T17:13:27.718047258-08:00","updated_at":"2025-12-23T17:20:04.929604707-08:00","closed_at":"2025-12-23T17:20:04.929604707-08:00","close_reason":"Replaced by hierarchical child wf-cvz.5","dependencies":[{"issue_id":"wf-ij4","depends_on_id":"wf-cvz","type":"discovered-from","created_at":"2025-12-23T17:13:27.721168461-08:00","created_by":"daemon"},{"issue_id":"wf-ij4","depends_on_id":"wf-cvz","type":"blocks","created_at":"2025-12-23T17:16:41.74485183-08:00","created_by":"daemon"}]}
{"id":"wf-jax","title":"Context from plugin","description":"Problem\n\nAgents starting work on an item lack an indexed, issue-specific way to request contextual documents and bead metadata. The existing Wrote context pack to /home/rgardler/projects/waif/docs/dev/CONTEXT_PACK.md command generates a global signpost () but does not expose a plugin/agent API that returns a structured, issue-scoped payload. This forces agents and humans to perform ad-hoc searches and increases time-to-first-contribution.\n\nUsers\n\n- Primary: OpenCode agents (e.g., , ) that need immediate, targeted context when starting work on a Beads issue.\n- Secondary: human producers who seed agent sessions via CLI and PM/Map who maintain selection rules.\n\nSuccess criteria\n\nAn OpenCode/waif plugin surface (OpenCode command + CLI wrapper) returns a deterministic JSON payload for a given Beads id containing:  (metadata),  (short text), and  (ordered list of path, excerpt, relevance_score). Done test: given a bead id, calling the plugin returns a JSON payload and a sample agent can consume it to start a task; unit tests verify redaction and token-budget summarization.\n\nConstraints\n\n- Must not include ignored or sensitive files; redaction follows  and existing redaction helpers.\n- Compatibility: the change must be additive and not break existing Wrote context pack to /home/rgardler/projects/waif/docs/dev/CONTEXT_PACK.md CLI behavior.\n- Output must be machine-readable (JSON) and size-bounded (support /profile); if the payload exceeds budget, the plugin must summarize and create/update a P0 bead for PM review per existing PRD rules.\n\nExisting state\n\n- CLI command:  (generates/writes ). (src/commands/context.ts:1)\n- Doc scanner:  (scans  and extracts excerpts). (src/lib/contextGenerator.ts:1)\n- Canonical PRD: . (docs/dev/context_pack_PRD.md:1)\n- Generated pack: . (docs/dev/CONTEXT_PACK.md:1)\n- Tests mentioning pack: . (tests/context.command.test.ts:1)\n\nDesired change\n\nUpdate  to add a plugin section specifying:\n- API surface: OpenCode command  plus  CLI wrapper (e.g., ) returning JSON.\n- Selection rules for documents (proximity, explicit links, headings, manual overrides) and scoring.\n- Redaction \u0026 token-budget strategy (summarize/shorten and create/update overflow P0 bead).\n- Example payload JSON schema and sample OpenCode caller flow.\n\nLikely duplicates / related docs\n\n-  (update target). (docs/dev/context_pack_PRD.md:1)\n- . (docs/dev/CONTEXT_PACK.md:1)\n-  (CLI entries). (docs/dev/CLI_PRD.md:1)\n- . (src/commands/context.ts:1)\n- . (src/lib/contextGenerator.ts:1)\n- . (tests/context.command.test.ts:1)\n\nRelated issues\n\n-  — Context Pack command (intake)\n-  — Implement 'waif ctx' CLI command (MVP)\n-  — Instruct agents to file context pack update requests\n-  — Default waif ctx writes docs/dev/CONTEXT_PACK.md and overwrites on each run\n\nClarifying questions\n\n1) Confirmed approach: implement OpenCode command + CLI wrapper (default). Proceed? (recommended)\n2) Inputs: allow  (implementer|reviewer) and  — confirm accepted parameters.\n3) Redaction: is -based redaction sufficient or add explicit deny-list (e.g., )?\n\nProposed next step\n\n- UPDATE PRD at: \n- Recommended next command: \n\n,description:Update intake brief to final draft","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-30T21:38:00.610432436-08:00","updated_at":"2026-01-19T04:09:30.751287634-08:00","closed_at":"2026-01-19T04:09:30.751292227-08:00"}
{"id":"wf-jax.1","title":"Update PRD: plugin for issue-specific context","description":"Goal\n\nUpdate  to add a Plugin API section that specifies a stable OpenCode command + CLI wrapper for fetching issue-scoped context.\n\nDeliverables\n\n- Edit  to add:\n  - API surface:  + CLI wrapper (example CLI args: )\n  - Selection rules for documents to include and scoring rules\n  - Redaction and token-budget policy (summarization and overflow-bead behavior)\n  - Example JSON payload schema and sample OpenCode caller flow\n  - Acceptance tests/examples to validate redaction and payload size\n\nSuccess criteria\n\n- PRD contains a clear API spec and example payload schema\n- PRD lists selection and redaction rules and a recommended test plan\n- Reviewer can implement a minimal plugin that returns the specified JSON schema without code changes to other files\n\nTests\n\n- Unit tests that validate payload schema and redaction rules (examples in PRD)\n- Integration example showing  outputs the documented schema\n\nRelated issues\n\n- wf-jax (parent intake)\n- wf-ba2.5.4, wf-ba2.5.4.1, wf-ba2.5.5, wf-moa\n\nNotes\n\n- This is a documentation/PRD update only; do not implement code in this task. Implementation should be tracked separately.\n","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-30T21:43:54.605798407-08:00","updated_at":"2026-01-19T03:55:04.464604932-08:00","dependencies":[{"issue_id":"wf-jax.1","depends_on_id":"wf-jax","type":"parent-child","created_at":"2025-12-30T21:43:54.620070137-08:00","created_by":"daemon"}],"deleted_at":"2026-01-19T03:55:04.464604932-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-jgy","title":"Feature: support array-form job.command and validation","description":"Support and validate exec-style array command forms to avoid shell parsing and reduce injection risk.\n\nAcceptance criteria:\n1) Schema updated to allow job.command to be either string or array of strings (exec form).  \n2) Config loader validates array elements (non-empty strings).  \n3) Runner supports array-form commands by passing args to spawn without shell: true.  \n4) Tests added for both forms and for validation rejecting unsafe shell strings when policy 'no-shell-strings' enabled.  \n5) Documentation updated to recommend array-form for untrusted configs.,--json","status":"open","priority":2,"issue_type":"feature","assignee":"patch","created_at":"2026-01-12T01:50:59.128825536-08:00","created_by":"WAIF","updated_at":"2026-01-12T01:50:59.128825536-08:00","labels":["stage:in_progress"],"dependencies":[{"issue_id":"wf-jgy","depends_on_id":"wf-e6r.2","type":"discovered-from","created_at":"2026-01-12T01:50:59.131780531-08:00","created_by":"WAIF"},{"issue_id":"wf-jgy","depends_on_id":"wf-3ur","type":"parent-child","created_at":"2026-01-19T04:03:06.92541327-08:00","created_by":"WAIF"}]}
{"id":"wf-jvw","title":"Rename project to WAFI","description":"Update repo naming to WAFI (Workflow Alien Intelligence), including CLI/package metadata, docs, and tests. Name intentionally jumbled; nod to nautical WAIF term; but project name is WAFI.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T14:03:30.427511194-08:00","updated_at":"2025-12-30T02:22:15.542525011-08:00","closed_at":"2025-12-30T02:22:15.542528406-08:00","dependencies":[{"issue_id":"wf-jvw","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:09:24.139869225-08:00","created_by":"daemon"}]}
{"id":"wf-k5um","title":"Epic: Rename CLI 'waif' to 'wf' (breaking)","description":"Hard rename: replace 'waif' with 'wf' everywhere in code, docs, tests, packaging. This is a breaking change and requires coordinated updates to completions, CI, and installers.","acceptance_criteria":"All references to command 'waif' replaced with 'wf' across source, entrypoints, docs, completion scripts, CI, tests, and packaging. CI and tests pass. Release notes and migration guide added. PR(s) created and linked.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-16T17:38:06.02451956-08:00","created_by":"WAIF","updated_at":"2026-01-18T00:41:08.485357944-08:00","closed_at":"2026-01-18T00:41:08.485357944-08:00","close_reason":"Closed"}
{"id":"wf-k5um.1","title":"Rename CLI entrypoint and package metadata from 'waif' to 'wf'","description":"Update CLI package entry points, setup/pyproject, and the main CLI driver to expose 'wf' instead of 'waif'. Ensure console_scripts, bin names, and shebangs are updated.","acceptance_criteria":"Package installs provide 'wf' command; running 'wf --help' shows expected usage. No leftover 'waif' entry points.","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/144","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:07.861902812-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:52:03.803137643-08:00","closed_at":"2026-01-16T17:52:03.803145343-08:00","dependencies":[{"issue_id":"wf-k5um.1","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:07.892615361-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.2","title":"Update shell completion scripts for 'wf' (bash, zsh, fish)","description":"Replace 'waif' with 'wf' in completion scripts and ensure installation paths and instructions are updated.","acceptance_criteria":"Completion scripts complete 'wf' correctly in bash, zsh, and fish. Installation docs updated.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:09.576586572-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:42:17.876143497-08:00","closed_at":"2026-01-16T17:42:17.876151655-08:00","dependencies":[{"issue_id":"wf-k5um.2","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:09.581194655-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.3","title":"Update docs and README to 'wf'","description":"Search and replace 'waif' with 'wf' in docs, README, examples, and usage sections. Add migration notes and changelog entry describing breaking change.","acceptance_criteria":"All docs reference 'wf' with examples updated. Migration guide and changelog entry present.","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/143","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:11.301945189-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:50:19.493042884-08:00","closed_at":"2026-01-16T17:50:19.493050767-08:00","dependencies":[{"issue_id":"wf-k5um.3","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:11.307115464-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.4","title":"Update tests and CI references to 'wf'","description":"Find CI configs and tests that call 'waif' and update them to 'wf'. Run test suite and fix failures caused by rename.","acceptance_criteria":"CI configs and tests use 'wf'; CI pipeline succeeds locally and remote after PR.","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/145","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:12.994114241-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:58:58.24349186-08:00","closed_at":"2026-01-16T17:58:58.243499102-08:00","dependencies":[{"issue_id":"wf-k5um.4","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:12.994705399-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.5","title":"Update packaging and installers to provide 'wf'","description":"Adjust packaging metadata (pyproject/setup.cfg), Dockerfiles, Homebrew formula, and any installers to install 'wf' as the CLI entrypoint.","acceptance_criteria":"Published package and installer provide 'wf' command; Docker images use 'wf'.","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/141","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:14.497587286-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:41:17.345032672-08:00","closed_at":"2026-01-16T17:41:17.345042172-08:00","dependencies":[{"issue_id":"wf-k5um.5","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:14.50215082-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.6","title":"Write migration guide and release notes for breaking rename","description":"Document breaking change, provide migration steps for end users, deprecation timeline, and example commands mapping 'waif' -\u003e 'wf'.","acceptance_criteria":"Migration guide present in docs/migration/ with clear steps and examples; release notes entry added.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:18.80893419-08:00","created_by":"WAIF","updated_at":"2026-01-16T21:03:40.104805917-08:00","closed_at":"2026-01-16T21:03:40.104810417-08:00","dependencies":[{"issue_id":"wf-k5um.6","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:18.816011131-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.7","title":"Audit repository for remaining 'waif' references","description":"Search the codebase for 'waif' references (scripts, docs, CI, tests) and create follow-up bd issues for anything needing manual fixes.","acceptance_criteria":"All discovered references are captured as bd issues or updated; no stray 'waif' occurrences remain.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T17:38:20.483437243-08:00","created_by":"WAIF","updated_at":"2026-01-17T12:49:29.218845021-08:00","closed_at":"2026-01-17T12:49:29.218845021-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-k5um.7","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T17:38:20.484215859-08:00","created_by":"WAIF"}]}
{"id":"wf-k5um.8","title":"docs: add tmux removal migration guide","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T20:28:42.45940611-08:00","created_by":"WAIF","updated_at":"2026-01-16T20:55:20.292322534-08:00","closed_at":"2026-01-16T20:55:20.292322534-08:00","close_reason":"Not required per Producer instruction","dependencies":[{"issue_id":"wf-k5um.8","depends_on_id":"wf-k5um","type":"parent-child","created_at":"2026-01-16T20:28:42.460023308-08:00","created_by":"WAIF"}]}
{"id":"wf-k9f","title":"waif next should ignore in-progress issues","description":"Bug: waif next returns in_progress issues. Expected: only open, unblocked issues should be eligible. Repro: mark issue ge-hch in_progress, run waif next; it is suggested. Fix: tighten eligibility to status=open only (still skip blocked). Update tests.","notes":"Implemented ignore in_progress eligibility; added test coverage. Fixed context idempotence regression (wf-vs3) by excluding generated docs/dev/CONTEXT_PACK.md from scan; context tests now pass.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-07T23:09:55.720896201-08:00","created_by":"WAIF","updated_at":"2026-01-08T00:44:34.922567921-08:00","closed_at":"2026-01-08T00:44:34.922567921-08:00","close_reason":"Closed per user request"}
{"id":"wf-kbi","title":"Task: Runner: array-form command support + capture opt-in","description":"Support command arrays to avoid shell usage; make capture opt-in and return structured RunResult","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-12T02:10:07.580601202-08:00","created_by":"WAIF","updated_at":"2026-01-12T02:10:07.580601202-08:00","dependencies":[{"issue_id":"wf-kbi","depends_on_id":"wf-e6r","type":"discovered-from","created_at":"2026-01-12T02:10:07.581987503-08:00","created_by":"WAIF"}]}
{"id":"wf-kgp","title":"Chore: Add history/ directory and .gitignore entry","description":"Create history/ directory for AI planning docs and add optional .gitignore instructions; document usage in AGENTS.md if needed.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-19T21:44:36.773611594-08:00","updated_at":"2025-12-19T22:11:35.54028336-08:00","dependencies":[{"issue_id":"wf-kgp","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.390645737-08:00","created_by":"daemon"}]}
{"id":"wf-kpp","title":"Feature: ooda echo captured stdout/stderr to console in non-JSON runs","description":"Print captured stdout to stdout and stderr to stderr for jobs that request capture when the top-level invocation is not --json. Apply to both scheduler and run-job handlers.\\n\\nAcceptance criteria:\\n1) When running 'waif ooda run-job' or 'waif ooda scheduler' without --json, captured stdout/stderr are printed to the console for jobs with capture:['stdout'] / capture:['stderr'].\\n2) Printing does not occur when --json is set.\\n3) Unit test added: tests/ooda-echo.test.ts that spies on console.log/console.error and verifies behavior for run-job handler via exported helper.\\n4) Changes on branch wf-e6r.2.1.1/job-command, commit messages include bd id, branch pushed, and PR updated.\\n\\nImplementation notes for Patch:\\n- Add exported helper printJobResult(job, result, jsonOutput) to src/commands/ooda.ts and call it in both scheduler's runJob and run-job action after runJobCommand returns and before snapshot writing.\\n- Add tests/ooda-echo.test.ts that imports printJobResult and calls it with a fake job and result, asserting console output behavior for jsonOutput true/false.\\n","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-11T21:29:15.979330696-08:00","created_by":"WAIF","updated_at":"2026-01-11T21:29:15.979330696-08:00","dependencies":[{"issue_id":"wf-kpp","depends_on_id":"wf-e6r.2.1.1","type":"discovered-from","created_at":"2026-01-11T21:29:15.98544881-08:00","created_by":"WAIF"}],"comments":[{"id":106,"issue_id":"wf-kpp","author":"rgardler","text":"Implemented printJobResult helper and added tests. Files changed: src/commands/ooda.ts, tests/ooda-echo.test.ts. Commits: 85930bc, 322efc5. Pushed branch wf-e6r.2.1.1/job-command. Local tests passed for hello-5s and echo tests. (wf-kpp)","created_at":"2026-01-12T05:30:55Z"}]}
{"id":"wf-kqv","title":"wf-mtc.3.4: docs update + remove .history_tmp snapshot","description":"Update docs/commands/ooda.md with run-job examples, security notes, and snapshot retention guidance. Remove local .history_tmp snapshot artifact from docs branch. Acceptance: docs updated, tests/instructions added, .history_tmp removed and history/*.jsonl ignored.","status":"closed","priority":2,"issue_type":"task","assignee":"scribbler","created_at":"2026-01-12T00:23:00.238920598-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:45:39.633703214-08:00","closed_at":"2026-01-12T00:45:39.633707262-08:00","dependencies":[{"issue_id":"wf-kqv","depends_on_id":"wf-mtc.3","type":"blocks","created_at":"2026-01-12T00:23:00.262978504-08:00","created_by":"WAIF"}],"comments":[{"id":129,"issue_id":"wf-kqv","author":"rgardler","text":"Hints for scribbler: 1) Update docs/commands/ooda.md to include: - run-job CLI examples (one-shot usage: 'waif ooda run-job --name \u003cjob\u003e --once'; JSON output mode: '--json' examples), - snapshot format description (fields written to JSONL: timestamp, job id, exitCode, durationMs, stdout/stderr sanitized), - retention/keep_last guidance and example config fragment, - security notes: command injection risk, recommended allowlist patterns, 'capture' opt-in, and guidance to run jobs as dedicated service accounts where applicable. 2) Add a short 'Examples' section demonstrating non-JSON and JSON output and redaction behavior. 3) Note that snapshots are ignored by default (history/*.jsonl in .gitignore) and the .history_tmp artifact has been removed in this branch. 4) Add a one-line test/instruction to run 'npx vitest tests/run-job.e2e.test.ts' locally to verify behavior. Acceptance: docs/commands/ooda.md updated, PR body updated with links to tests, and bd comment referencing PR #107.","created_at":"2026-01-12T08:24:15Z"},{"id":130,"issue_id":"wf-kqv","author":"rgardler","text":"Delegation: Producer delegated docs work to scribbler. Status: assigned to scribbler and in_progress. PR https://github.com/SorraTheOrc/waif/pull/107 contains the cleanup commit and awaits docs edits. Actions taken in this session: added history/*.jsonl to .gitignore, moved local snapshot into .history_tmp (then removed), removed .history_tmp in wf-mtc.3.4/docs-and-cleanup branch, opened PR #107. Files touched: .gitignore, .history_tmp/ooda_snapshot_1768205459098.jsonl (removed). Next steps for scribbler: update docs/commands/ooda.md per the hints comment (examples, snapshot format, retention, security notes), update PR body with links to tests, and request review. I will monitor PR #107 CI and notify when it is mergeable. If scribbler is unresponsive for 48h, I will post a reminder comment on the PR and the bead.","created_at":"2026-01-12T08:27:01Z"},{"id":131,"issue_id":"wf-kqv","author":"rgardler","text":"Docs updated and tests run.\n\n- PR: https://github.com/SorraTheOrc/waif/pull/107\n- Commit: 04a0938 (wf-kqv: docs: update ooda run-job docs and examples)\n- Files changed:\n  - docs/commands/ooda.md\n- Local test:\n  - npx vitest tests/run-job.e2e.test.ts (pass)\n","created_at":"2026-01-12T08:30:06Z"},{"id":134,"issue_id":"wf-kqv","author":"rgardler","text":"Closing wf-kqv: docs updated, cleanup committed and PR merged by Producer. Summary: docs/commands/ooda.md edited to include run-job examples, snapshot JSONL format, retention guidance, security notes, and local test instructions. Tests run: npx vitest tests/run-job.e2e.test.ts (pass). PR: https://github.com/SorraTheOrc/waif/pull/107. Files changed: docs/commands/ooda.md. .history_tmp artifact removed earlier.","created_at":"2026-01-12T08:45:37Z"}]}
{"id":"wf-ku4","title":"Add gh to allowed commands for all agents","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T02:23:03.586505752-08:00","updated_at":"2025-12-22T02:23:03.586505752-08:00","dependencies":[{"issue_id":"wf-ku4","depends_on_id":"wf-5ay","type":"parent-child","created_at":"2025-12-22T16:04:44.659440563-08:00","created_by":"daemon"}]}
{"id":"wf-kum","title":"wf-mtc.3.4: Docs - run-job examples \u0026 operator notes","description":"Update docs/commands/ooda.md to include run-job usage, --json behavior, --log default path, redaction notes, and migration from --once/--events. Acceptance criteria: docs updated and linked in PR description.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-11T23:25:33.215132864-08:00","created_by":"WAIF","updated_at":"2026-01-11T23:25:33.215132864-08:00"}
{"id":"wf-ky8","title":"P0: Enable parallel team work via WAIF_session_\u003cTeam\u003e tmux sessions","description":"Allow multiple teams to run independent WAIF tmux sessions by deriving a session name from the checkout directory. When a producer clones the repo into a directory named \u003cTeam\u003e and runs scripts/start-workflow-tmux.sh it should create/attach to a tmux session named \"WAIF_session_\u003cTeam\u003e\". This enables parallel, isolated team workflows where each team uses its own tmux session and panes without colliding with other teams running on the same host.\\n\\nRationale:\\n- Teams often need an isolated set of agent panes and environment so agents do not interfere with each other.\\n- Deriving the session name from the repo directory keeps the workflow discoverable and simple for producers (clone into my-team and run the script).\\n- This approach complements the existing start-workflow-tmux.sh layout and requires a small change to session naming/selection logic and documentation.","acceptance_criteria":"1) scripts/start-workflow-tmux.sh derives default session name from the repo directory and uses the pattern 'WAIF_session_\u003cTeam\u003e' when creating or attaching to tmux. 2) Multiple sessions with different \u003cTeam\u003e names can run concurrently on the same host without interfering. 3) The script preserves existing --session override behavior (explicit --session continues to work). 4) Documentation and example usage are added to docs/Workflow.md and scripts/start-workflow-tmux.sh comments. 5) No default behavior change for existing users unless they clone into a directory named with a Team identifier or explicitly pass --session. 6) Provide a short migration note and tests/instructions to validate parallel sessions.","status":"open","priority":0,"issue_type":"feature","created_at":"2025-12-24T16:51:54.955441531-08:00","updated_at":"2025-12-24T16:51:54.955441531-08:00","comments":[{"id":29,"issue_id":"wf-ky8","author":"map","text":"Implemented session-name derivation in scripts/start-workflow-tmux.sh. Default session now uses pattern 'WAIF_session_\u003cTeam\u003e' derived from the repo directory name. Preserves --session override behavior. Files changed: scripts/start-workflow-tmux.sh (.modified). Created issue wf-ky8. Next: add docs/Workflow.md update and tests to validate concurrent sessions.","created_at":"2025-12-25T00:58:04Z"},{"id":30,"issue_id":"wf-ky8","author":"map","text":"Added docs/Workflow.md update documenting WAIF_session_\u003cTeam\u003e behavior and created child tasks: wf-ky8.1 (docs) and wf-ky8.2 (integration test). Files changed: docs/Workflow.md, scripts/start-workflow-tmux.sh. Next: implement the integration test script under tests/integration and wire a CI job if desired.","created_at":"2025-12-25T01:09:56Z"},{"id":31,"issue_id":"wf-ky8","author":"map","text":"Assigned wf-ky8.1 to scribbler for docs updates. Files to edit: docs/Workflow.md (already updated). Next: scribbler to refine migration note and add examples. Remaining tasks: wf-ky8.2 (integration test) unassigned.","created_at":"2025-12-25T01:18:08Z"}]}
{"id":"wf-ky8.1","title":"Add docs: parallel tmux sessions","description":"Add documentation and example usage for WAIF_session_\u003cTeam\u003e behavior in docs/Workflow.md and include a short migration note. Ensure examples show clone+run steps and mention --session override.","status":"open","priority":2,"issue_type":"task","assignee":"scribbler","created_at":"2025-12-24T17:09:48.653173966-08:00","updated_at":"2025-12-24T17:18:06.156117428-08:00","dependencies":[{"issue_id":"wf-ky8.1","depends_on_id":"wf-ky8","type":"parent-child","created_at":"2025-12-24T17:09:48.665318792-08:00","created_by":"daemon"}]}
{"id":"wf-ky8.2","title":"Add integration test for parallel tmux sessions","description":"Add a small integration test script and CI instruction that validates multiple WAIF_session_\u003cTeam\u003e sessions can be created concurrently on the same host. The test should create two temp clones (teamA, teamB), run the start-workflow-tmux.sh script in --session derived mode, verify both tmux sessions exist, then clean up.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T17:09:53.097041175-08:00","updated_at":"2025-12-24T17:25:21.088358775-08:00","closed_at":"2025-12-24T17:25:21.088358775-08:00","close_reason":"Cancelled: integration test deferred; manual validation documented in docs/Workflow.md","dependencies":[{"issue_id":"wf-ky8.2","depends_on_id":"wf-ky8","type":"parent-child","created_at":"2025-12-24T17:09:53.116764373-08:00","created_by":"daemon"}]}
{"id":"wf-l3l","title":"Release management documentation","description":"Create docs/release_management.md with an initial recommended release process. Must include a version-number management section aligned with waif --version behavior (release semver vs dev stamps).","notes":"PR: https://github.com/SorraTheOrc/wafi/pull/4 (updated with README + docs edits)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T09:39:17.386809825-08:00","updated_at":"2025-12-19T10:08:04.53468642-08:00","closed_at":"2025-12-19T10:08:04.53468642-08:00"}
{"id":"wf-lp0","title":"waif ask: one-shot CLI agent query","description":"Problem\n\nSometimes we just want a quick, one-shot answer from an agent without starting an interactive CLI/TUI session. We need a `waif ask` command that accepts a prompt, sends it to an agent (default `Map`/`PM`), allows optionally prefixing the prompt with an agent name (e.g. `ask patch ...`), and returns the agent's response to the console in Markdown (or `--json`) with no session tracking (one-shot MVP).\n\nUsers\n\nPrimary: producers who need fast, ad-hoc answers in the terminal (PMs/engineers writing prompts).\nSecondary: CLI users and automation that may call `waif ask` from scripts; QA and docs teams who rely on predictable one-shot outputs.\n\nSuccess criteria\n\nMVP success is that a user can run `waif ask \"\u003cprompt\u003e\"` and receive a coherent agent response rendered as Markdown to the console (or machine-readable JSON when `--json` is passed). The UX/implementation goal: ask -\u003e get response (no session), responses are stable Markdown and usable in pipelines.\n\nConstraints\n\nNo timeline or special constraints were specified. No session tracking or state persistence in MVP. Default agent is `Map` (PM); agent override via prefixing the prompt is required. No privacy/security constraints specified by requester.\n\nExisting state\n\n- The CLI contains a PRD/CLI design effort (`docs/dev/CLI_PRD.md`) and PRD-agent wiring work (`wf-ba2.3.6`, `wf-ba2.3.1`) that overlap with PRD generation and OpenCode integration. There is not a dedicated `waif ask` command implemented today.\n\nDesired change\n\nAdd a new `waif ask` CLI command that:\n- Accepts a prompt string or reads from stdin\n- Sends the prompt to a chosen agent (default `Map`/`PM`), allowing an agent name prefix to override\n- Returns the agent's response to stdout rendered as Markdown, or `--json` for machine output\n- Is one-shot only (no session persistence)\n\nLikely duplicates / related docs\n\n- `docs/dev/CLI_PRD.md`\n- `docs/Workflow.md` (intake/PRD workflow)\n- `docs/dev/TUI_PRD.md`\n- `docs/dev/implemented/find_next_PRD.md`\n\nRelated issues\n\n- `wf-ba2.3.1` - Minimal PRD generator (writes Markdown file)\n- `wf-ba2.3.6` - Wire waif prd command to PRD Agent workflow\n- `wf-ba2.3` - PRD Template \u0026 Validation (epic)\n- `wf-7m7` - Add waif command to validate implementation plan integrity (related CLI expansion)\n- `wf-soh` - Integrate marked-terminal markdown rendering for all CLI output (rendering pipeline)\n\nClarifying questions\n\n1. Confirm default agent: should `Map` (PM) be the default for `waif ask`?  \n2. Which output modes are required beyond `--json` and rendered Markdown (e.g., raw text, exit codes for partial failures)?  \n3. Should `waif ask` support reading prompts from stdin or files for scripting?  \n4. Is any prompt auditing/logging required (even minimal), or must MVP avoid writing prompts anywhere?  \n5. Are there agent name parsing rules (single token prefix vs multiple-word agent names)?\n\nProposed next step\n\nNEW PRD at: `docs/dev/waif_ask_PRD.md`\nRecommended next command: `/prd docs/dev/waif_ask_PRD.md \u003cissue-id\u003e`","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T00:51:49.358764386-08:00","updated_at":"2025-12-22T15:55:32.463150759-08:00","closed_at":"2025-12-22T14:35:39.495289441-08:00","comments":[{"id":14,"issue_id":"wf-lp0","author":"patch","text":"PR #45 merged. Implemented ask prompt parsing so that when an agent name is provided and the following word is 'to', it is removed from the prompt. Added coverage in tests/ask.test.ts. Files touched: src/commands/ask.ts, tests/ask.test.ts. Validation: npm test tests/ask.test.ts.","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-m0u","title":"Enhancement: snapshot JSONL metadata (summary, sanitized, truncated)","description":"Add explicit metadata fields to job run snapshots written by writeJobSnapshot.\n\nAcceptance criteria:\n1) Snapshot JSONL records include fields: time (ISO), job_id, name, command, exit_code, status, summary (optional short string), stdout (sanitized/truncated), stderr (sanitized/truncated), sanitized: boolean, truncated: boolean.  \n2) writeJobSnapshot implementation updated to emit these fields atomically.  \n3) Unit tests added verifying presence of fields, correct truncation behavior, and that sanitized=true when redaction applied.  \n4) Backward-compatible: older snapshot readers should still be able to parse records (no breaking changes).  \n\nNotes: Patch should prepare a migration note if format change affects downstream tools.","status":"open","priority":2,"issue_type":"task","assignee":"patch","created_at":"2026-01-12T01:50:55.52682548-08:00","created_by":"WAIF","updated_at":"2026-01-12T01:50:55.52682548-08:00","dependencies":[{"issue_id":"wf-m0u","depends_on_id":"wf-e6r.2","type":"discovered-from","created_at":"2026-01-12T01:50:55.533794601-08:00","created_by":"WAIF"}]}
{"id":"wf-mb2","title":"fix tmux session naming","description":"Start workflow tmux sessions are being named inconsistently; normalize naming to include workflow id and stage. Update scripts/start-workflow-tmux.sh accordingly.","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-24T20:46:49.506066079-08:00","updated_at":"2026-01-19T18:47:52.044467095-08:00","comments":[{"id":37,"issue_id":"wf-mb2","author":"rgardler","text":"Started work: updated scripts/start-workflow-tmux.sh to normalize tmux session naming; committed changes to branch wf-mb2/fix-tmux-session-naming. Tests not run per request.","created_at":"2025-12-25T04:47:31Z"}],"deleted_at":"2026-01-19T18:47:52.044467095-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"wf-mbms","title":"Producer: convenience CLI wrappers (epic)","description":"# Producer: convenience CLI wrappers (epic) — Intake Draft\n\nProblem\n\nProducers repeatedly perform small, error-prone steps to start work on a Beads issue: claim the bead, create a correctly named topic branch, optionally launch an OpenCode interview. These steps are mechanical and frequently cause friction, mistakes (wrong branch name, unpushed local branch, forgotten claim), and lost time.\n\nUsers\n\n- Primary: Producers (people who create / act on beads)\n- Secondary: Reviewers and Integrators who benefit from consistent branch names and bead metadata\n\nSuccess criteria\n\n- `waif id start` (or `wf id start`) idempotently claims a bead and creates a local topic branch using a predictable naming rule\n- Safe defaults: abort on dirty working tree or missing tools; provide explicit remediation steps\n- Idempotence: repeated runs do not create duplicate branches, bead comments, or external refs\n- Minimal surface area: first deliverable performs local branch creation only (no automatic push or PR)\n- Documentation: update `docs/dev/CLI_PRD.md` with a \"Producer convenience CLI wrappers\" section and usage examples\n\nConstraints and rules\n\n- ALL bead operations must use `bd` (never edit `.beads/issues.jsonl` directly)\n- Respect `BD_ACTOR` / environment identity when making bead comments or updates\n- Default behaviour: do not push branches or create PRs automatically\n- Maintain auditability: add a single concise bead comment when a branch is created; prefer `bd update \u003cid\u003e --external-ref \"\u003cnote\u003e\"` to record external refs\n\nExisting state\n\n- Related commands and helpers exist in `src/lib/bd.ts` and `src/commands/*` (use existing helpers where possible)\n- Small, related beads exist (e.g., `wf-70j.2.1` - waif intake command)\n- Draft saved at `.opencode/tmp/intake-draft-Producer_convenience_CLI_wrappers.md` in the repo; treat as the single source for this intake draft.\n\nProposed change\n\nCreate an epic \"Producer: convenience CLI wrappers (epic)\" (P1) that delivers a small family of convenience commands. The first scoped deliverable:\n\n- CLI orchestration command `waif id start` (alias `wf id start` optional) that:\n  - Verifies clean working tree and required tools (`git`, `bd`) are present; otherwise abort with remediation steps\n  - Idempotently claims the bead via `bd update \u003cid\u003e --status in_progress` (no forced takeover)\n  - Creates a local topic branch with the canonical name: `bd-\u003cid\u003e/\u003cshort-desc\u003e`\n    - `bd-\u003cid\u003e` is the bead numeric id (e.g., `bd-123`); `short-desc` is derived from the bead title: lowercase, punctuation removed, spaces -\u003e hyphens, max 40 chars\n    - Examples: bead title `Add intake wrapper` -\u003e branch `bd-123/add-intake-wrapper`\n  - Leaves branch local (no push); prints a one-line audit message and suggests `git push -u origin \u003cbranch\u003e` when user is ready\n  - Adds a single bead comment like: `Branch created: bd-123/add-intake-wrapper (local)` and also runs `bd update \u003cid\u003e --external-ref \"branch:bd-123/add-intake-wrapper\"` to record the ref\n  - Supports `--dry-run` to show intended actions without making changes\n\nNon-goals (initial)\n\n- Do not push branches or create PRs automatically\n- Do not automatically complete or close beads\n- Do not perform interactive OpenCode interviews by default; launching OpenCode (if supported) must be explicit and interactive\n\nIdempotence and safety details\n\n- If branch already exists locally: command checks it points at expected commit (if determinable) and reuses it; do not recreate\n- If bead already claimed by same actor: do not re-comment repeatedly; optionally update comment timestamp or leave a single marker comment\n- If bead is claimed by a different actor: abort and explain options (request transfer via bd, or user can force with explicit flag)\n\nRisks \u0026 assumptions\n\n- Assumes `bd` CLI is available and the user has permission to update beads\n- Assumes branch naming convention is acceptable to teams; we may need to tune `short-desc` sanitation rules for edge cases\n- Idempotent commenting may require reading existing bead comments which could be slow; keep minimal interactions\n\nRelated beads / history\n\n- wf-70j.2.1 — waif intake command (related; do NOT subsume — keep as separate child/related item)\n- wf-ba2.3.6 — Wire waif prd command to PRD Agent workflow\n- wf-mj5 — Docs: Resolve TBDs in docs/dev/CLI_PRD.md\n\nOpen questions\n\n1) Branch push behaviour: default is local-only. Do we include a `--push` flag in v1? (RECOMMEND: defer; add `--push` later)\n2) Alias support: include `wf` alias in v1 or defer? (RECOMMEND: defer)\n3) Exact external-ref format: we propose `branch:\u003cbranch-name\u003e`; accept or change?\n\nNext actions (for intake completion)\n\n1. Review this draft and approve or provide edits\n2. Run conservative five-stage review: Completeness, Capture fidelity, Related-work \u0026 traceability, Risks \u0026 assumptions, Polish \u0026 handoff. (I will run these reviews and make small conservative edits where helpful.)\n3. When approved, create a new beads epic (P1) using this draft as the body; label `Status: Intake Completed` and assignee `Build`\n4. Update `docs/dev/CLI_PRD.md` with a short section linking to the bead and describing the initial command\n5. Implement CLI command in `src/commands` referencing `src/lib/bd.ts` helpers; add tests under `tests/`\n\nDraft authoring notes\n\n- Created by OpenCode agent in session; intended to be conservative and focused for rapid delivery\n- File path: `.opencode/tmp/intake-draft-Producer_convenience_CLI_wrappers.md`\n\n-- End of draft\n\nReviews (conservative five-stage)\n\n- Finished Completeness review: Draft covers problem, users, success criteria, constraints, and next actions; clarified draft location. Recommend adding explicit example CLI invocations and expected output in `docs/dev/CLI_PRD.md` during implementation.\n\n- Finished Capture fidelity review: Proposed behaviour maps cleanly to success criteria. Idempotence goals are explicit; `--push` and alias features remain out of initial scope (deferred).\n\n- Finished Related-work \u0026 traceability review: Related beads are listed and intentionally not subsumed. When creating the epic, include explicit links to `wf-70j.2.1` and any child tasks to preserve traceability.\n\n- Finished Risks \u0026 assumptions review: Reiterated that `bd` availability and permissions are required; idempotent commenting may require scanning existing bead comments (watch for pagination/rate limits). Suggest adding a small acceptance test that simulates re-run behaviour and claim-conflict scenarios.\n\n- Finished Polish \u0026 handoff review: Minor wording cleanups applied; branch-name rule and `--dry-run` are explicit. Next actions: create the beads epic, update `docs/dev/CLI_PRD.md`, implement the command in `src/commands` with tests under `tests/`, and provide example CLI output in docs.\n\n-- End of draft\n","status":"open","priority":1,"issue_type":"epic","assignee":"Build","owner":"ross@gardler.org","created_at":"2026-01-19T04:09:56.860246573-08:00","created_by":"WAIF","updated_at":"2026-01-19T04:09:56.860246573-08:00","labels":["Status: Intake Completed"],"dependencies":[{"issue_id":"wf-mbms","depends_on_id":"wf-3ur","type":"parent-child","created_at":"2026-01-19T04:11:28.886477628-08:00","created_by":"WAIF"}]}
{"id":"wf-mfg","title":"wf-mtc.3.2: Unit tests for run-job CLI","description":"Add unit tests for the run-job CLI: mock runJobCommand and writeJobSnapshot to verify success, non-zero exit, timeout, and JSON vs non-JSON printing behavior. Include tests for job not found and invalid config paths. Acceptance criteria: tests pass locally and CI.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-11T23:25:25.9358923-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:06:19.915563325-08:00","closed_at":"2026-01-12T00:06:19.915563325-08:00","close_reason":"Tests passed on PR #105","comments":[{"id":121,"issue_id":"wf-mfg","author":"rgardler","text":"Focused tests and full suite on PR #105 (run-job CLI handler) all passed. Branch wf-mtc.3.1/run-job-handler up to date. No issues observed.","created_at":"2026-01-12T08:06:17Z"}]}
{"id":"wf-mj5","title":"Docs: Resolve TBDs in docs/dev/CLI_PRD.md","description":"Address all TODO/TBD sections in docs/dev/CLI_PRD.md (enforcement, constraints, mechanisms, performance expectations).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:31.687929564-08:00","updated_at":"2025-12-19T22:11:35.442639289-08:00","dependencies":[{"issue_id":"wf-mj5","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.2927395-08:00","created_by":"daemon"}]}
{"id":"wf-moa","title":"Default waif ctx writes docs/dev/CONTEXT_PACK.md and overwrites on each run","description":"Change request: Make the default behavior of # CONTEXT PACK\n\n## Overview\n\nThis file is an agent-oriented signpost. See docs/dev/context_pack_PRD.md for requirements and selection rules.\n\n## Important docs\n\n- docs/dev/context_pack_PRD.md — Canonical PRD for Context Pack\n- docs/Workflow.md — Project workflow rules\n- AGENTS.md / @AGENTS.md — Agent roles and responsibilities\n\n## How to query live state\n\n- Beads issues: bd ready --json\n- Current in-progress: bd list --status=in_progress --json write to docs/dev/CONTEXT_PACK.md and overwrite it on every run (no --force required).\\n\\nAcceptance criteria:\\n- Running # CONTEXT PACK\n\n## Overview\n\nThis file is an agent-oriented signpost. See docs/dev/context_pack_PRD.md for requirements and selection rules.\n\n## Important docs\n\n- docs/dev/context_pack_PRD.md — Canonical PRD for Context Pack\n- docs/Workflow.md — Project workflow rules\n- AGENTS.md / @AGENTS.md — Agent roles and responsibilities\n\n## How to query live state\n\n- Beads issues: bd ready --json\n- Current in-progress: bd list --status=in_progress --json with no flags writes docs/dev/CONTEXT_PACK.md and overwrites it if present.\\n-  continues to work and write to custom paths.\\n- Unit tests validate default-write behavior and overwrite semantics.\\n- Tests pass.\\n\\nImplementation: update src/commands/context.ts and tests/context.command.test.ts on branch feature/wf-ba2.5.4.1/ctx-cli.\\n","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-30T15:31:33.977580337-08:00","updated_at":"2026-01-19T04:09:56.571285823-08:00","dependencies":[{"issue_id":"wf-moa","depends_on_id":"wf-ba2.5.4.1","type":"discovered-from","created_at":"2025-12-30T15:31:33.992272035-08:00","created_by":"daemon"}],"deleted_at":"2026-01-19T04:09:56.571285823-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"wf-mr1","title":"Chore: CI sandbox for run-job E2E","description":"Add isolated CI job to run run-job E2E tests in containerized sandbox","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-12T02:10:07.643695103-08:00","created_by":"WAIF","updated_at":"2026-01-12T02:10:07.643695103-08:00","dependencies":[{"issue_id":"wf-mr1","depends_on_id":"wf-e6r","type":"discovered-from","created_at":"2026-01-12T02:10:07.645120066-08:00","created_by":"WAIF"}]}
{"id":"wf-mtc","title":"Epic: ooda runner \u0026 snapshots","description":"Epic to implement job runner, snapshot writer, CLI run-job, and tests for OODA pipeline. Parent for runner/snapshots/features.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-10T19:20:00.329752777-08:00","created_by":"WAIF","updated_at":"2026-01-10T19:20:00.329752777-08:00","dependencies":[{"issue_id":"wf-mtc","depends_on_id":"wf-e6r.2","type":"discovered-from","created_at":"2026-01-11T19:14:14.07908262-08:00","created_by":"WAIF"}]}
{"id":"wf-mtc.1","title":"Implement runJobCommand (runner)","description":"API: runJobCommand(job, options). Spawn job command, enforce timeout, capture stdout/stderr, sanitize redactions, return structured result suitable for snapshot writer.\\n\\nAcceptance criteria:\\n- Exports runJobCommand(job, {timeoutMs, cwd, env, capture}) in src/lib/runner.ts\\n- Uses child_process.spawn or execa; enforces timeout and kills process\\n- Returns { exitCode, signal, stdout, stderr, sanitized_output, durationMs }\\n- Unit tests mock child_process and cover success, non-zero exit, timeout, and large output truncation\\n- Types and exports documented in comments,json","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-10T19:20:02.854210427-08:00","created_by":"WAIF","updated_at":"2026-01-11T19:56:18.78181777-08:00","closed_at":"2026-01-11T19:56:18.78181777-08:00","close_reason":"Merged via PR #101","dependencies":[{"issue_id":"wf-mtc.1","depends_on_id":"wf-mtc","type":"parent-child","created_at":"2026-01-10T19:20:02.873029667-08:00","created_by":"WAIF"}],"comments":[{"id":95,"issue_id":"wf-mtc.1","author":"rgardler","text":"Merged via PR #101. Files: src/lib/runner.ts, tests/lib/runner.test.ts. Full test suite passed locally and PR checks green. Closing bead.","created_at":"2026-01-12T03:56:16Z"}]}
{"id":"wf-mtc.2","title":"Implement snapshot writer and retention","description":"Create src/lib/snapshots.ts with writeJobSnapshot(logPath, result) and enforce retention policy for job snapshots.\\n\\nAcceptance criteria:\\n- Exports writeJobSnapshot(path, result, {retention, maxSize})\\n- Writes newline-delimited JSONL with structured snapshot (time, job_id, name, exit_code, sanitized_output, summary)\\n- Enforces retention by retaining only last N snapshots per job (use history/ or configured dir)\\n- Unit tests covering write, retention pruning, and large file handling,json","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-10T19:20:05.151107667-08:00","created_by":"WAIF","updated_at":"2026-01-11T19:56:23.581326091-08:00","closed_at":"2026-01-11T19:56:23.581326091-08:00","close_reason":"Merged via PR #101","dependencies":[{"issue_id":"wf-mtc.2","depends_on_id":"wf-mtc","type":"parent-child","created_at":"2026-01-10T19:20:05.160639717-08:00","created_by":"WAIF"}],"comments":[{"id":96,"issue_id":"wf-mtc.2","author":"rgardler","text":"Merged via PR #101. Files: src/lib/snapshots.ts, tests/lib/snapshots.test.ts. Full test suite passed locally and PR checks green. Closing bead.","created_at":"2026-01-12T03:56:21Z"}]}
{"id":"wf-mtc.3","title":"CLI: waif ooda run-job","description":"Add implementation plan and subtasks wf-mtc.3.1..wf-mtc.3.6. Patch requested to implement all subtasks and coordinate with Probe (tests) and Scribbler (docs). See comments and created tasks for details.","status":"closed","priority":1,"issue_type":"feature","assignee":"patch","created_at":"2026-01-10T19:20:07.585071617-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:40:57.409401854-08:00","closed_at":"2026-01-12T00:40:57.409407871-08:00","dependencies":[{"issue_id":"wf-mtc.3","depends_on_id":"wf-mtc","type":"parent-child","created_at":"2026-01-10T19:20:07.594196117-08:00","created_by":"WAIF"}],"comments":[{"id":117,"issue_id":"wf-mtc.3","author":"rgardler","text":"Implementation plan and task breakdown for wf-mtc.3 (run-job CLI) added. Subtasks to be created: wf-mtc.3.1..wf-mtc.3.6. Patch is requested to implement all subtasks and coordinate with Probe and Scribbler for tests and docs. See bd comments and subtasks for details.","created_at":"2026-01-12T07:25:19Z"},{"id":118,"issue_id":"wf-mtc.3","author":"rgardler","text":"Delegating implementation of subtasks wf-mtc.3.1..wf-mtc.3.6 to @patch. Patch: please pick up wf-mtc.3.1 first, implement CLI handler, then follow with tests (wf-mtc.3.2/wf-mtc.3.3) and docs (wf-mtc.3.4). Coordinate with @probe for testing and @scribbler for docs. Close each subtask as you finish and update wf-mtc.3 when all are done. Priority: 1 for implementation/tests/security review; 2 for docs/CI.","created_at":"2026-01-12T07:25:46Z"},{"id":120,"issue_id":"wf-mtc.3","author":"rgardler","text":"Opened PR https://github.com/SorraTheOrc/waif/pull/105 for subtask wf-am1 (run-job handler). Awaiting Probe for wf-mtc.3.2 tests.","created_at":"2026-01-12T07:54:13Z"},{"id":123,"issue_id":"wf-mtc.3","author":"rgardler","text":"Verification of wf-mtc.3.1 (run-job CLI handler) succeeded on PR #105. Focused tests and full suite passed; Patch may proceed with wf-mtc.3.3.","created_at":"2026-01-12T08:06:26Z"},{"id":127,"issue_id":"wf-mtc.3","author":"rgardler","text":"Progress: Verified wf-mtc.3.3 deterministic E2E on PR #106. Build + focused suites + full npm test all green.","created_at":"2026-01-12T08:11:08Z"},{"id":132,"issue_id":"wf-mtc.3","author":"rgardler","text":"Evaluation summary: implementation and tests present and merged (PRs #101-106, docs PR #107). runJobCommand, run-job CLI handler, unit and deterministic E2E tests, and docs are merged to main and tests passed. Remaining work: security review (wf-8n9) and CI adjustment (wf-puh) are still open; these are required before closing parent wf-mtc.3 per acceptance criteria. I did NOT close wf-mtc.3. Next steps: (1) assign wf-8n9 to a security reviewer for the mitigation plan and any code changes; (2) assign wf-puh to Ship/CI owner to finalize CI trigger matrix and budget; (3) after both are closed, re-run full test suite and close wf-mtc.3. Files/PRs referenced: PR #105, PR #106, PR #107, tests/run-job.e2e.test.ts, docs/commands/ooda.md.","created_at":"2026-01-12T08:37:46Z"},{"id":133,"issue_id":"wf-mtc.3","author":"rgardler","text":"Closing wf-mtc.3 per Producer request.\n\nSummary rationale:\n- Implementation, tests, and docs for the run-job CLI have been merged to main and verified (PRs listed below). The Producer asked to close this bead despite follow-up security/CI tasks remaining; those follow-ups are tracked as separate beads.\n\nMerged PRs:\n- #101, #102, #103, #104, #105 (run-job CLI handler), #106 (deterministic E2E), #107 (docs + cleanup)\n\nRepresentative files changed/created during this work:\n- src/lib/runner.ts\n- src/commands/ooda.ts\n- src/lib/config.ts\n- src/lib/schemas/ooda-scheduler.schema.json\n- docs/commands/ooda.md\n- tests/run-job.e2e.test.ts\n- tests/ooda-run-job.test.ts\n- tests/runJobCommand.timeout.test.ts\n- tests/runJobCommand.exit.test.ts\n- tests/runJobCommand.largeOutput.test.ts\n- tests/helpers/exit.js, sleep.js, emit-large.js\n- .github/workflows/ci-tests.yml\n- .gitignore (history/*.jsonl)\n\nFiles created/removed while working (ephemeral/planning):\n- history snapshot files were moved/removed and .history_tmp artifact deleted in branch wf-mtc.3.4 (cleanup committed and PR merged).\n\nRemaining tracked follow-ups (left open intentionally):\n- wf-8n9: security review - runJobCommand sandboxing \u0026 redaction\n- wf-puh: CI trigger/matrix review\n\nIf you want me to also close the follow-ups automatically after creating summary tasks (or reassign them), say so and I will create/assign the subtasks.","created_at":"2026-01-12T08:40:55Z"}]}
{"id":"wf-mtc.4","title":"Tests: runner \u0026 snapshots","description":"Add unit tests for runJobCommand and writeJobSnapshot: mock child_process, test timeout behavior, large output truncation, retention pruning.\\n\\nAcceptance criteria:\\n- tests/lib/runner.test.ts mocks child_process to simulate success, non-zero exit, timeout, and large stdout/stderr\\n- tests/lib/snapshots.test.ts verifies file writes, JSONL format, and retention policy,json","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-10T19:20:09.733036227-08:00","created_by":"WAIF","updated_at":"2026-01-11T19:56:28.826162868-08:00","closed_at":"2026-01-11T19:56:28.826162868-08:00","close_reason":"Merged via PR #101","dependencies":[{"issue_id":"wf-mtc.4","depends_on_id":"wf-mtc","type":"parent-child","created_at":"2026-01-10T19:20:09.743535067-08:00","created_by":"WAIF"}],"comments":[{"id":94,"issue_id":"wf-mtc.4","author":"rgardler","text":"Implemented tests and runner timeout fix. Files edited: src/lib/runner.ts, src/lib/snapshots.ts, tests/lib/runner.test.ts, tests/lib/snapshots.test.ts","created_at":"2026-01-12T03:34:32Z"},{"id":97,"issue_id":"wf-mtc.4","author":"rgardler","text":"Merged via PR #101. Tests implemented and runner timeout fix applied. Full test suite passed and PR merged to main. Closing bead.","created_at":"2026-01-12T03:56:26Z"}]}
{"id":"wf-mxr","title":"opencode: add log(line) helper to append to .opencode/logs/events.jsonl","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T23:28:57.690366043-08:00","updated_at":"2025-12-27T23:30:59.116280048-08:00","closed_at":"2025-12-27T23:30:59.116280048-08:00","close_reason":"Implemented log(line) helper and tests passing","comments":[{"id":63,"issue_id":"wf-mxr","author":"rgardler","text":"Added async log(line, stream?) helper to append JSONL lines to .opencode/logs/events.jsonl and accept optional writable stream. Rationale: provide a simple opencode logging API so handlers can call await log(line, stream). Files changed: src/lib/opencode.ts","created_at":"2025-12-28T07:29:26Z"}]}
{"id":"wf-n0bx","title":"Update shell completions to 'wf' and test scripts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-16T17:39:37.826933257-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:39:37.826933257-08:00","dependencies":[{"issue_id":"wf-n0bx","depends_on_id":"wf-k5um.7","type":"discovered-from","created_at":"2026-01-16T17:39:37.829732023-08:00","created_by":"WAIF"}]}
{"id":"wf-nd26","title":"cleanup: housekeeping (2026-01-18)","description":"Cleanup run 2026-01-18: scanned repository for merged branches and open PRs targeting origin/main. Findings: default branch=main; GH available; no local branches detected as merged into origin/main; no open PRs targeting main. Beads in_progress: wf-3ur.2 (Add workflow stage tracking) — mapped to branch bd-wf-3ur.2/add-workflow-stage-prd (current branch). No deletions performed. Next steps: create/merge PRs for completed branches, or request targeted deletions. Run again with explicit confirmation to delete local and/or remote branches.","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-18T20:24:37.447197971-08:00","created_by":"WAIF","updated_at":"2026-01-18T20:24:48.450618897-08:00"}
{"id":"wf-niw1","title":"Docs: update examples and references from 'waif' to 'wf'","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-16T17:39:34.403204613-08:00","created_by":"WAIF","updated_at":"2026-01-16T17:39:34.403204613-08:00","dependencies":[{"issue_id":"wf-niw1","depends_on_id":"wf-k5um.7","type":"discovered-from","created_at":"2026-01-16T17:39:34.407097879-08:00","created_by":"WAIF"},{"issue_id":"wf-niw1","depends_on_id":"wf-chore","type":"parent-child","created_at":"2026-01-19T03:59:22.093457188-08:00","created_by":"WAIF"}]}
{"id":"wf-oe1g","title":"Docs: remove migration section from OODA docs","description":"Remove the 'Migration' section from OODA-related docs (not released yet). Update PR #131 branch wf-e6r.3.3/docs so docs do not include migration guidance that implies a released change. Ensure examples remain accurate.\\n\\nAcceptance criteria:\\n- Remove any 'Migration' or 'Migration notes' sections from docs/operational/ooda-scheduler.md, docs/usage/ooda.md, docs/dev/prd-ooda-loop.md, and docs/commands/ooda.md (if present).\\n- Update PR #131 branch wf-e6r.3.3/docs with the change and push the commit to the branch.\\n- PR #131 description updated to reflect removal and rationale.\\n- Tests unaffected; run the two E2E vitest tests locally and report results.\\n- Bd issue references PR #131 and is linked to wf-e6r.3.3 as discovered-from if possible.","notes":"Docs updated and PR #131 merged; migration notes removed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T22:39:07.313691672-08:00","created_by":"WAIF","updated_at":"2026-01-15T22:50:30.533663849-08:00","closed_at":"2026-01-15T22:50:30.533674149-08:00","external_ref":"PR: https://github.com/SorraTheOrc/waif/pull/131","labels":["Status: PR Created"],"dependencies":[{"issue_id":"wf-oe1g","depends_on_id":"wf-e6r.3.3","type":"discovered-from","created_at":"2026-01-15T22:45:49.252266719-08:00","created_by":"WAIF"}]}
{"id":"wf-oib","title":"Tweak start-agent worktree naming + ignore worktrees","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T15:49:11.949677121-08:00","updated_at":"2025-12-19T15:49:54.0059182-08:00","closed_at":"2025-12-19T15:49:54.0059182-08:00"}
{"id":"wf-ors","title":"Context command output not idempotent (tests/context.command.test.ts failing)","notes":"Full test suite on wf-e6r.2.1/config-loader shows failing tests/context.command.test.ts (idempotent output mismatch). Fails because existing docs/dev/CONTEXT_PACK.md contains prior content; command writes new content but test expects identical on rerun. Needs investigation.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T02:56:05.73148751-08:00","created_by":"WAIF","updated_at":"2026-01-11T23:16:55.870678616-08:00","closed_at":"2026-01-11T23:16:55.870678616-08:00","close_reason":"Triaged: failing test reproduced locally and passed after recent merges; no further action required","labels":["Status: Blocked"],"dependencies":[{"issue_id":"wf-ors","depends_on_id":"wf-e6r.2.1","type":"discovered-from","created_at":"2026-01-08T02:56:05.736505559-08:00","created_by":"WAIF"}],"comments":[{"id":115,"issue_id":"wf-ors","author":"rgardler","text":"Triage: ran failing test(s) locally. Built project and executed tests/context.command.test.ts (writes default file). Test passed locally after recent merges (PRs #102/#103/#104). Suggest closing wf-ors if no further failures observed in CI. Command run: npm run build \u0026\u0026 npx vitest run tests/context.command.test.ts -t 'writes default file'","created_at":"2026-01-12T07:16:53Z"}]}
{"id":"wf-p46z","title":"Remove commands migrated to AI","description":"Remove CLI commands that have been migrated to AI/OpenCode: prd, ask, and implement. This epic tracks de-registering these commands from the CLI, removing implementation files, tests that reference them, updating docs and CI, and ensuring downstream automation is updated.","acceptance_criteria":"1) Commands 'prd', 'ask', and 'implement' no longer appear in CLI help or runtime.\\n2) Implementation files removed from src/ or safely unregistered per component owner decision.\\n3) Tests invoking these commands removed/updated and CI passes.\\n4) Docs and release notes updated to reflect removal and point to AI-hosted alternatives.\\n5) PRs created for each removal and merged.","notes":"PR: https://github.com/SorraTheOrc/waif/pull/153","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-16T22:40:48.740391563-08:00","created_by":"WAIF","updated_at":"2026-01-17T12:40:13.231717722-08:00","closed_at":"2026-01-17T12:40:13.231717722-08:00","close_reason":"Children implemented and PR #153 merged","labels":["Status: PR Created"]}
{"id":"wf-p46z.1","title":"Remove 'prd' command (moved to AI)","description":"Remove PRD CLI command and associated tests/docs; consumers should use the AI-hosted PRD generator (OpenCode).","acceptance_criteria":"1) prd no longer registered in src/index.ts.\\n2) src/commands/prd.ts deleted or disabled.\\n3) Tests referencing prd removed/updated.\\n4) Docs updated with guidance to use AI-hosted generator.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-16T22:40:48.821145941-08:00","created_by":"WAIF","updated_at":"2026-01-17T12:40:00.08626796-08:00","closed_at":"2026-01-17T12:40:00.08626796-08:00","close_reason":"Implemented in PR #153","dependencies":[{"issue_id":"wf-p46z.1","depends_on_id":"wf-p46z","type":"parent-child","created_at":"2026-01-16T22:40:48.823198309-08:00","created_by":"WAIF"}]}
{"id":"wf-p46z.2","title":"Remove 'ask' command (migrated to AI)","description":"Remove ask CLI command which injected prompts into tmux panes; replace with AI-hosted ask or document alternative.","acceptance_criteria":"1) ask removed from CLI registration.\\n2) src/commands/ask.ts deleted or disabled.\\n3) Tests and docs updated.\\n4) Logging/agent mapping docs updated.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-16T22:40:48.863980286-08:00","created_by":"WAIF","updated_at":"2026-01-17T12:40:04.858471317-08:00","closed_at":"2026-01-17T12:40:04.858471317-08:00","close_reason":"Implemented in PR #153","dependencies":[{"issue_id":"wf-p46z.2","depends_on_id":"wf-p46z","type":"parent-child","created_at":"2026-01-16T22:40:48.864932189-08:00","created_by":"WAIF"}]}
{"id":"wf-p46z.3","title":"Remove 'implement' command (migrated to AI)","description":"Remove 'implement' command that scaffolds branches and claims bd work; replace workflow with AI-hosted implementation orchestration or document replacement.","acceptance_criteria":"1) implement removed from CLI registration.\\n2) src/commands/implement.ts deleted or disabled.\\n3) Tests and docs updated.\\n4) Ensure no automation depends on the CLI version.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-16T22:40:48.906810321-08:00","created_by":"WAIF","updated_at":"2026-01-17T12:40:08.996410105-08:00","closed_at":"2026-01-17T12:40:08.996410105-08:00","close_reason":"Implemented in PR #153","dependencies":[{"issue_id":"wf-p46z.3","depends_on_id":"wf-p46z","type":"parent-child","created_at":"2026-01-16T22:40:48.907321029-08:00","created_by":"WAIF"}]}
{"id":"wf-p6be","title":"Chore: Move operator snapshots to history/ and ignore ephemeral outputs","description":"Make operator snapshot outputs ephemeral and prevent accidental commits. This chore will add a history/ directory for operator snapshots, update .gitignore to ignore snapshot files/patterns, and move any existing snapshot examples into history/.\\n\\nAcceptance criteria:\\n- Add history/ directory to repo and include README explaining purpose (history/ is for ephemeral AI/agent planning and operator snapshots).\\n- Add .gitignore entries to ignore common snapshot filenames and patterns (e.g., history/, *.snapshot, snapshots/*, files named 'false' if applicable).\\n- Move existing operator snapshot files (if any) into history/ or remove them as agreed; create a bead for manual review if removal required.\\n- Update docs/operational/ooda-scheduler.md (or a short note in history/README) describing where operator snapshots are saved and that they are intentionally excluded from commits.\\n- Create implementation branch and push changes as a single commit; include the beads id in the commit message.\\n\\nNotes:\\n- Do NOT alter runtime snapshotting behavior in this chore; only repository layout and ignore rules.\\n- Link discovered-from to wf-oe1g (docs cleanup) so history of the change is traceable.","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-15T23:00:27.186109852-08:00","created_by":"WAIF","updated_at":"2026-01-15T23:00:27.186109852-08:00","dependencies":[{"issue_id":"wf-p6be","depends_on_id":"wf-oe1g","type":"discovered-from","created_at":"2026-01-15T23:00:27.189321359-08:00","created_by":"WAIF"}]}
{"id":"wf-p83","title":"Make 'waif context' generator deterministic (fix failing test)","description":"tests/context.command.test.ts is failing due to non-deterministic output from the context generator. Make generation deterministic so repeated runs produce identical files.\\n\\nAcceptance criteria:\\n- src/commands/context.ts produces deterministic output for docs/dev/CONTEXT_PACK.md: sort any lists/keys and stabilise ordering before writing.\\n- tests/context.command.test.ts passes consistently (running the test twice in a row yields identical files).\\n- Add unit test(s) if necessary to cover ordering.\\n- The fix is limited to deterministic ordering and does not change user-visible content beyond ordering/stability.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T15:50:31.065541016-08:00","created_by":"WAIF","updated_at":"2026-01-11T20:21:00.878006252-08:00","closed_at":"2026-01-11T20:21:00.878006252-08:00","close_reason":"Deterministic context generator changes merged (stabilized ordering/filtering in src/commands/context.ts). Tests pass. Closing.","comments":[{"id":92,"issue_id":"wf-p83","author":"rgardler","text":"Stabilized context generation ordering by sorting entries, filtering out temporary TMP_* docs and the generated CONTEXT_PACK.md itself before rendering. Edited: src/commands/context.ts","created_at":"2026-01-11T02:53:53Z"},{"id":93,"issue_id":"wf-p83","author":"rgardler","text":"Stabilized context generation ordering by sorting entries, filtering out temporary TMP_* docs and the generated CONTEXT_PACK.md itself before rendering. Edited: src/commands/context.ts","created_at":"2026-01-11T02:54:58Z"}]}
{"id":"wf-pdpc","title":"Refactor: reduce silent catches in logging/helpers","description":"Reduce silent catch behavior in logging/helpers and surface non-fatal errors for easier debugging.\\n\\nBackground:\\nSeveral logging and snapshot helper code paths swallow errors silently which makes debugging harder when filesystem or encoding errors occur. This refactor surfaces these failures as debug-level messages while keeping the helpers best-effort (do not throw).\\n\\nAcceptance Criteria:\\n- Replace broad empty catch blocks in src/lib/snapshots.ts, src/commands/ooda.ts logging helpers, and related utils with debug logging (e.g., console.debug or a lightweight debug() wrapper) that emits the error string in non-production modes.\\n- Keep behavior: helpers must not throw or change return values; only difference is additional debug logging when errors occur.\\n- Add a unit test that simulates a write failure (mock fs methods) and asserts the helper does not throw and that debug was called/printed.\\n- Add a short note in the issue describing how to enable debug logging for local troubleshooting.\\n","notes":"PR created: https://github.com/SorraTheOrc/waif/pull/155 — Status: PR Created. To view debug logs locally set NODE_ENV=development or run commands to observe console.debug output.","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-16T01:18:48.676448194-08:00","created_by":"WAIF","updated_at":"2026-01-17T20:41:56.489363206-08:00","closed_at":"2026-01-17T20:41:56.489363206-08:00","close_reason":"Completed","labels":["Refactor"],"dependencies":[{"issue_id":"wf-pdpc","depends_on_id":"wf-e6r.5","type":"discovered-from","created_at":"2026-01-16T01:18:48.678050991-08:00","created_by":"WAIF"}]}
{"id":"wf-puh","title":"Chore: update CI to run only on PR create/update for topic branches","description":"Edit .github/workflows/ci-tests.yml to: \\n1) Limit push trigger to main only. \\n2) Enable pull_request trigger for topic branches and example patterns: 'wf-*', 'wf-*/*', 'wf-mtc.*', 'wf-mtc.4/*', 'wf-mtc.4/tests-runner-snapshots'. \\n3) Add a dedicated job in CI for sandbox smoke tests that runs run-job in a contained container (or self-hosted runner) to validate sandboxing. \\n4) Place new deterministic run-job tests into a 'run-job' job that runs in parallel to reduce total CI time but uses containment for safety. \\n\\nAcceptance criteria:\\n- .github/workflows/ci-tests.yml updated with the above triggers and job layout.\\n- New sandbox smoke job exists (calls a simple containerized job run) and is configured to run on PRs touching run-job code.\\n- Tests referencing run-job are split into the run-job job and the general test job.\\n- Document in the issue which runner is used (github-hosted vs self-hosted) and any permissions considerations.\\n\\nSuggested owner: ship (CI owner). Estimated effort: 1-2 days.,--json","status":"open","priority":1,"issue_type":"chore","created_at":"2026-01-11T21:04:50.825517239-08:00","created_by":"WAIF","updated_at":"2026-01-12T00:42:49.090206599-08:00","labels":["refactor"],"dependencies":[{"issue_id":"wf-puh","depends_on_id":"wf-e6r.2.1.1","type":"discovered-from","created_at":"2026-01-11T21:04:50.834983518-08:00","created_by":"WAIF"}],"comments":[{"id":100,"issue_id":"wf-puh","author":"rgardler","text":"Updated .github/workflows/ci-tests.yml so CI runs on pull_request for topic branches and push only on main. Change committed on wf-e6r.2.1.1/job-command and pushed (commit 4739a2e). CI run queued for PR #102: https://github.com/SorraTheOrc/waif/actions/runs/20908659611","created_at":"2026-01-12T05:05:11Z"}]}
{"id":"wf-q6t","title":"tmp intake brief test","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-22T10:06:34.405052364-08:00","updated_at":"2025-12-22T16:08:06.752636359-08:00","closed_at":"2025-12-22T16:04:41.39965267-08:00"}
{"id":"wf-qf6r","title":"Cleanup merged branches for PR #124","description":"Track deletion of local and remote feature branches created for PR #124 (wf-9ujx/ajv-use-defaults, wf-9ujx/ansi-clear-fix, wf-8tcx/implement-clear-tty). Do NOT delete branches until reviewer confirms. Provide commands to delete locally and remotely.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-14T22:22:17.32713358-08:00","created_by":"WAIF","updated_at":"2026-01-14T22:30:09.099980673-08:00","closed_at":"2026-01-14T22:30:09.099980673-08:00","close_reason":"Branches pruned and cleaned up locally and remotely"}
{"id":"wf-qsd","title":"Chore: add .vscode/ to .gitignore (untracked editor files)","description":"Add .vscode/ to .gitignore to avoid untracked editor settings blocking work. Do not commit other unrelated files. Patch agent should add entry and commit on the implementation branch before continuing.","acceptance_criteria":"1) .vscode/ listed in .gitignore at repo root. 2) Commit made on feature branch (wf-e6r.2.1.1/job-command or derived topic branch) with message: 'chore: ignore .vscode/'. 3) No other repo changes included in the commit.","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-08T20:41:02.351792286-08:00","created_by":"WAIF","updated_at":"2026-01-08T20:41:02.351792286-08:00","dependencies":[{"issue_id":"wf-qsd","depends_on_id":"wf-bkt","type":"discovered-from","created_at":"2026-01-08T20:41:02.353319526-08:00","created_by":"WAIF"}],"comments":[{"id":85,"issue_id":"wf-qsd","author":"rgardler","text":"Added .vscode/ to .gitignore and committed on branch wf-e6r.2.1.1/job-command-work (commit f5612ad). No other changes included. Pushed branch to origin.","created_at":"2026-01-09T04:41:11Z"},{"id":90,"issue_id":"wf-qsd","author":"rgardler","text":"Ignored .vscode/ (commit f5612ad) and later implemented job runner + snapshot writer (commit d865192) on wf-e6r.2.1.1/job-command-work. Files changed: .gitignore, src/lib/jobRunner.js, src/lib/snapshotWriter.js, src/commands/ooda.ts, tests/*. Commit d865192.","created_at":"2026-01-09T04:58:17Z"}]}
{"id":"wf-r1d","title":"OODA monitor uses OpenCode events to track agent status","description":"Problem\nCurrently the `waif ooda` monitor infers agent state from tmux pane titles which is unreliable. We should instead consume OpenCode events (see https://opencode.ai/docs/plugins/#events) to reliably track agent lifecycle (start/stop) and messages. This intake specifies an iterative implementation: v1 logs events of interest to the console; v2 detects agent start/stop reliably; v3 persists status to a YAML record.\n\nUsers\nPrimary users: the OODA Monitor operator (local developer running `waif ooda`) and the OODA monitor process itself. No secondary stakeholders were identified.\n\nSuccess criteria\n- v1 (console logs): `agent.started`, `agent.stopped`, and message-returned events appear in console logs; manual verification is acceptable initially; explore integration testability for automated verification.\n- v2 (detection): identify which agent starts and stops with 99.999% reliability (operational acceptance). Detection latency targets TBD in follow-ups.\n- v3 (persistent state): write a YAML status record during runtime to `history/` (permanent record) and maintain an in-memory cache for execution; console shows table of known agents with fields (agent, status, last_seen, source).\n\nConstraints\n- Priority: P0 (as requested).\n- Parent: wf-gn7.1 (WAIF OpenCode Plugin) — this issue is a child of that epic.\n- Timeline: no hard deadline specified.\n- Backwards compatibility: not required for this work (experimental acceptable).\n\nExisting state\n- Current ooda implementation uses pane titles and PID probes to infer agent state; this is implemented in `src/commands/ooda.ts` and supporting spike artifacts exist (scripts/ooda_probe.sh, history/ooda_probe_*.txt, history/ooda_heuristics.md).\n- Existing PRD and docs: `docs/dev/prd-ooda-loop.md` (OODA PRD), `history/ooda_command_PRD.md` (draft), and `docs/dev/opencode_integration_PRD.md` (OpenCode plugin PRD). Beads tasks exist: wf-cvz (ooda intake), wf-cvz.1 (probe spike), wf-cvz.2 (CLI work), and the OpenCode epic wf-gn7.1.\n\nDesired change\n- Integrate OpenCode plugin events as the canonical source of agent lifecycle events for the OODA monitor.\n- Implement iterative delivery:\n  - v1: subscribe to OpenCode events and log `agent.started`, `agent.stopped`, and message-returned events to console/log path. Provide `--log` support (existing CLI supports `--log` and `history/` defaults).\n  - v2: implement reliable mapping from events to agent identities (use existing agent map/fallbacks) and reach 99.999% identification reliability.\n  - v3: maintain an in-memory status cache and persist a YAML status snapshot to `history/ooda_status.yaml` (or similar) on changes or periodic flush.\n\nLikely duplicates / related docs\n- docs/dev/prd-ooda-loop.md\n- history/ooda_command_PRD.md\n- docs/dev/opencode_integration_PRD.md\n- src/commands/ooda.ts\n- src/lib/opencode.ts\n- scripts/ooda_probe.sh\n- history/ooda_probe_*.txt\n\nRelated issues (Beads IDs)\n- wf-gn7.1 — WAIF OpenCode Plugin (parent)\n- wf-cvz — ooda intake (epic)\n- wf-cvz.1 — Spike: collect tmux probe data for ooda (closed)\n- wf-cvz.2 — Implement CLI: waif ooda start/stop and logging (open)\n\nClarifying questions\n1) Confirm exact event names to subscribe to (suggested: `agent.started`, `agent.stopped`, `agent.message` / `message.returned`). Are these acceptable, or do you want alternative names/schema?\n2) For v1 automated testing: do you want a minimal OpenCode mock server in tests (preferred) or a plan to run a real OpenCode instance in CI? Which approach is acceptable for initial integration tests?\n3) For v3 YAML schema: confirm required fields (suggested: agent, status, last_seen (ISO8601), source (opencode|probe), optional metadata). Any additions?\n4) Retention/rotation for history/ooda_status.yaml: should we keep a single file (overwrite) or append timestamped snapshots for auditability?\n5) Any security/privacy constraints around logging agent messages that we must observe?\n\nProposed next step\n- UPDATE PRD at: docs/dev/prd-ooda-loop.md\n- Recommended next command (after confirming): /prd docs/dev/prd-ooda-loop.md \u003cnew-issue-id\u003e\n\nLinked PRD: docs/dev/prd-ooda-loop.md","notes":"Committed local beads updates, ran tests (npm test -\u003e all unit tests passed). PR created: https://github.com/SorraTheOrc/waif/pull/75","status":"closed","priority":0,"issue_type":"feature","assignee":"patch","created_at":"2025-12-24T23:25:38.997580156-08:00","updated_at":"2025-12-30T01:29:45.961646676-08:00","closed_at":"2025-12-30T01:29:45.961652392-08:00","external_ref":"PRD: docs/dev/prd-ooda-loop.md","dependencies":[{"issue_id":"wf-r1d","depends_on_id":"wf-e6r","type":"parent-child","created_at":"2026-01-08T00:18:36.916077513-08:00","created_by":"WAIF"}],"comments":[{"id":38,"issue_id":"wf-r1d","author":"map","text":"Linked PRD: docs/dev/prd-ooda-loop.md","created_at":"2025-12-25T07:34:04Z"},{"id":39,"issue_id":"wf-r1d","author":"map","text":"PRD updated and committed: docs/dev/prd-ooda-loop.md. Key changes: events-only OpenCode design, plugin→file bridge (.waif/opencode_events.jsonl) for v1, JSONL persistence schema at history/ooda_status.jsonl, example JSONL record, architecture diagram, mapping from OpenCode events to OODA status. Created branch wf-r1d/prd-ooda-loop-stashbranch and pushed. Next: open PR and request review from product owner and wf-gn7 owner.","created_at":"2025-12-25T08:23:00Z"},{"id":40,"issue_id":"wf-r1d","author":"map","text":"PR merged: https://github.com/SorraTheOrc/waif/pull/67. Files changed: docs/dev/prd-ooda-loop.md. Branch: wf-r1d/prd-ooda-loop-stashbranch. Next: implement event ingester and tests (follow-ups recommended).","created_at":"2025-12-25T08:36:25Z"},{"id":51,"issue_id":"wf-r1d","author":"map","text":"PR: https://github.com/SorraTheOrc/waif/pull/70","created_at":"2025-12-27T06:29:34Z"},{"id":52,"issue_id":"wf-r1d","author":"map","text":"Default ooda now uses OpenCode ingester when OPENCODE_ENABLED; added --probe flag to opt into tmux probe. PR: https://github.com/SorraTheOrc/waif/pull/70","created_at":"2025-12-27T07:21:48Z"},{"id":53,"issue_id":"wf-r1d","author":"map","text":"Default ooda now uses OpenCode ingester when OPENCODE_ENABLED; added --probe flag to opt into tmux probe. PR: https://github.com/SorraTheOrc/waif/pull/70","created_at":"2025-12-27T07:27:25Z"},{"id":54,"issue_id":"wf-r1d","author":"map","text":"Refactored OODA ingestion to require the OpenCode SDK subscribe API in production. Removed server auto-start and sample/mock/EventEmitter fallbacks from production paths. Kept long-running keepAlive behavior and file persistence. Added injection point for tests so a mock SDK event source can be used in unit/integration tests.\n\nFiles changed: src/lib/opencode.ts, src/lib/ooda-ingester.ts, src/commands/ooda.ts\n\nFollow-ups: Add tests/mocks/opencode-sdk-mock.ts (fake _sdk.event.subscribe) and update tests that previously relied on sample/mock or readMockEvents to inject the mock source. After tests are updated and pass, close bead.","created_at":"2025-12-27T21:53:07Z"},{"id":55,"issue_id":"wf-r1d","author":"map","text":"Added OpenCode SDK mock for tests and updated ingester/CLI tests to use SDK-only event source. Files touched: tests/mocks/opencode-sdk-mock.ts, tests/ooda-ingester.integration.test.ts, tests/opencode_ingest.test.ts, tests/ooda-cli-opencode.test.ts. npm run build \u0026\u0026 npm test now passing. Follow-up: none pending for test coverage; consider closing wf-r1d.10.","created_at":"2025-12-27T22:00:18Z"},{"id":56,"issue_id":"wf-r1d","author":"map","text":"Updated opencode ingester to accept canonical OpenCode plugin event names (session.* and message.*) in addition to legacy agent.* names. Added normalization of event types, preserved originalType metadata, expanded default subscriptions, updated mock/test events, and verified redaction still works. Files touched: src/lib/opencode.ts, src/lib/ooda-ingester.ts, src/commands/ooda.ts, tests/mocks/opencode-sdk-mock.ts, tests/opencode_ingest.test.ts, tests/ooda-ingester.integration.test.ts. Tests: npm run build; npm test.","created_at":"2025-12-27T22:08:33Z"},{"id":57,"issue_id":"wf-r1d","author":"map","text":"Removed probe/legacy paths from ooda CLI; opencode subscription is default; sample flag now feeds mock source; tests updated (src/commands/ooda.ts, src/lib/ooda-ingester.ts, tests/ooda-cli-opencode.test.ts, tests/ooda-cli-probe.test.ts, tests/ooda-ingestor.test.ts, tests/opencode_ingest.test.ts).","created_at":"2025-12-27T23:03:57Z"}]}
{"id":"wf-r1d.1","title":"Draft PRD: OODA monitor — produce canonical PRD for event-driven design","description":"Goal: Produce the canonical Draft PRD for the OODA monitor that specifies the event-driven design, plugin bridge, and JSONL persistence.\\n\\nTemplate: \\n- Goal: Produce draft PRD document for review.\\n- Acceptance: docs/dev/prd-ooda-loop.md exists and reflects event-driven OpenCode plugin design, includes architecture diagram, example JSONL record, and mapping from OpenCode events to OODA status.\\n- Artifacts produced: docs/dev/prd-ooda-loop.md (path) ; PR: https://github.com/SorraTheOrc/waif/pull/67\\n- Notes: This issue seeds the next review step.\\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:46:03.968390044-08:00","updated_at":"2025-12-28T16:00:12.766161112-08:00","closed_at":"2025-12-28T16:00:12.766161112-08:00","close_reason":"PRD updated and merged in PR #74","dependencies":[{"issue_id":"wf-r1d.1","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:46:03.980789105-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.1","depends_on_id":"wf-r1d.2","type":"blocks","created_at":"2025-12-25T00:47:44.324395721-08:00","created_by":"daemon"}],"comments":[{"id":68,"issue_id":"wf-r1d.1","author":"rgardler","text":"PRD updated and merged in PR #74: https://github.com/SorraTheOrc/waif/pull/74. Files changed: docs/dev/prd-ooda-loop.md, docs/dev/ooda_implementation_plan.md","created_at":"2025-12-29T00:00:10Z"}]}
{"id":"wf-r1d.10","title":"OODA v1: OpenCode event ingester + console logging","status":"closed","priority":0,"issue_type":"task","assignee":"patch","created_at":"2025-12-25T13:20:58.224698818-08:00","updated_at":"2025-12-27T14:00:22.387075463-08:00","closed_at":"2025-12-27T14:00:22.387075463-08:00","close_reason":"Completed","dependencies":[{"issue_id":"wf-r1d.10","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T13:20:58.226120814-08:00","created_by":"map"}]}
{"id":"wf-r1d.2","title":"PRD Review (5-step): OODA monitor PRD — validate architecture \u0026 schema","description":"Goal: Validate the PRD covers architecture, schema, CLI, and ops guidance.\\n\\nAcceptance criteria:\\n- Reviewers sign off in comments or required edits made and PRD updated.\\n- All open clarifying questions resolved.\\n\\nArtifacts produced by prior steps:\\n- docs/dev/prd-ooda-loop.md (merged PR #67)\\n- wf-r1d.1 (Draft PRD)\\n\\nDeliverables:\\n- Review checklist completed, any editorial fixes applied to PRD, and note added to wf-r1d.\\n\\nReviewers: wf-gn7 owners, product owner\\nBlocked-by: wf-r1d.1\\nNotes: Events-only decision, plugin-\u003efile bridge, JSONL schema in PRD.","notes":"Delegating PRD 5-step review to agents. Created subtask wf-r1d.2.1 to run checklist and collect reviewer sign-offs. Assigned scribbler to execute edits on docs/dev/prd-ooda-loop.md and produce review artifacts under history/. Agents will operate on the current branch and will not push changes. I will attach file lists and follow-ups to this issue when agents finish.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.187802635-08:00","updated_at":"2025-12-29T23:20:48.098247109-08:00","closed_at":"2025-12-29T23:20:48.098255405-08:00","dependencies":[{"issue_id":"wf-r1d.2","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.195146803-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.2","depends_on_id":"wf-r1d.3","type":"blocks","created_at":"2025-12-25T00:47:44.392891343-08:00","created_by":"daemon"}],"comments":[{"id":69,"issue_id":"wf-r1d.2","author":"rgardler","text":"Marked in_progress after PR #74 merge. Next: implement snapshot persistence to history/ (wf-r1d.* follow-ups), plugin filters, CI E2E harness, and redaction policy alignment (wf-ba2.8). Files referenced: docs/dev/prd-ooda-loop.md, docs/dev/ooda_implementation_plan.md","created_at":"2025-12-29T00:00:18Z"},{"id":70,"issue_id":"wf-r1d.2","author":"rgardler","text":"PRD Review Checklist (ready-to-post)\n\nPurpose: Use this comment as the canonical review checklist for wf-r1d.2. Do not start implementation until this review is closed. Reviewers: please paste your responses below under the 'Reviewer response' heading.\n\nFiles referenced: docs/dev/prd-ooda-loop.md, docs/dev/ooda_implementation_plan.md, src/commands/ooda.ts, .opencode/plugin/waif-ooda.ts, src/lib/opencode.ts, tests/*\n\n---\nReview checklist (copy each line and replace with OK / Needs edit + short note):\n\n1) Architecture \u0026 scope: OK / Needs edit\n- Can you summarize v1/v2/v3 in one sentence? (Reviewer summary: )\n\n2) Sample JSONL event: OK / Needs edit\n- Is there a realistic sample event in the PRD covering time, type, agent, title/summary, minimal metadata? (Notes: )\n\n3) Mapping rules → OODA state: OK / Needs edit\n- Are mapping rules explicit and exhaustive for common event types? Any missing / edge cases? (Notes: )\n\n4) CLI contract: OK / Needs edit\n- Are flags (--once, --interval, --log, --json) and example invocations documented and unambiguous? (Notes: )\n\n5) Persistence \u0026 retention: OK / Needs edit\n- Snapshot shape, redaction policy, storage path (history/) and rotation/retention guidance present? (Notes: )\n\n6) Redaction \u0026 privacy: OK / Needs edit\n- Is the redaction policy or reference (wf-ba2.8) covered? Any concerns about sensitive fields? (Notes: )\n\n7) Tests \u0026 CI plan: OK / Needs edit\n- Is there a concrete plan for unit tests (reader, mapping, snapshot writer) and CI E2E using a mock emitter? (Notes: )\n\n8) Ops \u0026 runbook: OK / Needs edit\n- Is there an operational runbook for running, troubleshooting ingestion, and expected error handling? (Notes: )\n\n9) Security \u0026 risk: OK / Needs edit\n- Are risks and mitigations for logging, access controls, and retention described? (Notes: )\n\n10) Open clarifying questions: (list any remaining questions here)\n\n---\nReviewer response template (paste into PR and/or beads):\n\nShort summary: (OK / Needs edit / Blocked)\nItems requiring edits: (one-line per item)\nSuggested edits or text (optional):\nSign-off: I approve / I approve pending X edits\nReviewer: @\u003cgithub-handle\u003e  Date: \u003cYYYY-MM-DD\u003e\n\n---\nOwner triage message (owner should post after addressing PR comments):\n\nThanks for the review — I addressed the items listed above in PR \u003cnumber\u003e (or explained why no change was needed). Outstanding items: (list). Next steps: (e.g., update docs in PR, create discovered follow-up bd tasks - will be created but remain blocked until this review closes).\n\n---\nSign-off \u0026 close message (owner once review is complete):\n\nPRD review complete and accepted. Sign-offs: \u003clist reviewers and handles\u003e. Discovered follow-ups created: (list bd ids). Implementation may proceed against the documented acceptance criteria. Closing wf-r1d.2.\n\n---\nFiles edited/created while adding this comment: none (this step only added a beads comment)\n\nIf you want me to record this as an 'in_review' status update I can, but per request I did not change the issue status (wf-r1d.2 remains in_progress).","created_at":"2025-12-29T00:31:25Z"},{"id":71,"issue_id":"wf-r1d.2","author":"rgardler","text":"@patch @probe @ship — gentle ping: PRD review checklist added to this issue. Please paste your Reviewer response under the 'Reviewer response' heading in the comment and/or add line-level comments on the PR: docs/dev/prd-ooda-loop.md (PR merged).\\n\\nReviewer checklist (copy each line and replace with OK / Needs edit + short note):\\n1) Architecture \u0026 scope: OK / Needs edit\\n2) Sample JSONL event: OK / Needs edit\\n3) Mapping rules → OODA state: OK / Needs edit\\n4) CLI contract: OK / Needs edit\\n5) Persistence \u0026 retention: OK / Needs edit\\n6) Redaction \u0026 privacy: OK / Needs edit\\n7) Tests \u0026 CI plan: OK / Needs edit\\n8) Ops \u0026 runbook: OK / Needs edit\\n9) Security \u0026 risk: OK / Needs edit\\n10) Open clarifying questions: (list any)\\n\\nIf you approve, please sign off with: 'Sign-off: I approve' and your github handle. If you need edits, please reference concrete PR comments or list the required doc changes here. Thank you!","created_at":"2025-12-29T00:31:57Z"}]}
{"id":"wf-r1d.2.1","title":"PRD Review: run 5-step checklist and collect reviewer sign-offs","description":"Run the 5-step PRD review checklist, collect reviewer sign-offs, and apply editorial updates to docs/dev/prd-ooda-loop.md. Produce a review note under history/ recording reviewer comments, decisions, and files edited. Operate on the current branch; do not push changes. List produced/edited files in bd comments when done.","notes":"Edited docs/dev/prd-ooda-loop.md and added a review note history/review-wf-r1d.2.md. Created clarifying tasks: wf-xrl, wf-3k9, wf-0p2, wf-608. Operated on current branch; no pushes performed.","status":"closed","priority":1,"issue_type":"task","assignee":"scribbler","created_at":"2025-12-28T16:37:27.667727595-08:00","updated_at":"2025-12-29T23:19:57.940314408-08:00","closed_at":"2025-12-29T23:19:57.940338908-08:00","dependencies":[{"issue_id":"wf-r1d.2.1","depends_on_id":"wf-r1d.2","type":"parent-child","created_at":"2025-12-28T16:37:27.677591556-08:00","created_by":"daemon"}]}
{"id":"wf-r1d.3","title":"Implementation \u0026 Test Plan: OODA monitor — event ingester, tests, persistence","description":"Goal: Produce a step-by-step implementation and test plan for the OODA event ingester.\\n\\nAcceptance criteria:\\n- A concrete implementation plan file exists and details the event ingester, status model, CLI, persistence, and CI test strategy.\\n- Test plan covers unit, integration, and CI expectations.\\n\\nArtifacts: docs/dev/prd-ooda-loop.md, wf-r1d.1, wf-r1d.2\\n\\nDeliverables:\\n- docs/dev/ooda_implementation_plan.md created in repo (or equivalent)\\n- Test matrix and CI notes\\n\\nReviewers: Implementation owner, wf-gn7 owners, product owner\\nBlocked-by: wf-r1d.2\\nNotes: No external OpenCode in CI; use mock emitter for tests.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.265904408-08:00","updated_at":"2025-12-29T23:20:21.586520459-08:00","closed_at":"2025-12-29T23:20:21.586529754-08:00","dependencies":[{"issue_id":"wf-r1d.3","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.266447149-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.3","depends_on_id":"wf-r1d.4","type":"blocks","created_at":"2025-12-25T00:47:44.452537658-08:00","created_by":"daemon"}]}
{"id":"wf-r1d.4","title":"Implementation Plan Review (5-step): verify implementation readiness","description":"Goal: Review and validate the implementation \u0026 test plan is ready for work.\\n\\nAcceptance criteria:\\n- Implementation plan reviewers sign off; open questions resolved.\\n- Plan is actionable with clear deliverables and tests.\\n\\nArtifacts: docs/dev/ooda_implementation_plan.md, wf-r1d.3\\n\\nDeliverables: Review checklist completed and plan updated as required.\\n\\nReviewers: Implementation owner, wf-gn7 owners\\nBlocked-by: wf-r1d.3\\nNotes: Confirm file-based event bridge and JSONL snapshot approach.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.32841371-08:00","updated_at":"2025-12-29T23:21:28.650233906-08:00","closed_at":"2025-12-29T23:21:28.650239906-08:00","dependencies":[{"issue_id":"wf-r1d.4","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.328946543-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.4","depends_on_id":"wf-r1d.5","type":"blocks","created_at":"2025-12-25T00:47:44.506692113-08:00","created_by":"daemon"}]}
{"id":"wf-r1d.5","title":"Implementation: OODA event ingester and UI","description":"Goal: Implement the OODA event ingester, CLI UI, and persistence per the approved implementation plan.\\n\\nAcceptance criteria:\\n- Unit and integration tests pass locally.\\n- CLI can read a mock .waif/opencode_events.jsonl and update status model.\\n- history/ooda_status.jsonl snapshots are appended when configured.\\n\\nArtifacts: code in src/commands/ooda.ts and helpers, tests in tests/, history/odata_status.jsonl (output)\\n\\nDeliverables:\\n- Event tailer module, mapping layer, CLI command scaffold, tests.\\n\\nReviewers: Implementation owner, reviewer group\\nBlocked-by: wf-r1d.4\\nNotes: Use temp files in tests; do not require network or external services.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.388847783-08:00","updated_at":"2025-12-29T23:20:56.361536835-08:00","closed_at":"2025-12-29T23:20:56.361541033-08:00","dependencies":[{"issue_id":"wf-r1d.5","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.389697904-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.5","depends_on_id":"wf-r1d.6","type":"blocks","created_at":"2025-12-25T00:47:44.566472965-08:00","created_by":"daemon"}],"comments":[{"id":61,"issue_id":"wf-r1d.5","author":"rgardler","text":"Added minimal OpenCode plugin (.opencode/plugin/waif-ooda.ts) that logs events to .opencode/logs/events.jsonl (best-effort mkdir+append). Filters out file.watcher.updated events under .git to avoid git lockfile noise. Removed stdout logging per request. Build: npm run build. Files touched: .opencode/plugin/waif-ooda.ts, .opencode/package-lock.json. Open question: add more filters (e.g., node_modules) if desired.","created_at":"2025-12-28T03:14:38Z"},{"id":62,"issue_id":"wf-r1d.5","author":"rgardler","text":"Removed tmux dependency from waif ooda; CLI now reads OpenCode events from .opencode/logs/events.jsonl, maps agent start/stop events to Busy/Free rows, and renders table/JSON. Added tests covering OpenCode event mapping and JSONL parsing. Tests: npm test. Files: src/commands/ooda.ts, tests/ooda-mapping.test.ts, tests/ooda.test.ts.","created_at":"2025-12-28T03:25:19Z"},{"id":66,"issue_id":"wf-r1d.5","author":"rgardler","text":"Removed wf-r1d.6 as blocker of wf-r1d.5 per Producer request (map).","created_at":"2025-12-28T21:29:57Z"},{"id":67,"issue_id":"wf-r1d.5","author":"rgardler","text":"PR #73 merged: removed wf-r1d.6 as blocker of wf-r1d.5. Landing complete. (map)","created_at":"2025-12-28T22:12:50Z"}]}
{"id":"wf-r1d.5.1","title":"OpenCode plugin for waif ooda (remove TMUX dependency)","description":"Problem:\nwf-r1d requires waif ooda to consume OpenCode events. The current waif ooda depends on tmux for live monitoring; we need an OpenCode plugin so waif ooda can monitor OpenCode events without tmux. Initial scope: register a plugin with OpenCode, subscribe to events, and log raw event JSON to console. This work should block wf-r1d implementation work.\n\nUsers:\nPrimary users are waif end-users operating the OODA loop. Secondary stakeholders include the wf-r1d product/implementation owners and ops.\n\nSuccess criteria:\n- Plugin is available/registered when OpenCode is run.\\n- waif ooda can connect to OpenCode via the plugin with no tmux dependency.\\n- The plugin subscribes to events and writes raw OpenCode event JSON to stdout (console).\\n- At least one integration test exercising a real OpenCode runtime; unit/integration tests may use mocks for CI.\n\nConstraints:\n- Timeline: ASAP; marked priority 1.\\n- Environment: local Linux development only for v1.\\n- Compatibility: remove tmux-based workflows for ooda (migration agreed).\\n- Risk tolerance: moderate; prefer minimal surface area for v1 (console-only logging, raw format).\n\nExisting state:\n- Current OODA implementation uses tmux for TUI/monitoring. Key files: src/commands/ooda.ts (current ooda logic), src/lib/opencode.ts (OpenCode helper lib).\n\nDesired change:\n- Implement an OpenCode plugin (in-process with OpenCode runtime per OpenCode docs) that registers on OpenCode startup, subscribes to events, and streams raw event JSON to stdout. Remove tmux dependency from ooda workflows.\n\nLikely duplicates / related docs:\n- docs/dev/opencode_integration_PRD.md\\n- docs/dev/prd-ooda-loop.md\\n- docs/dev/ooda_implementation_plan.md (referenced)\\n- docs/dev/CLI_PRD.md\\n- docs/commands/ask.md\\n- src/commands/ooda.ts\\n- src/lib/opencode.ts\n\nRelated issues (Beads):\n- wf-r1d.1 .. wf-r1d.8 (see wf-r1d.* series); parent set to wf-r1d.5\n\nClarifying questions (answered):\n1) Plugin runtime: run within OpenCode (registered plugin).\\n2) Event format: log raw OpenCode event JSON for v1.\\n3) Registration method: follow OpenCode docs/recommendation for plugin registration.\\n4) Environments: local Linux only.\\n5) Logging: console stdout only for v1.\\n6) Backwards compatibility: tmux workflows will be removed.\\n7) Tests: mocks for CI; at least one integration test against a real OpenCode runtime.\n\nProposed next step:\n- UPDATE PRD at: docs/dev/opencode_integration_PRD.md\\n\nRecommended next command: /prd docs/dev/opencode_integration_PRD.md \u003cnew-issue-id\u003e\\n\\nLinked PRD: docs/dev/opencode_integration_PRD.md\n,","status":"closed","priority":1,"issue_type":"feature","assignee":"rgardler","created_at":"2025-12-27T16:30:07.359606968-08:00","updated_at":"2025-12-28T01:54:32.788662722-08:00","closed_at":"2025-12-28T01:54:32.788662722-08:00","close_reason":"Closed","external_ref":"PRD: docs/dev/opencode_integration_PRD.md","dependencies":[{"issue_id":"wf-r1d.5.1","depends_on_id":"wf-r1d.5","type":"parent-child","created_at":"2025-12-27T16:30:07.366515781-08:00","created_by":"daemon"}],"comments":[{"id":58,"issue_id":"wf-r1d.5.1","author":"rgardler","text":"Linked PRD: docs/dev/opencode_integration_PRD.md","created_at":"2025-12-28T00:35:23Z"},{"id":60,"issue_id":"wf-r1d.5.1","author":"rgardler","text":"Added minimal OpenCode plugin (.opencode/plugin/waif-ooda.ts) that logs events to .opencode/logs/events.jsonl (best-effort mkdir+append). Filters out file.watcher.updated events under .git to avoid git lockfile noise. Removed stdout logging per request. Build: npm run build. Files touched: .opencode/plugin/waif-ooda.ts, .opencode/package-lock.json. Open question: add more filters (e.g., node_modules) if desired.","created_at":"2025-12-28T03:03:30Z"},{"id":64,"issue_id":"wf-r1d.5.1","author":"rgardler","text":"Deduplicated repeated log lines in .opencode/plugin/waif-ooda.ts\n\nRationale:\n- The OpenCode plugin was emitting identical JSONL lines repeatedly which caused noisy logs and unnecessary rotation.\n\nChange made:\n- Added an in-memory deduplication helper (lastLoggedLine + maybeLog) that skips writing a line if it is byte-for-byte identical to the immediately preceding logged line.\n\nAcceptance criteria:\n- Consecutive identical event lines are not written multiple times; distinct lines are still logged.\n- Existing rotation and maxBytes behavior unchanged.\n\nFiles edited:\n- .opencode/plugin/waif-ooda.ts\n\nManual test notes:\n- Emit the same event multiple times and confirm events.jsonl contains only one instance for consecutive duplicates.\n\nRisks / follow-ups:\n- This is a process-local, in-memory dedupe; duplicates from multiple processes or restarts will still appear. Consider a cross-process suppression or a short time-based dedupe if needed.\n","created_at":"2025-12-28T09:21:09Z"},{"id":65,"issue_id":"wf-r1d.5.1","author":"rgardler","text":"Explained duplicate-log handling in waif OpenCode plugin: plugin keeps an in-memory lastLoggedLine and skips writing if incoming line is byte-for-byte identical to the most recently logged line (simple immediate dedupe). This only prevents consecutive duplicates from the same running plugin instance; it does not dedupe across process restarts or multiple plugin instances. Logging/rotation is handled by src/lib/opencode.ts (opencode.log). Files reviewed: src/lib/opencode.ts, .opencode/plugin/waif-ooda.ts, .opencode/logs/events.jsonl. No files were edited.","created_at":"2025-12-28T09:22:21Z"}]}
{"id":"wf-r1d.6","title":"Implementation Review (5-step): validate event ingester \u0026 tests","description":"Goal: Review the implementation for correctness, readability, and test coverage.\\n\\nAcceptance criteria:\\n- Code review comments addressed.\\n- Tests cover parsing, mapping, and integration flow.\\n\\nArtifacts: PR with implementation, test outputs, docs/dev/ooda_implementation_plan.md\\n\\nDeliverables: Review checklist completed, acceptance tests passing.\\n\\nReviewers: Code owners, wf-gn7 owners\\nBlocked-by: wf-r1d.5\\nNotes: Flag flaky tests and propose mitigation.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.448498266-08:00","updated_at":"2025-12-29T23:18:48.086531656-08:00","closed_at":"2025-12-29T23:18:48.086538656-08:00","dependencies":[{"issue_id":"wf-r1d.6","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.449083336-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.6","depends_on_id":"wf-r1d.7","type":"blocks","created_at":"2025-12-25T00:47:44.623606542-08:00","created_by":"daemon"}]}
{"id":"wf-r1d.7","title":"Sign-Off: OODA monitor implementation acceptance","description":"Goal: Official sign-off that the OODA monitor implementation meets acceptance criteria.\\n\\nAcceptance criteria:\\n- Product owner and wf-gn7 owners approve the implementation.\\n- Any remaining follow-ups are captured as beads issues.\\n\\nArtifacts: Implementation PR, review notes, test results\\n\\nDeliverables: Formal sign-off comment on the parent bead and list of follow-ups.\\n\\nReviewers: Product owner, wf-gn7 owners\\nBlocked-by: wf-r1d.6\\nNotes: Prepare rollout/enablement steps.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.51095007-08:00","updated_at":"2025-12-30T01:29:50.73398282-08:00","closed_at":"2025-12-30T01:29:50.733988231-08:00","dependencies":[{"issue_id":"wf-r1d.7","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.511531143-08:00","created_by":"daemon"},{"issue_id":"wf-r1d.7","depends_on_id":"wf-r1d.8","type":"blocks","created_at":"2025-12-25T00:47:44.682865768-08:00","created_by":"daemon"}]}
{"id":"wf-r1d.8","title":"Landing the Plan: merge and operationalize OODA monitor","description":"Goal: Merge changes, update ops docs, and enable the plugin.\\n\\nAcceptance criteria:\\n- Merge PR completed, deployment/runbooks updated, plugin owners coordinated.\\n- history/ documents present and any permissions noted.\\n\\nArtifacts: PR merged, docs/dev/release_management.md updated, history/ notes\\n\\nDeliverables: Merge, ops checklist completed, enablement confirmed.\\n\\nReviewers: Ops, product owner\\nBlocked-by: wf-r1d.7\\nNotes: Coordinate with wf-gn7 for plugin rollout.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T00:47:40.573886801-08:00","updated_at":"2025-12-30T01:29:58.851988386-08:00","closed_at":"2025-12-30T01:29:58.851995227-08:00","dependencies":[{"issue_id":"wf-r1d.8","depends_on_id":"wf-r1d","type":"parent-child","created_at":"2025-12-25T00:47:40.574691748-08:00","created_by":"daemon"}]}
{"id":"wf-r4r","title":"Docs: Add feature flags config and flag-audit docs","description":"Add an example config/flags.json, document the 'flag-audit' and 'check-release' behaviors, and link to docs/release_management.md.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T21:44:29.273427787-08:00","updated_at":"2025-12-19T22:11:35.390701161-08:00","dependencies":[{"issue_id":"wf-r4r","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.240101432-08:00","created_by":"daemon"}]}
{"id":"wf-rjh","title":"PRD: add formal worklog \u0026 workflow-state recording convention to workflow_stage_tracking_PRD","description":"Add a formal convention to docs/dev/workflow_stage_tracking_PRD.md describing how to record a concise per-bead worklog and the current workflow state for that bead. This is a docs-only change: produce clear format, examples, recommended fields, where to store in the bead (comment vs metadata), and how agents should use it.","acceptance_criteria":"1) docs/dev/workflow_stage_tracking_PRD.md updated to include a 'Per-bead worklog \u0026 state' section that defines:\n  - a concise line-oriented worklog format (timestamp, actor, short action, resulting state, optional link/reference)\n  - the canonical place to store the worklog (bead comment with a short prefix like 'WORKLOG:' or bead metadata field 'worklog' and 'workflow_state') and guidance when to use each\n  - examples of 3 realistic entries (e.g., claim/in_progress, handoff, close) and a full sample bead comment block\n  - recommended length/character limits and privacy guidance\n2) A short 'usage' checklist that agents follow when updating beads (update worklog entry, set workflow_state, add discovered-from/deps when applicable)\n3) Acceptance validated by a PR that edits docs/dev/workflow_stage_tracking_PRD.md, references this bd id in the PR description, and includes a one-paragraph rationale in the PR body. The PR must be created on a branch named with the bd id and short description (bd-\u003cid\u003e/add-worklog-prd).\n4) Update must be referenced in a bd comment on this issue listing files edited: docs/dev/workflow_stage_tracking_PRD.md","notes":"Handoff: created PR updating docs/dev/workflow_stage_tracking_PRD.md to add per-bead worklog \u0026 workflow_state convention. Files changed: docs/dev/workflow_stage_tracking_PRD.md, .opencode/command/intake.md. PR: https://github.com/SorraTheOrc/waif/pull/93","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T19:12:06.036951357-08:00","updated_at":"2026-01-02T17:18:01.155415686-08:00","closed_at":"2026-01-02T17:18:01.155415686-08:00","close_reason":"Closed"}
{"id":"wf-rjh.1","title":"docs(prd): align workflow_state examples with canonical stages from docs/Workflow.md (wf-rjh)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T23:15:07.477872189-08:00","updated_at":"2026-01-19T03:57:21.253820193-08:00","closed_at":"2026-01-19T03:57:21.253828462-08:00","labels":["state:done"],"dependencies":[{"issue_id":"wf-rjh.1","depends_on_id":"wf-rjh","type":"parent-child","created_at":"2025-12-31T23:15:07.501838829-08:00","created_by":"daemon"}]}
{"id":"wf-rkq","title":"Feature: waif show — display an issue with blockers and children","description":"Summary: Add CLI command 'waif show \u003cid\u003e' that prints a beads issue using the standard table output and includes its blockers and children in separate tables for quick triage.\\n\\nImplementation notes:\\n- New command: src/commands/show.ts\\n- Use src/lib/bd.ts to fetch issue with dependencies and src/lib/table.ts to render tables.\\n- Output: main issue table, then Blockers and Children tables (id, title, priority, status, assignee).\\n- Tests: add tests/show.test.ts covering display, error case (issue not found), and formatting.\\n\\nSuccess criteria:\\n1) 'waif show \u003cid\u003e' prints the issue and its blockers/children in table format.\\n2) Unit tests and README/help updated.\\n\\nSuggested owner: forge; timebox: 1-2 days.","notes":"Merged PR #62; feature landed and smoke-tested","status":"closed","priority":2,"issue_type":"feature","assignee":"rgardler","created_at":"2025-12-24T13:07:46.300344305-08:00","updated_at":"2025-12-24T16:38:53.48482585-08:00","closed_at":"2025-12-24T16:38:53.48483384-08:00"}
{"id":"wf-s5d","title":"Epic: Document Review","description":"Track documentation review and cleanup tasks across docs.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-19T22:11:27.11510783-08:00","updated_at":"2025-12-22T16:31:06.887751219-08:00","labels":["epic"]}
{"id":"wf-s6qp","title":"Status snapshot: project state 2026-01-14","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-14T18:57:58.825499421-08:00","created_by":"WAIF","updated_at":"2026-01-14T18:57:58.825499421-08:00"}
{"id":"wf-sbg","title":"Config-driven tmux workflow agents","description":"## Overview\n\n[Describe the high-level goal and scope of this epic]\n\n## Success Criteria\n\n- [ ] Criteria 1\n- [ ] Criteria 2\n- [ ] Criteria 3\n\n## Background\n\n[Provide context and motivation]\n\n## Scope\n\n**In Scope:**\n- Item 1\n- Item 2\n\n**Out of Scope:**\n- Item 1\n- Item 2\n","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-20T21:28:17.573994634-08:00","updated_at":"2025-12-20T22:35:02.47853008-08:00","closed_at":"2025-12-20T22:35:02.47853008-08:00","labels":["epic"]}
{"id":"wf-soh","title":"Integrate marked-terminal markdown rendering for all CLI output","description":"## Feature Request\n\nUpdate the waid/waif CLI so that **all user-facing console output is authored as Markdown** and is rendered to styled terminal output using `marked-terminal`.\n\nThis should apply to every command in `src/commands/*` and any shared output helpers in `src/lib/*`.\n\n## Motivation\n\n- Improve legibility of CLI output (headings, lists, code blocks, links).\n- Standardize output formatting across commands by using a single rendering pipeline.\n- Enable richer UX without hand-crafted table/string formatting in each command.\n\n## Use Cases\n\n1. **User runs any command**: Output includes headings, lists, and inline code with consistent styling.\n2. **Errors and warnings**: Output is still Markdown, rendered with emphasis and code blocks where appropriate.\n3. **Machine-readable mode** (if applicable): JSON output remains raw JSON (not Markdown-rendered) and should bypass rendering.\n\n## Proposed Solution\n\n- Add `marked` + `marked-terminal` dependency.\n- Implement a single output helper (e.g. `src/lib/consoleMarkdown.ts`) that takes Markdown and prints rendered output.\n- Refactor commands to produce Markdown strings instead of direct `console.log`/table output.\n- Maintain a clear bypass for JSON mode (where the CLI already supports it).\n\n## Alternatives Considered\n\n- Keep current ad-hoc formatting: continues inconsistent UX and repeated formatting logic.\n- Use `chalk`-only styling: less expressive than Markdown and harder to maintain.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-19T15:36:29.728802415-08:00","updated_at":"2025-12-19T15:36:55.569965075-08:00","labels":["cli","markdown","ux"]}
{"id":"wf-ss7","title":"Integrate OpenCode logs with waif OODA subscription","description":"Make the OpenCode plugin publish log events to a subscription API so the 'waif ooda' command can receive real-time events when running. Coordinate plugin changes, CLI subscription lifecycle, tests, and documentation.","acceptance_criteria":"1) The OpenCode plugin (.opencode/plugin/waif-ooda.ts) exposes a well-documented emission hook or publishes events to a lightweight local event bus.\n2) The 'waif ooda' CLI subscribes on start and unsubscribes on stop, receiving events emitted by the plugin in real time.\n3) Tests validate end-to-end behavior (plugin emits -\u003e CLI receives) in a reproducible environment.\n4) Design and implementation plan saved in history/ with clear handoff to implementer.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-29T22:45:10.147030059-08:00","updated_at":"2025-12-30T01:22:13.169181722-08:00","closed_at":"2025-12-30T01:22:13.169181722-08:00","close_reason":"won't fix","comments":[{"id":73,"issue_id":"wf-ss7","author":"rgardler","text":"Created sub-issues: wf-ss7.1 (plugin subscribe API), wf-ss7.2 (CLI subscribe/unsubscribe), wf-ss7.3 (tests), wf-ss7.5 (docs). Reason: implement real-time event forwarding from plugin to 'waif ooda' command.","created_at":"2025-12-30T06:45:23Z"}]}
{"id":"wf-ss7.1","title":"Add event emission hook to .opencode/plugin/waif-ooda.ts","description":"Modify the plugin to publish each canonical event object to an in-process subscription API when a listener is attached. Keep file-writing behavior; emission is additive. Provide an exported subscribe/unsubscribe API and document usage.","acceptance_criteria":"1) Plugin exports subscribe(handler) and unsubscribe(handler) functions.\n2) When a handler is registered, each time maybeLog writes a new line the plugin also invokes handlers with the parsed event object.\n3) No breaking changes to existing OpenCode plugin behavior; file logging remains.\n4) Tests verify handler receives events and can be removed.","notes":"PR branch: feature/wf-ss7.1-subscribe-hook (commit d2c9047). Exports subscribe/unsubscribe from .opencode/plugin/waif-ooda.ts and notifies subscribers when events are logged. Tests run locally: npm test (all passing).","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-29T22:45:12.04781513-08:00","updated_at":"2025-12-30T01:22:13.18677593-08:00","closed_at":"2025-12-30T01:22:13.18677593-08:00","close_reason":"won't fix","external_ref":"branch:feature/wf-ss7.1-subscribe-hook","dependencies":[{"issue_id":"wf-ss7.1","depends_on_id":"wf-ss7","type":"parent-child","created_at":"2025-12-29T22:45:12.055615252-08:00","created_by":"daemon"}]}
{"id":"wf-ss7.1.1","title":"Implement plugin subscribe/unsubscribe API","description":"Add exported subscribe(handler) and unsubscribe(handler) functions to .opencode/plugin/waif-ooda.ts. Ensure maybeLog invokes registered handlers with parsed canonical object whenever a line is written. Keep existing file-log behavior unchanged. Include minimal in-file documentation and exported types.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T23:50:14.144295307-08:00","updated_at":"2025-12-30T01:29:13.973003532-08:00","closed_at":"2025-12-30T01:29:13.973012416-08:00","dependencies":[{"issue_id":"wf-ss7.1.1","depends_on_id":"wf-ss7.1","type":"parent-child","created_at":"2025-12-29T23:50:14.147191654-08:00","created_by":"daemon"}]}
{"id":"wf-ss7.2","title":"Make 'waif ooda' command subscribe/unsubscribe to plugin events","description":"Update the CLI command so that on start it registers a handler with the plugin subscribe API and on stop it unregisters. Events received should be forwarded into the command's output stream in real time.","acceptance_criteria":"1) 'waif ooda' registers a handler at start and unregisters on stop.\n2) Handler receives canonical event objects and the command emits them in the same format as existing file logs.\n3) Tests simulate plugin emission and verify CLI receives events while running and not after stopping.","notes":"Branch: feature/wf-ss7/wf-ss7.2-ooda-subscribe. Implemented CLI subscription to plugin events on start; unsubscribes on stop. Added test ooda-cli-subscribe.test.ts. Ran tests: npm test (all passing).","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-29T22:45:14.731957126-08:00","updated_at":"2025-12-30T01:22:13.196312218-08:00","closed_at":"2025-12-30T01:22:13.196312218-08:00","close_reason":"won't fix","external_ref":"branch:feature/wf-ss7/wf-ss7.2-ooda-subscribe","dependencies":[{"issue_id":"wf-ss7.2","depends_on_id":"wf-ss7","type":"parent-child","created_at":"2025-12-29T22:45:14.743944663-08:00","created_by":"daemon"}]}
{"id":"wf-ss7.3","title":"Add unit/integration tests for plugin-\u003eCLI subscription","description":"Create tests that verify: subscription receives events, duplicate subscriptions don't cause multiple deliveries, unsubscribe stops delivery, and file logging still occurs.","acceptance_criteria":"1) Tests included under tests/ validating plugin subscription API.\n2) CI-friendly: tests do not depend on live OpenCode service; they call plugin functions directly.\n3) Tests pass locally.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:45:16.394676358-08:00","updated_at":"2025-12-30T01:22:13.206274131-08:00","closed_at":"2025-12-30T01:22:13.206274131-08:00","close_reason":"won't fix","dependencies":[{"issue_id":"wf-ss7.3","depends_on_id":"wf-ss7","type":"parent-child","created_at":"2025-12-29T22:45:16.404109847-08:00","created_by":"daemon"}]}
{"id":"wf-ss7.5","title":"Document subscription API and CLI behavior","description":"Add short design note to history/ explaining the subscription API, lifecycle of CLI subscriptions, and example usage for implementers.","acceptance_criteria":"1) history/waif-ooda-subscription.md created with design and usage examples.\n2) Links to implementation issues included in the epic.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:45:20.00718229-08:00","updated_at":"2025-12-30T01:22:13.216328475-08:00","closed_at":"2025-12-30T01:22:13.216328475-08:00","close_reason":"won't fix","dependencies":[{"issue_id":"wf-ss7.5","depends_on_id":"wf-ss7","type":"parent-child","created_at":"2025-12-29T22:45:20.014688718-08:00","created_by":"daemon"}]}
{"id":"wf-t31","title":"Add template usage guidance to bd onboard output","description":"## Feature Request\n\nUpdate the `bd onboard` command output to include guidance on when and how AI agents should use templates when creating issues.\n\n## Motivation\n\nCurrently, `bd onboard` provides comprehensive instructions for AI agents but doesn't mention the template system. This leads to AI agents creating minimal issues without the structured documentation that templates provide. Adding template guidance would:\n\n1. Improve issue quality by encouraging use of structured templates\n2. Ensure bugs include reproduction steps and environment details\n3. Ensure features capture design decisions and alternatives considered\n4. Maintain consistency across issues created by different AI agents\n\n## Use Cases\n\n1. **AI Agent Onboarding**: When a new AI agent runs `bd onboard`, it learns to use templates for bugs, features, and epics automatically\n2. **Existing Projects**: Teams can regenerate AGENTS.md with updated best practices by re-running `bd onboard`\n3. **Documentation Consistency**: All projects using beads get consistent, high-quality issue documentation\n\n## Proposed Solution\n\nModify the `bd onboard` command output in two places:\n\n1. **AGENTS.md content**: Update the \"Create new issues\" section to show template usage:\n   ```bash\n   # For bugs and features, use templates for structured documentation\n   bd create \"Bug title\" --from-template bug -p 1 --json\n   bd create \"Feature title\" --from-template feature -p 2 --json\n   ```\n\n2. **Add Templates section** after \"MCP Server\" section with:\n   - List of available templates (bug, feature, epic)\n   - When to use each template\n   - When to skip templates (tasks/chores)\n   - Template viewing commands\n\n3. **Update Important Rules** to include: \"Use templates (`--from-template`) for bugs, features, and epics\"\n\n## Alternatives Considered\n\n- **Alternative 1**: Add template suggestions to `bd create` command itself (e.g., prompt \"Use --from-template?\")\n  - Why not chosen: Too intrusive for human users who may prefer quick issue creation\n  \n- **Alternative 2**: Create separate `bd onboard --with-templates` flag\n  - Why not chosen: Splits the onboarding experience; templates should be default best practice","notes":"Reference implementation: This project's AGENTS.md and .github/copilot-instructions.md files contain the exact changes needed.\n\nUpstream repo: https://github.com/steveyegge/beads\n\nNext steps:\n1. Fork the beads repository\n2. Locate the onboard command source (likely cmd/onboard.go)\n3. Apply the template guidance additions shown in this project\n4. Test with 'bd onboard' in a fresh directory\n5. Submit PR with clear rationale (improves AI agent issue quality)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-16T11:24:48.087806737-08:00","updated_at":"2025-12-30T02:24:11.37922724-08:00","closed_at":"2025-12-30T02:24:11.37922724-08:00","close_reason":"Closed","labels":["documentation","feature"],"dependencies":[{"issue_id":"wf-t31","depends_on_id":"wf-ba2","type":"blocks","created_at":"2025-12-19T00:18:26.92361752-08:00","created_by":"daemon"}]}
{"id":"wf-tdd","title":"wf-mtc.3.6: CI - include run-job tests and budget review","description":"Ensure run-job unit and E2E tests are included in CI matrix, keep runtime budget acceptable, and add caching where possible. Acceptance criteria: CI workflow updated if needed and test run time within accepted threshold.","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-11T23:25:40.119033953-08:00","created_by":"WAIF","updated_at":"2026-01-19T04:08:12.970700909-08:00","closed_at":"2026-01-19T04:08:12.970709813-08:00"}
{"id":"wf-tgk","title":"Docs: update tooling integrations install-from-source","description":"Update docs/dev/integrations.md to (1) state WAIF uses bv graph analysis for prioritizing/managing work items and (2) ensure bd/bv/opencode install+upgrade steps are from-source builds.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T15:07:24.668871746-08:00","updated_at":"2025-12-20T15:07:36.063782003-08:00","closed_at":"2025-12-20T15:07:36.063782003-08:00","dependencies":[{"issue_id":"wf-tgk","depends_on_id":"wf-s5d","type":"discovered-from","created_at":"2025-12-20T15:07:24.682659268-08:00","created_by":"daemon"}]}
{"id":"wf-u5m","title":"Remove or gate lint references in workflow docs until lint exists","description":"Problem\\n- Docs and templates reference npm run lint, but the repo does not currently define a lint script. This leads to confusion and false checklists during handoffs/PR reviews.\\n\\nGoal\\n- Update docs/templates to either remove lint references or clearly mark lint as optional/placeholder until the repository adopts a linter.\\n\\nDeliverables\\n- Update docs/dev/git_workflow.md and PR template sections that mention lint\\n- Ensure handoff template and branch protection guidance do not imply a missing command\\n- Capture the chosen wording in a bd comment and link to any follow-up lint implementation issue\\n\\nNotes\\n- This should only proceed after wf-z3v decides to remove/gate lint rather than implementing lint.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T23:26:37.39040986-08:00","updated_at":"2025-12-22T23:27:16.506331418-08:00","dependencies":[{"issue_id":"wf-u5m","depends_on_id":"wf-z3v","type":"discovered-from","created_at":"2025-12-22T23:27:33.136908107-08:00","created_by":"daemon"}]}
{"id":"wf-u75","title":"P0: waif next --assignee \u003cname\u003e","description":"Implement a real assignee filter for `waif next`. Currently `waif next` accepts a positional search string (docs/dev/prd/prd-command-next.md) and treats input like `assignee:patch` as plain text fuzzy-matched against title/description (so it does not actually filter by assignee). Add an explicit option `--assignee \u003cname\u003e` (or `-a`) to restrict eligible candidates to issues where issue.assignee matches the provided name.\\n\\nContext:\\n- Existing PRD: docs/dev/prd/prd-command-next.md (search-prioritized selection intake)\\n- Implementation: src/commands/next.ts loads issues via bd ready --json (or issues jsonl) and ranks them; Issue type already includes assignee?: string\\n- Table rendering already supports an Assignee column (src/lib/table.ts)\\n- Test fixtures include assignee fields (tests/next.test.ts) but no CLI filter exists\\n","acceptance_criteria":"1) `waif next --assignee \u003cname\u003e` returns the top-ranked eligible issue among ONLY those with assignee equal to \u003cname\u003e (string compare after trim; case-sensitive unless decided otherwise). 2) When no issues match, exit code 1 with a clear error message (and in --json mode, emit a JSON error object consistent with other commands). 3) `waif next` behavior is unchanged when --assignee is not set, including existing positional search-string behavior. 4) `waif next --assignee \u003cname\u003e \u003csearch\u003e` (if both are provided) applies assignee filtering first, then applies the existing search-prioritized reranking within the filtered set (keeping determinism and current tie-break). 5) Update PRD docs/dev/prd/prd-command-next.md to document the new flag and clarify that positional search is not a structured filter. 6) Add/extend tests in tests/next.test.ts covering: assignee filtering selects correct issue; no-match errors; assignee+search interaction; and determinism. 7) README/help output updated to mention --assignee.","status":"closed","priority":0,"issue_type":"feature","assignee":"patch","created_at":"2026-01-12T02:23:51.785624331-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:20:43.835237999-08:00","closed_at":"2026-01-14T01:20:43.835237999-08:00","close_reason":"Merged: feature implemented and tests/docs updated"}
{"id":"wf-u75.1","title":"Implement: waif next --assignee (implementation)","description":"Implementation steps:\n- Add CLI option --assignee (alias -a) to src/commands/next.ts and parse value with existing option parser.\n- When loading candidates (bd ready --json), filter the list to only issues where issue.assignee is equal to the provided name after trimming whitespace.\n- Ensure filtering is applied before the existing search-prioritized ranking so that search terms only rerank within the filtered set.\n- When no issues match the assignee filter, exit with code 1 and print a clear error; in --json mode emit a JSON error object matching other commands.\n- Keep existing behavior unchanged when --assignee is not provided.\n- Update unit tests referenced in wf-u75.2 and add integration test fixture if needed.\nFiles to modify (suggested): src/commands/next.ts, src/lib/table.ts (if column changes needed), tests/next.test.ts.\nAcceptance criteria: see parent wf-u75. Copy parent acceptance criteria into implementation as checklist.","status":"closed","priority":0,"issue_type":"task","assignee":"patch","created_at":"2026-01-14T01:02:58.129077686-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:20:43.570451347-08:00","closed_at":"2026-01-14T01:20:43.570451347-08:00","close_reason":"Merged: implemented --assignee and tests","dependencies":[{"issue_id":"wf-u75.1","depends_on_id":"wf-u75","type":"parent-child","created_at":"2026-01-14T01:02:58.132778245-08:00","created_by":"WAIF"}]}
{"id":"wf-u75.2","title":"Tests: waif next --assignee","description":"Tests to add/update:\n- tests/next.test.ts: add cases verifying:\n  1) waif next --assignee NAME returns the top-ranked eligible issue among only those with assignee === NAME.\n  2) waif next --assignee NAME when no issues match exits with code 1 and prints a clear error; in --json mode the CLI emits a JSON error object.\n  3) waif next --assignee NAME SEARCH applies assignee filtering first, then applies existing search/prioritization within the filtered set.\n  4) Determinism: repeated runs with the same seed produce identical selection/tie-breaking.\n- Update fixtures to include multiple issues with different assignee values.\n- Run tests locally: npm ci \u0026\u0026 npm test -- tests/next.test.ts\n- Add small E2E or snapshot test if project conventions expect it.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-14T01:02:58.178952946-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:20:43.627993687-08:00","closed_at":"2026-01-14T01:20:43.627993687-08:00","close_reason":"Merged: tests added and passing","dependencies":[{"issue_id":"wf-u75.2","depends_on_id":"wf-u75","type":"parent-child","created_at":"2026-01-14T01:02:58.179523454-08:00","created_by":"WAIF"}]}
{"id":"wf-u75.3","title":"Docs: update PRD and help for waif next --assignee","description":"Docs work:\n- Update docs/dev/prd/prd-command-next.md to document the new --assignee / -a option, behavior, examples, and interaction with positional search.\n- Include examples: filtering by assignee, no-match behavior, and combined assignee+search usage.\n- Add a short migration note in history/ if desired, explaining that positional search is not a structured filter.\n- Link docs to CLI help and tests in wf-u75.2.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T01:02:58.227023045-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:20:43.683670823-08:00","closed_at":"2026-01-14T01:20:43.683670823-08:00","close_reason":"Merged: docs updated (PRD + README)","dependencies":[{"issue_id":"wf-u75.3","depends_on_id":"wf-u75","type":"parent-child","created_at":"2026-01-14T01:02:58.227633926-08:00","created_by":"WAIF"}]}
{"id":"wf-u75.4","title":"CLI: update help/README to document --assignee","description":"CLI/help updates:\n- Update the command help text in src/commands/next.ts (or the CLI help generator) to list --assignee, alias -a, and an example usage line.\n- Update README or docs/usage.md where waif next examples live to include the new flag and an example workflow.\n- Ensure --help and man/help output show the new option and that --json behavior is documented.\n- Run the CLI help locally to validate: node ./dist/index.js next --help (or use the project preferred invocation).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-14T01:02:58.277498893-08:00","created_by":"WAIF","updated_at":"2026-01-14T01:20:43.78109471-08:00","closed_at":"2026-01-14T01:20:43.78109471-08:00","close_reason":"Merged: CLI help and README updated","dependencies":[{"issue_id":"wf-u75.4","depends_on_id":"wf-u75","type":"parent-child","created_at":"2026-01-14T01:02:58.278112072-08:00","created_by":"WAIF"}]}
{"id":"wf-uba","title":"Task: tests for runJobCommand and run-job CLI","description":"Add unit tests mocking child_process.spawn for runJobCommand and an E2E test invoking 'waif ooda run-job' programmatically and asserting snapshot JSONL output.","acceptance_criteria":"1) Unit tests for runJobCommand cover success, failure, timeout. 2) E2E test programmatically calls run-job and asserts a JSONL snapshot is written and sanitized. 3) Tests run deterministically in CI.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T20:38:05.068486703-08:00","created_by":"WAIF","updated_at":"2026-01-11T23:13:31.164051926-08:00","closed_at":"2026-01-11T23:13:31.164051926-08:00","close_reason":"Merged (PR #103) — tests added \u0026 passing","dependencies":[{"issue_id":"wf-uba","depends_on_id":"wf-bkt","type":"discovered-from","created_at":"2026-01-08T20:38:05.069771063-08:00","created_by":"WAIF"}],"comments":[{"id":88,"issue_id":"wf-uba","author":"rgardler","text":"Unit tests added for runJobCommand and snapshotWriter. Tests passed locally (focused + full vitest). Commit d865192. Branch: wf-e6r.2.1.1/job-command-work.","created_at":"2026-01-09T04:58:14Z"},{"id":110,"issue_id":"wf-uba","author":"rgardler","text":"Claiming wf-uba to finalize unit and E2E tests for runJobCommand and run-job CLI. Current status: runJobCommand exported, writeJobSnapshot implemented, test files added (ooda-run-job.test.ts, ooda-hello-5s.test.ts, ooda-echo.test.ts). Next: review tests for coverage gaps (timeout case, large output truncation), add mocks for child_process where needed, and ensure CI deterministic behavior.","created_at":"2026-01-12T06:19:22Z"},{"id":114,"issue_id":"wf-uba","author":"rgardler","text":"Tests for runJobCommand and run-job CLI added and merged in PR #103. Files added: tests/helpers/sleep.js, tests/helpers/exit.js, tests/helpers/emit-large.js, tests/runJobCommand.timeout.test.ts, tests/runJobCommand.exit.test.ts, tests/runJobCommand.largeOutput.test.ts. Merge commit: 308cfc919f521a855e68fac57ed5f5c7af044a6b. Local branch deleted. Tests passed locally and in CI.","created_at":"2026-01-12T07:13:28Z"}]}
{"id":"wf-uctv","title":"Enhance 'wf next' to prioritize in-progress epic children and blockers","description":"Title: Enhance `wf next` to prioritize in-progress epic children and blockers\n\nProblem\n\n- When the current in-progress issue is an Epic, `wf next` currently recommends work using global scoring only. Producers want the command to surface the next most important work specifically for that Epic (child or blocking item) and to make the Epic context explicit in the recommendation.\n\nUsers\n\n- Primary: Producer / PM who uses `wf next` to decide what to direct agents or humans to work on next.\n- Secondary: Engineers/agents who pick the recommended bead to start work.\n\nSuccess criteria\n\n1. When the top-ranked issue (by existing selection logic) is an Epic and its status is in_progress, `wf next` should instead recommend the most important child or blocking issue for that Epic.\n2. \"Most important\" selection rule (v1): prefer any child that is already in_progress (recommend finishing it). If none are in_progress, pick the child or blocking issue with the highest bv priority score (fallback to numeric priority then recency if bv is unavailable).\n3. Output must clearly indicate: the parent Epic is in_progress, the recommended issue is selected as the next-most-important for that Epic, and whether the recommended issue is a child or a blocker. If a child/blocker is already in_progress, highlight that and state that completing it is the highest priority.\n4. `wf next [search]` and optional `--assignee \u003cname\u003e` behavior: `--assignee` should filter candidates by assignee before applying the Epic-focused selection; if no assignee provided, select across all assignees.\n5. Tests: add unit tests for the selection logic and an integration test that exercises bd show/list and verifies CLI output.  (User requested acceptance criteria: unit tests + idempotence)\n6. Idempotence: running the command repeatedly must not mutate bead state; any proposed annotations or comments must be idempotent (no duplicate comments on repeat runs). The default behavior is proposal-only (do not auto-update bd assignee or status).\n\nConstraints\n\n- Read-only by default: the command must not change bead status or assignee unless an explicit follow-up flag/action is added in a later change.\n- Deterministic tie-breakers: where scores tie, break deterministically by numeric priority then created_at then id.\n- Use existing signals where available: bv priority scores when available, fallback to local heuristics when not.\n- Keep CLI latency reasonable: scope search to Epic's children and direct blockers rather than entire issue set when Epic context applies.\n\nExisting state\n\n- Current implementation: src/commands/next.ts (implements ranking, fuzzy search, bv integration, --assignee filter, and JSON/human output)\n- Current PRD: docs/dev/prd-command-next.md (covers search-prioritized selection and general next behavior)\n- Tests area: tests/ (tests/next.test.ts exists as a starting point)\n- Beads issues referencing next, PRD, and PM skills (examples: wf-70j.*, wf-5e2, wf-c2n)\n\nDesired change\n\n- Update the existing PRD at docs/dev/prd-command-next.md to include a new section describing Epic-aware selection when the currently in-progress item is an Epic.\n- Implement the selection changes in src/commands/next.ts:\n  - Detect when the top candidate is an Epic with status `in_progress`.\n  - Gather that Epic's child issues and any immediate blocking issues.\n  - Apply selection rules: prefer in_progress children, else bv score (fallback to priority/recency).\n  - Maintain `--assignee` optional filter behavior: apply assignee filter before Epic-focused selection.\n  - Update human output: clearly show Epic context and why the child/blocker was chosen.\n- Add unit tests for the new selection logic and an integration test exercising bd outputs and CLI human output.\n- Ensure idempotence and proposal-only behavior (no automatic bd state mutation).\n\nLikely duplicates / related docs\n\n- docs/dev/prd-command-next.md — existing PRD to UPDATE\n- docs/Workflow.md — guidance on how Producers use `next` in practice\n- src/commands/next.ts — implementation to change\n- tests/next.test.ts — place to add tests\n\nRelated Beads issues\n\n- wf-70j.5 — PM skill: assignment proposal heuristics + propose-only confirmation\n- wf-70j.4 — PM skill: generate bead hierarchy (plan) with PRD traceability\n- wf-70j.2 — PM skill: scripted interview + intake normalization (reuse /intake)\n- wf-5e2 — PM: decompose PRD into bead plan (plan command)\n- wf-c2n — source issue referenced by existing PRD\n\nRecommended next step\n\n- UPDATE PRD at: docs/dev/prd-command-next.md (I will propose an updated PRD section to capture Epic-aware selection).\n\nAreas that could use further expansion\n\n- Exact formatting of the human output (example snippet) — I can draft a suggested output layout (one-row table + Details + an explicit \"Epic context: \u003cepic-id\u003e (in_progress) — recommended child: \u003cid\u003e (\u003creason\u003e)\").\n- Whether a non-default mode should allow automatic assignment/claiming of the recommended child (out of scope for v1; requires explicit opt-in).\n\nOpen questions (answered)\n\n1. Fallback rule: bv → numeric priority → recency → id (confirmed: user accepted)\n2. Children vs blockers: treat equal (confirmed: user accepted)\n3. JSON metadata: include Epic context and selection reason in `--json` output (recommended), unless you prefer to keep v1 JSON unchanged. Please call out if you prefer unchanged JSON for v1.\n\n--\n\nDrafted by: Build (PM AI)\nDerived keywords: next, epic, child, blocker, in_progress\n\nPlease review the draft. Reply with:\n- \"approve\" to proceed to the five mini-review iterations and then I'll prepare the PRD update and implementation plan; or\n- \"edit:\" plus specific edits you'd like; or\n- answers to the Open questions above.\n","status":"closed","priority":1,"issue_type":"feature","assignee":"Build","created_at":"2026-01-17T12:23:56.020165803-08:00","created_by":"WAIF","updated_at":"2026-01-18T00:47:15.145186952-08:00","closed_at":"2026-01-18T00:47:15.145186952-08:00","close_reason":"Closed","labels":["Status: Intake Completed"]}
{"id":"wf-udv","title":"waif ask: Intake brief","description":"Problem\n\nSometimes we just want a quick, one-shot answer from an agent without starting an interactive CLI/TUI session. We need a `waif ask` command that accepts a prompt, sends it to an agent (default `Map`/`PM`), allows optionally prefixing the prompt with an agent name (e.g. `ask patch ...`), and returns the agent's response to the console in Markdown (or `--json`) with no session tracking (one-shot MVP).\n\nUsers\n\nPrimary: producers who need fast, ad-hoc answers in the terminal (PMs/engineers writing prompts).\nSecondary: CLI users and automation that may call `waif ask` from scripts; QA and docs teams who rely on predictable one-shot outputs.\n\nSuccess criteria\n\nMVP success is that a user can run `waif ask \"\u003cprompt\u003e\"` and receive a coherent agent response rendered as Markdown to the console (or machine-readable JSON when `--json` is passed). The UX/implementation goal: ask -\u003e get response (no session), responses are stable Markdown and usable in pipelines.\n\nConstraints\n\nNo timeline or special constraints were specified. No session tracking or state persistence in MVP. Default agent is `Map` (PM); agent override via prefixing the prompt is required. No privacy/security constraints specified by requester.\n\nExisting state\n\n- The CLI contains a PRD/CLI design effort (`docs/dev/CLI_PRD.md`) and PRD-agent wiring work (`wf-ba2.3.6`, `wf-ba2.3.1`) that overlap with PRD generation and OpenCode integration. There is not a dedicated `waif ask` command implemented today.\n\nDesired change\n\nAdd a new `waif ask` CLI command that:\n- Accepts a prompt string or reads from stdin\n- Sends the prompt to a chosen agent (default `Map`/`PM`), allowing an agent name prefix to override\n- Returns the agent's response to stdout rendered as Markdown, or `--json` for machine output\n- Is one-shot only (no session persistence)\n\nLikely duplicates / related docs\n\n- `docs/dev/CLI_PRD.md`\n- `docs/Workflow.md` (intake/PRD workflow)\n- `docs/dev/TUI_PRD.md`\n- `docs/dev/implemented/find_next_PRD.md`\n\nRelated issues\n\n- `wf-ba2.3.1` - Minimal PRD generator (writes Markdown file)\n- `wf-ba2.3.6` - Wire waif prd command to PRD Agent workflow\n- `wf-ba2.3` - PRD Template \u0026 Validation (epic)\n- `wf-7m7` - Add waif command to validate implementation plan integrity (related CLI expansion)\n- `wf-soh` - Integrate marked-terminal markdown rendering for all CLI output (rendering pipeline)\n\nClarifying questions\n\n1. Confirm default agent: should `Map` (PM) be the default for `waif ask`?  \n2. Which output modes are required beyond `--json` and rendered Markdown (e.g., raw text, exit codes for partial failures)?  \n3. Should `waif ask` support reading prompts from stdin or files for scripting?  \n4. Is any prompt auditing/logging required (even minimal), or must MVP avoid writing prompts anywhere?  \n5. Are there agent name parsing rules (single token prefix vs multiple-word agent names)?\n\nProposed next step\n\nNEW PRD at: `docs/dev/waif_ask_PRD.md`\nRecommended next command: `/prd docs/dev/waif_ask_PRD.md \u003cissue-id\u003e`","notes":"OpenCode wiring added; enable with OPENCODE_ENABLED=1 and install OpenCode SDK. PR: https://github.com/SorraTheOrc/waif/pull/19","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T00:51:55.603388916-08:00","updated_at":"2025-12-21T02:28:02.410489552-08:00","closed_at":"2025-12-21T02:28:02.410489552-08:00"}
{"id":"wf-ug7","title":"Update the ask command to open opencode TUI rather than handle the exchange directly: Intake brief","description":"Problem: Current ask sends prompt to headless opencode server and hides interaction; prefer opening the agent's tmux pane with opencode TUI and injecting the prompt so the user can interact.\nUsers: Primary: human producer using ask; Secondary: agent pane context/observers in tmux.\nSuccess criteria: Running \"ask \u003cprompt\u003e\" (e.g., \"ask patch to implement bead bd-1\") opens opencode TUI in the target agent pane, injects the prompt, executes it there, while leaving focus in the originating pane.\nConstraints: No deadline; no need for backward compatibility; focus remains in invoking pane; target pane is the agent pane from start-workflow-tmux; add logging of date/time, target agent, and prompt in an AI-readable format.\nExisting state: ask calls headless opencode server and parses results for quick exchange.\nDesired change: Send command to the target agent tmux pane to launch opencode TUI with the prompt injected; keep invoking pane focus; log timestamp, agent, prompt for later AI analysis.\nLikely duplicates / related docs: docs/dev/CLI_PRD.md; docs/dev/TUI_PRD.md; docs/Workflow.md; scripts/start-workflow-tmux.sh.\nRelated issues: wf-lp0 waif ask: Intake brief; wf-ba2.3.6 Wire waif prd command to PRD Agent workflow; wf-bxn Docs: Resolve TBDs in docs/dev/TUI_PRD.md.\nClarifying questions: 1) Where to store the ask logs (file path/rotation)? 2) What fallback behavior if the target agent pane is missing? 3) Should ask detect/select agent pane by name, window, or config mapping? 4) Should ask surface errors inline or silently return after sending to tmux?\nProposed next step: UPDATE PRD at: docs/dev/CLI_PRD.md. Recommended next command: /prd docs/dev/CLI_PRD.md \u003cissue-id\u003e","notes":"PR opened: https://github.com/SorraTheOrc/waif/pull/38","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T11:03:06.001021001-08:00","updated_at":"2025-12-22T16:27:17.353277271-08:00","closed_at":"2025-12-22T14:27:17.119113803-08:00","comments":[{"id":15,"issue_id":"wf-ug7","author":"rgardler","text":"Linked PRD: docs/dev/CLI_PRD.md","created_at":"2025-12-24T00:43:53Z"}]}
{"id":"wf-ult","title":"plugin: ignore session.diff events","description":"Do not log or persist OpenCode events with type 'session.diff' to reduce noise.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-27T21:50:42.649613888-08:00","updated_at":"2025-12-28T14:25:04.977493359-08:00","closed_at":"2025-12-28T14:25:04.977493359-08:00","close_reason":"Closed"}
{"id":"wf-urb","title":"Config-driven tmux workflow agents","description":"## Overview\n\nMake `start-workflow-tmux.sh` config-driven so agent panes (pm/design/build/docs/review/user) and their idle scheduler settings can be customized without editing the script.\n\n## Problem\n\nCurrently `start-workflow-tmux.sh` hard-codes:\n- The list of agent panes and their order\n- The PM idle_task override (inline in bash)\n- Environment overrides like BD_ACTOR\n\nTweaking agents or idle behavior requires editing the script, which is error-prone and makes upgrades harder.\n\n## Users\n\n- Developers running the multi-agent tmux workflow\n- Teams wanting custom agent configurations (e.g., different worktrees, extra agents)\n\n## Solution\n\nCreate a declarative YAML config (`config/workflow_agents.yaml`) that defines each agent pane with optional settings. Update the script to parse this config (via Python helper) and spawn panes accordingly.\n\n## Scope\n\n**In Scope:**\n- YAML config schema: agent name, worktree, env overrides, idle settings\n- Python parser helper (`scripts/parse-workflow-config.py`)\n- Update `start-workflow-tmux.sh` to use the parser\n- Fallback to current defaults when config is missing\n- Error loudly on malformed YAML\n- Documentation updates\n\n**Out of Scope:**\n- Sequential idle commands (future)\n- Changing pane layout or adding GUIs\n- New background daemons beyond idle scheduler\n\n## Constraints\n\n- Must preserve existing default behavior when config is absent\n- Python 3.x with PyYAML (standard on most systems)\n- Support `WORKFLOW_AGENTS_CONFIG` env var for alternate config path","notes":"PR opened: https://github.com/SorraTheOrc/waif/pull/16","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-20T21:29:18.634450562-08:00","updated_at":"2025-12-20T22:46:59.342149366-08:00","closed_at":"2025-12-20T22:46:59.342149366-08:00","labels":["epic"]}
{"id":"wf-urb.1","title":"Add config schema and example (config/workflow_agents.yaml)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T21:29:18.750941571-08:00","updated_at":"2025-12-20T21:44:18.313397086-08:00","closed_at":"2025-12-20T21:44:18.313404778-08:00","dependencies":[{"issue_id":"wf-urb.1","depends_on_id":"wf-urb","type":"parent-child","created_at":"2025-12-20T21:29:18.783210274-08:00","created_by":"daemon"}]}
{"id":"wf-urb.2","title":"Implement YAML parser helper (scripts/parse-workflow-config.py)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T21:29:18.877587481-08:00","updated_at":"2025-12-20T21:44:18.383236881-08:00","closed_at":"2025-12-20T21:44:18.383243625-08:00","dependencies":[{"issue_id":"wf-urb.2","depends_on_id":"wf-urb","type":"parent-child","created_at":"2025-12-20T21:29:18.878759212-08:00","created_by":"daemon"}]}
{"id":"wf-urb.3","title":"Update start-workflow-tmux.sh to read config and spawn panes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T21:29:18.93925385-08:00","updated_at":"2025-12-20T21:44:18.431327102-08:00","closed_at":"2025-12-20T21:44:18.431333846-08:00","dependencies":[{"issue_id":"wf-urb.3","depends_on_id":"wf-urb","type":"parent-child","created_at":"2025-12-20T21:29:18.940159795-08:00","created_by":"daemon"}]}
{"id":"wf-urb.4","title":"Wire idle task override to scripts/idle-scheduler.sh","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:29:18.992397493-08:00","updated_at":"2025-12-20T21:44:18.485307226-08:00","closed_at":"2025-12-20T21:44:18.48531397-08:00","dependencies":[{"issue_id":"wf-urb.4","depends_on_id":"wf-urb","type":"parent-child","created_at":"2025-12-20T21:29:18.993198323-08:00","created_by":"daemon"}]}
{"id":"wf-urb.5","title":"Document config format in docs/Workflow.md and docs/dev/idle_scheduler_module.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:29:19.048537279-08:00","updated_at":"2025-12-20T21:44:18.531701956-08:00","closed_at":"2025-12-20T21:44:18.531708068-08:00","dependencies":[{"issue_id":"wf-urb.5","depends_on_id":"wf-urb","type":"parent-child","created_at":"2025-12-20T21:29:19.049234152-08:00","created_by":"daemon"}]}
{"id":"wf-ux2","title":"Login fails with special characters","description":"Priority: 1","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-16T12:44:06.717940292-08:00","updated_at":"2025-12-16T12:44:18.171003121-08:00","deleted_at":"2025-12-16T12:44:18.171003121-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"wf-v0m","title":"Delegate command to pass work to another agent: Intake brief","description":"Problem:\n- We have waif ask to send free-form prompts to agents, but repeating delegation patterns (bead id + intent + agent) is common and error-prone. A dedicated waif delegate shortcut accepting a bead id, a short action phrase, and an agent target would provide a concise, auditable, reproducible way to delegate routine tasks to agents.\n\nUsers:\n- Primary: Producer (human) who delegates work.\n- Secondary: agent roles (patch, probe, scribbler, ship) that receive delegations; repo maintainers who review delegated actions.\n\nSuccess criteria:\n- A CLI command \"waif delegate \u003cbd-id\u003e \u003caction\u003e to \u003cagent\u003e\" exists that validates the bead id, records a delegation audit note in the bead, and issues a deterministic waif ask to the target agent with a standard prompt template. Acceptance test: running \"waif delegate wf-123 implement to patch\" results in a beads note on wf-123 containing \"delegated-to:@patch (implement)\" and an entry in the ask log.\n\nConstraints:\n- Timeline: P2 default.\n- Risk tolerance: low for automation performing publishing actions; default behavior is ask-only and requires explicit delegation for push/merge.\n- Compatibility: reuse existing waif ask mechanics and beads audit conventions; do not perform push/merge unless explicitly delegated.\n\nExisting state:\n- waif ask exists (src/commands/ask.ts).\n- Docs reference delegation patterns and recording conventions.\n\nDesired change:\n- Add a CLI subcommand waif delegate that: 1) validates bead id exists and is open; 2) formats a standard delegation prompt; 3) records an idempotent beads note (delegated-to:@\u003cagent\u003e (\u003caction\u003e)); 4) invokes waif ask to send the prompt; 5) prevents risky actions by default and surfaces approvals required.\n\nLikely duplicates / related docs:\n- docs/Workflow.md\n- docs/dev/CLI_PRD.md\n- docs/dev/TUI_PRD.md\n- docs/dev/git_workflow.md\n- docs/.github/permissions_matrix.md\n- .opencode/command/implement.md\n- .opencode/command/intake.md\n\nRelated issues:\n- wf-2ia: PM Delegation Workflow\n- wf-70j: Define the PM process for selecting and assigning work: Intake brief\n- wf-79y.15: Permissions \u0026 enforcement matrix for git operations\n\nClarifying questions:\n1) Should waif delegate be a client-side helper that only writes the beads note and composes waif ask, or should it optionally perform push/merge when delegated to an actor (opt-in only)?\n2) What is the canonical prompt template to send to agents? (e.g., \"Please implement \u003cbd-id\u003e: \u003cshort action\u003e\").\n3) Which agents (if any) should be allowed push/merge rights by default?\n\nProposed next step:\n- NEW PRD at: docs/dev/delegate_command_PRD.md\n- Recommended command to continue: /prd docs/dev/delegate_command_PRD.md \u003cnew-issue-id\u003e","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:05:09.802393461-08:00","updated_at":"2025-12-23T23:05:09.802393461-08:00"}
{"id":"wf-v5ox","title":"Feature: Delegate stage:plan_defined beads to GitHub Copilot","description":"# Headline\nAdd a `waif` CLI command that delegates a `stage:plan_defined` Beads issue subtree to GitHub Copilot by creating a GitHub Issue in the current repo’s `origin` remote, assigning it to GitHub user `copilot`, and updating the Beads subtree to `in_progress` with traceability via `bd update --external-ref`.\n\n# Key details\n\n## Problem\nProducers need a repeatable way to hand off well-planned Beads work to GitHub Copilot without manual translation into GitHub Issues and without losing traceability between the Beads graph and the GitHub work item.\n\n## Users\n- Primary: Producer / PM who delegates implementation work.\n- Secondary: Engineers reviewing Copilot output and progress; automation that reports on delegation/implementation.\n\n## Success criteria\n- Command fails fast with a clear error and no side effects if the bead is not eligible (not `status=open` or missing `stage:plan_defined`).\n- Given a bead id `X`, `waif` verifies:\n  - `X.status == open`\n  - `X.labels` include `stage:plan_defined` (case-insensitive)\n- `waif` gathers the full subtree: `X` plus all descendants (children-of-children, etc.).\n- `waif` creates exactly one GitHub Issue in the repo pointed to by `git remote get-url origin`.\n- The GitHub Issue contains:\n  - A clear summary of the parent bead goal.\n  - A roll-up of all descendant beads with their ids, titles, and acceptance criteria (where present).\n  - A “Beads references” section listing all included bead ids.\n- The GitHub Issue is assigned to GitHub user `copilot`.\n- After successful GitHub Issue creation, `waif` updates Beads for `X` and all descendants:\n  - `bd update \u003cid\u003e --status in_progress`\n  - `bd update \u003cid\u003e --add-label \"status:in_progress\"`\n  - `bd update \u003cid\u003e --external-ref \"\u003cissueUrl\u003e\"` (same external-ref value for all items)\n  - `bd comments add \u003cid\u003e \"Delegated to GitHub: \u003cissueUrl\u003e\"`\n- Idempotence:\n  - Re-running delegation for the same bead id does not create a second GitHub Issue.\n  - If `--external-ref` already exists on the bead (and looks like a GitHub Issue URL), `waif` reuses it (and may re-apply missing labels/comments idempotently).\n- Operational metric goal:\n  - Copilot successfully implements the feature in ~95% of cases (measurement definition and source is an open question).\n\n## Constraints\n- Use the `origin` remote of the current working directory to determine the GitHub repo to target.\n- Prefer GitHub CLI (`gh`) for GitHub Issue creation (assumes user is authenticated).\n- Use Beads CLI for all Beads mutations (no direct edits to `.beads/issues.jsonl`).\n- Be conservative/idempotent: do not duplicate comments, labels, or external refs.\n- ASCII-safe output suitable for terminal usage.\n\n## Existing state (if applicable)\n- Workflow stage labels are defined in `docs/dev/workflow_stage_tracking_PRD.md`, including `stage:plan_defined`.\n- `gh` is present in the environment (`gh --version` works).\n- Repo uses Beads (`bd`) for issue tracking.\n\n## Desired change (if applicable)\n- Add a new `waif` CLI command (name TBD; e.g., `waif delegate \u003cbead-id\u003e`).\n- The command uses the current working copy’s `origin` remote to determine the GitHub repo.\n- The command creates/updates GitHub+Beads artifacts as described in Success criteria.\n\n## Likely duplicates / related docs\n- `docs/dev/workflow_stage_tracking_PRD.md`\n- `docs/dev/integrations.md`\n\n## Related issues (Beads ids)\n- `wf-5e2` — PM: decompose PRD into bead plan (adjacent upstream work; produces plan-defined content)\n\n## Open questions\n- What is the exact GitHub Issue body template (section ordering, required fields)?\n- How should idempotence find the existing GitHub issue? (Preferred: read existing `--external-ref` on the bead and/or search GitHub issues for a marker.)\n- How do we define and measure “Copilot successfully implements the feature in 95% of cases”? (e.g., merged PR without human code changes? closed issue without reopen? time-to-merge threshold?)\n\n## Recommended next step\nNEW PRD at: `docs/prd/delegate_beads_to_github_copilot_PRD.md`\n\n## Notes\n- The `--external-ref` flag accepts a freeform string; for this feature we store the full GitHub Issue URL.\n","status":"open","priority":1,"issue_type":"feature","assignee":"Build","created_at":"2026-01-18T21:06:58.075827327-08:00","created_by":"WAIF","updated_at":"2026-01-18T21:06:58.075827327-08:00","labels":["Status: Intake Completed"]}
{"id":"wf-v5x","title":"Fix failing tests: ooda readOpencodeEvents parsing keeps only latest per agent","description":"Investigate and fix failing test in tests/ooda.test.ts: readOpencodeEvents should keep latest event per agent while parsing and skip invalid entries. Root cause may be parsing logic or deduplication logic in src/ooda.*","acceptance_criteria":"1) Tests in tests/ooda.test.ts pass locally.\n2) readOpencodeEvents correctly returns two distinct agent entries for the provided fixture.\n3) Add or update unit tests to prevent regressions.\n4) Link to any code changes in PR.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T22:55:27.80485155-08:00","updated_at":"2025-12-30T02:25:21.22467539-08:00","closed_at":"2025-12-30T02:25:21.22467539-08:00","close_reason":"Closed"}
{"id":"wf-vaq","title":"Ensure start-workflow-tmux exports BD_ACTOR and agent envs","notes":"start-workflow-tmux updated in PR 58 to export BD_ACTOR/WAIF_AGENT/OPENCODE_AGENT; validated tests and docs updated","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T20:13:21.797084879-08:00","updated_at":"2025-12-23T20:53:18.091758133-08:00","closed_at":"2025-12-23T20:53:18.091795856-08:00"}
{"id":"wf-vpw","title":"Implement runJobCommand (runner)","description":"Implement runJobCommand(job, options): spawn job.command, enforce timeout, capture stdout/stderr, sanitize redactions, return structured result suitable for snapshot writer.\\n\\nAcceptance criteria:\\n- Exports runJobCommand(job, {timeoutMs, cwd, env, capture}) in src/lib/runner.ts\\n- Uses child_process.spawn or execa; enforces timeout and kills process\\n- Returns { exitCode, signal, stdout, stderr, sanitized_output, durationMs }\\n- Unit tests mock child_process and cover success, non-zero exit, timeout, and large output truncation\\n- Types and exports documented in comments,description-file:-","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-10T14:57:03.839502027-08:00","created_by":"WAIF","updated_at":"2026-01-14T19:10:36.428473066-08:00","closed_at":"2026-01-14T19:10:36.428473066-08:00","close_reason":"Implemented \u0026 merged in PRs #101 and #103 (runner + tests). Files: src/lib/runner.ts, tests/lib/runner.test.ts. Closing as implemented."}
{"id":"wf-vs3","title":"Context command: non-deterministic output / idempotence failure","description":"Context command test is non-deterministic: repeated 'waif context' runs produced different files. Failing test: tests/context.command.test.ts -\u003e writes default file and overwrites on each run. Add investigation + make idempotent.","notes":"Fixed by excluding generated docs/dev/CONTEXT_PACK.md from scan; waif context now idempotent; tests/context.command.test.ts passes.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T23:18:37.766418615-08:00","created_by":"WAIF","updated_at":"2026-01-07T23:47:49.452196382-08:00","closed_at":"2026-01-07T23:47:49.452341982-08:00","dependencies":[{"issue_id":"wf-vs3","depends_on_id":"wf-k9f","type":"discovered-from","created_at":"2026-01-07T23:18:37.778242335-08:00","created_by":"WAIF"}]}
{"id":"wf-wb1y","title":"Refactor: remove duplicate regex in src/lib/redact.ts","description":"Remove duplicate regex block in src/lib/redact.ts and add a regression test.\\n\\nBackground:\\nsrc/lib/redact.ts contains a duplicated replacement block for inline JSON field truncation. This is harmless but confusing.\\n\\nAcceptance Criteria:\\n- Remove the duplicate regex replacement so the logic is only applied once.\\n- Add a unit test that verifies inline JSON field truncation behavior still applies (e.g., long \"text\" fields are truncated and marked with ...[TRUNCATED]).\\n- Run tests locally (CI) to ensure no regressions.\\n","status":"open","priority":3,"issue_type":"chore","created_at":"2026-01-16T01:18:48.58074284-08:00","created_by":"WAIF","updated_at":"2026-01-16T01:25:20.577070363-08:00","labels":["Refactor"],"dependencies":[{"issue_id":"wf-wb1y","depends_on_id":"wf-e6r.5","type":"discovered-from","created_at":"2026-01-16T01:18:48.582625898-08:00","created_by":"WAIF"}]}
{"id":"wf-wv1d","title":"Audit \u0026 close duplicate PRs merged into combined branch","description":"Find PRs merged into wf-k5um/combined-rename (PR #150) and close their corresponding open PRs if they are duplicates (add comment linking to PR #150). List PR numbers to be closed and close them manually or request maintainers to close if necessary.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T20:49:36.25477184-08:00","created_by":"WAIF","updated_at":"2026-01-16T20:57:56.583395159-08:00","closed_at":"2026-01-16T20:57:56.583403992-08:00"}
{"id":"wf-xcq","title":"Feature: ooda snapshot persistence (history JSONL)","description":"Acceptance criteria:\\n- CLI flag --log \u003cpath\u003e appends sanitized snapshot lines to history/\u003cfile\u003e.jsonl\\n- Snapshot shape: { time, agent, status, title, reason } (no full message bodies)\\n- Unit tests that simulate .opencode/logs/events.jsonl and assert snapshot append contains sanitized fields\\n- Test run passes locally (npm test)\\n\\nNotes: implement in src/commands/ooda.ts, tests under tests/; snapshot files live in history/ by default.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T16:00:27.50683035-08:00","updated_at":"2025-12-30T02:25:52.51447002-08:00","closed_at":"2025-12-30T02:25:52.51447002-08:00","close_reason":"Closed","dependencies":[{"issue_id":"wf-xcq","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T16:00:27.519913065-08:00","created_by":"daemon"}]}
{"id":"wf-xrl","title":"Q1: Confirm canonical event names used by workflow wf-r1d.2","description":"Confirm and lock canonical event names for v1. Recommended: agent.started, agent.stopped, agent.message (or message.returned). Update PRD if owners prefer alternate names.","notes":"Locked event names for v1: agent.started, agent.stopped, agent.message (recommended). PRD updated to reflect these names.","status":"closed","priority":1,"issue_type":"task","assignee":"patch","created_at":"2025-12-28T17:07:30.473534465-08:00","updated_at":"2025-12-28T21:27:56.214221389-08:00","closed_at":"2025-12-28T21:27:56.214227998-08:00","dependencies":[{"issue_id":"wf-xrl","depends_on_id":"wf-r1d.2","type":"discovered-from","created_at":"2025-12-28T17:07:30.482865155-08:00","created_by":"daemon"}]}
{"id":"wf-xtd","title":"Align OpenCode agent definitions with template","description":"Audit every .opencode/agent/*.md definition against the Forge template, normalize structure/permissions, and apply improvements requested by Producer.","notes":"All .opencode/agent definitions rewritten to match template (Focus, Workflow, Repo rules, Boundaries) with least-privilege permissions; forge.md now canonical example.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T19:06:14.185278567-08:00","updated_at":"2025-12-20T19:12:43.18581296-08:00","closed_at":"2025-12-20T19:12:40.97934297-08:00"}
{"id":"wf-xzis","title":"Remove 'wf context' command","description":"Remove the 'wf context' CLI command everywhere: implementation, tests, help, docs, and release notes.","acceptance_criteria":"1) 'wf context' command no longer appears in CLI help or available commands.\\n2) All CLI registration and handler code removed.\\n3) Tests referencing it removed/updated and CI passes.\\n4) Docs and release notes updated.\\n5) PR created, reviewed and merged.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-16T22:14:10.313934722-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.794459058-08:00","closed_at":"2026-01-16T22:28:27.794459058-08:00","close_reason":"Epic complete: all child issues closed after PR merge"}
{"id":"wf-xzis.1","title":"Remove 'wf context' from CLI registry and handlers","description":"Delete the command registration, handler functions, argument parsing, and any feature flags related to 'wf context'. Ensure no runtime references remain.","acceptance_criteria":"1) Command code removed. 2) Project builds and unit tests run. 3) No references at runtime.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-16T22:14:10.385109573-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.556999728-08:00","closed_at":"2026-01-16T22:28:27.556999728-08:00","close_reason":"Merged PR: removed 'wf context' command","dependencies":[{"issue_id":"wf-xzis.1","depends_on_id":"wf-xzis","type":"parent-child","created_at":"2026-01-16T22:14:10.397687253-08:00","created_by":"WAIF"}]}
{"id":"wf-xzis.2","title":"Remove or update tests referencing 'wf context'","description":"Find all tests that reference 'wf context' and remove or update them. Add coverage if needed.","acceptance_criteria":"CI unit tests pass without references to the command.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T22:14:10.444829878-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.619761498-08:00","closed_at":"2026-01-16T22:28:27.619761498-08:00","close_reason":"Merged PR: tests removed/updated","dependencies":[{"issue_id":"wf-xzis.2","depends_on_id":"wf-xzis","type":"parent-child","created_at":"2026-01-16T22:14:10.446205576-08:00","created_by":"WAIF"}]}
{"id":"wf-xzis.3","title":"Update CLI help and man pages to remove 'wf context'","description":"Update help output, man pages, and any auto-generated CLI docs so the command is no longer advertised.","acceptance_criteria":"CLI --help does not list 'wf context'; man/help pages updated.","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-16T22:14:10.489052882-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.675916818-08:00","closed_at":"2026-01-16T22:28:27.675916818-08:00","close_reason":"Merged PR: CLI help and man pages updated","dependencies":[{"issue_id":"wf-xzis.3","depends_on_id":"wf-xzis","type":"parent-child","created_at":"2026-01-16T22:14:10.489612449-08:00","created_by":"WAIF"}]}
{"id":"wf-xzis.4","title":"Update docs, README and release notes to remove references to 'wf context'","description":"Search docs/README and update or remove references to the command. Add a release note entry about removal if appropriate.","acceptance_criteria":"No repo docs reference 'wf context'; release notes draft included in PR.","status":"closed","priority":1,"issue_type":"chore","created_at":"2026-01-16T22:14:10.558298738-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.721915008-08:00","closed_at":"2026-01-16T22:28:27.721915008-08:00","close_reason":"Merged PR: docs and PRD updated","dependencies":[{"issue_id":"wf-xzis.4","depends_on_id":"wf-xzis","type":"parent-child","created_at":"2026-01-16T22:14:10.559300543-08:00","created_by":"WAIF"}]}
{"id":"wf-xzis.5","title":"Create branch, open PR, run CI and merge after review","description":"Create a topic branch named with the main implementation feature id, open a PR referencing the BD issues, run CI, and merge after review.","acceptance_criteria":"PR created and merged; BD issues closed or transitioned appropriately.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-16T22:14:10.601508486-08:00","created_by":"WAIF","updated_at":"2026-01-16T22:28:27.757479498-08:00","closed_at":"2026-01-16T22:28:27.757479498-08:00","close_reason":"PR created and merged","dependencies":[{"issue_id":"wf-xzis.5","depends_on_id":"wf-xzis","type":"parent-child","created_at":"2026-01-16T22:14:10.602102226-08:00","created_by":"WAIF"}]}
{"id":"wf-y6o","title":"Task: writeJobSnapshot + retention enforcement","description":"Implement append-only JSONL snapshot writer for job runs and enforce retention keep_last per job.","acceptance_criteria":"1) writeJobSnapshot appends a single-line JSON record with required fields. 2) enforceRetention keeps last N lines if keep_last set. 3) Tests cover writer and retention enforcement.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T20:38:02.652386973-08:00","created_by":"WAIF","updated_at":"2026-01-14T19:10:37.895308998-08:00","closed_at":"2026-01-14T19:10:37.895308998-08:00","close_reason":"writeJobSnapshot + retention enforcement implemented and merged. Files: src/lib/snapshotWriter.js (and src/lib/snapshots.ts), tests/lib/snapshots.test.ts. Closing as implemented; open wf-3wc for metadata additions.","dependencies":[{"issue_id":"wf-y6o","depends_on_id":"wf-bkt","type":"discovered-from","created_at":"2026-01-08T20:38:02.657504833-08:00","created_by":"WAIF"}],"comments":[{"id":87,"issue_id":"wf-y6o","author":"rgardler","text":"writeJobSnapshot + enforceRetention implemented in src/lib/snapshotWriter.js. Commit d865192. Branch: wf-e6r.2.1.1/job-command-work.","created_at":"2026-01-09T04:58:12Z"}]}
{"id":"wf-y8he","title":"Packaging: expose 'wf' binary alongside 'waif'","description":"Add a 'wf' bin entry in package.json (mapping 'wf' -\u003e dist/index.js) for install/publish parity and keep 'waif' for compatibility. Update packaging scripts and release steps so 'wf' is the canonical published CLI. Include tests: npm link should create a 'wf' executable and 'which wf' should resolve. Coordinate with ship for publishing (npm/homebrew).","notes":"PR https://github.com/SorraTheOrc/waif/pull/151","status":"closed","priority":1,"issue_type":"task","assignee":"rgardler","created_at":"2026-01-16T21:22:08.095073485-08:00","created_by":"WAIF","updated_at":"2026-01-16T21:31:12.722703229-08:00","closed_at":"2026-01-16T21:31:12.722703229-08:00","close_reason":"Merged via PR #151","external_ref":"gh-151","labels":["Status: PR Created"]}
{"id":"wf-ygu","title":"Docs: Fix README typos and clarify naming","description":"Fix spelling (e.g., 'accomodate' -\u003e 'accommodate') and clarify WAIF/WAFI naming in README.md for clarity.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-19T21:44:39.605504367-08:00","updated_at":"2025-12-19T22:11:35.584418906-08:00","dependencies":[{"issue_id":"wf-ygu","depends_on_id":"wf-s5d","type":"parent-child","created_at":"2025-12-19T22:11:34.443532972-08:00","created_by":"daemon"}]}
{"id":"wf-yjnx","title":"in-progress output missing dependency relationships in bd show","description":"Problem: The in-progress / bd ready output does not show \"Depends on\" relationships that appear in `bd show`. Example missing relationship:\n  → ge-hch.5: M2 — AI-assisted branching integration [P1]\n\nImpact: This causes incomplete blocker information in the in-progress view and can lead to work being started or merged out of order.\n\nAcceptance criteria:\n- bd ready and in-progress listings include \"Depends on\" lines for items that have dependencies, matching the dependency list shown by `bd show`.\n- The in-progress summary formatting includes linked IDs and titles (e.g., \"→ ge-hch.5: M2 — AI-assisted branching integration [P1]\").\n- Unit/integration test(s) added to validate in-progress output includes dependencies when present.\n- A short docs note added describing expected display behavior and how dependencies are represented in in-progress views.\n\nNotes: P0 (critical) because it affects correctness of scheduling and blocking semantics.","notes":"Duplicate of wf-fzov (Merged PR #159)","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-18T17:10:16.31133648-08:00","created_by":"WAIF","updated_at":"2026-01-19T00:58:20.225361685-08:00","closed_at":"2026-01-19T00:58:20.225368294-08:00","labels":["critical","display"]}
{"id":"wf-z2q","title":"chore: reinstate removed parent-\u003echild relationships","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-25T13:23:14.78227984-08:00","updated_at":"2026-01-19T03:00:57.187473136-08:00","closed_at":"2026-01-19T03:00:57.187473136-08:00","close_reason":"Closed"}
{"id":"wf-z3v","title":"Decide lint policy (add lint script vs update docs)","description":"Problem\\n- Workflow docs mention npm run lint as a standard quality gate, but the repo currently has no lint script in package.json. This creates inconsistent expectations and weakens branch protection guidance.\\n\\nGoal\\n- Decide which policy we want:\\n  A) Add a lint script (and optionally a CI lint check) so docs remain accurate, or\\n  B) Update docs/templates to stop referencing lint until the project adopts one.\\n\\nDecision criteria\\n- Do we have an eslint config (or other linter) we want to standardize on?\\n- Should lint be required in CI/branch protection or only optional locally?\\n\\nDeliverables\\n- A short decision recorded in bd comments on this issue that picks A or B and notes rationale.\\n- Close this issue once decision is made and the chosen implementation issue is unblocked.\\n\\nRelated follow-ups\\n- If A: see wf-1mv\\n- If B: see wf-u5m","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-22T23:26:27.086500222-08:00","updated_at":"2025-12-22T23:27:07.080538272-08:00","dependencies":[{"issue_id":"wf-z3v","depends_on_id":"wf-79y","type":"related","created_at":"2025-12-22T23:27:56.033937527-08:00","created_by":"daemon"}]}
{"id":"wf-zck","title":"Chore: run full test suite and report results","description":"Run the full test suite (npm test) on main after recent merges and report failures or flaky tests. Include timing and top failing tests if any. Acceptance criteria: full suite completes (pass/fail) and report posted to this bead.","status":"tombstone","priority":2,"issue_type":"chore","assignee":"probe","created_at":"2026-01-12T01:51:02.238455296-08:00","created_by":"WAIF","updated_at":"2026-01-12T01:56:21.404750572-08:00","dependencies":[{"issue_id":"wf-zck","depends_on_id":"wf-e6r.2","type":"discovered-from","created_at":"2026-01-12T01:51:02.239325246-08:00","created_by":"WAIF"}],"deleted_at":"2026-01-12T01:56:21.404750572-08:00","deleted_by":"daemon","delete_reason":"delete","original_type":"chore"}
{"id":"wf-zws","title":"Integration test: add waif show --json test","notes":"Integration test implemented and merged in PR #63. tests/show.cli.test.ts added by probe on branch feature/wf-zws-show-json-itest.","status":"closed","priority":2,"issue_type":"task","assignee":"rgardler","created_at":"2025-12-24T16:45:38.688911704-08:00","updated_at":"2025-12-24T17:59:36.844133824-08:00","closed_at":"2025-12-24T17:59:36.844231523-08:00","dependencies":[{"issue_id":"wf-zws","depends_on_id":"wf-3xw","type":"discovered-from","created_at":"2025-12-24T16:45:38.695564317-08:00","created_by":"daemon"}]}
